/*
  ___________           __         .__         .__        
 /   _____/  | __ _____/  |_  ____ |  |__      |__| ____  
 \_____  \|  |/ // __ \   __\/ ___\|  |  \     |  |/  _ \ 
 /        \    <\  ___/|  | \  \___|   Y  \    |  (  <_> )
/_______  /__|_ \\___  >__|  \___  >___|  / /\ |__|\____/ 
    \/     \/    \/          \/     \/  \/            
 
 HTML5 graphics made w/ WebGL, WebRTC & Canvas
 
 -------------------------------------------------------------------
 SketchAPI built for "Basic example"
 -------------------------------------------------------------------
 Sketch API v3.5.7.13
 Copyright (c) Sketch.IO, Inc. <https://sketch.io>
 -------------------------------------------------------------------
 
 The following list of modules are included in the SketchAPI, and
 are separately available under the MIT license: 
 -------------------------------------------------------------------
 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
 -------------------------------------------------------------------
    module: ClassList shim
       src: https://github.com/remy/polyfills
   authors: Remy Sharp
 copyright: (c) 2010 Remy Sharp, <http://remysharp.com>
   license: MIT
 -------------------------------------------------------------------
    module: CSSMatrix Decomposition
       src: http://www.joelambert.co.uk/morf/
    author: Joe Lambert
 copyright: (c) 2011 Joe Lambert <http://www.joelambert.co.uk>
   license: MIT
 -------------------------------------------------------------------
    module: MegaPixImage - fix rendering large images in iOS6/iOS7
       src: https://github.com/stomita/ios-imagefile-megapixel
    author: Shinichi Tomita
 copyright: (c) 2012 Shinichi Tomita <shinichi.tomita@gmail.com>
   license: MIT
 -------------------------------------------------------------------
    module: AnimationFrame shim
       src: https://github.com/kof/animationFrame
    author: Oleg Slobodskoi
 copyright: (c) 2013 Oleg Slobodskoi
   license: MIT
 -------------------------------------------------------------------
    module: CanvasToBlob.js - A canvas.toBlob() implementation.
       src: https://github.com/eligrey/canvas-toBlob.js
    author: Eli Grey
 copyright: (c) 2011 Eli Grey <http://eligrey.com>
   license: MIT
 -------------------------------------------------------------------
    module: Parse URI 1.2.2
       src: http://stevenlevithan.com
    author: Steven Levithan
 copyright: (c) 2007 Steven Levithan
   license: MIT
 -------------------------------------------------------------------
    module: arcToBezier - Convert from Elliptical Arc to Bezier Curve(s)
       src: http://stevenlevithan.com
    author: Raph Levien <raph@artofcode.com>
 copyright: (c) 2002 USC/Information Sciences Institute
   license: MIT
 -------------------------------------------------------------------
    module: Alertify.js - Theme-able alerts
       src: https://github.com/fabien-d/alertify.js/
    author: Fabien Doiron
 copyright: (c) 2012 Fabien Doiron
   license: MIT
 -------------------------------------------------------------------
    module: ContextMenu - Theme-able context menus.
       src: https://github.com/aantthony/contextmenu
    author: Anthony Foster
 copyright: (c) 2012 Anthony Foster
   license: MIT
 -------------------------------------------------------------------
    module: CSSMatrix shim
       src: https://github.com/camupod/CSSMatrix
   authors: Cameron Lakenen & Arian Stolwijk
 copyright: (c) 2013 Cameron Lakenen & Arian Stolwijk
   license: MIT
 -------------------------------------------------------------------
    module: Blob.js - A Blob implementation (2013-06-20)
       src: https://github.com/eligrey/Blob.js
    author: Eli Grey
 copyright: (c) 2011 Eli Grey <http://eligrey.com>
   license: MIT
 -------------------------------------------------------------------
    module: FileSaver.js - A saveAs() FileSaver implementation
       src: https://github.com/eligrey/FileSaver.js
    author: Eli Grey
 copyright: (c) 2011 Eli Grey <http://eligrey.com>
   license: MIT
*/
Array.isArray = Array.isArray || function(a) {
  return a && "[object Array]" === Object.prototype.toString.call(a)
};
Array.prototype.every = Array.prototype.every || function(a, g) {
  for (var c = 0, f = this.length; c < f && a.call(g || window, this[c], c, this); ++c);
  return c === f
};
Array.prototype.filter = Array.prototype.filter || function(a, g) {
  for (var c = [], f = 0, b = this.length, h; f < b; ++f) h = this[f], a.call(g || window, h, f, this) && c.push(h);
  return c
};
Array.prototype.forEach = Array.prototype.forEach || function(a, g) {
  for (var c = 0, f = this.length; c < f; ++c) a.call(g || window, this[c], c, this)
};
Array.prototype.indexOf = Array.prototype.indexOf || function(a) {
  for (var g = 0, c = this.length; g < c; ++g)
    if (this[g] === a) return g;
  return -1
};
Array.prototype.lastIndexOf = Array.prototype.lastIndexOf || function(a) {
  for (var g = this.length - 1; - 1 < g; --g)
    if (this[g] === a) return g;
  return -1
};
Array.prototype.map = Array.prototype.map || function(a, g) {
  for (var c = [], f = 0, b = this.length; f < b; ++f) c.push(a.call(g || window, this[f], f, this));
  return c
};
Array.prototype.reduce = Array.prototype.reduce || function(a, g) {
  for (var c = g || 0, f = 0, b = this.length; f < b; ++f) c = a.call(window, c, this[f], f, this);
  return c
};
Array.prototype.reduceRight = Array.prototype.reduceRight || function(a, g) {
  for (var c = g || 0, f = this.length - 1; - 1 < f; --f) c = a.call(window, c, this[f], f, this);
  return c
};
Array.prototype.some = Array.prototype.some || function(a, g) {
  for (var c = 0, f = this.length; c < f && !a.call(g || window, this[c], c, this); ++c);
  return c === f
};
Array.prototype.concat = Array.prototype.concat || function(a) {
  for (var g = 0; g < a.length; g++) this.push(a[g]);
  return this
};
(function(a) {
  a.btoa || (a.btoa = function(a) {
    a = escape(a);
    var c = "",
      f, b, h = "",
      d, e, m = "",
      k = 0;
    do f = a.charCodeAt(k++), b = a.charCodeAt(k++), h = a.charCodeAt(k++), d = f >> 2, f = (f & 3) << 4 | b >> 4, e = (b & 15) << 2 | h >> 6, m = h & 63, isNaN(b) ? e = m = 64 : isNaN(h) && (m = 64), c = c + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m);
    while (k < a.length);
    return c
  });
  a.atob || (a.atob = function(a) {
    var c = "",
      f, b, h = "",
      d, e = "",
      m = 0;
    /[^A-Za-z0-9\+\/\=]/g.exec(a) && alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");
    a = a.replace(/[^A-Za-z0-9\+\/\=]/g, "");
    do f = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(m++)), b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(m++)), d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(m++)),
      e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(m++)), f = f << 2 | b >> 4, b = (b & 15) << 4 | d >> 2, h = (d & 3) << 6 | e, c += String.fromCharCode(f), 64 != d && (c += String.fromCharCode(b)), 64 != e && (c += String.fromCharCode(h)); while (m < a.length);
    return unescape(c)
  })
})(this);
(function() {
  function a(a) {
    this._element = a;
    if (a.className != this._classCache && (this._classCache = a.className)) {
      a = this._classCache.replace(/^\s+|\s+$/g, "").split(/\s+/);
      var d;
      for (d = 0; d < a.length; d++) b.call(this, a[d])
    }
  }

  function g(a, d, b) {
    Object.defineProperty ? Object.defineProperty(a, d, {
      get: b
    }) : a.__defineGetter__(d, b)
  }
  if (!("undefined" === typeof window.Element || "classList" in document.documentElement)) {
    var c = Array.prototype,
      f = c.slice,
      b = c.push,
      h = c.splice,
      d = c.join;
    a.prototype = {
      add: function(a) {
        this.contains(a) ||
          (b.call(this, a), a = f.call(this, 0), this._element.className = a.join(" "))
      },
      contains: function(a) {
        return -1 !== Array.prototype.indexOf.call(this, a)
      },
      item: function(a) {
        return this[a] || null
      },
      remove: function(a) {
        a = Array.prototype.indexOf.call(this, a); - 1 !== a && (h.call(this, a, 1), a = f.call(this, 0), this._element.className = a.join(" "))
      },
      toString: function() {
        return d.call(this, " ")
      },
      toggle: function(a) {
        this.contains(a) ? this.remove(a) : this.add(a);
        return this.contains(a)
      }
    };
    window.DOMTokenList = a;
    g(Element.prototype, "classList",
      function() {
        return new a(this)
      })
  }
})();
window.WebKitCSSMatrix ? window.CSSMatrix = WebKitCSSMatrix : function() {
  function a() {
    var a = [].slice.call(arguments);
    if (a.length)
      for (var h = a.length; h--;) Math.abs(a[h]) < f && (a[h] = 0);
    c(this);
    if (16 == a.length) this.m11 = this.a = a[0], this.m12 = this.b = a[1], this.m13 = a[2], this.m14 = a[3], this.m21 = this.c = a[4], this.m22 = this.d = a[5], this.m23 = a[6], this.m24 = a[7], this.m31 = a[8], this.m32 = a[9], this.m33 = a[10], this.m34 = a[11], this.m41 = this.e = a[12], this.m42 = this.f = a[13], this.m43 = a[14], this.m44 = a[15];
    else if (6 == a.length) this.m11 = this.a =
      a[0], this.m12 = this.b = a[1], this.m21 = this.c = a[2], this.m22 = this.d = a[3], this.m41 = this.e = a[4], this.m42 = this.f = a[5];
    else if ("string" == typeof a[0]) this.setMatrixValue(a[0]);
    else if (0 < a.length) throw new TypeError("Invalid Matrix Value");
  }

  function g(b, c) {
    return new a(c.m11 * b.m11 + c.m12 * b.m21 + c.m13 * b.m31 + c.m14 * b.m41, c.m11 * b.m12 + c.m12 * b.m22 + c.m13 * b.m32 + c.m14 * b.m42, c.m11 * b.m13 + c.m12 * b.m23 + c.m13 * b.m33 + c.m14 * b.m43, c.m11 * b.m14 + c.m12 * b.m24 + c.m13 * b.m34 + c.m14 * b.m44, c.m21 * b.m11 + c.m22 * b.m21 + c.m23 * b.m31 + c.m24 * b.m41, c.m21 *
      b.m12 + c.m22 * b.m22 + c.m23 * b.m32 + c.m24 * b.m42, c.m21 * b.m13 + c.m22 * b.m23 + c.m23 * b.m33 + c.m24 * b.m43, c.m21 * b.m14 + c.m22 * b.m24 + c.m23 * b.m34 + c.m24 * b.m44, c.m31 * b.m11 + c.m32 * b.m21 + c.m33 * b.m31 + c.m34 * b.m41, c.m31 * b.m12 + c.m32 * b.m22 + c.m33 * b.m32 + c.m34 * b.m42, c.m31 * b.m13 + c.m32 * b.m23 + c.m33 * b.m33 + c.m34 * b.m43, c.m31 * b.m14 + c.m32 * b.m24 + c.m33 * b.m34 + c.m34 * b.m44, c.m41 * b.m11 + c.m42 * b.m21 + c.m43 * b.m31 + c.m44 * b.m41, c.m41 * b.m12 + c.m42 * b.m22 + c.m43 * b.m32 + c.m44 * b.m42, c.m41 * b.m13 + c.m42 * b.m23 + c.m43 * b.m33 + c.m44 * b.m43, c.m41 * b.m14 + c.m42 * b.m24 + c.m43 *
      b.m34 + c.m44 * b.m44)
  }

  function c(a) {
    a.m11 = a.a = 1;
    a.m12 = a.b = 0;
    a.m13 = 0;
    a.m14 = 0;
    a.m21 = a.c = 0;
    a.m22 = a.d = 1;
    a.m23 = 0;
    a.m24 = 0;
    a.m31 = 0;
    a.m32 = 0;
    a.m33 = 1;
    a.m34 = 0;
    a.m41 = a.e = 0;
    a.m42 = a.f = 0;
    a.m43 = 0;
    a.m44 = 1;
    return a
  }
  var f = 1E-6;
  a.prototype.setMatrixValue = function(a) {
    var h, d = [],
      e = /^matrix3d\((.*)\)/;
    a = String(a).trim();
    c(this);
    if (/^none$/.test(a)) return this;
    d = a.replace(/^.*\((.*)\)$/g, "$1").split(/\s*,\s*/);
    for (h = d.length; h--;) d[h] = parseFloat(d[h]);
    if (/^matrix\((.*)\)/.test(a) && 6 === d.length) this.m11 = this.a = d[0], this.m12 =
      this.b = d[2], this.m41 = this.e = d[4], this.m21 = this.c = d[1], this.m22 = this.d = d[3], this.m42 = this.f = d[5];
    else if (e.test(a) && 16 === d.length) this.m11 = this.a = d[0], this.m12 = this.b = d[1], this.m13 = d[2], this.m14 = d[3], this.m21 = this.c = d[4], this.m22 = this.d = d[5], this.m23 = d[6], this.m24 = d[7], this.m31 = d[8], this.m32 = d[9], this.m33 = d[10], this.m34 = d[11], this.m41 = this.e = d[12], this.m42 = this.f = d[13], this.m43 = d[14], this.m44 = d[15];
    else throw new TypeError("Invalid Matrix Value");
    return this
  };
  a.prototype.multiply = function(a) {
    return g(this,
      a)
  };
  a.prototype.inverse = function() {
    throw Error("the inverse() method is not implemented (yet).");
  };
  a.prototype.translate = function(b, c, d) {
    "undefined" == typeof d && (d = 0);
    var e = new a;
    e.m41 = e.e = b;
    e.m42 = e.f = c;
    e.m43 = d;
    return g(this, e)
  };
  a.prototype.scale = function(b, c, d) {
    "undefined" == typeof c && (c = b);
    "undefined" == typeof d && (d = 1);
    var e = new a;
    e.m11 = e.a = b;
    e.m22 = e.d = c;
    e.m33 = d;
    return g(this, e)
  };
  a.prototype.rotate = function(b, c, d) {
    "undefined" == typeof c && (c = b);
    "undefined" == typeof d && (d = b);
    var e, f;
    b *= Math.PI / 180;
    e = c *
      (Math.PI / 180);
    f = d * (Math.PI / 180);
    d = Math.cos(b);
    b = -Math.sin(b);
    c = Math.cos(e);
    e = -Math.sin(e);
    var k = Math.cos(f);
    f = -Math.sin(f);
    var l = new a;
    l.m11 = l.a = c * k;
    l.m12 = l.b = -c * f;
    l.m13 = e;
    l.m21 = l.c = b * e * k + d * f;
    l.m22 = l.d = d * k - b * e * f;
    l.m23 = -b * c;
    l.m31 = b * f - d * e * k;
    l.m32 = b * k + d * e * f;
    l.m33 = d * c;
    return g(this, l)
  };
  a.prototype.rotateAxisAngle = function(b, c, d, e) {
    "undefined" == typeof c && (c = b);
    "undefined" == typeof d && (d = b);
    var f;
    f = e * (Math.PI / 360);
    e = Math.sin(f);
    f = Math.cos(f);
    var k = e * e,
      l = Math.sqrt(b * b + c * c + d * d);
    0 === l ? (c = b = 0, d = 1) : (b /= l, c /=
      l, d /= l);
    var l = b * b,
      r = c * c,
      p = d * d,
      q = new a;
    q.m11 = q.a = 1 - 2 * (r + p) * k;
    q.m12 = q.b = 2 * (b * c * k + d * e * f);
    q.m13 = 2 * (b * d * k - c * e * f);
    q.m21 = q.c = 2 * (c * b * k - d * e * f);
    q.m22 = q.d = 1 - 2 * (p + l) * k;
    q.m23 = 2 * (c * d * k + b * e * f);
    q.m31 = 2 * (d * b * k + c * e * f);
    q.m32 = 2 * (d * c * k - b * e * f);
    q.m33 = 1 - 2 * (l + r) * k;
    q.m14 = q.m24 = q.m34 = 0;
    q.m41 = q.e = q.m42 = q.f = q.m43 = 0;
    q.m44 = 1;
    return g(this, q)
  };
  a.prototype.toString = function() {
    var a, c = function(a) {
        return a.toFixed(6)
      },
      d;
    d = this.m13 || this.m14 || this.m23 || this.m24 || this.m31 || this.m32 || 1 !== this.m33 || this.m34 || this.m43 || 1 !== this.m44 ? !1 :
      !0;
    d && (a = !0);
    return a ? "matrix(" + [this.a, this.b, this.c, this.d, this.e, this.f].map(c).join(", ") + ")" : "matrix3d(" + [this.m11, this.m12, this.m13, this.m14, this.m21, this.m22, this.m23, this.m24, this.m31, this.m32, this.m33, this.m34, this.m41, this.m42, this.m43, this.m44].map(c).join(", ") + ")"
  };
  a.prototype.skewX = function(b) {
    b *= Math.PI / 180;
    var c = new a;
    c.m21 = c.c = Math.tan(b);
    return g(c, this)
  };
  a.prototype.skewY = function(b) {
    b *= Math.PI / 180;
    var c = new a;
    c.m12 = c.b = Math.tan(b);
    return g(c, this)
  };
  "undefined" !== typeof exports ?
    ("undefined" !== typeof module && module.exports && (exports = module.exports = a), exports.CSSMatrix = a) : window.CSSMatrix = a
}();
(function() {
  var a = function(c, f, b, h) {
      this.x = c ? c : 0;
      this.y = f ? f : 0;
      this.z = b ? b : 0;
      this.w = h ? h : 0;
      this.checkValues = function() {
        this.x = this.x ? this.x : 0;
        this.y = this.y ? this.y : 0;
        this.z = this.z ? this.z : 0;
        this.w = this.w ? this.w : 0
      };
      this.length = function() {
        this.checkValues();
        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
      };
      this.normalise = function() {
        var d = this.length();
        return new a(this.x / d, this.y / d, this.z / d)
      };
      this.dot = function(a) {
        return this.x * a.x + this.y * a.y + this.z * a.z + this.w * a.w
      };
      this.cross = function(d) {
        return new a(this.y *
          d.z - this.z * d.y, this.z * d.x - this.x * d.z, this.x * d.y - this.y * d.x)
      };
      this.combine = function(d, e, b) {
        return new a(e * this.x + b * d.x, e * this.y + b * d.y, e * this.z + b * d.z)
      }
    },
    g = function(c) {
      void 0 === c ? c = {} : null;
      var f = {
          perspective: null,
          translate: null,
          skew: null,
          scale: null,
          rotate: null
        },
        b;
      for (b in f) this[b] = c[b] ? c[b] : new a
    };
  CSSMatrix.prototype.transformVector = function(c) {
    return new a(this.m11 * c.x + this.m12 * c.y + this.m13 * c.z, this.m21 * c.x + this.m22 * c.y + this.m23 * c.z, this.m31 * c.x + this.m32 * c.y + this.m33 * c.z)
  };
  CSSMatrix.prototype.transpose =
    function() {
      for (var a = new CSSMatrix, f = 0, b = 0, f = 0; 2 >= f; f++)
        for (b = f + 1; 3 >= b; b++) a["m" + (f + 1) + (b + 1)] = this["m" + (b + 1) + (f + 1)], a["m" + (b + 1) + (f + 1)] = this["m" + (f + 1) + (b + 1)];
      return a
    };
  CSSMatrix.prototype.determinant = function() {
    return this.m14 * this.m23 * this.m32 * this.m41 - this.m13 * this.m24 * this.m32 * this.m41 - this.m14 * this.m22 * this.m33 * this.m41 + this.m12 * this.m24 * this.m33 * this.m41 + this.m13 * this.m22 * this.m34 * this.m41 - this.m12 * this.m23 * this.m34 * this.m41 - this.m14 * this.m23 * this.m31 * this.m42 + this.m13 * this.m24 * this.m31 * this.m42 +
      this.m14 * this.m21 * this.m33 * this.m42 - this.m11 * this.m24 * this.m33 * this.m42 - this.m13 * this.m21 * this.m34 * this.m42 + this.m11 * this.m23 * this.m34 * this.m42 + this.m14 * this.m22 * this.m31 * this.m43 - this.m12 * this.m24 * this.m31 * this.m43 - this.m14 * this.m21 * this.m32 * this.m43 + this.m11 * this.m24 * this.m32 * this.m43 + this.m12 * this.m21 * this.m34 * this.m43 - this.m11 * this.m22 * this.m34 * this.m43 - this.m13 * this.m22 * this.m31 * this.m44 + this.m12 * this.m23 * this.m31 * this.m44 + this.m13 * this.m21 * this.m32 * this.m44 - this.m11 * this.m23 * this.m32 * this.m44 -
      this.m12 * this.m21 * this.m33 * this.m44 + this.m11 * this.m22 * this.m33 * this.m44
  };
  CSSMatrix.prototype.decompose = function() {
    var c = new CSSMatrix(this.toString()),
      f, b, h, d, e;
    if (0 === c.m33) return new g((new CSSMatrix).decompose());
    for (e = 1; 4 >= e; e++)
      for (j = 1; 4 >= j; j++) c["m" + e + j] /= c.m44;
    for (e = 1; 3 >= e; e++) c["m" + e + "4"] = 0;
    c.m44 = 1;
    if (0 === c.determinant()) return new g((new CSSMatrix).decompose());
    0 != c.m14 || 0 != c.m24 || 0 != c.m34 ? (f = new a(c.m14, c.m24, c.m34, c.m44), b = c.inverse(), b = b.transpose(), f = b.transformVector(f), c.m14 = c.m24 =
      c.m34 = 0, c.m44 = 1) : f = new a(0, 0, 0, 1);
    b = new a(c.m41, c.m42, c.m43);
    c.m41 = 0;
    c.m42 = 0;
    c.m43 = 0;
    h = [new a, new a, new a];
    for (e = 1; 3 >= e; e++) h[e - 1].x = c["m" + e + "1"], h[e - 1].y = c["m" + e + "2"], h[e - 1].z = c["m" + e + "3"];
    c = new a;
    d = new a;
    c.x = h[0].length();
    h[0] = h[0].normalise();
    d.x = h[0].dot(h[1]);
    h[1] = h[1].combine(h[0], 1, -d.x);
    c.y = h[1].length();
    h[1] = h[1].normalise();
    d.x /= c.y;
    d.y = h[0].dot(h[2]);
    h[2] = h[2].combine(h[0], 1, -d.y);
    d.z = h[1].dot(h[2]);
    h[2] = h[2].combine(h[1], 1, -d.z);
    c.z = h[2].length();
    h[2] = h[2].normalise();
    d.y /= c.z;
    d.y /= c.z;
    e = h[1].cross(h[2]);
    if (0 > h[0].dot(e))
      for (e = 0; 3 > e; e++) c.x *= -1, h[e].x *= -1, h[e].y *= -1, h[e].z *= -1;
    e = new a;
    e.y = Math.asin(-h[0].z);
    0 != Math.cos(e.y) ? (e.x = Math.atan2(h[1].z, h[2].z), e.z = Math.atan2(h[0].y, h[0].x)) : (e.x = Math.atan2(-h[2].x, h[1].y), e.z = 0);
    return new g({
      perspective: f,
      translate: b,
      skew: d,
      scale: c,
      rotate: e
    })
  }
})();
(function() {
  function a(a, b, c) {
    var d = document.createElement("canvas");
    g(a, d, b, c);
    return d.toDataURL("image/jpeg", b.quality || 0.8)
  }

  function g(a, b, c, d) {
    var e = a.naturalWidth,
      m = a.naturalHeight,
      k = c.width,
      l = c.height,
      r = b.getContext("2d");
    r.save();
    c = c.orientation;
    switch (c) {
      case 5:
      case 6:
      case 7:
      case 8:
        b.width = l;
        b.height = k;
        break;
      default:
        b.width = k, b.height = l
    }
    switch (c) {
      case 2:
        r.translate(k, 0);
        r.scale(-1, 1);
        break;
      case 3:
        r.translate(k, l);
        r.rotate(Math.PI);
        break;
      case 4:
        r.translate(0, l);
        r.scale(1, -1);
        break;
      case 5:
        r.rotate(0.5 *
          Math.PI);
        r.scale(1, -1);
        break;
      case 6:
        r.rotate(0.5 * Math.PI);
        r.translate(0, -l);
        break;
      case 7:
        r.rotate(0.5 * Math.PI);
        r.translate(k, -l);
        r.scale(-1, 1);
        break;
      case 8:
        r.rotate(-0.5 * Math.PI), r.translate(-k, 0)
    }
    b = a.naturalWidth;
    1048576 < b * a.naturalHeight ? (c = document.createElement("canvas"), c.width = c.height = 1, c = c.getContext("2d"), c.drawImage(a, -b + 1, 0), b = 0 === c.getImageData(0, 0, 1, 1).data[3]) : b = !1;
    b && (e /= 2, m /= 2);
    b = document.createElement("canvas");
    b.width = b.height = 1024;
    c = b.getContext("2d");
    if (d) {
      d = m;
      var p = document.createElement("canvas");
      p.width = 1;
      p.height = d;
      p = p.getContext("2d");
      p.drawImage(a, 0, 0);
      for (var p = p.getImageData(0, 0, 1, d).data, q = 0, t = d, s = d; s > q;) 0 === p[4 * (s - 1) + 3] ? t = s : q = s, s = t + q >> 1;
      d = s / d;
      d = 0 === d ? 1 : d
    } else d = 1;
    k = Math.ceil(1024 * k / e);
    l = Math.ceil(1024 * l / m / d);
    for (p = d = 0; d < m;) {
      for (t = q = 0; q < e;) c.clearRect(0, 0, 1024, 1024), c.drawImage(a, -q, -d), r.drawImage(b, 0, 0, 1024, 1024, t, p, k, l), q += 1024, t += k;
      d += 1024;
      p += l
    }
    r.restore()
  }

  function c(a) {
    if (window.Blob && a instanceof Blob) {
      var b = new Image,
        c = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL &&
        window.webkitURL.createObjectURL ? window.webkitURL : null;
      if (!c) throw Error("No createObjectURL function found to create blob url");
      b.src = c.createObjectURL(a);
      this.blob = a;
      a = b
    }
    if (!a.naturalWidth && !a.naturalHeight) {
      var d = this;
      a.onload = function() {
        var a = d.imageLoadListeners;
        if (a) {
          d.imageLoadListeners = null;
          for (var b = 0, c = a.length; b < c; b++) a[b]()
        }
      };
      this.imageLoadListeners = []
    }
    this.srcImage = a
  }
  c.prototype.render = function(c, b) {
    if (this.imageLoadListeners) {
      var h = this;
      this.imageLoadListeners.push(function() {
        h.render(c,
          b)
      })
    } else {
      b = b || {};
      var d = this.srcImage.naturalWidth,
        e = this.srcImage.naturalHeight,
        m = b.width,
        k = b.height,
        l = b.maxWidth,
        r = b.maxHeight,
        p = !this.blob || "image/jpeg" === this.blob.type;
      m && !k ? k = e * m / d << 0 : k && !m ? m = d * k / e << 0 : (m = d, k = e);
      l && m > l && (m = l, k = e * m / d << 0);
      r && k > r && (k = r, m = d * k / e << 0);
      var d = {
          width: m,
          height: k
        },
        q;
      for (q in b) d[q] = b[q];
      q = c.tagName.toLowerCase();
      "img" === q ? c.src = a(this.srcImage, d, p) : "canvas" === q && g(this.srcImage, c, d, p);
      if ("function" === typeof this.onrender) this.onrender(c)
    }
  };
  "function" === typeof define && define.amd ?
    define([], function() {
      return c
    }) : this.MegaPixImage = c
})();
(function(a) {
  function g(a) {
    if (!(this instanceof g)) return new g(a);
    a || (a = {});
    "number" == typeof a && (a = {
      frameRate: a
    });
    null != a.useNative || (a.useNative = !0);
    this.options = a;
    this.frameRate = a.frameRate || g.FRAME_RATE;
    this._frameLength = 1E3 / this.frameRate;
    this._isCustomFrameRate = this.frameRate !== g.FRAME_RATE;
    this._timeoutId = null;
    this._callbacks = {};
    this._tickCounter = this._lastTickTime = 0
  }
  var c, f;
  (function() {
    var b, h = ["webkit", "moz", "ms", "o"],
      d;
    try {
      a.top.name, d = a.top
    } catch (e) {
      d = a
    }
    c = d.requestAnimationFrame;
    f = d.cancelAnimationFrame ||
      d.cancelRequestAnimationFrame;
    for (b = 0; b < h.length && !c; b++) c = d[h[b] + "RequestAnimationFrame"], f = d[h[b] + "CancelAnimationFrame"] || d[h[b] + "CancelRequestAnimationFrame"];
    c && c(function() {
      g.hasNative = !0
    })
  })();
  g.FRAME_RATE = 60;
  g.shim = function(b) {
    var c = new g(b);
    a.requestAnimationFrame = function(a) {
      return c.request(a)
    };
    a.cancelAnimationFrame = function(a) {
      return c.cancel(a)
    };
    return c
  };
  g.now = Date.now || function() {
    return (new Date).getTime()
  };
  g.navigationStart = g.now();
  g.perfNow = function() {
    return a.performance && a.performance.now ?
      a.performance.now() : g.now() - g.navigationStart
  };
  g.hasNative = !1;
  g.prototype.request = function(b) {
    var h = this,
      d;
    ++this._tickCounter;
    if (g.hasNative && h.options.useNative && !this._isCustomFrameRate) return c(b);
    if (!b) throw new TypeError("Not enough arguments");
    null == this._timeoutId && (d = this._frameLength + this._lastTickTime - g.now(), 0 > d && (d = 0), this._timeoutId = a.setTimeout(function() {
      var a;
      h._lastTickTime = g.now();
      h._timeoutId = null;
      ++h._tickCounter;
      for (a in h._callbacks)
        if (h._callbacks[a]) {
          if (g.hasNative && h.options.useNative) c(h._callbacks[a]);
          else h._callbacks[a](g.perfNow());
          delete h._callbacks[a]
        }
    }, d));
    this._callbacks[this._tickCounter] = b;
    return this._tickCounter
  };
  g.prototype.cancel = function(a) {
    g.hasNative && this.options.useNative && f(a);
    delete this._callbacks[a]
  };
  "object" == typeof exports && "object" == typeof module ? module.exports = g : "function" == typeof define && define.amd ? define(function() {
    return g
  }) : a.AnimationFrame = g;
  a.requestAnimationframe && a.cancelAnimationFrame || g.shim()
})(window);
if ("function" !== typeof Blob && "object" !== typeof Blob || "undefined" === typeof URL)
  if ("function" !== typeof Blob && "object" !== typeof Blob || "undefined" === typeof webkitURL) var Blob = function(a) {
    var g = a.BlobBuilder || a.WebKitBlobBuilder || a.MozBlobBuilder || a.MSBlobBuilder || function(a) {
      var f = function(a) {
          return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]
        },
        b = function() {
          this.data = []
        },
        h = function(a, d, e) {
          this.data = a;
          this.size = a.length;
          this.type = d;
          this.encoding = e
        },
        d = b.prototype,
        e = h.prototype,
        m = a.FileReaderSync,
        k = function(a) {
          this.code = this[this.name = a]
        },
        l = "NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),
        r = l.length,
        p = a.URL || a.webkitURL || a,
        q = p.createObjectURL,
        t = p.revokeObjectURL,
        s = p,
        g = a.btoa,
        v = a.atob,
        u = a.ArrayBuffer,
        y = a.Uint8Array;
      for (h.fake = e.fake = !0; r--;) k.prototype[l[r]] = r + 1;
      p.createObjectURL || (s = a.URL = {});
      s.createObjectURL = function(a) {
        var d = a.type;
        null === d && (d = "application/octet-stream");
        if (a instanceof h) return d =
          "data:" + d, "base64" === a.encoding ? d + ";base64," + a.data : "URI" === a.encoding ? d + "," + decodeURIComponent(a.data) : g ? d + ";base64," + g(a.data) : d + "," + encodeURIComponent(a.data);
        if (q) return q.call(p, a)
      };
      s.revokeObjectURL = function(a) {
        "data:" !== a.substring(0, 5) && t && t.call(p, a)
      };
      d.append = function(a) {
        var d = this.data;
        if (y && (a instanceof u || a instanceof y)) {
          var e = "";
          a = new y(a);
          for (var b = 0, c = a.length; b < c; b++) e += String.fromCharCode(a[b]);
          d.push(e)
        } else if ("Blob" === f(a) || "File" === f(a))
          if (m) e = new m, d.push(e.readAsBinaryString(a));
          else throw new k("NOT_READABLE_ERR");
        else a instanceof h ? "base64" === a.encoding && v ? d.push(v(a.data)) : "URI" === a.encoding ? d.push(decodeURIComponent(a.data)) : "raw" === a.encoding && d.push(a.data) : ("string" !== typeof a && (a += ""), d.push(unescape(encodeURIComponent(a))))
      };
      d.getBlob = function(a) {
        arguments.length || (a = null);
        return new h(this.data.join(""), a, "raw")
      };
      d.toString = function() {
        return "[object BlobBuilder]"
      };
      e.slice = function(a, d, e) {
        var b = arguments.length;
        3 > b && (e = null);
        return new h(this.data.slice(a, 1 < b ? d :
          this.data.length), e, this.encoding)
      };
      e.toString = function() {
        return "[object Blob]"
      };
      return b
    }(a);
    return function(a, f) {
      var b = f ? f.type || "" : "",
        h = new g;
      if (a)
        for (var d = 0, e = a.length; d < e; d++) h.append(a[d]);
      return h.getBlob(b)
    }
  }(self);
  else self.URL = webkitURL;
  (function(a) {
    var g = a.Uint8Array;
    a = a.HTMLCanvasElement;
    var c = /\s*;\s*base64\s*(?:;|$)/i,
      f;
    g && (f = new g([62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51]));
    a && !a.prototype.toBlob && (a.toBlob = a.prototype.toBlob = function(a, h) {
      h || (h = "image/png");
      if (this.mozGetAsFile) a(this.mozGetAsFile("canvas", h));
      else {
        var d = Array.prototype.slice.call(arguments,
            1),
          e = this.toDataURL.apply(this, d),
          m = e.indexOf(","),
          d = e.substring(m + 1),
          e = c.test(e.substring(0, m)),
          k;
        if (Blob.fake) k = new Blob, k.encoding = e ? "base64" : "URI", k.data = d, k.size = d.length;
        else if (g)
          if (e) {
            k = Blob;
            for (var e = d.length, m = new g(3 * (e / 4) | 0), l = 0, r = 0, p = [0, 0], q = 0, t = 0, s, w; e--;) w = d.charCodeAt(l++), s = f[w - 43], 255 !== s && void 0 !== s && (p[1] = p[0], p[0] = w, t = t << 6 | s, q++, 4 === q && (m[r++] = t >>> 16, 61 !== p[1] && (m[r++] = t >>> 8), 61 !== p[0] && (m[r++] = t), q = 0));
            k = new k([m], {
              type: h
            })
          } else k = new Blob([decodeURIComponent(d)], {
            type: h
          });
        a(k)
      }
    });
    a && !a.prototype.toBlobURL && (a.prototype.toBlobURL = function(a) {
      a = a || function(a) {
        console.log("no callback", a)
      };
      this.toBlob(function(c) {
        a(URL.createObjectURL(c))
      })
    })
  })(self);
document.createElementNS || (document.createElementNS = function(a, g) {
  return document.createElement(g)
});
if (!window.chrome || !window.chrome.fileSystem) {
  var saveAs = saveAs || "undefined" !== typeof navigator && navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator) || function(a) {
    if ("undefined" === typeof navigator || !/MSIE [1-9]\./.test(navigator.userAgent)) {
      var g = a.document,
        c = a.URL || a.webkitURL || a,
        f = g.createElementNS("http://www.w3.org/1999/xhtml", "a"),
        b = !a.externalHost && "download" in f,
        h = a.webkitRequestFileSystem,
        d = a.requestFileSystem || h || a.mozRequestFileSystem,
        e = function(d) {
          (a.setImmediate || a.setTimeout)(function() {
            throw d;
          }, 0)
        },
        m = 0,
        k = [],
        l = function() {
          for (var a = k.length; a--;) {
            var d = k[a];
            "string" === typeof d ? c.revokeObjectURL(d) : d.remove()
          }
          k.length = 0
        },
        r = function(a, d, b) {
          d = [].concat(d);
          for (var c = d.length; c--;) {
            var k = a["on" + d[c]];
            if ("function" === typeof k) try {
              k.call(a, b || a)
            } catch (l) {
              e(l)
            }
          }
        },
        p = function(e, c) {
          var l = this,
            p = e.type,
            q = !1,
            t, z, A = function() {
              var d = (a.URL || a.webkitURL || a).createObjectURL(e);
              k.push(d);
              return d
            },
            B = function() {
              r(l, ["writestart", "progress", "write", "writeend"])
            },
            D = function() {
              if (q || !t) t = A(e);
              z ? z.location.href =
                t : window.open(t, "_blank");
              l.readyState = l.DONE;
              B()
            },
            G = function(a) {
              return function() {
                if (l.readyState !== l.DONE) return a.apply(this, arguments)
              }
            },
            F = {
              create: !0,
              exclusive: !1
            },
            C;
          l.readyState = l.INIT;
          c || (c = "download");
          if (b) t = A(e), g = a.document, f = g.createElementNS("http://www.w3.org/1999/xhtml", "a"), f.href = t, f.download = c, p = g.createEvent("MouseEvents"), p.initMouseEvent("click", !0, !1, a, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null), f.dispatchEvent(p), l.readyState = l.DONE, B();
          else {
            a.chrome && (p && "application/octet-stream" !== p) && (C =
              e.slice || e.webkitSlice, e = C.call(e, 0, e.size, "application/octet-stream"), q = !0);
            h && "download" !== c && (c += ".download");
            if ("application/octet-stream" === p || h) z = a;
            d ? (m += e.size, d(a.TEMPORARY, m, G(function(a) {
              a.root.getDirectory("saved", F, G(function(a) {
                var d = function() {
                  a.getFile(c, F, G(function(a) {
                    a.createWriter(G(function(d) {
                      d.onwriteend = function(d) {
                        z.location.href = a.toURL();
                        k.push(a);
                        l.readyState = l.DONE;
                        r(l, "writeend", d)
                      };
                      d.onerror = function() {
                        var a = d.error;
                        a.code !== a.ABORT_ERR && D()
                      };
                      ["writestart", "progress",
                        "write", "abort"
                      ].forEach(function(a) {
                        d["on" + a] = l["on" + a]
                      });
                      d.write(e);
                      l.abort = function() {
                        d.abort();
                        l.readyState = l.DONE
                      };
                      l.readyState = l.WRITING
                    }), D)
                  }), D)
                };
                a.getFile(c, {
                  create: !1
                }, G(function(a) {
                  a.remove();
                  d()
                }), G(function(a) {
                  a.code === a.NOT_FOUND_ERR ? d() : D()
                }))
              }), D)
            }), D)) : D()
          }
        },
        q = p.prototype,
        t = function(a, d) {
          return new p(a, d)
        };
      q.abort = function() {
        this.readyState = this.DONE;
        r(this, "abort")
      };
      q.readyState = q.INIT = 0;
      q.WRITING = 1;
      q.DONE = 2;
      q.error = q.onwritestart = q.onprogress = q.onwrite = q.onabort = q.onerror = q.onwriteend =
        null;
      a.addEventListener("unload", l, !1);
      t.unload = function() {
        l();
        a.removeEventListener("unload", l, !1)
      };
      return t
    }
  }("undefined" !== typeof self && self || "undefined" !== typeof window && window || this.content);
  "undefined" !== typeof module && null !== module ? module.exports = saveAs : "undefined" !== typeof define && null !== define && null != define.amd && define([], function() {
    return saveAs
  })
}
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.util && (sketch.util = {});
(function(a) {
  sketch.DomMisc = function(a) {
    var c = a.util = a.util || {};
    c.Canvas = function(b, d, e) {
      var c;
      e && (c = document.getElementById(e));
      c || (c = document.createElement("canvas"));
      "function" === typeof FlashCanvas && (c.onload = a.supports.fn.init);
      c.id = e || "";
      c.ctx = c.getContext("2d");
      b && d ? (c.width = b || 1, c.height = d || 1) : (b = a.canvas2d, c.width = b.width * b.pixelRatio, c.height = b.height * b.pixelRatio);
      return c
    };
    c.Canvas.getContext = function(a, d, e) {
      a = a || c.Canvas(d, e);
      if (a.getContext) return isFinite(d) && (a.width = d), isFinite(e) &&
        (a.height = e), a.getContext("2d");
      if (a.globalCompositeOperation) return isFinite(d) && (a.canvas.width = d), isFinite(e) && (a.canvas.height = e), a
    };
    c.json = {};
    c.json.filterCircular = function(a, d) {
      return "object" === typeof d && (null === d || d.nodeName || d.tagName) ? void 0 : d
    };
    c.getTime = function() {
      return window.performance && window.performance.now ? window.performance.now() : (new Date).getTime()
    };
    c.perf = a.perf = function() {
      var a = c.getTime();
      return function() {
        var d = c.getTime();
        return Math.round(d - a)
      }
    };
    c.exists = function(a, d) {
      try {
        for (var e =
            a.split("."), b = e.length, c = d || window, l = 0; l < b; l++) {
          var f = e[l];
          if (null == c[f]) return !1;
          c = c[f]
        }
        return !0
      } catch (p) {
        return !1
      }
    };
    var f = "function" === typeof CanvasPattern;
    c.clone = function(a) {
      if (!a || "object" !== typeof a) return a;
      if (a.constructor && !(a.childNodes || a.getImageData || f && a instanceof CanvasPattern)) {
        var d = new a.constructor,
          e;
        for (e in a) d[e] = a[e] && "object" === typeof a[e] ? c.clone(a[e]) : a[e];
        return d
      }
    };
    c.mergeObject = function(a, d) {
      if (!a || "object" !== typeof a) return d;
      for (var e in a)
        if (a[e] && "object" === typeof a[e]) {
          var b =
            a[e];
          b.cloneNode || (d[e] = typeof d[e] === typeof a[e] ? c.mergeObject(a[e], d[e]) : c.mergeObject(a[e], new b.constructor))
        } else d[e] = a[e];
      return d
    };
    c.count = function(a, d, e) {
      if (isFinite(a.length)) return a.length;
      if ("object" === typeof a) {
        var b = 0,
          c = "undefined" !== typeof d;
        if (c && "undefined" !== typeof e)
          for (var l in a) a[l] && a[l][d] === e && ++b;
        else if (c)
          for (l in a) "undefined" !== typeof a[l] && ++b;
        else
          for (l in a) ++b;
        return b
      }
    };
    c.clamp = function(a, d, e) {
      return a < d ? d : a > e ? e : a
    };
    c.each = function(a, d) {
      if (!d) return console.log("missing callback",
        arguments);
      if (!a) return console.log("missing object", arguments);
      for (var e = 0; e < a.length; e++) d(a[e])
    };
    c.object2array = function(a) {
      var d = [],
        e;
      for (e in a) d.push(e);
      return d
    };
    c.array2object = function(a) {
      for (var d = {}, e = 0, b = a.length; e < b; e++) d[a[e]] = !0;
      return d
    };
    c.array2index = function(a) {
      for (var d = {}, e = 0; e < a.length; e++) d[a[e]] = e;
      return d
    };
    c.getMetrics = function(a) {
      if (a = a || this.selection && this.selection[0]) {
        if (a === window || a === document) a = document.body;
        var d = {},
          e = a.getBoundingClientRect();
        d.width = e.width;
        d.height =
          e.height;
        d.x1 = e.left;
        d.y1 = e.top;
        d.scaleX = e.width / a.offsetWidth || 1;
        d.scaleY = e.height / a.offsetHeight || 1;
        d.scrollLeft = 0;
        d.scrollTop = 0;
        var e = window.getComputedStyle(a),
          c = b(e, "border-left-width"),
          k = b(e, "border-right-width"),
          l = b(e, "border-bottom-width"),
          f = b(e, "border-top-width");
        d.border = [c, k, f, l];
        d.x1 += c;
        d.y1 += f;
        d.width -= k + c;
        d.height -= l + f;
        c = b(e, "margin-left");
        k = b(e, "margin-right");
        l = b(e, "margin-bottom");
        f = b(e, "margin-top");
        d.border = [c, k, f, l];
        d.x1 -= c;
        d.y1 -= f;
        d.width += k + c;
        d.height += l + f;
        c = b(e, "padding-left");
        k = b(e, "padding-right");
        l = b(e, "padding-bottom");
        f = b(e, "padding-top");
        d.padding = [c, k, f, l];
        d.x2 = d.x1 + d.width;
        d.y2 = d.y1 + d.height;
        e = e.getPropertyValue("position");
        for (a = "fixed" === e ? a : a.parentNode; null !== a && a !== document.body && void 0 !== a.scrollTop;) {
          e = window.getComputedStyle(a);
          e = e.getPropertyValue("position");
          if ("absolute" !== e)
            if ("fixed" === e) {
              d.scrollTop -= a.parentNode.scrollTop;
              d.scrollLeft -= a.parentNode.scrollLeft;
              break
            } else d.scrollLeft += a.scrollLeft, d.scrollTop += a.scrollTop;
          a = a.parentNode
        }
        d.scrollBodyLeft =
          void 0 !== window.pageXOffset ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft;
        d.scrollBodyTop = void 0 !== window.pageYOffset ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
        d.scrollLeft -= d.scrollBodyLeft;
        d.scrollTop -= d.scrollBodyTop;
        return d
      }
    };
    var b = function(a, d) {
      var e = parseFloat(a.getPropertyValue(d), 10);
      return isFinite(e) ? e : 0
    };
    c.parseUri = function(a) {
      a || (a = window.location);
      var d = c.parseUri.options;
      a = d.parser[d.strictMode ?
        "strict" : "loose"].exec(a);
      for (var e = {}, b = 14; b--;) e[d.key[b]] = a[b] || "";
      e[d.q.name] = {};
      e[d.key[12]].replace(d.q.parser, function(a, b, c) {
        b && (e[d.q.name][b] = c)
      });
      return e
    };
    c.parseUri.isLocalhost = function(a) {
      var d = a.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);
      return "<" === a.substr(0, 1) || "string" === typeof d[1] && 0 < d[1].length && d[1].toLowerCase() !== location.protocol || "string" === typeof d[2] && 0 < d[2].length && d[2].replace(RegExp(":(" + {
          "http:": 80,
          "https:": 443
        }[location.protocol] + ")?$"), "") !==
        location.host ? !1 : !0
    };
    c.parseUri.options = {
      strictMode: !1,
      key: "source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
      q: {
        name: "queryKey",
        parser: /(?:^|&)([^&=]*)=?([^&]*)/g
      },
      parser: {
        strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
        loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
      }
    }
  };
  "undefined" !== typeof module && module.exports ? module.exports = sketch.DomMisc : sketch.DomMisc(sketch)
})(sketch);
var dom = {};
(function() {
  dom.removeChildNodes = function(a) {
    if (a)
      for (; a.hasChildNodes();) a.removeChild(a.firstChild)
  };
  dom.removeNodes = function(a) {
    "string" === typeof a && (a = sketch.$$(a));
    for (var g = 0, c = a.length; g < c; g++) {
      var f = a[g];
      f.parentNode.removeChild(f)
    }
  };
  dom.setCSS = function(a, g, c) {
    "string" === typeof a && (a = sketch.$$(a));
    for (var f = 0, b = a.length; f < b; f++) a[f].style[g] = c
  };
  dom.hasClass = function(a, g) {
    "string" === typeof a && (a = sketch.$(a));
    return -1 !== (" " + a.className + " ").indexOf(" " + g + " ")
  };
  dom.setClass = function(a, g, c, f) {
    "string" ===
    typeof a && (a = sketch.$(a));
    if (a)
      if (a.length)
        for (f = 0; f < a.length; f++) dom.setClass(a[f], g, c);
      else {
        a && g ? f = f || [a] : (c = a, g = c.className || "active", a = c.target || {}, f = c.list || [a], c = c.on);
        "undefined" === typeof c && (c = !0);
        if ("string" === typeof f) {
          if (!a.parentNode) return;
          f = a.parentNode.querySelectorAll(f)
        }
        var b = a.className || "";
        if (f.length)
          for (var h = 0, d = f.length; h < d; h++) {
            var e = " " + f[h].className + " ";
            f[h].className = e.split(" " + g + " ").join(" ").trim()
          } else a.className = (" " + b + " ").split(" " + g + " ").join(" ").trim();
        !1 ===
          c || ("toggle" === c && -1 !== b.indexOf(g) || a.className && -1 !== a.className.indexOf(g)) || (a.className = (a.className + " " + g).trim())
      }
  };
  dom.create = function(a, g) {
    if (-1 !== a.indexOf("<")) {
      var c = document.createElement("div");
      c.innerHTML = a;
      c = c.firstChild;
      if (!c) return
    } else c = document.createElement(a);
    for (var f in g) "function" === typeof g[f] && 0 === f.indexOf("on") && eventjs.add(c, f, g[f]);
    return c
  };
  dom.append = function(a, g) {
    "string" === typeof a && (a = sketch.$(a));
    "string" === typeof g && (g = dom.create(g));
    a.appendChild(g);
    return g
  }
})();
"undefined" === typeof dom && (dom = {});
(function() {
  var a, g = {};
  dom.loadImage = function(c) {
    "string" === typeof c && (c = {
      src: c
    });
    var b = c.image || new Image,
      h = function() {
        var b = c.src;
        return dom.loadImageBase64({
          url: b,
          onerror: function(a) {
            d(3);
            g[k.host] = 3
          },
          onload: function(e) {
            if (e) {
              var l = b.split(".").pop();
              c.src = "data:image/" + l + ";base64," + e.responseText;
              d(0);
              g[k.host] = !0 === a ? 1 : 0
            }
          },
          onprogress: c.onprogress
        })
      },
      d = function(a) {
        b.onload = c.onload;
        b.onerror = c.onerror;
        b.onprogress = c.onprogress;
        switch (a) {
          case 0:
            b.src = c.src;
            break;
          case 1:
            b.crossOrigin = "anonymous";
            b.src = c.src;
            break;
          case 2:
            h();
            break;
          case 3:
            if (!dom.loadImage.proxyUrl) break;
            b.src = dom.loadImage.proxyUrl + escape(c.src)
        }
        return b
      },
      e = function(a) {
        a = a.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);
        return "data:" === a[1] || "blob:" === a[1] || "filesystem:" === a[1] ? !0 : "string" === typeof a[1] && 0 < a[1].length && a[1].toLowerCase() !== location.protocol || "string" === typeof a[2] && 0 < a[2].length && a[2].replace(RegExp(":(" + {
          "http:": 80,
          "https:": 443
        }[location.protocol] + ")?$"), "") !== location.host ? !1 : !0
      },
      m = function() {
        if (e(c.src)) return d(0);
        var b = g[k.host];
        return "undefined" !== typeof b ? d(b) : !1 !== a || "withCredentials" in req ? h() : d(3)
      },
      k = document.createElement("a");
    k.href = c.src;
    if (e(c.src)) return d(0);
    if ("undefined" !== typeof a) return m(a);
    var l = new Image;
    l.crossOrigin = "anonymous";
    l.onload = function() {
      var d = document.createElement("canvas").getContext("2d");
      d.drawImage(l, 0, 0);
      try {
        d.getImageData(0, 0, 1, 1), m(a = !0)
      } catch (b) {
        m(a = !1)
      }
    };
    l.src = "https://lh4.googleusercontent.com/-Qw7nlh9DWec/TvV5qTZ9yfI/AAAAAAAADOA/XdalA5bQBOY/s128/1x1.png";
    return b
  };
  var c = function(a) {
    var b = "",
      c, d = Array(4),
      e = 0;
    for (c = 0; e < a.length;) {
      c = Array(3);
      for (var m = 0; m < c.length; m++) c[m] = e < a.length ? a.charCodeAt(e++) & 255 : 0;
      d[0] = c[0] >> 2;
      d[1] = (c[0] & 3) << 4 | c[1] >> 4;
      d[2] = (c[1] & 15) << 2 | c[2] >> 6;
      d[3] = c[2] & 63;
      c = e - (a.length - 1);
      switch (c) {
        case 2:
          d[3] = 64;
          d[2] = 64;
          break;
        case 1:
          d[3] = 64
      }
      for (m = 0; m < d.length; m++) b += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d[m])
    }
    return b
  };
  dom.loadImageBase64 = function(a) {
    var b = a.onload;
    a.onload = function(h) {
      if (h.responseText) {
        h = c(h.responseText);
        if (a.JS64) {
          h = "data:image/png;base64," + h;
          var d = document.createElement("canvas"),
            e = d.getContext("2d"),
            m = new Image;
          m.onload = function() {
            var a = this.offsetWidth,
              c = this.offsetHeight;
            d.width = a;
            d.height = c;
            d.style.width = a + "px";
            d.style.height = c + "px";
            document.getElementById("output");
            e.drawImage(this, 0, 0);
            for (var a = e.getImageData(0, 0, a, c).data, c = [], f = a.length, p = -1, q = 0; q < f; q += 4) 0 < a[q] && (c[++p] = String.fromCharCode(a[q]));
            a = c.join("");
            b({
              responseText: a
            });
            document.body.removeChild(m)
          };
          m.src = h;
          return !0
        }
        b({
          responseText: h
        })
      }
    };
    sketch.util.request(a)
  }
})();
"undefined" !== typeof module && module.exports && (module.exports = dom.loadImage);
"undefined" === typeof dom && (dom = {});
(function() {
  dom.loadScript = function() {
    this.loaded = {};
    this.loading = {};
    return this
  };
  dom.loadScript.prototype.add = function(a) {
    var g = this;
    "string" === typeof a && (a = {
      url: a
    });
    var c = a.urls;
    "undefined" === typeof c && (c = [{
      url: a.url,
      verify: a.verify
    }]);
    var f = document.getElementsByTagName("head")[0],
      b = function(a, d) {
        if (!(g.loaded[a.url] || d && "undefined" === typeof window[d])) {
          g.loaded[a.url] = !0;
          if (g.loading[a.url]) g.loading[a.url]();
          delete g.loading[a.url];
          a.callback && a.callback();
          "undefined" !== typeof r && r()
        }
      },
      h = !1,
      d = [],
      e = function(e) {
        "string" === typeof e && (e = {
          url: e,
          verify: a.verify
        });
        if (/([\w\d.])$/.test(e.verify)) {
          var c = e.test = e.verify;
          if ("object" === typeof c)
            for (var k = 0; k < c.length; k++) d.push(c[k]);
          else d.push(c)
        }
        g.loaded[e.url] || (c = document.createElement("script"), c.onreadystatechange = function() {
            "loaded" !== this.readyState && "complete" !== this.readyState || b(e)
          }, c.onload = function() {
            b(e)
          }, c.onerror = function(a) {
            h = !0;
            delete g.loading[e.url];
            if ("object" === typeof e.test)
              for (var d in e.test) m(e.test[d]);
            else m(e.test)
          },
          c.setAttribute("type", "text/javascript"), c.setAttribute("src", e.url), f.appendChild(c), g.loading[e.url] = function() {})
      },
      m = function(a) {
        for (var e = [], b = 0; b < d.length; b++) d[b] !== a && e.push(d[b]);
        d = e
      },
      k = function(e) {
        if (e) b(e, e.test);
        else
          for (var l = 0; l < c.length; l++) b(c[l], c[l].test);
        for (var f = !0, l = 0; l < d.length; l++) {
          var m = d[l];
          if (m && -1 !== m.indexOf(".")) {
            var m = m.split("."),
              r = window[m[0]];
            "undefined" !== typeof r && (2 === m.length ? "undefined" === typeof r[m[1]] && (f = !1) : 3 === m.length && "undefined" === typeof r[m[1]][m[2]] &&
              (f = !1))
          } else "undefined" === typeof window[m] && (f = !1)
        }!a.strictOrder && f ? h ? a.error && a.error() : a.callback && a.callback() : setTimeout(function() {
          k(e)
        }, 10)
      };
    if (a.strictOrder) {
      var l = -1,
        r = function() {
          l++;
          if (c[l]) {
            var d = c[l],
              b = d.url;
            g.loading[b] ? g.loading[b] = function() {
              d.callback && d.callback();
              r()
            } : g.loaded[b] ? r() : (e(d), k(d))
          } else h ? a.error && a.error() : a.callback && a.callback()
        };
      r()
    } else
      for (l = 0; l < c.length; l++) e(c[l]), k(c[l])
  };
  dom.loadScript = new dom.loadScript
})();
"undefined" !== typeof module && module.exports && (module.exports = dom.loadScript);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.util && (sketch.util = {});
(function(a) {
  a.util.request = function(g) {
    "undefined" === typeof XMLHttpRequest && (XMLHttpRequest, function() {
      for (var a = [function() {
          return new ActiveXObject("Msxml2.XMLHTTP")
        }, function() {
          return new ActiveXObject("Msxml3.XMLHTTP")
        }, function() {
          return new ActiveXObject("Microsoft.XMLHTTP")
        }], f = 0; f < a.length; f++) {
        try {
          a[f]()
        } catch (b) {
          continue
        }
        break
      }
      XMLHttpRequest = a[f]
    }());
    "undefined" === typeof(new XMLHttpRequest).responseText ? (document.write("\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n\x3c/script>\r\n"),
      a.util.request = function(a) {
        function f(a) {
          for (var e = {}, b = 0; 256 > b; b++)
            for (var c = 0; 256 > c; c++) e[String.fromCharCode(b + 256 * c)] = String.fromCharCode(b) + String.fromCharCode(c);
          b = IEBinaryToArray_ByteStr(a);
          a = IEBinaryToArray_ByteStr_Last(a);
          return b.replace(/[\s\S]/g, function(a) {
            return e[a]
          }) + a
        }
        "string" === typeof a && (a = {
          url: a
        });
        var b = XMLHttpRequest();
        b.open(a.body ? "POST" : "GET", a.url, !0);
        b.overrideMimeType && b.overrideMimeType("text/plain; charset=x-user-defined");
        if (a.headers)
          for (var h in a.headers) b.setRequestHeader(h,
            a.headers[h]);
        else a.body && b.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        a.responseType && (b.responseType = a.responseType);
        a.onerror && "onerror" in b && (b.onerror = a.onerror);
        a.onprogress && "onprogress" in b && (b.onprogress = a.onprogress);
        b.onreadystatechange = function(d) {
          if (4 === b.readyState)
            if (200 === b.status || 304 === b.status || 0 === b.status) {
              if (b.responseText = f(b.responseBody), a.onload) a.onload(b)
            } else if (a.onerror) a.onerror(d, !1)
        };
        b.setRequestHeader("Accept-Charset", "x-user-defined");
        b.send(null);
        return b
      }) : a.util.request = function(c) {
      "string" === typeof c && (c = {
        url: c
      });
      var f = new XMLHttpRequest;
      f.open(c.body ? "POST" : "GET", c.url, !0);
      f.overrideMimeType && f.overrideMimeType("text/plain; charset=x-user-defined");
      if (c.headers)
        for (var b in c.headers) f.setRequestHeader(b, c.headers[b]);
      else c.body && f.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      c.responseType && (f.responseType = c.responseType);
      c.onerror && "onerror" in f && (f.onerror = c.onerror);
      c.onprogress && (f.upload && "onprogress" in
        f.upload) && (c.body ? f.upload.onprogress = c.onprogress : f.onprogress = c.onprogress);
      f.onreadystatechange = function(b) {
        if (4 === f.readyState)
          if (200 === f.status || 304 === f.status || 0 === f.status && a.userAgent.cordova) {
            if (c.onload) c.onload(f)
          } else if (c.onerror) c.onerror(b, !1)
      };
      f.send(c.body);
      return f
    };
    a.util.request(g)
  }
})(sketch);
"undefined" !== typeof module && module.exports && (XMLHttpRequest = require("xmlhttprequest").XMLHttpRequest, module.exports = sketch.util.request);
"undefined" === typeof eventjs && (eventjs = {});
(function(a) {
  a.modifyEventListener = !1;
  a.modifySelectors = !1;
  a.add = function(a, d, b, e) {
    return c(a, d, b, e, "add")
  };
  a.remove = function(a, d, b, e) {
    return c(a, d, b, e, "remove")
  };
  a.returnFalse = function(a) {
    return !1
  };
  a.stop = function(a) {
    a && (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0, a.cancelBubbleCount = 0)
  };
  a.prevent = function(a) {
    a && (a.preventDefault ? a.preventDefault() : a.preventManipulation ? a.preventManipulation() : a.returnValue = !1)
  };
  a.cancel = function(d) {
    a.stop(d);
    a.prevent(d)
  };
  a.blur = function() {
    if (a.isEditingText()) {
      var d =
        document.activeElement;
      d.blur && d.blur()
    }
  };
  a.isEditingText = function() {
    var a = document.activeElement;
    if (!a) return !1;
    var d = a.nodeName;
    return "INPUT" === d || "TEXTAREA" === d || "true" === a.contentEditable ? !0 : !1
  };
  a.getEventSupport = function(a, d) {
    "string" === typeof a && (d = a, a = window);
    d = "on" + d;
    if (d in a) return !0;
    a.setAttribute || (a = document.createElement("div"));
    if (a.setAttribute && a.removeAttribute) {
      a.setAttribute(d, "");
      var b = "function" === typeof a[d];
      "undefined" !== typeof a[d] && (a[d] = null);
      a.removeAttribute(d);
      return b
    }
  };
  var g = function(a) {
      if (!a || "object" !== typeof a) return a;
      var d = new a.constructor,
        b;
      for (b in a) d[b] = a[b] && "object" === typeof a[b] ? g(a[b]) : a[b];
      return d
    },
    c = function(d, k, h, w, v, u) {
      w = w || {};
      if ("[object Object]" === String(d)) {
        var y = d;
        d = y.target;
        delete y.target;
        if (y.type && y.listener) {
          k = y.type;
          delete y.type;
          h = y.listener;
          delete y.listener;
          for (var x in y) w[x] = y[x]
        } else {
          for (var z in y) {
            var A = y[z];
            "function" !== typeof A && (w[z] = A)
          }
          var B = {};
          for (x in y) {
            z = x.split(",");
            var A = y[x],
              D = {},
              G;
            for (G in w) D[G] = w[G];
            if ("function" ===
              typeof A) h = A;
            else if ("function" === typeof A.listener)
              for (G in h = A.listener, A) "function" !== typeof A[G] && (D[G] = A[G]);
            else continue;
            for (A = 0; A < z.length; A++) B[x] = a.add(d, z[A], h, D, v)
          }
          return B
        }
      }
      if (d && k && h) {
        if ("string" === typeof d && "ready" === k)
          if (window.eventjs_stallOnReady) k = "load", d = window;
          else {
            var F = (new Date).getTime(),
              C = w.timeout,
              E = window.setInterval(function() {
                (new Date).getTime() - F > C && window.clearInterval(E);
                document.querySelector(d) && (window.clearInterval(E), setTimeout(h, 1))
              }, w.interval || 1E3 / 60);
            return
          }
        if ("string" ===
          typeof d) {
          d = document.querySelectorAll(d);
          if (0 === d.length) return b("Missing target on listener!", arguments);
          1 === d.length && (d = d[0])
        }
        y = {};
        if (0 < d.length && d !== window) {
          x = 0;
          for (G = d.length; x < G; x++)(z = c(d[x], k, h, g(w), v)) && (y[x] = z);
          return f(y)
        }
        "string" === typeof k && (k = k.toLowerCase(), -1 !== k.indexOf(" ") ? k = k.split(" ") : -1 !== k.indexOf(",") && (k = k.split(",")));
        if ("string" !== typeof k) {
          if ("number" === typeof k.length)
            for (x = 0, G = k.length; x < G; x++)(z = c(d, k[x], h, g(w), v)) && (y[k[x]] = z);
          else
            for (x in k)(z = "function" === typeof k[x] ?
              c(d, x, k[x], g(w), v) : c(d, x, k[x].listener, g(k[x]), v)) && (y[x] = z);
          return f(y)
        }
        0 === k.indexOf("on") && (k = k.substr(2));
        if ("object" !== typeof d) return b("Target is not defined!", arguments);
        if ("function" !== typeof h) return b("Listener is not a function!", arguments);
        x = w.useCapture || !1;
        y = l(d) + "." + l(h) + "." + (x ? 1 : 0);
        if (a.Gesture && a.Gesture._gestureHandlers[k]) {
          y = k + y;
          if ("remove" === v) {
            if (!m[y]) return;
            m[y].remove();
            delete m[y]
          } else if ("add" === v) {
            if (m[y]) return m[y].add(), m[y];
            if (w.useCall && !a.modifyEventListener) {
              var H =
                h;
              h = function(a, b) {
                for (var e in b) a[e] = b[e];
                return H.call(d, a)
              }
            }
            w.gesture = k;
            w.target = d;
            w.listener = h;
            w.fromOverwrite = u;
            m[y] = a.proxy[k](w)
          }
          return m[y]
        }
        for (var J = e(k), A = 0; A < J.length; A++)
          if (k = J[A], B = k + "." + y, "remove" === v) m[B] && (d[p](k, h, x), delete m[B]);
          else if ("add" === v) {
          if (m[B]) break;
          d[r](k, h, x);
          m[B] = {
            id: B,
            type: k,
            target: d,
            listener: h,
            remove: function() {
              for (var b = 0; b < J.length; b++) a.remove(d, J[b], h, w)
            }
          }
        }
        return m[B]
      }
    },
    f = function(a) {
      return {
        remove: function() {
          for (var d in a) a[d].remove()
        },
        add: function() {
          for (var d in a) a[d].add()
        }
      }
    },
    b = function(a, d) {
      "undefined" !== typeof console && "undefined" !== typeof console.error && console.error(a, d)
    },
    h = {
      msPointer: ["MSPointerDown", "MSPointerMove", "MSPointerUp"],
      touch: ["touchstart", "touchmove", "touchend"],
      mouse: ["mousedown", "mousemove", "mouseup"]
    },
    d = {
      MSPointerDown: 0,
      MSPointerMove: 1,
      MSPointerUp: 2,
      touchstart: 0,
      touchmove: 1,
      touchend: 2,
      mousedown: 0,
      mousemove: 1,
      mouseup: 2
    };
  a.supports = {};
  window.navigator.msPointerEnabled && (a.supports.msPointer = !0);
  a.getEventSupport("touchstart") && (a.supports.touch = !0);
  a.getEventSupport("mousedown") &&
    (a.supports.mouse = !0);
  var e = function() {
      return function(b) {
        var e = document.addEventListener ? "" : "on",
          c = d[b];
        if (isFinite(c)) {
          b = [];
          for (var k in a.supports) b.push(e + h[k][c]);
          return b
        }
        return [e + b]
      }
    }(),
    m = {},
    k = 0,
    l = function(a) {
      if (a === window) return "#window";
      if (a === document) return "#document";
      a.uniqueID || (a.uniqueID = "e" + k++);
      return a.uniqueID
    },
    r = document.addEventListener ? "addEventListener" : "attachEvent",
    p = document.removeEventListener ? "removeEventListener" : "detachEvent";
  a.createPointerEvent = function(d, b, e) {
    var c =
      b.gesture,
      k = b.target,
      l = d.changedTouches || a.proxy.getCoords(d);
    if (l.length) {
      var f = l[0];
      b.pointers = e ? [] : l;
      b.pageX = f.pageX;
      b.pageY = f.pageY;
      b.x = b.pageX;
      b.y = b.pageY
    }
    e = document.createEvent("Event");
    e.initEvent(c, !0, !0);
    e.originalEvent = d;
    for (var p in b) "target" !== p && (e[p] = b[p]);
    d = e.type;
    a.Gesture && a.Gesture._gestureHandlers[d] && b.oldListener.call(k, e, b, !1)
  };
  a.modifyEventListener && window.HTMLElement && function() {
    var d = function(d) {
      var b = function(b) {
        var k = b + "EventListener",
          l = d[k];
        d[k] = function(d, k, f) {
          if (a.Gesture &&
            a.Gesture._gestureHandlers[d]) {
            var p = f;
            "object" === typeof f ? p.useCall = !0 : p = {
              useCall: !0,
              useCapture: f
            };
            c(this, d, k, p, b, !0)
          } else
            for (d = e(d), p = 0; p < d.length; p++) l.call(this, d[p], k, f)
        }
      };
      b("add");
      b("remove")
    };
    navigator.userAgent.match(/Firefox/) ? (d(HTMLDivElement.prototype), d(HTMLCanvasElement.prototype)) : d(HTMLElement.prototype);
    d(document);
    d(window)
  }();
  a.modifySelectors && function() {
    var a = NodeList.prototype;
    a.removeEventListener = function(a, d, b) {
      for (var e = 0, c = this.length; e < c; e++) this[e].removeEventListener(a,
        d, b)
    };
    a.addEventListener = function(a, d, b) {
      for (var e = 0, c = this.length; e < c; e++) this[e].addEventListener(a, d, b)
    }
  }();
  return a
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.pointerSetup = function(d) {
    d.target = d.target || window;
    d.doc = d.target.ownerDocument || d.target;
    d.minFingers = d.minFingers || d.fingers || 1;
    d.maxFingers = d.maxFingers || d.fingers || Infinity;
    d.position = d.position || "relative";
    delete d.fingers;
    var b = {
      enabled: !0
    };
    b.gesture = d.gesture;
    b.target = d.target;
    b.env = d.env;
    a.modifyEventListener && d.fromOverwrite && (d.oldListener = d.listener, d.listener = a.createPointerEvent);
    var c = 0,
      k = 0 === b.gesture.indexOf("pointer") && a.modifyEventListener ? "pointer" :
      "mouse";
    d.oldListener && (b.oldListener = d.oldListener);
    b.listener = d.listener;
    b.__listener = d.listener;
    b.proxy = function(a) {
      d.listener = a;
      a(d.event, b)
    };
    b.add = function() {
      !0 !== b.enabled && (d.onPointerDown && a.add(d.target, k + "down", d.onPointerDown), d.onPointerMove && a.add(d.doc, k + "move", d.onPointerMove), d.onPointerUp && a.add(d.doc, k + "up", d.onPointerUp), b.enabled = !0)
    };
    b.remove = function() {
      !1 !== b.enabled && (d.onPointerDown && a.remove(d.target, k + "down", d.onPointerDown), d.onPointerMove && a.remove(d.doc, k + "move", d.onPointerMove),
        d.onPointerUp && a.remove(d.doc, k + "up", d.onPointerUp), b.reset(), b.enabled = !1)
    };
    b.pause = function(b) {
      !d.onPointerMove || b && !b.move || a.remove(d.doc, k + "move", d.onPointerMove);
      !d.onPointerUp || b && !b.up || a.remove(d.doc, k + "up", d.onPointerUp);
      c = d.fingers;
      d.fingers = 0
    };
    b.resume = function(b) {
      !d.onPointerMove || b && !b.move || a.add(d.doc, k + "move", d.onPointerMove);
      !d.onPointerUp || b && !b.up || a.add(d.doc, k + "up", d.onPointerUp);
      d.fingers = c
    };
    b.cancel = function(a) {
      g.animation.stop();
      b.pause(a)
    };
    b.reset = function() {
      d.tracker = {};
      d.fingers = 0
    };
    return b
  };
  g.hasDistance = function(a, b) {
    return !(a.x === b.x && a.y === b.y)
  };
  g.animation = new function() {
    var a = this,
      b = !1,
      c = null,
      k = function() {
        c();
        b && requestAnimationFrame(k)
      };
    this.stop = function() {
      b = !1
    };
    this.listener = function(l, f, p) {
      if ("down" === f.state) {
        var h = null,
          g = null;
        c = function() {
          if (h !== f.x || g !== f.y || "up" === f.state) p(l, f), h = f.x, g = f.y
        };
        b || (b = !0, k())
      } else "up" === f.state && a.stop()
    };
    return this
  };
  var c = a.supports;
  a.isMouse = !!c.mouse;
  a.isMSPointer = !!c.touch;
  a.isTouch = !!c.msPointer;
  g.pointerStart = function(d,
    b, c) {
    var k = (d.type || "mousedown").toUpperCase();
    0 === k.indexOf("MOUSE") ? (a.isMouse = !0, a.isTouch = !1, a.isMSPointer = !1) : 0 === k.indexOf("TOUCH") ? (a.isMouse = !1, a.isTouch = !0, a.isMSPointer = !1) : 0 === k.indexOf("MSPOINTER") && (a.isMouse = !1, a.isTouch = !1, a.isMSPointer = !0);
    var l = function(a, d) {
      var b = c.bbox,
        e = f[d] = {};
      switch (c.position) {
        case "absolute":
          e.offsetX = 0;
          e.offsetY = 0;
          break;
        case "differenceFromLast":
          e.offsetX = a.pageX;
          e.offsetY = a.pageY;
          break;
        case "difference":
          e.offsetX = a.pageX;
          e.offsetY = a.pageY;
          break;
        case "move":
          e.offsetX =
            a.pageX - b.x1;
          e.offsetY = a.pageY - b.y1;
          break;
        default:
          e.offsetX = b.x1 - b.scrollLeft, e.offsetY = b.y1 - b.scrollTop
      }
      var b = a.pageX - e.offsetX,
        k = a.pageY - e.offsetY;
      e.rotation = 0;
      e.scale = 1;
      e.startTime = e.moveTime = (new Date).getTime();
      e.move = {
        x: b,
        y: k
      };
      e.start = {
        x: b,
        y: k
      };
      c.fingers++
    };
    c.event = d;
    c.listener = b.__listener;
    var k = !c.fingers,
      f = c.tracker;
    d = d.changedTouches || g.getCoords(d);
    for (var p = d.length, h = 0; h < p; h++) {
      var t = d[h],
        s = t.identifier || Infinity;
      if (c.fingers) {
        if (c.fingers >= c.maxFingers) {
          var w = [];
          for (s in c.tracker) w.push(s);
          b.identifier = w.join(",");
          return k
        }
        var v = 0;
        for (w in f) {
          if (f[w].up) {
            delete f[w];
            l(t, s);
            c.cancel = !0;
            break
          }
          v++
        }
        f[s] || l(t, s)
      } else f = c.tracker = {}, b.bbox = c.bbox = g.getBoundingBox(c.target), c.fingers = 0, c.cancel = !1, l(t, s)
    }
    w = [];
    for (s in c.tracker) w.push(s);
    b.identifier = w.join(",");
    a.isTouchStart = !0;
    a.isTouchEnd = !1;
    return k
  };
  g.pointerEnd = function(d, b, c, k) {
    var l = d.touches || [],
      f = l.length;
    d = {};
    for (var p = 0; p < f; p++) {
      var h = l[p].identifier;
      d[h || Infinity] = !0
    }
    for (h in c.tracker) l = c.tracker[h], d[h] || l.up || (k && k({
      pageX: l.pageX,
      pageY: l.pageY,
      changedTouches: [{
        pageX: l.pageX,
        pageY: l.pageY,
        identifier: "Infinity" === h ? Infinity : h
      }]
    }, "up"), l.up = !0, c.fingers--);
    if (0 !== c.fingers) return !1;
    k = [];
    c.gestureFingers = 0;
    for (h in c.tracker) c.gestureFingers++, k.push(h);
    b.identifier = k.join(",");
    a.isTouchEnd = !0;
    a.isTouchStart = !1;
    return !0
  };
  g.getCoords = function(a) {
    isFinite(a.pageX) ? g.getCoords = function(a) {
      return Array({
        type: "mouse",
        x: a.pageX,
        y: a.pageY,
        pageX: a.pageX,
        pageY: a.pageY,
        identifier: a.pointerId || Infinity
      })
    } : g.getCoords = function(a) {
      var d = document.documentElement;
      a = a || window.event;
      return Array({
        type: "mouse",
        x: a.clientX + d.scrollLeft,
        y: a.clientY + d.scrollTop,
        pageX: a.clientX + d.scrollLeft,
        pageY: a.clientY + d.scrollTop,
        identifier: Infinity
      })
    };
    return g.getCoords(a)
  };
  var f = 0,
    b = 0;
  g.getCoord = function(a) {
    if (a.changedTouches) return (a = a.changedTouches) && a.length ? {
      x: f = a[0].pageX,
      y: b = a[0].pageY
    } : {
      x: f,
      y: b
    };
    if (isFinite(a.pageX) && isFinite(a.pageY)) return {
      x: a.pageX,
      y: a.pageY
    };
    var e = document.documentElement;
    a = a || window.event;
    return {
      x: a.clientX + e.scrollLeft,
      y: a.clientY + e.scrollTop
    }
  };
  var h = function(a, b) {
    var c = parseFloat(a.getPropertyValue(b), 10);
    return isFinite(c) ? c : 0
  };
  g.getBoundingBox = function(a) {
    if (a === window || a === document) a = document.body;
    var b = {},
      c = a.getBoundingClientRect();
    b.width = c.width;
    b.height = c.height;
    b.x1 = c.left;
    b.y1 = c.top;
    b.scaleX = c.width / a.offsetWidth || 1;
    b.scaleY = c.height / a.offsetHeight || 1;
    b.scrollLeft = 0;
    b.scrollTop = 0;
    c = window.getComputedStyle(a);
    if (!1 === ("border-box" === c.getPropertyValue("box-sizing"))) {
      var k = h(c, "border-left-width"),
        l = h(c, "border-right-width"),
        f =
        h(c, "border-bottom-width"),
        p = h(c, "border-top-width");
      b.border = [k, l, p, f];
      b.x1 += k;
      b.y1 += p;
      b.width -= l + k;
      b.height -= f + p
    }
    b.x2 = b.x1 + b.width;
    b.y2 = b.y1 + b.height;
    c = c.getPropertyValue("position");
    for (a = "fixed" === c ? a : a.parentNode; null !== a && a !== document.body && void 0 !== a.scrollTop;) {
      c = window.getComputedStyle(a);
      c = c.getPropertyValue("position");
      if ("absolute" !== c)
        if ("fixed" === c) {
          b.scrollTop -= a.parentNode.scrollTop;
          b.scrollLeft -= a.parentNode.scrollLeft;
          break
        } else b.scrollLeft += a.scrollLeft, b.scrollTop += a.scrollTop;
      a = a.parentNode
    }
    b.scrollBodyLeft = void 0 !== window.pageXOffset ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft;
    b.scrollBodyTop = void 0 !== window.pageYOffset ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
    b.scrollLeft -= b.scrollBodyLeft;
    b.scrollTop -= b.scrollBodyTop;
    return b
  };
  (function() {
    var d = navigator.userAgent.toLowerCase(),
      b = -1 !== d.indexOf("macintosh"),
      c;
    c = b && -1 !== d.indexOf("khtml") ? {
        91: !0,
        93: !0
      } : b && -1 !==
      d.indexOf("firefox") ? {
        224: !0
      } : {
        17: !0
      };
    (g.metaTrackerReset = function() {
      a.fnKey = g.fnKey = !1;
      a.metaKey = g.metaKey = !1;
      a.escKey = g.escKey = !1;
      a.ctrlKey = g.ctrlKey = !1;
      a.shiftKey = g.shiftKey = !1;
      a.altKey = g.altKey = !1
    })();
    g.metaTracker = function(d) {
      var b = "keydown" === d.type;
      27 === d.keyCode && (a.escKey = g.escKey = b);
      c[d.keyCode] && (a.metaKey = g.metaKey = b);
      a.ctrlKey = g.ctrlKey = d.ctrlKey;
      a.shiftKey = g.shiftKey = d.shiftKey;
      a.altKey = g.altKey = d.altKey
    }
  })()
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.MutationObserver = function() {
  var a = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver,
    g = !a && function() {
      var a = document.createElement("p"),
        f = !1,
        b = function() {
          f = !0
        };
      if (a.addEventListener) a.addEventListener("DOMAttrModified", b, !1);
      else if (a.attachEvent) a.attachEvent("onDOMAttrModified", b);
      else return !1;
      a.setAttribute("id", "target");
      return f
    }();
  return function(c, f) {
    a ? (new a(function(a) {
      a.forEach(function(a) {
        f.call(a.target, a.attributeName)
      })
    })).observe(c, {
      subtree: !1,
      attributes: !0
    }) : g ? eventjs.add(c, "DOMAttrModified", function(a) {
      f.call(c, a.attrName)
    }) : "onpropertychange" in document.body && eventjs.add(c, "propertychange", function(a) {
      f.call(c, window.event.propertyName)
    })
  }
}();
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.click = function(c) {
    c.gesture = c.gesture || "click";
    c.maxFingers = c.maxFingers || c.fingers || 1;
    c.onPointerDown = function(b) {
      g.pointerStart(b, f, c) && a.add(c.target, "mouseup", c.onPointerUp)
    };
    c.onPointerUp = function(b) {
      if (g.pointerEnd(b, f, c)) {
        a.remove(c.target, "mouseup", c.onPointerUp);
        var h = (b.changedTouches || g.getCoords(b))[0],
          d = c.bbox,
          e = g.getBoundingBox(c.target),
          m = h.pageY - e.scrollBodyTop,
          h = h.pageX - e.scrollBodyLeft;
        if (h > d.x1 && m > d.y1 && h < d.x2 && m < d.y2 && d.scrollTop === e.scrollTop) {
          for (var k in c.tracker) break;
          d = c.tracker[k];
          f.x = d.start.x;
          f.y = d.start.y;
          c.listener(b, f)
        }
      }
    };
    var f = g.pointerSetup(c);
    f.state = "click";
    a.add(c.target, "mousedown", c.onPointerDown);
    return f
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.click = g.click
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.dbltap = g.dblclick = function(c) {
    c.gesture = c.gesture || "dbltap";
    c.maxFingers = c.maxFingers || c.fingers || 1;
    var f, b, h, d, e;
    c.onPointerDown = function(k) {
      var l = k.changedTouches || g.getCoords(k);
      f && !b ? (e = l[0], b = (new Date).getTime() - f) : (d = l[0], f = (new Date).getTime(), b = 0, clearTimeout(h), h = setTimeout(function() {
        f = 0
      }, 700));
      g.pointerStart(k, m, c) && (a.add(c.target, "mousemove", c.onPointerMove).listener(k), a.add(c.target, "mouseup", c.onPointerUp))
    };
    c.onPointerMove = function(k) {
      if (f && !b) e = (k.changedTouches ||
        g.getCoords(k))[0];
      else if (!e) return;
      k = c.bbox;
      var l = e.pageX - k.x1,
        m = e.pageY - k.y1;
      0 < l && l < k.width && 0 < m && m < k.height && 25 >= Math.abs(e.pageX - d.pageX) && 25 >= Math.abs(e.pageY - d.pageY) || (a.remove(c.target, "mousemove", c.onPointerMove), clearTimeout(h), f = b = 0)
    };
    c.onPointerUp = function(d) {
      g.pointerEnd(d, m, c) && (a.remove(c.target, "mousemove", c.onPointerMove), a.remove(c.target, "mouseup", c.onPointerUp));
      if (f && b) {
        if (700 >= b) {
          m.state = c.gesture;
          for (var e in c.tracker) break;
          e = c.tracker[e];
          m.x = e.start.x;
          m.y = e.start.y;
          c.listener(d,
            m)
        }
        clearTimeout(h);
        f = b = 0
      }
    };
    var m = g.pointerSetup(c);
    m.state = "dblclick";
    a.add(c.target, "mousedown", c.onPointerDown);
    return m
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.dbltap = g.dbltap;
  a.Gesture._gestureHandlers.dblclick = g.dblclick
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.dragElement = function(c, f) {
    g.drag({
      event: f,
      target: c,
      position: "move",
      listener: function(b, f) {
        c.style.left = f.x + "px";
        c.style.top = f.y + "px";
        a.prevent(b)
      }
    })
  };
  g.drag = function(c) {
    c.gesture = "drag";
    c.onPointerDown = function(b) {
      g.pointerStart(b, f, c) && !c.monitor && (a.add(c.doc, "mousemove", c.onPointerMove), a.add(c.doc, "mouseup", c.onPointerUp));
      c.onPointerMove(b, "down")
    };
    c.onPointerMove = function(a, h) {
      if (!c.tracker) return c.onPointerDown(a);
      for (var d = a.changedTouches || g.getCoords(a), e = d.length,
          m = 0; m < e; m++) {
        var k = d[m],
          l = k.identifier || Infinity,
          r = c.tracker[l];
        r && (r.pageX = k.pageX, r.pageY = k.pageY, f.state = h || "move", f.identifier = l, f.start = r.start, f.fingers = c.fingers, "differenceFromLast" === c.position ? (f.x = r.pageX - r.offsetX, f.y = r.pageY - r.offsetY, r.offsetX = r.pageX, r.offsetY = r.pageY) : (f.x = r.pageX - r.offsetX, f.y = r.pageY - r.offsetY), c.animationFrame ? g.animation.listener(a, f, c.listener) : c.listener(a, f))
      }
    };
    c.onPointerUp = function(b) {
      g.pointerEnd(b, f, c, c.onPointerMove) && !c.monitor && (a.remove(c.doc, "mousemove",
        c.onPointerMove), a.remove(c.doc, "mouseup", c.onPointerUp))
    };
    var f = g.pointerSetup(c);
    if (c.event) c.onPointerDown(c.event);
    else a.add(c.target, "mousedown", c.onPointerDown), c.monitor && (a.add(c.doc, "mousemove", c.onPointerMove), a.add(c.doc, "mouseup", c.onPointerUp));
    return f
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.drag = g.drag
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy,
    c = Math.PI / 180,
    f = function(a, c) {
      var d = 0,
        e = 0,
        f = 0,
        k;
      for (k in c) {
        var l = c[k];
        l.up || (d += l.move.x, e += l.move.y, f++)
      }
      a.x = d / f;
      a.y = e / f;
      return a
    };
  g.gesture = function(b) {
    b.gesture = b.gesture || "gesture";
    b.minFingers = b.minFingers || b.fingers || 2;
    b.onPointerDown = function(d) {
      var e = b.fingers;
      g.pointerStart(d, h, b) && (a.add(b.doc, "mousemove", b.onPointerMove), a.add(b.doc, "mouseup", b.onPointerUp));
      if (b.fingers === b.minFingers && e !== b.fingers) {
        h.fingers = b.minFingers;
        h.scale = 1;
        h.rotation = 0;
        h.state = "start";
        var e = "",
          c;
        for (c in b.tracker) e += c;
        h.identifier = parseInt(e);
        f(h, b.tracker);
        b.listener(d, h)
      }
    };
    b.onPointerMove = function(a, e) {
      for (var m = b.bbox, k = b.tracker, l = a.changedTouches || g.getCoords(a), r = l.length, p = 0; p < r; p++) {
        var q = l[p],
          t = q.identifier || Infinity,
          s = k[t];
        s && (s.move.x = q.pageX - m.x1, s.move.y = q.pageY - m.y1)
      }
      if (!(b.fingers < b.minFingers)) {
        l = [];
        r = m = 0;
        f(h, k);
        for (t in k)
          if (q = k[t], !q.up) {
            p = q.start;
            if (!p.distance) {
              var s = p.x - h.x,
                w = p.y - h.y;
              p.distance = Math.sqrt(s * s + w * w);
              p.angle = Math.atan2(s, w) / c
            }
            var s = q.move.x - h.x,
              w = q.move.y - h.y,
              v = Math.sqrt(s * s + w * w),
              m = m + v / p.distance,
              s = Math.atan2(s, w) / c,
              p = (p.angle - s + 360) % 360 - 180;
            q.DEG2 = q.DEG1;
            q.DEG1 = 0 < p ? p : -p;
            isFinite(q.DEG2) && (q.rotation = 0 < p ? q.rotation + (q.DEG1 - q.DEG2) : q.rotation - (q.DEG1 - q.DEG2), r += q.rotation);
            l.push(q.move)
          }
        h.touches = l;
        h.fingers = b.fingers;
        h.scale = m / b.fingers;
        h.rotation = r / b.fingers;
        h.state = "change";
        b.listener(a, h)
      }
    };
    b.onPointerUp = function(d) {
      var e = b.fingers;
      g.pointerEnd(d, h, b) && (a.remove(b.doc, "mousemove", b.onPointerMove), a.remove(b.doc, "mouseup", b.onPointerUp));
      e === b.minFingers && b.fingers < b.minFingers && (h.fingers = b.fingers, h.state = "end", b.listener(d, h))
    };
    var h = g.pointerSetup(b);
    a.add(b.target, "mousedown", b.onPointerDown);
    return h
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.gesture = g.gesture
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.pointerdown = g.pointermove = g.pointerup = function(c) {
    c.gesture = c.gesture || "pointer";
    if (!c.target.isPointerEmitter) {
      var f = !0;
      c.onPointerDown = function(a) {
        f = !1;
        b.gesture = "pointerdown";
        c.listener(a, b)
      };
      c.onPointerMove = function(a) {
        b.gesture = "pointermove";
        c.listener(a, b, f)
      };
      c.onPointerUp = function(a) {
        f = !0;
        b.gesture = "pointerup";
        c.listener(a, b, !0)
      };
      var b = g.pointerSetup(c);
      a.add(c.target, "mousedown", c.onPointerDown);
      a.add(c.target, "mousemove", c.onPointerMove);
      a.add(c.doc, "mouseup",
        c.onPointerUp);
      c.target.isPointerEmitter = !0;
      return b
    }
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.pointerdown = g.pointerdown;
  a.Gesture._gestureHandlers.pointermove = g.pointermove;
  a.Gesture._gestureHandlers.pointerup = g.pointerup
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.shake = function(a) {
    var f = {
        gesture: "devicemotion",
        acceleration: {},
        accelerationIncludingGravity: {},
        target: a.target,
        listener: a.listener,
        remove: function() {
          window.removeEventListener("devicemotion", e, !1)
        }
      },
      b = (new Date).getTime(),
      h = {
        x: 0,
        y: 0,
        z: 0
      },
      d = {
        x: {
          count: 0,
          value: 0
        },
        y: {
          count: 0,
          value: 0
        },
        z: {
          count: 0,
          value: 0
        }
      },
      e = function(e) {
        var k = e.accelerationIncludingGravity;
        h.x = 0.8 * h.x + (1 - 0.8) * k.x;
        h.y = 0.8 * h.y + (1 - 0.8) * k.y;
        h.z = 0.8 * h.z + (1 - 0.8) * k.z;
        f.accelerationIncludingGravity = h;
        f.acceleration.x =
          k.x - h.x;
        f.acceleration.y = k.y - h.y;
        f.acceleration.z = k.z - h.z;
        if ("devicemotion" === a.gesture) a.listener(e, f);
        else
          for (var k = (new Date).getTime(), l = 0; 3 > l; l++) {
            var r = "xyz" [l],
              p = f.acceleration[r],
              r = d[r],
              q = Math.abs(p);
            !(1E3 > k - b) && 4 < q && (p = k * p / q, q = Math.abs(p + r.value), r.value && 200 > q ? (r.value = p, r.count++, 3 === r.count && (a.listener(e, f), b = k, r.value = 0, r.count = 0)) : (r.value = p, r.count = 1))
          }
      };
    if (window.addEventListener) return window.addEventListener("devicemotion", e, !1), f
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers =
    a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.shake = g.shake
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy,
    c = Math.PI / 180;
  g.swipe = function(f) {
    f.snap = f.snap || 90;
    f.threshold = f.threshold || 1;
    f.gesture = f.gesture || "swipe";
    f.onPointerDown = function(c) {
      g.pointerStart(c, b, f) && (a.add(f.doc, "mousemove", f.onPointerMove).listener(c), a.add(f.doc, "mouseup", f.onPointerUp))
    };
    f.onPointerMove = function(a) {
      a = a.changedTouches || g.getCoords(a);
      for (var d = a.length, b = 0; b < d; b++) {
        var c = a[b],
          k = f.tracker[c.identifier || Infinity];
        k && (k.move.x = c.pageX, k.move.y = c.pageY, k.moveTime = (new Date).getTime())
      }
    };
    f.onPointerUp =
      function(h) {
        if (g.pointerEnd(h, b, f)) {
          a.remove(f.doc, "mousemove", f.onPointerMove);
          a.remove(f.doc, "mouseup", f.onPointerUp);
          var d, e, m, k, l = {
              x: 0,
              y: 0
            },
            r = 0,
            p = 0,
            q = 0,
            t;
          for (t in f.tracker) {
            var s = f.tracker[t];
            k = s.move.x - s.start.x;
            var w = s.move.y - s.start.y,
              r = r + s.move.x,
              p = p + s.move.y;
            l.x += s.start.x;
            l.y += s.start.y;
            q++;
            e = Math.sqrt(k * k + w * w);
            s = s.moveTime - s.startTime;
            k = Math.atan2(k, w) / c + 180;
            e = s ? e / s : 0;
            if ("undefined" === typeof m) m = k, d = e;
            else if (20 >= Math.abs(k - m)) m = (m + k) / 2, d = (d + e) / 2;
            else return
          }
          t = f.gestureFingers;
          f.minFingers <=
            t && f.maxFingers >= t && d > f.threshold && (l.x /= q, l.y /= q, b.start = l, b.x = r / q, b.y = p / q, b.angle = -(((m / f.snap + 0.5 >> 0) * f.snap || 360) - 360), b.velocity = d, b.fingers = t, b.state = "swipe", f.listener(h, b))
        }
      };
    var b = g.pointerSetup(f);
    a.add(f.target, "mousedown", f.onPointerDown);
    return b
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.swipe = g.swipe
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.longpress = function(a) {
    a.gesture = "longpress";
    return g.tap(a)
  };
  g.tap = function(c) {
    c.delay = c.delay || 500;
    c.timeout = c.timeout || 250;
    c.driftDeviance = c.driftDeviance || 10;
    c.gesture = c.gesture || "tap";
    var f, b;
    c.onPointerDown = function(d) {
      g.pointerStart(d, h, c) && (f = (new Date).getTime(), a.add(c.doc, "mousemove", c.onPointerMove).listener(d), a.add(c.doc, "mouseup", c.onPointerUp), "longpress" === c.gesture && (b = setTimeout(function() {
        if (!(d.cancelBubble && 1 < ++d.cancelBubbleCount)) {
          var a = 0,
            b;
          for (b in c.tracker) {
            var k =
              c.tracker[b];
            if (!0 === k.end || c.cancel) return;
            a++
          }
          c.minFingers <= a && c.maxFingers >= a && (h.state = "start", h.fingers = a, h.x = k.start.x, h.y = k.start.y, c.listener(d, h))
        }
      }, c.delay)))
    };
    c.onPointerMove = function(d) {
      var b = c.bbox;
      d = d.changedTouches || g.getCoords(d);
      for (var f = d.length, k = 0; k < f; k++) {
        var l = d[k],
          h = c.tracker[l.identifier || Infinity];
        if (h) {
          var p = l.pageX - b.x1,
            l = l.pageY - b.y1,
            q = p - h.start.x,
            h = l - h.start.y,
            h = Math.sqrt(q * q + h * h);
          if (!(0 < p && p < b.width && 0 < l && l < b.height && h <= c.driftDeviance)) {
            a.remove(c.doc, "mousemove", c.onPointerMove);
            c.cancel = !0;
            break
          }
        }
      }
    };
    c.onPointerUp = function(d) {
      if (g.pointerEnd(d, h, c) && (clearTimeout(b), a.remove(c.doc, "mousemove", c.onPointerMove), a.remove(c.doc, "mouseup", c.onPointerUp), !(d.cancelBubble && 1 < ++d.cancelBubbleCount)))
        if ("longpress" === c.gesture) "start" === h.state && (h.state = "end", c.listener(d, h));
        else if (!(c.cancel || (new Date).getTime() - f > c.timeout)) {
        var e = c.gestureFingers;
        c.minFingers <= e && c.maxFingers >= e && (h.state = "tap", h.fingers = c.gestureFingers, c.listener(d, h))
      }
    };
    var h = g.pointerSetup(c);
    a.add(c.target,
      "mousedown", c.onPointerDown);
    return h
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.tap = g.tap;
  a.Gesture._gestureHandlers.longpress = g.longpress
})(eventjs);
"undefined" === typeof eventjs && (eventjs = {});
eventjs.proxy = eventjs.proxy || {};
(function(a) {
  var g = a.proxy;
  g.wheelPreventElasticBounce = function(c) {
    c && ("string" === typeof c && (c = document.querySelector(c)), a.add(c, "wheel", function(c, b) {
      b.preventElasticBounce();
      a.stop(c)
    }))
  };
  g.wheel = function(c) {
    var f, b = c.timeout || 150,
      h = 0,
      d = {
        gesture: "wheel",
        state: "start",
        wheelDelta: 0,
        target: c.target,
        listener: c.listener,
        preventElasticBounce: function(d) {
          var b = this.target,
            e = b.scrollTop;
          e + b.offsetHeight === b.scrollHeight && 0 >= this.wheelDelta ? a.cancel(d) : 0 === e && 0 <= this.wheelDelta && a.cancel(d);
          a.stop(d)
        },
        add: function() {
          c.target[m](l, e, !1)
        },
        remove: function() {
          c.target[k](l, e, !1)
        }
      },
      e = function(a) {
        a = a || window.event;
        d.state = h++ ? "change" : "start";
        d.wheelDelta = a.detail ? -20 * a.detail : a.wheelDelta;
        c.listener(a, d);
        clearTimeout(f);
        f = setTimeout(function() {
          h = 0;
          d.state = "end";
          d.wheelDelta = 0;
          c.listener(a, d)
        }, b)
      },
      m = document.addEventListener ? "addEventListener" : "attachEvent",
      k = document.removeEventListener ? "removeEventListener" : "detachEvent",
      l = a.getEventSupport("mousewheel") ? "mousewheel" : "DOMMouseScroll";
    c.target[m](l,
      e, !1);
    return d
  };
  a.Gesture = a.Gesture || {};
  a.Gesture._gestureHandlers = a.Gesture._gestureHandlers || {};
  a.Gesture._gestureHandlers.wheel = g.wheel
})(eventjs);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.language && (sketch.language = {});
(function(a) {
  var g;
  a.language.setLocale = function(f) {
    g ? g.setLocale(f) : g = new c({
      directory: "./js/project/locales",
      locale: f,
      extension: ".json",
      onload: function(b) {
        a.configure.lang = f
      }
    })
  };
  a.language.translate = function(c) {
    var b = a.configure.lang,
      h = g.__(c);
    h ? -1 !== h.indexOf("{") && (h = h.replace("{sk-version}", a.__version)) : (h = c, "en" !== b && a.feature.debug && console.log("Missing translation:", arguments));
    return h
  };
  var c = function(c) {
    for (var b in c) this[b] = c[b];
    c = this.locale;
    a.language[c] ? this.setLocaleData(c, a.language[c]) :
      this.setLocale(c)
  };
  c.localeCache = {};
  c.prototype = {
    defaultLocale: "en",
    directory: "/locales",
    extension: ".min.json",
    getLocale: function() {
      return this.locale
    },
    setLocale: function(a) {
      a || (a = document.querySelector("html").getAttribute("lang"));
      a || (a = this.defaultLocale);
      this.locale = a;
      a in c.localeCache || this.getLocaleFileFromServer()
    },
    setLocaleData: function(a, b) {
      c.localeCache[a] = b
    },
    getLocaleFileFromServer: function(a) {
      var b = this.onload,
        h = this.locale;
      sketch.util.request({
        url: this.directory + "/" + h + this.extension,
        onload: function(a) {
          a = JSON.parse(a.responseText);
          c.localeCache[h] = a;
          b && b(a)
        }
      })
    },
    __: function() {
      var a = c.localeCache[this.locale][arguments[0]];
      1 < arguments.length && (a = vsprintf(a, Array.prototype.slice.call(arguments, 1)));
      return a
    },
    __n: function(a, b) {
      var h = c.localeCache[this.locale][a];
      b = parseInt(b, 10);
      h = 0 === b ? h.zero : 1 < b ? h.other : h.one;
      h = vsprintf(h, [b]);
      2 < arguments.length && (h = vsprintf(h, Array.prototype.slice.call(arguments, 2)));
      return h
    }
  };
  (function(a) {
    function b(a) {
      return Object.prototype.toString.call(a).slice(8, -1).toLowerCase()
    }
    var c = function() {
      c.cache.hasOwnProperty(arguments[0]) || (c.cache[arguments[0]] = c.parse(arguments[0]));
      return c.format.call(null, c.cache[arguments[0]], arguments)
    };
    c.format = function(a, e) {
      var f = 1,
        k = a.length,
        l = "",
        r = [],
        p, q, g, s;
      for (p = 0; p < k; p++)
        if (l = b(a[p]), "string" === l) r.push(a[p]);
        else if ("array" === l) {
        g = a[p];
        if (g[2])
          for (l = e[f], q = 0; q < g[2].length; q++) {
            if (!l.hasOwnProperty(g[2][q])) throw c('[sprintf] property "%s" does not exist', g[2][q]);
            l = l[g[2][q]]
          } else l = g[1] ? e[g[1]] : e[f++];
        if (/[^s]/.test(g[8]) &&
          "number" != b(l)) throw c("[sprintf] expecting number but found %s", b(l));
        switch (g[8]) {
          case "b":
            l = l.toString(2);
            break;
          case "c":
            l = String.fromCharCode(l);
            break;
          case "d":
            l = parseInt(l, 10);
            break;
          case "e":
            l = g[7] ? l.toExponential(g[7]) : l.toExponential();
            break;
          case "f":
            l = g[7] ? parseFloat(l).toFixed(g[7]) : parseFloat(l);
            break;
          case "o":
            l = l.toString(8);
            break;
          case "s":
            l = (l = String(l)) && g[7] ? l.substring(0, g[7]) : l;
            break;
          case "u":
            l >>>= 0;
            break;
          case "x":
            l = l.toString(16);
            break;
          case "X":
            l = l.toString(16).toUpperCase()
        }
        l = /[def]/.test(g[8]) &&
          g[3] && 0 <= l ? "+" + l : l;
        q = g[4] ? "0" == g[4] ? "0" : g[4].charAt(1) : " ";
        s = g[6] - String(l).length;
        if (g[6]) {
          for (var w = []; 0 < s; w[--s] = q);
          q = w.join("")
        } else q = "";
        r.push(g[5] ? l + q : q + l)
      }
      return r.join("")
    };
    c.cache = {};
    c.parse = function(a) {
      for (var b = [], c = [], k = 0; a;) {
        if (null !== (b = /^[^\x25]+/.exec(a))) c.push(b[0]);
        else if (null !== (b = /^\x25{2}/.exec(a))) c.push("%");
        else if (null !== (b = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))) {
          if (b[2]) {
            var k = k | 1,
              l = [],
              f = b[2],
              p = [];
            if (null !== (p = /^([a-z_][a-z_\d]*)/i.exec(f)))
              for (l.push(p[1]);
                "" !==
                (f = f.substring(p[0].length));)
                if (null !== (p = /^\.([a-z_][a-z_\d]*)/i.exec(f))) l.push(p[1]);
                else if (null !== (p = /^\[(\d+)\]/.exec(f))) l.push(p[1]);
            else throw "[sprintf] huh?";
            else throw "[sprintf] huh?";
            b[2] = l
          } else k |= 2;
          if (3 === k) throw "[sprintf] mixing positional and named placeholders is not (yet) supported";
          c.push(b)
        } else throw "[sprintf] huh?";
        a = a.substring(b[0].length)
      }
      return c
    };
    a.sprintf = c;
    a.vsprintf = function(a, b, f) {
      f = b.slice(0);
      f.splice(0, 0, a);
      return c.apply(null, f)
    }
  })("undefined" != typeof exports ? exports :
    window)
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.util && (sketch.util = {});
(function(a) {
  a.util.MathClass = function(a) {
    a.util.RAD_DEG = 180 / Math.PI;
    a.util.DEG_RAD = 1 / a.util.RAD_DEG;
    a.util.INFINITY = 4294967295;
    a.util.INFINITY_MINUS_24bit = a.util.INFINITY - 16777215;
    a.util.INFINITY_MINUS_16bit = a.util.INFINITY - 65535;
    a.util.INFINITY_MINUS_8bit = a.util.INFINITY - 255;
    a.util.Random = function(c) {
      this.seed = "number" === typeof c ? c : a.util.Random.seed();
      this.n = Number(this.seed);
      return this
    };
    a.util.Random.seed = function() {
      return 2147483648 * Math.random() >> 0
    };
    a.util.Random.prototype = {
      toInt: function() {
        return this.n =
          16807 * this.n % 2147483647
      },
      toDouble: function() {
        return (this.n = 16807 * this.n % 2147483647) / 2147483647
      },
      intRange: function(a, f) {
        a -= 0.4999;
        return Math.round(a + (f + 0.4999 - a) * ((this.n = 16807 * this.n % 2147483647) / 2147483647))
      },
      doubleRange: function(a, f) {
        return a + (f - a) * ((this.n = 16807 * this.n % 2147483647) / 2147483647)
      }
    };
    a.util.getScreenMetrics = function() {
      var a = function(a) {
          try {
            b.style.fontSize = a
          } catch (d) {
            b.style.fontSize = ""
          }
          return b.offsetHeight / 1E4
        },
        f = document.createElement("div");
      f.style.cssText = "position: relative; width: 1px; height: 1px; overflow: scroll;";
      var b = document.createElement("div");
      b.style.cssText = "position: absolute; width: 100em; height: 10000em; overflow: hidden;";
      f.appendChild(b);
      document.body.appendChild(f);
      for (var h = "normal xx-small x-small small medium large x-large xx-large".split(" "), d = {}, e = 0; e < h.length; e++) d[h[e] + "_px"] = a(h[e]);
      d["%>px"] = a("100%") / 100;
      d["px>pt"] = 1 / a("1pt");
      d["pt>pc"] = 1 / 12;
      d["px>in"] = 1 / a("72pt");
      d["in>ft"] = 1 / 12;
      d["ft>yd"] = 1 / 3;
      d["px>mm"] = 25.4 * d["px>in"];
      d["mm>cm"] = 0.1;
      d["cm>m"] = 0.01;
      d["px>ex"] = 1 / a("1ex");
      d["ex>em"] =
        1 / d["px>ex"] / a("1em");
      d["px>px"] = 1;
      document.body.removeChild(f);
      var m = function(a, d, b, e) {
        for (var c in d) "object" === typeof(e = d[c]) ? m(a, e, c) : (b && (a["px>" + c] = a["px>" + b] * a[b + ">" + c], a[b + ">" + e] = a[b + ">" + c] * a[c + ">" + e], a[b + ">px"] = 1 / a["px>" + b], a[e + ">" + b] = 1 * (1 / a[c + ">" + e]) / a[b + ">" + c], a[c + ">" + b] = 1 / a[b + ">" + c]), a["px>" + e] = a["px>" + c] * a[c + ">" + e], a[c + ">px"] = 1 / a["px>" + c], a[e + ">px"] = 1 * (1 / a["px>" + c]) / a[c + ">" + e], a[e + ">" + c] = 1 / a[c + ">" + e])
      };
      m(d, {
        pt: "pc",
        mm: {
          cm: "m"
        },
        "in": {
          ft: "yd"
        },
        ex: "em"
      });
      return d
    };
    a.util.createHash = function(a) {
      if (!a) return 0;
      for (var f = 5381, b = 0, h = a.length; b < h; b++) var d = a[b].charCodeAt(),
        f = (f << 5) + f + d;
      return f
    }
  }
})(sketch);
"undefined" !== typeof module && module.exports ? module.exports = sketch.util.MathClass : sketch.util.MathClass(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.util && (sketch.util = {});
(function(a) {
  a.util.version = function(a, c) {
    function f(a, c) {
      c = c || 4;
      a = a.split(".").map(function(a) {
        var d = parseInt(a);
        return (a = a.replace(d, "")) ? d + a[0].charCodeAt() / 255 : d
      });
      for (var d = 0, e = 0; e < a.length && c !== e; ++e) d += a[e] / 255 * Math.pow(255, c - e + 1);
      return d
    }
    this.value = a;
    this.hash = f(a, c);
    this.isGreaterThan = function(b, c) {
      return f(a, c) > f(b, c)
    };
    this.isLessThan = function(b, c) {
      return f(a, c) < f(b, c)
    };
    return this
  }
})(sketch);
var STRING = {
  rxSplitByUppercase: /([A-Z]?[^A-Z]*)/g,
  rxAlphaNumeric: /[^A-Z0-9]+/gi,
  rxNumeric: /[0-9.-]*/g,
  replaceAll: function(a, g, c) {
    if (a) {
      if ("object" === typeof g) {
        for (var f = 0; f < g.length; f++) a = a.split(g[f]).join(c[f]);
        return a
      }
      return a.split(g).join(c)
    }
  },
  ucfirst: function(a) {
    if (a) return a[0].toUpperCase() + a.substr(1)
  },
  ucwords: function(a) {
    if (a) return a.replace(/^(.)|\s(.)/g, function(a) {
      return a.toUpperCase()
    })
  },
  addslashes: function(a) {
    return a.replace(/([\\"'])/g, "\\$1").replace(/\0/g, "\\0")
  },
  stripslashes: function(a) {
    return a.replace(/\0/g,
      "0").replace(/\\([\\'"])/g, "$1")
  },
  dirname: function(a) {
    return a.replace(/\\/g, "/").replace(/\/[^\/]*$/, "")
  },
  basename: function(a) {
    return a.replace(/\\/g, "/").replace(/.*\//, "")
  },
  filename: function(a) {
    return a ? a.split(".").shift() : ""
  },
  splitByUpperCase: function(a) {
    return a.match(/([A-Z]?[^A-Z]*)/g).slice(0, -1)
  },
  extension: function(a) {
    return a ? a.split(".").pop().toLowerCase() : ""
  },
  lpad: function(a, g, c) {
    for (; a.length < c;) a = g + a;
    return a
  },
  rpad: function(a, g, c) {
    for (; a.length < c;) a += g;
    return a
  },
  encode_utf8: function(a) {
    return unescape(encodeURIComponent(a))
  },
  decode_utf8: function(a) {
    return decodeURIComponent(escape(a))
  }
};
"trim" in String.prototype || (String.prototype.trim = function(a) {
  return this.replace(/^\s+|\s+$/g, "")
});
"undefined" !== typeof module && module.exports && (module.exports = STRING);
(function(a) {
  if ("object" === typeof exports) module.exports = a();
  else if ("function" === typeof define && define.amd) define(a);
  else {
    var g;
    try {
      g = window
    } catch (c) {
      g = self
    }
    g.SparkMD5 = a()
  }
})(function() {
  var a = function(a, d) {
      return a + d & 4294967295
    },
    g = function(d, b, e, c, k, l) {
      b = a(a(b, d), a(c, l));
      return a(b << k | b >>> 32 - k, e)
    },
    c = function(a, d, b, e, c, k, l) {
      return g(d & b | ~d & e, a, d, c, k, l)
    },
    f = function(a, d, b, e, c, k, l) {
      return g(d & e | b & ~e, a, d, c, k, l)
    },
    b = function(a, d, b, e, c, k, l) {
      return g(b ^ (d | ~e), a, d, c, k, l)
    },
    h = function(d, e) {
      var k = d[0],
        l = d[1],
        h = d[2],
        m = d[3],
        k = c(k, l, h, m, e[0], 7, -680876936),
        m = c(m, k, l, h, e[1], 12, -389564586),
        h = c(h, m, k, l, e[2], 17, 606105819),
        l = c(l, h, m, k, e[3], 22, -1044525330),
        k = c(k, l, h, m, e[4], 7, -176418897),
        m = c(m, k, l, h, e[5], 12, 1200080426),
        h = c(h, m, k, l, e[6], 17, -1473231341),
        l = c(l, h, m, k, e[7], 22, -45705983),
        k = c(k, l, h, m, e[8], 7, 1770035416),
        m = c(m, k, l, h, e[9], 12, -1958414417),
        h = c(h, m, k, l, e[10], 17, -42063),
        l = c(l, h, m, k, e[11], 22, -1990404162),
        k = c(k, l, h, m, e[12], 7, 1804603682),
        m = c(m, k, l, h, e[13], 12, -40341101),
        h = c(h, m, k, l, e[14], 17, -1502002290),
        l = c(l, h,
          m, k, e[15], 22, 1236535329),
        k = f(k, l, h, m, e[1], 5, -165796510),
        m = f(m, k, l, h, e[6], 9, -1069501632),
        h = f(h, m, k, l, e[11], 14, 643717713),
        l = f(l, h, m, k, e[0], 20, -373897302),
        k = f(k, l, h, m, e[5], 5, -701558691),
        m = f(m, k, l, h, e[10], 9, 38016083),
        h = f(h, m, k, l, e[15], 14, -660478335),
        l = f(l, h, m, k, e[4], 20, -405537848),
        k = f(k, l, h, m, e[9], 5, 568446438),
        m = f(m, k, l, h, e[14], 9, -1019803690),
        h = f(h, m, k, l, e[3], 14, -187363961),
        l = f(l, h, m, k, e[8], 20, 1163531501),
        k = f(k, l, h, m, e[13], 5, -1444681467),
        m = f(m, k, l, h, e[2], 9, -51403784),
        h = f(h, m, k, l, e[7], 14, 1735328473),
        l =
        f(l, h, m, k, e[12], 20, -1926607734),
        k = g(l ^ h ^ m, k, l, e[5], 4, -378558),
        m = g(k ^ l ^ h, m, k, e[8], 11, -2022574463),
        h = g(m ^ k ^ l, h, m, e[11], 16, 1839030562),
        l = g(h ^ m ^ k, l, h, e[14], 23, -35309556),
        k = g(l ^ h ^ m, k, l, e[1], 4, -1530992060),
        m = g(k ^ l ^ h, m, k, e[4], 11, 1272893353),
        h = g(m ^ k ^ l, h, m, e[7], 16, -155497632),
        l = g(h ^ m ^ k, l, h, e[10], 23, -1094730640),
        k = g(l ^ h ^ m, k, l, e[13], 4, 681279174),
        m = g(k ^ l ^ h, m, k, e[0], 11, -358537222),
        h = g(m ^ k ^ l, h, m, e[3], 16, -722521979),
        l = g(h ^ m ^ k, l, h, e[6], 23, 76029189),
        k = g(l ^ h ^ m, k, l, e[9], 4, -640364487),
        m = g(k ^ l ^ h, m, k, e[12], 11, -421815835),
        h = g(m ^ k ^ l, h, m, e[15], 16, 530742520),
        l = g(h ^ m ^ k, l, h, e[2], 23, -995338651),
        k = b(k, l, h, m, e[0], 6, -198630844),
        m = b(m, k, l, h, e[7], 10, 1126891415),
        h = b(h, m, k, l, e[14], 15, -1416354905),
        l = b(l, h, m, k, e[5], 21, -57434055),
        k = b(k, l, h, m, e[12], 6, 1700485571),
        m = b(m, k, l, h, e[3], 10, -1894986606),
        h = b(h, m, k, l, e[10], 15, -1051523),
        l = b(l, h, m, k, e[1], 21, -2054922799),
        k = b(k, l, h, m, e[8], 6, 1873313359),
        m = b(m, k, l, h, e[15], 10, -30611744),
        h = b(h, m, k, l, e[6], 15, -1560198380),
        l = b(l, h, m, k, e[13], 21, 1309151649),
        k = b(k, l, h, m, e[4], 6, -145523070),
        m = b(m, k, l, h, e[11],
          10, -1120210379),
        h = b(h, m, k, l, e[2], 15, 718787259),
        l = b(l, h, m, k, e[9], 21, -343485551);
      d[0] = a(k, d[0]);
      d[1] = a(l, d[1]);
      d[2] = a(h, d[2]);
      d[3] = a(m, d[3])
    },
    d = function(a) {
      var d = [],
        b;
      for (b = 0; 64 > b; b += 4) d[b >> 2] = a.charCodeAt(b) + (a.charCodeAt(b + 1) << 8) + (a.charCodeAt(b + 2) << 16) + (a.charCodeAt(b + 3) << 24);
      return d
    },
    e = function(a) {
      var d = [],
        b;
      for (b = 0; 64 > b; b += 4) d[b >> 2] = a[b] + (a[b + 1] << 8) + (a[b + 2] << 16) + (a[b + 3] << 24);
      return d
    },
    m = function(a) {
      var b = a.length,
        e = [1732584193, -271733879, -1732584194, 271733878],
        c, k, l;
      for (c = 64; c <= b; c += 64) h(e, d(a.substring(c -
        64, c)));
      a = a.substring(c - 64);
      k = a.length;
      l = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
      for (c = 0; c < k; c += 1) l[c >> 2] |= a.charCodeAt(c) << (c % 4 << 3);
      l[c >> 2] |= 128 << (c % 4 << 3);
      if (55 < c)
        for (h(e, l), c = 0; 16 > c; c += 1) l[c] = 0;
      b = (8 * b).toString(16).match(/(.*?)(.{0,8})$/);
      a = parseInt(b[2], 16);
      b = parseInt(b[1], 16) || 0;
      l[14] = a;
      l[15] = b;
      h(e, l);
      return e
    },
    k = "0123456789abcdef".split(""),
    l = function(a) {
      var d;
      for (d = 0; d < a.length; d += 1) {
        for (var b = a, e = d, c = a[d], l = "", f = void 0, f = 0; 4 > f; f += 1) l += k[c >> 8 * f + 4 & 15] + k[c >> 8 * f & 15];
        b[e] = l
      }
      return a.join("")
    },
    r = function() {
      this.reset()
    };
  "5d41402abc4b2a76b9719d911017c592" !== l(m("hello")) && (a = function(a, d) {
    var b = (a & 65535) + (d & 65535);
    return (a >> 16) + (d >> 16) + (b >> 16) << 16 | b & 65535
  });
  r.prototype.append = function(a) {
    /[\u0080-\uFFFF]/.test(a) && (a = unescape(encodeURIComponent(a)));
    this.appendBinary(a);
    return this
  };
  r.prototype.appendBinary = function(a) {
    this._buff += a;
    this._length += a.length;
    a = this._buff.length;
    var b;
    for (b = 64; b <= a; b += 64) h(this._state, d(this._buff.substring(b - 64, b)));
    this._buff = this._buff.substr(b - 64);
    return this
  };
  r.prototype.end = function(a) {
    var d =
      this._buff,
      b = d.length,
      e, c = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    for (e = 0; e < b; e += 1) c[e >> 2] |= d.charCodeAt(e) << (e % 4 << 3);
    this._finish(c, b);
    a = a ? this._state : l(this._state);
    this.reset();
    return a
  };
  r.prototype._finish = function(a, d) {
    var b = d,
      e;
    a[b >> 2] |= 128 << (b % 4 << 3);
    if (55 < b)
      for (h(this._state, a), b = 0; 16 > b; b += 1) a[b] = 0;
    e = 8 * this._length;
    e = e.toString(16).match(/(.*?)(.{0,8})$/);
    b = parseInt(e[2], 16);
    e = parseInt(e[1], 16) || 0;
    a[14] = b;
    a[15] = e;
    h(this._state, a)
  };
  r.prototype.reset = function() {
    this._buff = "";
    this._length = 0;
    this._state = [1732584193, -271733879, -1732584194, 271733878];
    return this
  };
  r.prototype.destroy = function() {
    delete this._state;
    delete this._buff;
    delete this._length
  };
  r.hash = function(a, d) {
    /[\u0080-\uFFFF]/.test(a) && (a = unescape(encodeURIComponent(a)));
    var b = m(a);
    return d ? b : l(b)
  };
  r.hashBinary = function(a, d) {
    var b = m(a);
    return d ? b : l(b)
  };
  r.ArrayBuffer = function() {
    this.reset()
  };
  r.ArrayBuffer.prototype.append = function(a) {
    var d = this._concatArrayBuffer(this._buff, a),
      b = d.length;
    this._length += a.byteLength;
    for (a = 64; a <= b; a += 64) h(this._state,
      e(d.subarray(a - 64, a)));
    this._buff = a - 64 < b ? d.subarray(a - 64) : new Uint8Array(0);
    return this
  };
  r.ArrayBuffer.prototype.end = function(a) {
    var d = this._buff,
      b = d.length,
      e = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      c;
    for (c = 0; c < b; c += 1) e[c >> 2] |= d[c] << (c % 4 << 3);
    this._finish(e, b);
    a = a ? this._state : l(this._state);
    this.reset();
    return a
  };
  r.ArrayBuffer.prototype._finish = r.prototype._finish;
  r.ArrayBuffer.prototype.reset = function() {
    this._buff = new Uint8Array(0);
    this._length = 0;
    this._state = [1732584193, -271733879, -1732584194, 271733878];
    return this
  };
  r.ArrayBuffer.prototype.destroy = r.prototype.destroy;
  r.ArrayBuffer.prototype._concatArrayBuffer = function(a, d) {
    var b = a.length,
      e = new Uint8Array(b + d.byteLength);
    e.set(a);
    e.set(new Uint8Array(d), b);
    return e
  };
  r.ArrayBuffer.hash = function(a, d) {
    var b = new Uint8Array(a),
      c = b.length,
      k = [1732584193, -271733879, -1732584194, 271733878],
      f, m, r;
    for (f = 64; f <= c; f += 64) h(k, e(b.subarray(f - 64, f)));
    b = f - 64 < c ? b.subarray(f - 64) : new Uint8Array(0);
    m = b.length;
    r = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    for (f = 0; f < m; f += 1) r[f >> 2] |=
      b[f] << (f % 4 << 3);
    r[f >> 2] |= 128 << (f % 4 << 3);
    if (55 < f)
      for (h(k, r), f = 0; 16 > f; f += 1) r[f] = 0;
    c = (8 * c).toString(16).match(/(.*?)(.{0,8})$/);
    b = parseInt(c[2], 16);
    c = parseInt(c[1], 16) || 0;
    r[14] = b;
    r[15] = c;
    h(k, r);
    return d ? k : l(k)
  };
  return r
});
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.util && (sketch.util = {});
(function(a) {
  a.Queue = function(a) {
    var c = this,
      f = a.oncomplete || a.callback,
      b = a.onprogress || a.progress,
      h = !1 === a.flatten ? !1 : !0;
    this.canceled = !1;
    this.cancel = function() {
      if (!(c.canceled || 0 >= c.remaining)) {
        if (a.oncancel) a.oncancel();
        c.canceled = !0
      }
    };
    this.next = function() {
      if (!c.canceled) {
        var d = c.queue,
          e = c.remaining,
          m = c.length,
          k = m - e - 1,
          l = c.keys[k];
        b && b(m ? 1 - (e + 1) / m : 1);
        if (d.length)
          if (c.remaining--, m = (e = "[object Object]" === String(r)) && r.length, h) a.next.call(c, d.shift(), l, k);
          else {
            var r = d[0];
            e && !m && d.shift();
            e && m ? a.next.call(c,
              r.shift(), l, k) : a.next.call(c, d.shift(), l, k)
          } else f && f()
      }
    };
    this.reset = function(d) {
      if (a.range) {
        var b = a.range,
          f = b.from;
        for (d = []; f <= b.to; f++) d.push(f)
      } else d = d || a.items;
      this.length = 0;
      this.remaining = -1;
      this.queue = [];
      this.keys = [];
      var k = function(a, b) {
        if (Array.isArray(a))
          for (var d = 0; d < a.length; d++) b(d);
        else
          for (d in a) b(d)
      };
      k(d, function(a) {
        var b = d[a];
        if ("[object Object]" !== String(b) || h) c.queue.push(b), c.keys.push(a), c.length++, c.remaining++;
        else {
          var e = [];
          this.queue.push(e);
          k(b, function(a) {
            e.push(b[key1]);
            c.keys.push(a);
            c.length++;
            c.remaining++
          })
        }
      })
    };
    this.reset();
    this.next();
    return this
  };
  "undefined" !== typeof module && module.exports && (module.exports = a.Queue)
})(sketch.util);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.exec = function(c, f, b) {
    if (!c) return console.log("missing trigger", arguments);
    if (-1 !== c.indexOf(">")) new sketch.util.Queue({
      items: c.split(">"),
      flatten: !0,
      next: function(b) {
        a.exec(b);
        this.next()
      }
    });
    else {
      var h = "root.exec(" + Array.prototype.slice.call(arguments).join(",") + ")";
      if (a.exec.cmds[c]) return a.exec.cmds[c](c, f, b, h);
      a.setTool(c, f, b)
    }
  };
  a.exec.register = function(c, f) {
    c.indexOf && (-1 !== c.indexOf(" ") ? c = c.split(" ") : -1 !== c.indexOf(",") && (c = c.split(",")));
    if ("object" === typeof c)
      for (var b =
          0; b < c.length; b++) a.exec.cmds[c[b]] = f;
    else a.exec.cmds[c] = f
  };
  a.exec.unregister = function(c) {
    delete a.exec.cmds[c]
  };
  var g = function(c, f, b) {
    eventjs.shiftKey && (c *= 10, f *= 10);
    b ? 0 !== a.selection.length && a.scene.copy().paste().selection.move(c, f) : (a.keyboard.pressed[37] || a.selection.move(0, 0, "cache"), a.selection.move(c, f, "move"))
  };
  a.exec.cmds = {
    "layer-download": function(c, f, b, h) {
      a.download.image({
        filename: a.project.title + "-layerExport",
        fromSelection: !0
      })
    },
    "layer-move-left": function(a, f, b, h) {
      g(-(f || 1), 0)
    },
    "layer-move-up": function(a,
      f, b, h) {
      g(0, -(f || 1))
    },
    "layer-move-right": function(a, f, b, h) {
      g(f || 1, 0)
    },
    "layer-move-down": function(a, f, b, h) {
      g(0, f || 1)
    },
    "layer-clone-left": function(a, f, b, h) {
      g(-(f || 1), 0, !0)
    },
    "layer-clone-up": function(a, f, b, h) {
      g(0, -(f || 1), !0)
    },
    "layer-clone-right": function(a, f, b, h) {
      g(f || 1, 0, !0)
    },
    "layer-clone-down": function(a, f, b, h) {
      g(0, f || 1, !0)
    },
    "debug-action": function(c, f, b, h) {
      if (0 !== a.selection.length)
        for (var d in a.selection.items) {
          c = a.scene.data[d];
          if ("undefined" === typeof c) break;
          console.log(c.id, c.hash, c)
        }
    },
    render: function() {
      a.render.clean()
    },
    "zoom-in": function(c, f, b, h) {
      a.render.dirtyControls = !0;
      a.orientation.zoomIn()
    },
    "zoom-out": function(c, f, b, h) {
      a.render.dirtyControls = !0;
      a.orientation.zoomOut()
    },
    "zoom-reset": function(c, f, b, h) {
      a.render.dirtyControls = !0;
      a.orientation.reset()
    },
    "layer-to-stamp": function(c, f, b, h) {
      a.assets.addStampFromSelection()
    },
    "layer-merge": function(c, f, b, h) {
      a.assets.addCloneFromSelection()
    },
    "path-merge": function(c, f, b, h) {
      a.vector.mergeActions();
      c = a.scene.getSelection();
      a.scene.removeSelection();
      if (c = a.vector.mergeActions(c)) c.dirty = !0, a.history.store({
        from: "add",
        to: [c],
        name: "Merge Objects"
      }), a.scene.push(c), a.scene.sort(), a.scene.reindex(), a.render.clean("pathMerge")
    },
    "layer-forwards": function(c, f, b, h) {
      a.scene.sendForwards && a.selection.length && (a.scene.sendForwards({
        record: !0
      }), a.render.clean(h))
    },
    "layer-to-front": function(c, f, b, h) {
      a.scene.sendForwards && a.selection.length && (a.scene.sendForwards({
        record: !0,
        toFront: !0
      }), a.render.clean(h))
    },
    "layer-backwards": function(c, f, b, h) {
      a.scene.sendBackwards && a.selection.length && (a.scene.sendBackwards({
          record: !0
        }),
        a.render.clean(h))
    },
    "layer-to-back": function(c, f, b, h) {
      a.scene.sendBackwards && a.selection.length && (a.scene.sendBackwards({
        record: !0,
        toBack: !0
      }), a.render.clean(h))
    },
    "layer-delete": function(c, f, b, h) {
      a.selection.length && (a.scene.removeSelection(), a.render.clean(h))
    },
    "layer-copy": function(c, f, b, h) {
      a.scene.copy && a.selection.length && (a.scene.copy(), a.scene.setDirtyControl(), a.scene.render(h))
    },
    "layer-cut": function(c, f, b, h) {
      a.scene.cut && a.selection.length && (a.scene.cut(), a.scene.render(h))
    },
    "layer-paste": function(c,
      f, b, h) {
      a.scene.paste && a.scene.paste(function() {
        f && a.scene.deselectAll();
        a.scene.render(h);
        a.exec("select")
      })
    },
    "select-all": function(c, f, b, h) {
      a.exec("select", function() {
        a.scene.selectAll().render("exec.select-all")
      })
    },
    "select-inverse": function(c, f, b, h) {
      a.exec("select", function() {
        a.scene.selectInverse().render("exec.select-inverse")
      })
    },
    "deselect-all": function(c, f, b, h) {
      a.scene.deselectAll();
      a.render.clean(h)
    },
    undo: function(c, f, b, h) {
      a.history && (a.scene.deselectAll(), a.render.dirtyControls = !0, a.history.undo())
    },
    redo: function(c, f, b, h) {
      a.history && (a.scene.deselectAll(), a.render.dirtyControls = !0, a.history.redo())
    },
    print: function(c, f, b, h) {
      a.print()
    },
    save: function(c, f, b, h) {
      a.download.image()
    },
    "save-server": function(c, f, b, h) {
      a.server.save()
    },
    "save-image": function(c, f, b, h) {
      a.download.image()
    },
    "save-gif": function(c, f, b, h) {
      a.download.image("gif")
    },
    "save-jpeg": function(c, f, b, h) {
      a.download.image("jpeg", f, b)
    },
    "save-png": function(c, f, b, h) {
      a.download.image("png", f, b)
    },
    "save-webp": function(c, f, b, h) {
      a.download.image("webp",
        f, b)
    },
    "save-json": function(c, f, b, h) {
      a.download.json()
    },
    "save-pdf": function(c, f, b, h) {
      a.download.pdf()
    },
    "save-zip": function(c, f, b, h) {
      a.download.zip()
    },
    camera: function(c, f, b, h) {
      a.exec("take-snapshot")
    },
    "take-snapshot": function(c, f, b, h) {
      a.camera.capture && !a.camera.capturing && (c = a.rtc.getDefaultID(), a.rtc.videos[c] ? a.camera.capture(null, null, c, null, function() {
        a.exec("select")
      }) : a.setup.webRTC(function() {
        a.exec("take-snapshot");
        a.rtc.pause()
      }))
    },
    clear: function(c, f, b, h) {
      a.scene.clear()
    },
    reset: function(c,
      f, b, h) {
      a.ctx.canvas.width = a.ctx.canvas.width;
      a.render.clipped = !1;
      a.scene.reset();
      a.history.reset();
      a.project.resetScroll();
      a.orient.reset()
    },
    "new": function(c, f, b, h) {
      a.exec("reset")
    },
    "new-prompt": function(c, f, b, h) {
      if ((!a.scene || a.scene && 0 === a.scene.data.length) && (!a.history || a.history && 0 === a.history.history.vector.data.length)) a.exec("reset"), f && f(), window.alertify && alertify.log("New Project Created!");
      else return a.ui.confirm({
        message: "new-project-confirm",
        callback: function(d) {
          d ? (a.exec("reset"),
            f && f(), window.alertify && alertify.log("New Project Created!")) : b && b()
        },
        labels: {
          ok: "Continue",
          cancel: "Cancel"
        }
      })
    },
    "configure-blink": function(c, f, b, h) {
      a.exec.cmds.configure(f, b, h)
    },
    configure: function(c, f, b, h) {
      c = -1 === (h || "").indexOf("blink") ? "toggle" : "blink";
      a.windows[c]("sk-configure", function(b) {
        if (b) {
          b = a.tool.type;
          if ("select" === b) {
            var e = a.scene.data[a.selection.idx];
            e && (b = e.type)
          }
          a.ui.buildConfigure(b, !0)
        }
      })
    },
    menu: function(c, f, b, h) {
      c = a.$("#tool-menu");
      contextmenu.show(a.ui.menuMain, c.offsetLeft, 45, !0)
    },
    "menu-export": function(c, f, b, h) {
      c = a.$("#tool-menu-export");
      contextmenu.show(a.ui.menuMainExport, c.offsetLeft, 45, !0)
    },
    "menu-download": function(c, f, b, h) {
      c = a.$("#tool-menu-download");
      contextmenu.show(a.ui.menuMainDownload, c.offsetLeft, 45, !0)
    },
    "menu-about": function(c, f, b, h) {
      c = a.$("#tool-menu-about");
      contextmenu.show(a.ui.menuMainAbout, c.offsetLeft, 45, !0)
    },
    help: function(c, f, b, h) {
      a.windows.byId("sketch-help") ? a.windows.toggle("sketch-help") : a.windows.write("help")
    },
    about: function(c, f, b, h) {
      a.windows.byId("sketch-about") ?
        a.windows.toggle("sketch-about") : a.windows.write("about")
    },
    palette: function(c, f, b, h) {
      a.windows.toggle("sk-palette")
    },
    "color-picker": function(c, f, b, h) {
      a.windows.toggle("sk-palette")
    },
    colorPalette: function(c, f, b, h) {
      a.colorPalette.enabled ? a.colorPalette.disable() : a.colorPalette.enable()
    },
    login: function(c, f, b, h) {
      a.windows.write("login");
      a.loader.stop()
    },
    file: function(c, f, b, h) {
      a.windows.write("file")
    },
    open: function(c, f, b, h) {
      a.windows.write("open")
    },
    "open-computer": function(c, f, b, h) {
      a.windows.write("open-computer")
    },
    "save-computer": function(c, f, b, h) {
      a.windows.write("save-computer")
    },
    "open-sketch": function(c, f, b, h) {
      a.windows.write("open-sketch");
      window.API && API.Sketchpad.list()
    },
    "save-sketch": function(c, f, b, h) {
      a.windows.write("save-sketch");
      c = document.querySelector("#sketch-sync");
      c.innerHTML = a.configure.sync || "";
      c.href = a.loc.createURL("share");
      document.querySelector("#avgrund-html .filename");
      document.querySelector("#avgrund-html .description")
    },
    "open-drive": function(c, f, b, h) {
      a.windows.write("open-drive");
      window.API &&
        API.GoogleDrive.list()
    },
    "save-drive": function(c, f, b, h) {
      a.windows.write("save-drive");
      window.API && API.GoogleDrive.enable();
      document.querySelector("#sketch-file .filename").value = a.project.title || ""
    },
    snapshot: function(c, f, b, h) {
      a.scene.deselectAll();
      a.toolkit.setTool("snapshot");
      window.alertify && alertify.log("Click & drag to create your screenshot.")
    }
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sk && (sk = sketch);
sketch.Namespace = function(a) {
  sk = a;
  a.__editing = !1;
  a.__enabled = !1;
  a.__modified = !1;
  a.__modifiedOnline = !1;
  a.__rendering = !1;
  a.__state = "";
  a.__version = "3.5.7";
  "{{" == a.__version.substr(0, 2) && (a.__version = "3.5.2.4dev");
  "undefined" !== typeof window && window.location && (a.__debug = "?debug" === window.location.search);
  a.colorPicker = a.colorPicker || {};
  a.convert = a.convert || {};
  a.gen = a.gen || {};
  a.language = a.language || {};
  a.lib = a.lib || {};
  a.loc = a.loc || {};
  a.render = a.render || {};
  a.on = a.on || {};
  a.project = a.project || {};
  a.io = a.io || {};
  a.server = a.server || {};
  a.setup = a.setup || {};
  a.supports = a.supports || {
    io: {}
  };
  a.ui = a.ui || {};
  a.userAgent = a.userAgent || {};
  a.util = a.util || {};
  a.vector = a.vector || {};
  a.tool = a.tool || {};
  a.toolkit = a.toolkit || {};
  a.toolkit.__init = a.toolkit.__init || {};
  a.toolkit.__icons = a.toolkit.__icons || {};
  a.configure = a.configure || {
    tools: {}
  };
  a.configure.defaultSketch = "new";
  a.configure.lang = "en";
  a.configure.theme = "light";
  a.configure.prefix = "sketch";
  a.configure.background = void 0;
  a.configure.defaultFill = {
    type: "color"
  };
  a.configure.defaultStroke = {
    type: "color"
  };
  a.configure.image = {};
  a.configure.image.mime = "image/png";
  a.configure.image.quality = 1;
  (function() {
    var g = a.feature = a.feature || {};
    g.debug = !1;
    g.debugCache = !1;
    g.debugMouse = !1;
    g.debugRender = !1;
    g.debugSetup = !1;
    g.log = !1;
    g.kiosk = !1;
    g.cache2D = !0;
    g.cache257 = !1;
    g.cacheSVG = !0;
    g.bruteForce = !0;
    g.project = {};
    g.project.lockProperties = !1;
    g.project.format = "json";
    g.project.title = "Drawing";
    g.project.description = "made with https://sketch.io/";
    g.project.bounds = {};
    g.project.clip = {};
    g.project.background = "rgba(0,0,0,0)";
    g.project.units = "%";
    g.project.width = 1;
    g.project.height = 1;
    g.project.x = 0;
    g.project.y = 0;
    g.tools = {};
    g.tools.controls = {};
    g.tools.controls.anchor = void 0;
    g.tools.controls.n = void 0;
    g.tools.controls.s = void 0;
    g.tools.controls.e = void 0;
    g.tools.controls.w = void 0;
    g.tools.controls.ne = void 0;
    g.tools.controls.se = void 0;
    g.tools.controls.sw = void 0;
    g.tools.controls.nw = void 0;
    g.tools.controls.mouse = {};
    g.tools.controls.mouse.width = 16;
    g.tools.controls.mouse.height = 16;
    g.tools.controls.touch = {};
    g.tools.controls.touch.width =
      24;
    g.tools.controls.touch.height = 24;
    g.tools.drawCenterPoint = !0;
    g.tools.drawBoundingBox = !0;
    g.tools.usePointInPath = !1;
    g.tools.usePointInBoundingBox = !0;
    g.tools.usePointInImageData = !1;
    g.tools.usePointNearest = !0;
    g.tools.movable = !0;
    g.tools.defaultWidth = 100;
    g.tools.defaultHeight = 100;
    g.tools.minWidth = 1;
    g.tools.minHeight = 1;
    g.tools.maxWidth = a.util.INFINITY;
    g.tools.maxHeight = a.util.INFINITY;
    g.tools.image = {};
    g.tools.image.filter = !1;
    g.tools.text = {};
    g.tools.text.clickToPlace = !1;
    g.tools.text.dragToPlace = !0;
    g.canvas = {};
    g.canvas.useGroupBoundingBox = !1;
    g.canvas.openDefaultProject = !1;
    g.canvas.scaleContainer = !1;
    g.canvas.clearWithBackground = !0;
    g.canvas.saveWithBackground = !0;
    g.canvas.zoom = {};
    g.canvas.zoom.min = 0.25;
    g.canvas.zoom.max = 100;
    g.canvas.zoom.increment = 0.1;
    g.canvas.pixelRatio = !1;
    g.vector = {};
    g.vector.record = !0;
    g.vector.edit = !0;
    g.social = {};
    g.social.setCookie = !0;
    g.social.autoLogout = !1;
    g.social.autoLogoutTimeout = !1;
    g.beforeUnloadPrompt = !1;
    g.cursorCSS = !1;
    g.windows = !0;
    g.preventScroll = !1;
    g.requireAuth = !1;
    g.exportDrop = !1;
    g.ui = {};
    g.ui.genRangeBar = !0;
    g.ui.mediaSelect = !1;
    g.ui.sourceAtopColor = "#fff";
    g.ui.tooltips = !1;
    g.palette = {};
    g.palette.hexInput = !1;
    g.palette.closeButton = !1;
    g.palette.eyeDropper = !1;
    g.palette.grid = !1;
    g.palette.gridInstantLoad = !1;
    g.style = {};
    g.style.lockToGlobal = !0;
    g.palette.colorPicker = !1;
    g.palette.color = !0;
    g.palette.gradient = !1;
    g.palette.pattern = !1;
    g.palette.blend = !1;
    g.palette.composite = !1;
    g.palette.header = "";
    g.placement = {};
    g.placement.drag = !0;
    g.placement.click = !0;
    g.placement.mediaClick = !0;
    g.placement.mediaDrag = !1;
    g.placement.constrainToCanvas = !1;
    g.history = {};
    g.history.autoSelect = !1;
    g.history.bitmap = !1;
    g.history.vector = !1;
    g.history.limit = !1;
    g.sync = {};
    g.sync.json = !1;
    g.sync.thumb = !1;
    g.sync.image = !1;
    g.sync.svg = !1;
    g.sync.zip = !1;
    g.sync.maxFileSize = 0;
    g.sync.maxAssetSize = 0;
    g.sync.localRefs = !0;
    g.sync.useDefaultFormat = !1;
    g.sync.hash = !1;
    g.fileSystem = !1;
    g.stream = {};
    g.stream.maxFileSize = 0;
    g.stream.audio = !1;
    g.stream.sketch = !1;
    g.stream.sketchLive = !1;
    g.stream.text = !1;
    g.stream.video = !1;
    g.stream.videoAtop = !1;
    g.stream.tech =
      "RTCDataChannel";
    g.stream.spectrumAnalysis = !1
  })();
  (function() {
    var g = a.attributes = {};
    g.basicObject = {
      seed: "number",
      bbox: "object",
      composite: "string",
      groupId: "string",
      opacity: "number",
      rotate: "object",
      scale: "object",
      translate: "object"
    };
    g.styledObject = a.util.mergeObject(g.basicObject, {
      fill: "style",
      stroke: "style"
    });
    g.rules = {
      movable: "boolean",
      rotatable: "boolean",
      scalable: "boolean",
      selectable: "boolean",
      useAlignX: "string",
      useAlignY: "string",
      useConstrain: "boolean",
      useConstrainX: "boolean",
      useConstrainY: "boolean",
      useControlNE: "boolean",
      useControlNW: "boolean",
      useControlSE: "boolean",
      useControlSW: "boolean",
      useHighRes: "boolean",
      useMaxCopies: "number",
      useMaxHeight: "number",
      useMaxWidth: "number",
      useMinHeight: "number",
      useMinWidth: "number",
      useStickToBack: "boolean",
      useStickToFront: "boolean",
      useStretchToEdge: "boolean"
    }
  })()
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.Namespace);
"undefined" === typeof sketch && (sketch = {});
sketch.on = sketch.on || {};
(function(a) {
  document.querySelector.bind ? (a.$ = document.querySelector.bind(document), a.$$ = document.querySelectorAll.bind(document)) : (a.$ = function() {
    return document.querySelector.apply(document, arguments)
  }, a.$$ = function() {
    return document.querySelectorAll.apply(document, arguments)
  });
  "undefined" !== typeof eventjs && (a.addEvent = eventjs.add, a.removeEvent = eventjs.remove);
  a.canvas2d = {
    pixelRatio: window.devicePixelRatio || 1,
    container: document,
    zoom: 1,
    rotate: 0,
    y: 0,
    x: 0,
    bounds: {
      x1: 0,
      y1: 0,
      x2: Infinity,
      y2: Infinity
    },
    layers: {
      cache: "",
      bitmap: "",
      layer0: "z-index: 0;",
      draw: "z-index: 1;",
      active: "z-index: 2;"
    }
  };
  a.Project = function() {
    var g = this;
    this.units = "%";
    this.y = this.x = 0;
    this.height = this.width = 1;
    this.scrollTop = this.scrollLeft = 0;
    this.pages = {};
    this.pages.data = [];
    this.pages.current = 0;
    this.pages.length = 0;
    this.format = "json";
    this.title = a.feature.project.title;
    this.description = a.feature.project.description;
    this.clip = {};
    this.bounds = {
      width: 0,
      height: 0,
      style: {
        fillStyle: "",
        strokeStyle: "",
        lineWidth: 0
      }
    };
    this.viewport = {
      width: 0,
      height: 0,
      clip: {}
    };
    this.getBounds = function() {
      var c = this.getViewport();
      if ("%" === a.project.units) var f = (a.project.width || 1) * c.width,
        c = (a.project.height || 1) * c.height;
      else f = a.project.width, c = a.project.height;
      this.bounds.width = f;
      this.bounds.height = c;
      return this.bounds
    };
    this.getViewport = function() {
      var c = a.canvas2d,
        f = c.bounds,
        b = c.container;
      a.feature.canvas.scaleContainer ? (c = window.innerWidth - f.x1, b = window.innerHeight - f.y1) : (c = b.offsetWidth - f.x1, b = b.offsetHeight - f.y1);
      var h = a.container,
        c = Math.min(c, f.x2 -
          f.x1, h.offsetWidth),
        b = Math.min(b, f.y2 - f.y1, h.offsetHeight);
      this.viewport.width = c;
      this.viewport.height = b;
      return this.viewport
    };
    this.setData = function(c) {
      g.x = c.x;
      g.y = c.y;
      a.orient.reset();
      g.setSize(c.width, c.height, c.units);
      g.setScroll(c.scrollLeft, c.scrollTop);
      a.orient.reset();
      a.orient.setZoom(c.zoom || 1)
    };
    this.getData = function() {
      var c = {};
      c.units = g.units;
      c.x = g.x;
      c.y = g.y;
      c.width = g.width;
      c.height = g.height;
      c.scrollLeft = g.scrollLeft;
      c.scrollTop = g.scrollTop;
      c.zoom = a.canvas2d.zoom;
      return c
    };
    this.setSize = function(c,
      f, b) {
      c || f ? "%" === b ? (this.width = c, this.height = f, this.units = "%") : (this.width = c, this.height = f, this.units = "px") : (this.height = this.width = 1, this.units = "%");
      a.setSize()
    };
    this.setPage = function(a, f) {
      var b = this.pages,
        h = Math.min(b.length - 1, Math.max(0, f ? b.current + a : a));
      b.current = h;
      for (var d = 0, e = 0; e < h; e++) d += b.data[e].height;
      this.scrollElement.scrollTop = d
    };
    this.setScroll = function(c, f) {
      var b = a.project.scrollElement;
      isFinite(c) && (b.scrollLeft = c);
      isFinite(f) && (b.scrollTop = f)
    };
    this.resetScroll = function() {
      var c = a.project.scrollElement;
      c.scrollTop = 0;
      c.scrollLeft = 0;
      a.project.scrollTop = 0;
      a.project.scrollLeft = 0
    }
  };
  a.construct = function(g) {
    if ("ready" === a.__state) return console.log("SketchAPI was already constructed.");
    if (window.glfx && !glfx.presets.length) return glfx.loadFilters(function() {
      a.construct(g)
    });
    if (!g) return console.log("sketch.construct() requires configuration.");
    if (!a.__state) {
      a.__state = "construct";
      new a.DomMisc(a);
      new a.Namespace(a);
      new a.Supports(a);
      a.project && (a.project = new a.Project);
      for (var c = ["prefix", "lang", "background",
          "defaultSketch"
        ], f = 0; f < c.length; f++) {
        var b = c[f];
        g[b] && (a.configure[b] = g[b], delete g[b])
      }
      var h = g.onready || g.onReady;
      a.on.sketchReady = function() {
        a.__state = "ready";
        a.on.sketchReady = function() {};
        a.feature.history.bitmap && a.history.storeBitmap();
        h && window.setTimeout(function() {
          h("sketch")
        }, 1)
      };
      a.util.mergeObject(g.icons || {}, a.toolkit.__icons);
      a.util.mergeObject(g.configure || {}, a.configure);
      a.util.mergeObject(g.feature || {}, a.feature);
      a.util.mergeObject(g.feature.project || {}, a.project);
      c = a.util.clone(a.feature.tools);
      for (b in a.configure.tools) !1 !== a.util.exists("sketch.toolkit.__init." + a.configure.tools[b].toolkit) && (a.feature[b] = a.util.mergeObject(a.feature.tools[b] || a.feature[b] || c, c));
      a.loc.setHost(a.configure.hosts || g.hosts);
      a.lib.init && (a.lib.init("text"), a.lib.init("clipart"), a.lib.init("image"), a.lib.init("template"), a.lib.init("stamp"));
      a.setContainer(g);
      var d = a.canvas2d,
        e = g.onsupport || g.onSupport;
      a.supports.fn.init(function() {
        e && e();
        setTimeout(function() {
          a.language.setLocale(a.configure.lang || "en");
          a.setBackground(a.configure.background || "none");
          a.project.units = a.feature.project.units;
          a.setSize();
          var b = d.layers;
          a.active = b.active.ctx;
          a.cache = b.cache.ctx;
          a.ctx = b.layer0.ctx;
          new a.Style(a);
          new a.StylePalette(a);
          new a.Configure(a);
          a.style.init();
          a.history = new a.History(a);
          a.toolkit.setup();
          a.setup.run();
          a.feature.debug && (document.body.style.overflow = "auto");
          a.setup.events();
          a.feature.stream.sketchLive && a.setup.webRTC();
          a.getItem("sync", function(b) {
            a.render.start();
            var d = a.loc.search;
            d.debug && (a.feature.debug =
              d.debug);
            d.pixelRatio && (a.canvas2d.pixelRatio = parseFloat(d.pixelRatio));
            d.zoom && (a.canvas2d.zoom = parseFloat(d.zoom));
            a.configure.sync = b;
            a.on.sketchReady()
          })
        }, 0)
      })
    }
  };
  a.alignDummy = function() {
    if (a.orient && !a.feature.canvas.clearWithBackground) {
      var g = a.orient.scale,
        c = a.orient.getValues(),
        f = a.setBounds(),
        b = a.canvas2d.dummy;
      b.style.width = g * f.width + "px";
      b.style.height = g * f.height + "px";
      b.style.left = c.x + a.project.scrollLeft * (1 - g) + "px";
      b.style.top = c.y + a.project.scrollTop * (1 - g) + "px";
      (c = a.configure.backgroundRaw) &&
      c.canvas && (c = c.canvas, b.style.backgroundSize = c.width * g + "px " + c.height * g + "px")
    }
  };
  a.setBackground = function(g) {
    if (g) {
      var c = a.configure,
        f = function(b) {
          a.feature.canvas.clearWithBackground || (a.canvas2d.dummy.style.background = b)
        },
        b = function(b, d, k) {
          c.theme = k;
          b(d, function(a) {
            f(a.css);
            c.backgroundRaw = a
          });
          a.setItem("backdrop", g)
        };
      a.project.background = g;
      switch (g) {
        case "none":
          return;
        case "blank":
          c.theme = "dark";
          f("#fff");
          c.backgroundRaw = "#fff";
          a.setItem("backdrop", "light");
          return;
        case "white":
          c.theme = "light";
          f("#fff");
          c.backgroundRaw = "#fff";
          a.setItem("backdrop", "light");
          return;
        case "black":
          c.theme = "dark";
          f("#000");
          c.backgroundRaw = "#000";
          a.setItem("backdrop", "dark");
          return;
        case "grid":
          return b(a.gen.grid, "grid", "light");
        case "graphPaper":
          return b(a.gen.grid, "graphPaper", "light");
        case "bluePrint":
          return b(a.gen.grid, "bluePrint", "light");
        case "notebook":
          return b(a.gen.paper, "notebook", "light");
        case "looseLeaf":
          return b(a.gen.paper, "looseLeaf", "light");
        case "lined":
          return b(a.gen.paper, "lined", "dark");
        case "transparent":
          return b(a.gen.interlace,
            "transparent", "light");
        case "transparentDark":
          return b(a.gen.interlace, "transparentDark", "dark");
        default:
          b = g.trim(), -1 !== b.indexOf("://") && "url" !== b.substr(0, 3) && (b = "url(" + b + ")"), f(b)
      }
      if (g.indexOf && -1 !== g.indexOf("url(")) {
        var h = document.createElement("img"),
          b = g.substr(4, g.length - 5).split("'").join("").split('"').join(""),
          d = a.util.Canvas(1, 1).ctx;
        h.onload = function() {
          var a = d.createPattern(h, "repeat");
          c.backgroundRaw = a
        };
        h.src = b
      } else c.backgroundRaw = g;
      a.scene && a.selection.length && a.render("root.setBackground");
      a.setItem("backdrop", g)
    } else a.getItem("backdrop", function(b) {
      a.setBackground(b || "light")
    })
  };
  a.setZoom = function(g) {
    if (!a.orient) return console.log("Missing orientation module.", arguments);
    a.orient.setZoom(g)
  };
  a.setPixelRatio = function(g) {
    a.canvas2d.pixelRatio = g;
    a.scene.setDirtyCache(a.scene.data);
    a.setSize();
    a.orient.reset();
    a.orient.render("root.setPixelRatio")
  };
  a.setBounds = function(g, c) {
    var f = a.canvas2d,
      b = f.container,
      h = a.project.getBounds(),
      d = g || h.width,
      h = c || h.height;
    d && h || (h = a.util.getMetrics(b),
      d = h.width - f.bounds.x1, h = h.height - f.bounds.y1);
    var e = a.project.getViewport(),
      f = e.height,
      e = Math.max(e.width, d),
      f = Math.max(f, h);
    "%" !== a.project.units && (b.style.width = e + "px", b.style.height = f + "px");
    return {
      targetWidth: e,
      targetHeight: f,
      width: d,
      height: h
    }
  };
  a.setSize = function(g, c) {
    a.render.clipped = !1;
    var f = !a.feature.vector.edit && a.cache,
      b = a.canvas2d,
      h = b.layers,
      d = b.container,
      e = d.parentNode;
    e.style.overflow = "auto";
    "%" === a.project.units && (d.style.width = e.style.width = "100%", d.style.height = e.style.height = "100%",
      e.scrollTop = 0);
    var m = a.project.getViewport(),
      k = m.width,
      m = m.height,
      l = a.setBounds(g, c);
    "%" === a.project.units ? e.style.overflow = "hidden" : (e.style.overflowX = l.targetWidth <= k ? "hidden" : "auto", e.style.overflowY = l.targetHeight <= m ? "hidden" : "auto", l.targetWidth <= k && l.targetHeight <= m && a.project.resetScroll());
    a.feature.canvas.scaleContainer && !a.render.forOutput ? (g = Math.min(l.targetWidth, k), c = Math.min(l.targetHeight, m)) : (g = l.targetWidth, c = l.targetHeight, e.style.overflow = "visible", e.scrollTop = 0);
    b.width = g;
    b.height =
      c;
    e && "sk-canvas" === e.id ? (e.style.left = b.bounds.x1 + "px", e.style.top = b.bounds.y1 + "px") : (d.style.left = b.bounds.x1 + "px", d.style.top = b.bounds.y1 + "px");
    f && (a.cache.canvas.width = g, a.cache.canvas.height = c, a.cache.drawImage(a.ctx.canvas, 0, 0));
    for (var r in h) f && "cache" === r || (d = a.util.Canvas(null, null, r), b.container.appendChild(d), h[r].indexOf && (d.style.cssText = b.layers[r]), d.style.width = b.width + "px", d.style.height = b.height + "px", h[r] = d);
    f && (a.ctx.canvas.width = g, a.ctx.canvas.height = c, a.ctx.drawImage(a.cache.canvas,
      0, 0), a.cache.canvas.width = g, a.cache.canvas.height = c);
    if (a.scene && a.scene.data) {
      f = a.selection.items;
      for (r in f)
        if (f = a.scene.data[r]) f.dirtyControl = !0;
      a.scene.detectInBounds();
      sk.windows.restore()
    }
  };
  a.setContainer = function(g) {
    var c = "string" === typeof g ? g : g.container || document.body;
    "string" === typeof c && (c = document.querySelector(c));
    c && (a.container = c);
    if (!document.querySelector("#sk-canvas")) {
      var f = c,
        b = dom.create('<div class="sk-viewport"></div>'),
        c = dom.create('<div id="sk-canvas"></div>');
      b.appendChild(c);
      f.appendChild(b)
    }
    f = c.querySelector(".sk-dummy-canvas");
    f || (f = document.createElement("div"), f.className = "sk-dummy-canvas", c.appendChild(f));
    a.canvas2d.dummy = f;
    a.project.scrollElement = g.scrollElement || c.parentNode || c;
    return a.canvas2d.container = c
  };
  a.getItem = function(g, c) {
    c = c || function(a) {
      console.log("Missing callback:", a)
    };
    if (a.util.exists("chrome.storage.local")) chrome.storage.local.get(g, function(a) {
      c(a[g])
    });
    else {
      var f = a.configure.prefix;
      "dev" === f ? (console.log("dev mode"), c("")) : (f = localStorage.getItem(f +
        "/" + g) || "", c(f))
    }
  };
  a.setItem = function(g, c) {
    if (a.util.exists("chrome.storage.local")) {
      var f = {};
      f[g] = c;
      chrome.storage.local.set(f)
    } else localStorage.setItem(a.configure.prefix + "/" + g, c)
  };
  a.reset = function() {
    a.project.resetScroll();
    a.assets && a.assets.reset();
    a.orient && a.orient.reset();
    a.scene && a.scene.reset();
    a.history && a.history.reset()
  };
  a.util.antizoom = function() {};
  (function() {
    var g = [];
    a.setup = {};
    a.setup.add = function(a) {
      g.push(a)
    };
    a.setup.run = function() {
      for (var a = 0; a < g.length; a++) g[a]()
    }
  })();
  a.setup.add(function() {
    a.util.exists("sketch.io.SVG") &&
      (a.io.svg = new a.io.SVG(a), a.open.svg = a.io.svg.open);
    a.util.exists("sketch.io.JSON") && (a.io.json = new a.io.JSON(a), a.open.json = a.io.json.open);
    a.util.exists("sketch.Save") && (a.save = new a.Save(a));
    a.util.exists("sketch.SceneTransform") && a.SceneSelection && (a.SceneSelection.prototype.transform = a.SceneTransform(a));
    if (a.util.exists("sketch.Scene")) {
      var g = a.actions = a.scene = new a.Scene(a);
      a.hovered = a.scene.hovered;
      a.selection = a.scene.selection;
      g.clipboard && g.clipboard.addFocusEvent()
    }
    a.util.exists("sketch.theme") &&
      a.theme.init();
    a.util.exists("detectZoom") && (a.util.detectZoom = detectZoom());
    a.util.exists("sketch.util.getScreenMetrics") && (a.convert.metrics = a.util.getScreenMetrics());
    a.util.exists("dom.loadImage") && a.loc.PROXY && (dom.loadImage.proxyUrl = a.loc.PROXY);
    a.util.exists("EnableContextMenu") && (a.ui.contextMenu = EnableContextMenu(document, window));
    a.util.exists("sketch.vector.shape") && (a.vector.VOBPath = a.vector.shape.VOBPath);
    a.util.exists("sketch.Camera") && (a.camera = new a.Camera(a));
    a.util.exists("sketch.RTC") &&
      (a.rtc = new a.RTC(a));
    a.util.exists("widget.Thumbnailer") && !a.util.thumbnailer && (a.util.thumbnailer = (new widget.Thumbnailer).generate);
    a.util.exists("widget.Loader") && !a.loader && (a.loader = new widget.Loader);
    a.util.exists("widget.Vortex") && (a.vortex = new widget.Vortex(document.body));
    a.util.exists("sketch.net.Swarm") && (a.net.swarm = new sketch.net.Swarm, a.net.users = new sketch.net.Users);
    a.Assets && (a.assets = new a.Assets(a));
    a.Palette && (a.palette = new a.Palette);
    a.util.exists("sketch.render.Cache2d") && (a.render.cache =
      new a.render.Cache2d(a));
    a.util.exists("sketch.keyboard.init") && a.keyboard.init();
    a.util.exists("sketch.orientation") && a.orientation.init()
  });
  a.setup.onResize = function() {
    var g = a.canvas2d,
      c = g.container.parentNode;
    eventjs.add(window, "resize", function(c) {
      a.util.antizoom();
      window.clearTimeout(window.resizeTimeout);
      window.resizeTimeout = window.setTimeout(function() {
        a.on.beforeResize && a.on.beforeResize();
        a.setSize();
        a.orient.reset(!0);
        a.render("onResize");
        a.on.resize && a.on.resize();
        a.eventOverride("onResize",
          c) || "text" === a.tool.type && a.toolkit.text.updateCSS()
      }, 100)
    });
    eventjs.add(c, "scroll", function(f) {
      var b = c.scrollTop,
        h = c.scrollLeft;
      a.project.scrollTop = b;
      a.project.scrollLeft = h;
      a.render.clipped = !1;
      a.alignDummy();
      var d = g.layers,
        e;
      for (e in d) {
        var m = d[e];
        m.style.left = h + "px";
        m.style.top = b + "px"
      }
      if (a.scene) {
        b = a.scene.data;
        for (h = 0; h < b.length; h++) d = a.scene.data[h], d.dirtyTransform = !0, delete d.visible;
        a.toolkit.text && (d = a.scene.data[a.selection.idx]) && "text" === d.type && a.toolkit.text.updateCSSTransform();
        a.render.dirtyControls = !0;
        a.render("container.onscroll");
        a.toolkit.callOverride("onScroll", f)
      }
    });
    a.util.antizoom()
  };
  a.setup.onHashChange = function() {
    var g = function() {
        a.dataChannel ? (a.server.open(), a.dataChannel.send(["session.change", c])) : a.server.open()
      },
      c = a.loc.getRoomID();
    eventjs.add(window, "hashchange", function(f) {
      f = a.loc.getRoomID();
      if (c !== f) {
        var b = c;
        c = f;
        "ready" === a.__state && a.scene.data.length ? a.ui.confirm({
            message: "open-confirm",
            callback: function(c) {
              c ? g() : a.loc.setHash("sketch", b)
            },
            labels: {
              ok: "Open Project",
              cancel: "Cancel"
            }
          }) :
          g()
      }
    })
  };
  a.setTooltip = function(g, c) {
    var f = a.active && a.active.canvas;
    f && (f.style.cursor = c || "");
    a.feature.ui.tooltips && widget.Tooltip ? "" === g ? widget.Tooltip.hide() : widget.Tooltip.show(g) : f && (f.title = g || "")
  };
  a.addTooltip = function(g, c, f) {
    eventjs.add({
      target: g,
      mouseover: function(b) {
        a.setTooltip(c, f);
        eventjs.stop(b)
      },
      mouseout: function(b) {
        a.setTooltip("");
        eventjs.stop(b)
      }
    })
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.Assets = function(a) {
    var c = this;
    this.reset = function() {
      c.data = {};
      c.missing = {};
      c.URLtoID = {};
      c.IDtoURL = {};
      return c
    };
    this.remove = function(a) {
      delete c.data[a];
      delete c.missing[a];
      return a
    };
    this.isEqual = function(a, b) {
      if (a === b) return !0;
      var f = c.getItem(a);
      return f && f.src === b ? !0 : (f = c.getItem(b)) && f.src === a ? !0 : !1
    };
    this.getItem = function(a) {
      return c.URLtoID[a] ? c.getById(c.URLtoID[a]) : c.data[a] ? c.data[a] : ""
    };
    this.getBlob = function(a, b) {
      var f = c.getById(a);
      if (f.blob) return b && b(f.blob), f.blob;
      "[object HTMLImageElement]" ===
      String(f) && (f = h(f));
      f.toBlob(function(a) {
        f.blob = a;
        b && b(a)
      })
    };
    this.getById = function(a, b) {
      return c.data[a] ? c.data[a] : c.createDefault(a, b)
    };
    var f = a.util.array2object(["[object Blob]", "[object File]"]),
      b = a.util.array2object(["[object HTMLCanvasElement]", "[object HTMLImageElement]"]);
    this.add = function(d, e, h, k) {
      "string" === typeof d && (d = {
        src: d
      });
      f[String(d)] && (d = {
        blob: d
      });
      var l = d.src || d.blob || d.data || "",
        r;
      if (!(r = d.type)) a: {
        if ("string" === typeof l) switch (STRING.basename(l).toLowerCase().split(".").pop()) {
          case "jpeg":
          case "png":
          case "gif":
          case "webp":
            r =
              "image";
            break a;
          case "svg":
            r = "clipart";
            break a
        }
        r = void 0
      }
      var p = d.targetId || null;
      e = d.onload || e;
      h = d.onerror || h;
      k = d.onprogress || k;
      var q = String(l),
        t;
      l || console.log(d, String(d));
      if (b[q]) return c.createId(l, function(a) {
        c.createResource(a, "image", l);
        e && e.call(l, a, l)
      }, p);
      if (f[q]) {
        if ("image/svg+xml" === l.type) return a.convert.blobToText(l, function(a) {
          d.src = a;
          d.type = "clipart";
          c.add(d, e, h, k)
        });
        t = l;
        l = URL.createObjectURL(l)
      }
      if (0 === l.indexOf("#asset-")) {
        q = l;
        l = c.getById(l, d);
        if ("undefined" === typeof c.data[q]) {
          if (a.io.json.folder) return t =
            "clipart" === d.type ? ".svg" : ".png", d.src = a.io.json.folder + q.substr(1) + t, c.add(d, e, h, k);
          c.createDefault(q, d)
        }
        e && e.call(l, q, l)
      } else {
        if (c.URLtoID[l]) {
          var q = c.URLtoID[l],
            s = c.getById(q, d);
          if ("clipart" !== s.type || !s.clone || a.feature.cacheSVG) {
            e && e.call(s, q, l);
            return
          }
        }
        0 === l.indexOf("<svg") && (l = '<?xml version="1.0" encoding="UTF-8"?>' + l);
        0 === l.indexOf("<?xml") && (l = "data:image/svg+xml;base64," + btoa(STRING.encode_utf8(l)));
        if (0 === l.indexOf("data:image/svg")) return c.createId(l, function(b) {
          if (a.feature.cacheSVG &&
            c.data[b]) {
            var d = c.data[b];
            e && e.call(d, b, d)
          } else new a.vector.SVG({
            src: l,
            ctx: a.canvas2d.layers.cache.ctx,
            useCache: a.feature.cacheSVG,
            onprogress: k,
            onerror: function(b) {
              a.feature.debug && console.log(b);
              h && h(b)
            },
            onload: function(a) {
              c.createResource(b, "clipart", a);
              e && e.call(a, b, a)
            }
          })
        }, p);
        if ("clipart" === r || "svg" === l.split(".").pop()) return a.util.request({
          url: l,
          onerror: h,
          onload: function(b) {
            c.add({
              targetId: p,
              data: b.responseText,
              onprogress: k,
              onerror: function(b) {
                a.feature.debug && console.log(b);
                h && h(b)
              },
              onload: function(a,
                b) {
                c.URLtoID[l] = a;
                c.IDtoURL[a] = l;
                e && e.call(b, a, b)
              }
            })
          }
        });
        c.loadImage({
          src: l,
          blob: t,
          onload: e,
          onerror: h,
          onprogress: k,
          targetId: p
        })
      }
    };
    this.addClipart = function(b, e, f, k, l) {
      c.add({
        type: "clipart",
        data: b,
        onload: function(b, d) {
          var c = a.lib.clipart;
          if (!c || !c.tree) return e(b, d);
          var k = c.tree.yourFiles;
          if (!k) return e(b, d);
          if (k[b]) e && e(b, d);
          else {
            k[b] = "loading";
            if (!a.gen.preview) return e(b, d);
            a.gen.preview({
              type: "clipart",
              resource: d,
              width: 52,
              height: 52,
              oncomplete: function(a) {
                c.paths.splice(0, 0, k[b] = {
                  type: "clipart",
                  filename: b,
                  filepath: b,
                  thumbnail: a.canvas.toDataURL()
                });
                e && e(b, d)
              }
            })
          }
        },
        onprogress: k,
        onerror: f,
        targetId: l
      })
    };
    this.addImage = function(b, e, f, k, l) {
      c.add({
        type: "image",
        data: b,
        onload: function(b, d) {
          var c = a.lib.clipart;
          if (!c || !c.tree) return e(b, d);
          var k = c.tree.yourFiles;
          if (!k) return e(b, d);
          k[b] ? e && e(b, d) : (k[b] = "loading", a.util.thumbnailer({
            src: d,
            width: 52,
            height: 52,
            onload: function(a) {
              c.paths.splice(0, 0, k[b] = {
                type: "image",
                filename: b,
                filepath: b,
                thumbnail: a.toDataURL()
              });
              e && e(b, d)
            }
          }))
        },
        onprogress: k,
        onerror: f,
        targetId: l
      })
    };
    this.addFromActions = function(a) {
      for (var b = 0; b < a.length; b++) {
        var f = a[b];
        if (f.src) {
          var k = f.src;
          if ("#" === k[0]) switch (f.type) {
            case "clipart":
              c.addClipart(k);
              break;
            case "image":
              c.addImage(k);
              break;
            case "stamp":
              c.addStamp(k)
          }
        }
      }
    };
    this.addCloneFromSelection = function() {
      a.save.canvas({
        background: "none",
        fromSelection: !0,
        callback: function(b) {
          b.toBlob(function(b) {
            a.scene.add({
              type: "image",
              src: URL.createObjectURL(b)
            })
          })
        }
      })
    };
    this.addStampFromSelection = function() {
      a.save.canvas({
        background: "none",
        fromSelection: !0,
        callback: function(b) {
          a.scene.deselectAll();
          c.addStamp(b, function() {
            a.ui.setToolMenu("stamp");
            a.ui.buildConfigure("stamp", !0);
            a.toolkit.setTool("stamp", function() {
              var b = a.tool.device.brush,
                d = b.fill;
              d[d.type] = "none";
              delete b.fill.__colors
            })
          })
        }
      })
    };
    this.addStamp = function(b, e, f, k, l) {
      c.add({
        type: "image",
        data: b,
        onload: function(b, d) {
          var c = a.lib.stamp;
          if (!c) return e(b, d);
          var k = c.tree.yourFiles;
          if (!k) return e(b, d);
          k[b] ? e && e() : (k[b] = "loading", a.util.thumbnailer({
            src: d,
            width: 52,
            height: 52,
            onload: function(l) {
              a.configure.tools.stamp.src =
                b;
              c.paths.splice(0, 0, k[b] = {
                type: "stamp",
                filename: b,
                filepath: b,
                thumbnail: l.toDataURL()
              });
              e && e(b, d)
            }
          }))
        },
        onprogress: k,
        onerror: f,
        targetId: l
      })
    };
    this.addPattern = function(a, b) {};
    this.addFont = function(a, b) {};
    this.loadImage = function(b) {
      var e, f = b.src,
        k = b.targetId,
        l = b.onload || b.onLoad,
        r = b.onerror || b.onError,
        p = b.onprogress || b.onProgress,
        q = function(k, h) {
          c.createResource(e, "image", k);
          k.setAttribute("data-src", f);
          k.image = h;
          k.assetID = k.title = e;
          if (b.blob) k.blob = b.blob;
          else if (a.feature.stream.maxFileSize) return k.toBlob(function(a) {
            k.blob =
              a;
            l && l.call(k, e, k)
          });
          l && l.call(k, e, k)
        };
      dom.loadImage({
        src: f,
        onprogress: function(a) {
          p && p(a)
        },
        onerror: function() {
          r && r()
        },
        onload: function() {
          var b = this;
          a.userAgent.ios && window.MegaPixImage && (b = h(this));
          c.createId(b, function(a) {
            c.URLtoID[f] = e = a;
            c.IDtoURL[e] = f;
            q(b, {
              src: f
            })
          }, k)
        }
      })
    };
    var h = function(b) {
      var e = document.createElement("canvas");
      e.width = b.width;
      e.height = b.height;
      if (a.userAgent.ios && window.MegaPixImage) {
        var c = new MegaPixImage(b);
        c.render(e, {
          maxWidth: 1E3,
          maxHeight: 1E3
        })
      } else c = e.getContext("2d"),
        c.drawImage(b, 0, 0);
      return e
    };
    this.createId = function(a, b, f) {
      if (f) return b(f);
      "string" === typeof a ? 25E4 < a.length ? b("#asset-" + SparkMD5.hash(a.substr(0, 25E4))) : b("#asset-" + SparkMD5.hash(a)) : a.assetID ? b(a.assetID) : b(c.createIdFromImage(a))
    };
    this.createIdFromImage = function(a) {
      var b = a.width,
        f = a.height;
      if (64 > b && 64 > f) return a.assetID = "#asset-" + SparkMD5.hash(a.toDataURL()), a.assetID;
      var k = c.thumbnail || document.createElement("canvas");
      k.ctx = k.ctx || k.getContext("2d");
      var l = Math.min(b, 64),
        h = Math.min(f, 64);
      k.width =
        l;
      k.height = h;
      k.ctx.drawImage(a, 0, 0, b, f, 0, 0, l, h);
      c.thumbnail = k;
      a.assetID = "#asset-" + SparkMD5.hash(k.toDataURL());
      return a.assetID
    };
    this.createDefault = function(a, b, f) {
      b = b || {};
      if (c.data[a]) {
        f = c.data[a];
        var k = f.width;
        b = f.height
      } else f = document.createElement("canvas"), k = b && b.width || 1, b = b && b.height || 1;
      f.width = k;
      f.height = b;
      f.className = "sk-default";
      var l = f.getContext("2d");
      l.fillStyle = "rgba(127,127,127,0.5)";
      l.fillRect(0, 0, k, b);
      c.data[a] = f;
      c.missing[a] = !0;
      return f
    };
    this.createResource = function(b, e, f) {
      var k =
        c.data[b] || "",
        l = "sk-default" === k.className;
      c.data[b] = f;
      c.data[b].type = e;
      k && !l || !(sk.peerjs || a.peer && a.peer.sendFile) || a.assets.getBlob(b, function(e) {
        sk.peerjs ? sk.peerjs.handle.file.send(e) : sk.sfclient && !sk.sfclient.files[b] && a.peer.sendFile(e, b)
      });
      if (c.missing[b] || l) delete c.missing[b], a.scene.traverse(function(e) {
        e.src === b && (e.dirtyCacheForce = !0, a.toolkit.media.loadResource({
          action: e
        }))
      })
    };
    return this.reset()
  }
})(sketch);
"undefined" !== typeof module && module.exports && (module.exports = sketch.AssetClass);
"undefined" === typeof sketch && (sketch = {});
sketch.keyboard = sketch.keyboard || {};
sketch.toolkit = sketch.toolkit || {};
(function(a) {
  a.keyboard.pressed = {};
  a.keyboard.keydown = function(h) {
    eventjs.proxy.metaTracker(h);
    var d = eventjs.metaKey,
      e = eventjs.shiftKey,
      m = eventjs.altKey,
      k = eventjs.isEditingText(),
      l = h.keyCode;
    switch (l) {
      case 75:
        if (d && e && a.userAgent.nodewebkit) {
          var r = require("nw.gui").Window.get();
          r.isKioskMode ? require("nw.gui").App.quit() : r.enterKioskMode()
        }
        break;
      case 219:
        if (d) return m ? a.exec("layer-to-back") : a.exec("layer-backwards"), c(h);
        break;
      case 221:
        if (d) return m ? a.exec("layer-to-front") : a.exec("layer-forwards"),
          c(h);
        break;
      case 80:
        if (d) return a.print(), c(h);
        break;
      case 83:
        if (d) return m ? a.download.image() : e && a.toolkit.snapshot ? a.exec("snapshot") : a.server.enabled() ? a.save.fromQuery() : a.download.image(), c(h);
        break;
      case 27:
        if (a.eventOverride("onEscapeKey", h)) return;
        sk.windows.hasFocus() ? sk.windows.closeFocused() : a.scene.deselectAll();
        b("escapeKey", h);
        return c(h)
    }
    if (!k && "eyeDropper" !== a.colorPicker.state && !a.eventOverride(g[l], h)) {
      switch (l) {
        case 48:
          if (e && a.feature.canvas.zoom) {
            if (k && !d) break;
            a.exec("zoom-reset");
            return c(h)
          }
          break;
        case 173:
        case 189:
          if (e && a.feature.canvas.zoom) {
            if (k && !d) break;
            a.exec("zoom-out");
            return c(h)
          }
          break;
        case 61:
        case 187:
          if (e && a.feature.canvas.zoom) {
            if (k && !d) break;
            a.exec("zoom-in");
            return c(h)
          }
          break;
        case 188:
          if (e) return a.windows.blink("sk-configure"), a.ui.buildConfigure(), c(h);
          break;
        case 83:
          if (e && a.fs && a.ui.openProjectWindow) return a.ui.openProjectWindow(".export-project", !0), c(h);
          break;
        case 78:
          if (e && a.fs && a.ui.openProjectWindow) return a.ui.openProjectWindow(".new-project", !0), c(h);
          break;
        case 79:
          if (d && a.supports.chooseEntry) return a.open.chooseEntry(function(b) {
            a.addMedia({
              openAsNew: !0,
              blob: b
            })
          }), c(h);
          if (e && a.fs && a.ui.openProjectWindow) return a.ui.openProjectWindow(".open-project", !0), c(h);
          break;
        case 32:
          if (a.orient) {
            h.preventDefault();
            if ("zoom" === a.tool.type) return;
            a.ptool = a.tool.type;
            a.exec("zoom")
          } else a.util.toggleVideo && a.util.toggleVideo();
          return;
        case 49:
        case 50:
        case 51:
        case 52:
        case 53:
        case 54:
        case 55:
        case 56:
        case 57:
          if (!a.feature.hotkeys) return;
          h = a.feature.hotkeys[l - 49];
          switch (h) {
            case "brush":
            case "shape":
              if ((d = document.querySelector(".sketch-select-" + h)) && d.id) return a.exec(d.id.replace("tool-", ""));
            default:
              return a.exec(h)
          }
        case 191:
          if (e) return a.exec("help");
          return;
        case 46:
        case 8:
          eventjs.cancel(h);
          a.exec("layer-delete");
          b("deleteKey", h);
          return;
        case 13:
          document.activeElement === document.body && eventjs.cancel(h);
          document.querySelector("#alertify-ok") && document.querySelector("#alertify-ok").click();
          b("enterKey", h);
          return;
        case 18:
          if (a.toolkit.select) {
            if (d) break;
            if (!a.feature.vector.edit ||
              a.tool === a.toolkit.select) return;
            a.ptool = a.tool.type;
            a.exec("select")
          }
          return;
        case 65:
          d && (eventjs.cancel(h), e ? a.exec("select-inverse") : a.exec("select-all"));
          return;
        case 67:
          e ? a.exec("color-picker") : d && (eventjs.cancel(h), a.exec("layer-copy"));
          return;
        case 73:
          a.exec("debug-action");
          return;
        case 86:
          if (d && !f()) {
            if (a.__rendering) return;
            a.tool.reset && a.tool.reset();
            eventjs.cancel(h);
            a.exec("layer-paste", "select" !== a.tool.type)
          }
          return;
        case 88:
          d && (eventjs.cancel(h), a.exec("layer-cut"));
          return;
        case 90:
          if (d) {
            eventjs.cancel(h);
            if (a.__rendering) return;
            if (e) {
              if (a.eventOverride("onRedo", h)) break;
              a.exec("redo")
            } else {
              if (a.eventOverride("onUndo", h)) break;
              a.exec("undo")
            }
          }
          return;
        case 37:
          if (a.on.leftKey) b("leftKey", h);
          else if (sketch.selection.length) {
            eventjs.altKey ? a.exec("layer-clone-left", 1) : a.exec("layer-move-left", 1);
            eventjs.cancel(h);
            break
          } else if (a.util.changeVideoFilter && a.rtc.videos.you) {
            a.util.changeVideoFilter(-1);
            break
          } else {
            if (a.tool.device && a.tool.device.brush && a.tool.device.brush.isGhost) {
              h = a.tool.device.brush;
              h.seed++;
              a.tool.ghost(h.event);
              return
            }
            e && (a.sidebar && a.sidebar.close) && a.sidebar.close()
          }
          break;
        case 39:
          if (a.on.rightKey) b("rightKey", h);
          else if (sketch.selection.length) {
            eventjs.altKey ? a.exec("layer-clone-right", 1) : a.exec("layer-move-right", 1);
            eventjs.cancel(h);
            break
          } else if (a.util.changeVideoFilter && a.rtc.videos.you) {
            a.util.changeVideoFilter(1);
            break
          } else {
            if (a.tool.device && a.tool.device.brush && a.tool.device.brush.isGhost) {
              h = a.tool.device.brush;
              h.seed--;
              a.tool.ghost(h.event);
              return
            }
            e && (a.sidebar && a.sidebar.open) &&
              a.sidebar.open()
          }
          break;
        case 38:
          a.on.upKey ? b("upKey", h) : m && a.project.pages && a.project.pages.length ? (sketch.project.setPage(-1, "useRelative"), eventjs.cancel(h)) : sketch.selection.length && (eventjs.altKey ? a.exec("layer-clone-up", 1) : a.exec("layer-move-up", 1), eventjs.cancel(h));
          break;
        case 40:
          a.on.downKey ? b("downKey", h) : m && a.project.pages && a.project.pages.length ? (sketch.project.setPage(1, "useRelative"), eventjs.cancel(h)) : sketch.selection.length && (eventjs.altKey ? a.exec("layer-clone-down", 1) : a.exec("layer-move-down",
            1), eventjs.cancel(h));
          break;
        default:
          return
      }
      c(h, !1)
    }
  };
  var g = {
    8: "Backspace",
    9: "Tab",
    13: "Enter",
    16: "Shift",
    17: "Ctrl",
    18: "Alt",
    19: "PauseBreak",
    20: "CapsLock",
    27: "Escape",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "Left",
    38: "Up",
    39: "Right",
    40: "Down",
    45: "Insert",
    46: "Delete",
    48: "0",
    49: "1",
    50: "2",
    51: "3",
    52: "4",
    53: "5",
    54: "6",
    55: "7",
    56: "8",
    57: "9",
    65: "A",
    66: "B",
    67: "C",
    68: "D",
    69: "E",
    70: "F",
    71: "G",
    72: "H",
    73: "I",
    74: "J",
    75: "K",
    76: "L",
    77: "M",
    78: "N",
    79: "O",
    80: "P",
    81: "Q",
    82: "R",
    83: "S",
    84: "T",
    85: "U",
    86: "V",
    87: "W",
    88: "X",
    89: "Y",
    90: "Z",
    91: "LeftWindow",
    92: "RightWindow",
    93: "Select",
    96: "Numpad0",
    97: "Numpad1",
    98: "Numpad2",
    99: "Numpad3",
    100: "Numpad4",
    101: "Numpad5",
    102: "Numpad6",
    103: "Numpad7",
    104: "Numpad8",
    105: "Numpad9",
    106: "Multiply",
    107: "Add",
    109: "Subtract",
    110: "DecimalPoint",
    111: "Divide",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    186: "SemiColon",
    187: "EqualSign",
    188: "Comma",
    189: "Dash",
    190: "Period",
    191: "ForwardSlash",
    192: "GraveAccent",
    219: "OpenBracket",
    220: "Backslash",
    221: "CloseBracket",
    222: "SingleQuote"
  };
  a.keyboard.keyup = function(b) {
    eventjs.proxy.metaTracker(b);
    var d = eventjs.metaKey,
      e = b.keyCode;
    if (!eventjs.isEditingText() && (a.keyboard.pressed[e] = !1, d && a.ptool && (a.scene.deselectAll(), a.exec(a.ptool), delete a.ptool), !a.eventOverride(g[e], b))) switch (e) {
      case 18:
        if (a.toolkit.select) {
          if (!a.ptool || !a.feature.vector.edit) break;
          a.exec(a.ptool);
          delete a.ptool
        }
        break;
      case 32:
        a.orient && a.exec(a.ptool);
        break;
      case 37:
      case 38:
      case 39:
      case 40:
        a.selection.move(0,
          0, "record")
    }
  };
  var c = function(b, d) {
      a.scene.setDirtyControl();
      a.render("root.select.keydown " + b.keyCode);
      a.keyboard.pressed[b.keyCode] = !0;
      !1 !== d && eventjs.cancel(b)
    },
    f = function() {
      return window.Clipboard && "[object ClipboardConstructor]" !== String(window.Clipboard) ? a.scene && a.scene.paste && a.addMedia : !1
    };
  (function() {
    var b;
    a.keyboard.enable = function() {
      f() && (b = eventjs.add(window, "paste", a.scene.onPasteNative))
    };
    a.keyboard.disable = function() {
      b && b.remove()
    }
  })();
  a.keyboard.init = function() {
    if (!a.userAgent.mobile) {
      var b =
        function(b, d) {
          var e = a.toolkit.getToolIcon(b);
          return e && -1 !== e.indexOf(".") ? "<img " + ('class="lazy" src="' + a.ui.images.transparent + '" data-') + 'src="' + (a.loc.MEDIA + "ux/tools/" + e) + '" width="18" style="vertical-align:middle; margin: 0 2px 2px 0;' + d + '"/> ' : '<span class="icon-' + b + '" style="' + d + '"></span> '
        },
        d = [];
      a.keyboard.enable();
      a.save && (d.push("File" + b("save", "float:right")), a.toolkit.snapshot ? (d.push([b("save") + "Save", "cmd.s"]), d.push([b("download") + "Download PNG", "alt.cmd.s"]), d.push([b("camera") +
        "Take Snapshot", "shift.cmd.s"
      ])) : d.push([b("save") + "Save", "cmd.s"]), d.push([b("print") + "Print", "cmd.p"]));
      a.history && (d.push("History" + b("undo", "float:right")), d.push([b("undo") + "Undo history", "cmd.z"]), d.push([b("redo") + "Redo history", "shift.cmd.z"]));
      d.push("Shortcuts");
      d.push([b("select") + "Quick Selection", "alt"]);
      var e = a.feature.hotkeys;
      if (e)
        for (var c = 0; c < e.length; c++) {
          var k = e[c],
            l = STRING.ucwords(k);
          d.push([b(k) + l + " tool", c + 1 + ""])
        }
      a.feature.vector.edit && (d.push(" Select tool" + b("select", "float:right")),
        d.push(["Select", "click"]), d.push(["Add to Selection", "shift.click"]), d.push(["Remove from Selection", "cmd.click"]), d.push(["Select all", "cmd.a"]), d.push(["Unselect", "escape"]), d.push(["Remove", "delete"]), a.scene && (a.scene.cut && (d.push(["Copy", "cmd.c"]), d.push(["Cut", "cmd.x"]), d.push(["Paste", "cmd.v"])), a.scene.sendForwards && (d.push(["Send Backwards", "cmd.["]), d.push(["Send Forwards", "cmd.]"]), d.push(["Send to Back", "alt.cmd.["]), d.push(["Send to Front", "alt.cmd.]"])), a.feature.tools.movable && (d.push(["Move Left",
          "left"
        ]), d.push(["Move Right", "right"]), d.push(["Move Up", "up"]), d.push(["Move Down", "down"]))));
      a.feature.windows && (d.push("Windows"), d.push(["Close window", "escape"]), a.fs && d.push([b("file") + "New Project", "shift.n"]), a.fs && d.push([b("folder") + "My Projects", "shift.o"]), a.fs && d.push([b("export") + "Export", "shift.s"]), a.palette && d.push(["Color Picker", "shift.c"]), d.push(["Help <i>(you are here)</i>", "shift.?"]));
      a.feature.canvas.zoom && (d.push("Zoom" + b("zoom-in", "float: right")), d.push(["Zoom in", "shift.+"]),
        d.push(["Zoom out", "shift.-"]), d.push(["Zoom to actual size", "shift.0"]));
      if (c = document.getElementById("shortcuts")) {
        c.innerHTML = '<h1><img src="./media/ux/keyboard-shortcuts.png" height="36" style="position: relative; top: -2px;">Keyboard Shortcuts</h1>';
        b = document.createElement("div");
        b.style.cssText = "margin: 0 10px";
        c.appendChild(b);
        c.appendChild(document.createElement("br"));
        for (var f = function(a, b, d) {
            var e = [];
            a = a.toUpperCase();
            a = a.split(b);
            for (b = 0; b < a.length; b++) {
              var c = a[b]; - 1 !== c.indexOf("|") ?
                e.push(f(c, "|", " | ")) : e.push("<span>" + c + "</span>")
            }
            return e.join(d)
          }, e = "", c = 0; c < d.length; c++) l = d[c], "string" === typeof l ? (k = document.createElement("div"), k.className = "sk-header-break", k.innerHTML = l, b.appendChild(k)) : (e = f(l[1], ".", " & "), k = document.createElement("div"), k.className = "cmd", k.innerHTML = e, b.appendChild(k), a.addTooltip(k, l[1].replace(".", " + ")), e = document.createElement("font"), e.style.color = "#666", e.innerHTML = "&nbsp;: &nbsp;", b.appendChild(e), e = document.createElement("span"), e.innerHTML =
          l[0], b.appendChild(e), l = document.createElement("br"), b.appendChild(l))
      }
    }
  };
  var b = function(b, d) {
    if (a.on[b]) a.on[b](d)
  };
  a.toolkit.callOverride = function(b, d) {
    if (a.tool && a.tool[b]) return a.tool[b](d), !0;
    var e = a.tool && a.tool.device,
      e = e && e.brush;
    if (!(e && (e.event && e.self) && e[b])) return !1;
    e[b](d);
    return !0
  };
  a.eventOverride = function(b, d) {
    if (b) {
      var e = d.keyCode,
        c = a.keyboard.pressed;
      if (-1 === b.indexOf("on")) {
        var k = b;
        b = "on" + b + "Key";
        d.name = k[0].toLowerCase() + k.substr(1);
        d.state = "keyup" === d.type ? "up" : c[e] ? "press" :
          "down"
      }
      if (a.toolkit.callOverride(b, d)) return c[e] = !0
    }
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.loc = sketch.loc || {};
(function(a) {
  a.loc.getHash = function(g) {
    var c = "?" + window.location.hash.substr(1),
      c = a.util.parseUri(c).queryKey;
    a.loc.hash = c;
    a.project.title = c.sketch || a.project.title;
    return g ? c[g] : c
  };
  a.loc.getSearch = function() {
    var g = a.util.parseUri(window.location.search).queryKey,
      c;
    for (c in g) "" === g[c] && (g[c] = !0);
    return a.loc.search = g
  };
  a.loc.update = function() {
    a.loc.search = a.loc.getSearch();
    a.loc.hash = a.loc.getHash()
  };
  a.loc.setHost = function(g) {
    var c = a.feature.fileSystem ? a.fs && a.fs.getRootPath() || "" : "",
      f = function(a) {
        return -1 ===
          a.indexOf("://") && a ? e + a : a
      },
      b = function(b, e, k) {
        for (var h in b) b[h].replace && (b[h] = b[h].replace(e, k));
        b.feature && a.util.mergeObject(b.feature || {}, a.feature);
        e = b.IO || "";
        k = b.RTC || "";
        h = b.pathWeb || b.HOST || "";
        var m = e.split(":").shift(),
          g = h.split(":").shift();
        a.loc.host = h;
        a.loc.protocol = d.protocol;
        a.loc.IO = e.replace(m, g);
        a.loc.RTC = k.replace(m, g);
        a.loc.MEDIA = d.protocol + "//" + (b.MEDIA || h + "media/");
        a.loc.PROXY = (b.PROXY || "").replace(m, g);
        a.loc.GET = f(b.pathGet || b.GET || c).replace(m, g);
        a.loc.POST = f(b.pathPost || b.POST ||
          c).replace(m, g)
      },
      h = function(b) {
        b.feature && a.util.mergeObject(b.feature || {}, a.feature);
        var e = b.pathWeb || b.HOST || "";
        a.loc.host = e;
        a.loc.protocol = d.protocol;
        a.loc.IO = b.IO;
        a.loc.RTC = b.RTC;
        a.loc.MEDIA = d.protocol + "//" + (b.MEDIA || e + "media/");
        a.loc.PROXY = b.PROXY;
        a.loc.GET = f(b.pathGet || b.GET || c);
        a.loc.POST = f(b.pathPost || b.POST || c)
      };
    g = g || a.loc.hosts || {};
    a.loc.hosts = g;
    a.loc.update();
    var d = window.location,
      e = d.protocol + "//",
      m = d.host;
    if (g[m]) return h(g[m]);
    for (var k in g)
      if (h = g[k], h.alias && -1 !== h.alias.indexOf(m)) return b(a.util.clone(h),
        k, m);
    return function() {
      a.feature.debugSetup && console.log("WARNING: Host is not set.");
      var b = d.href.split("#")[0].split("?")[0].split("/");
      b.pop();
      b = b.join("/") + "/";
      a.loc.host = b;
      a.loc.protocol = d.protocol;
      a.loc.MEDIA = b + "media/";
      a.loc.PROXY = b + "getImage.php?url=";
      a.loc.GET = c;
      a.loc.POST = c
    }()
  };
  a.loc.setHash = function(g, c) {
    if ("string" === typeof g) {
      var f = a.loc.getHash();
      f[g] = c;
      return a.loc.setHash(f)
    }
    if (c) {
      var f = a.loc.getHash(),
        b;
      for (b in g) f[b] = g[b];
      return a.loc.setHash(f)
    }
    f = [];
    g = g || a.loc.getHash();
    for (b in g) {
      var h =
        g[b];
      void 0 !== h && (h ? f.push(b + "=" + h) : f.push(b))
    }
    f = "#" + f.join("&");
    window.location.hash !== f && (window.location.hash = f)
  };
  a.loc.createURL = function(g) {
    switch (g) {
      case "share":
        return "http://sketchpad.io/sketch/#sketch=" + a.configure.sync
    }
  };
  a.loc.getRoomID = function() {
    if (a.server.enabled && a.server.enabled()) {
      var g = a.loc.getHash("sketch");
      if (g) return g;
      if (g = window.location.pathname.substr(1)) return g.replace("()", "")
    }
  };
  a.loc.getRandomID = function(a) {
    a || (a = 8);
    for (var c = ["a", "e", "i", "o", "u"], f = "bcdfghjklmnpqrstvwxyz".split(""),
        b = "", h = 0; h < a; h++) b = 0 == h % 2 ? b + c[4 * Math.random() >> 0] : b + f[20 * Math.random() >> 0];
    return b
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.canvas2d = sketch.canvas2d || {};
sketch.supports = sketch.supports || {};
sketch.userAgent = sketch.userAgent || {};
sketch.Supports = function(a) {
  (function() {
    var c = navigator.userAgent || navigator.vendor || window.opera,
      b = a.userAgent = a.userAgent || {};
    b.__ = c;
    b.ie = !!document.documentMode;
    b.firefox = "undefined" !== typeof InstallTrigger;
    b.opera = !!window.opera || /Opera|OPR/i.test(c);
    b.chrome = !!window.chrome && !b.opera;
    b.safari = /Safari/i.test(c) && !b.opera && !b.chrome;
    b.ios = /iPhone|iPad|iPod/i.test(c);
    b.android = /Android/i.test(c);
    b.blackberry = /Blackberry/i.test(c);
    b.mac = !b.ios && /Mac/.test(c);
    b.windows = /Windows/.test(c);
    b.linux = /Linux/.test(c);
    b.mobile = /Opera Mini|IEMobile|Symbian|WebOS/i.test(c) || b.ios || b.android || b.blackberry;
    b.cordova = /^file:\/{3}[^\/]/i.test(window.location.href) && b.mobile;
    b.nodewebkit = !(!a.util.exists("process.versions") || !process.versions["node-webkit"]);
    b.ios && (c = ("" + (/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ""])[1]).replace("undefined", "3_2").replace("_", ".").replace("_", "") || !1) && (b.iosVersion = new a.util.version(c))
  })();
  var g = function(a, b) {
    if (a[b]) return a[b];
    b = b[0].toUpperCase() +
      b.substr(1);
    return a["webkit" + b] || a["moz" + b] || a["ms" + b] || a["o" + b]
  };
  a.supports.fn = {};
  a.supports.fn.init = function(c) {
    var b = a.util.Canvas(1, 1);
    a.supports.fn.detectExport(b, function() {
      a.supports.webgl = !!window.WebGLRenderingContext;
      a.supports.canvas = !!b.ctx;
      a.supports.fn.fileSystem(b);
      a.supports.fn.detectCanvas2dFeatures(b);
      a.supports.fn.detectPixelRatioSupport();
      a.supports.fn.detectFeature();
      c && c()
    })
  };
  a.supports.fn.getUserMedia = function() {
    return !!(navigator.getUserMedia || navigator.webkitGetUserMedia ||
      navigator.mozGetUserMedia || navigator.msGetUserMedia)
  };
  a.supports.fn.peerConnection = function() {
    return !!(window.PeerConnection || window.webkitPeerConnection00 || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || window.RTCPeerConnection)
  };
  a.supports.fn.fileSystem = function() {
    a.supports.chooseEntry = a.util.exists("chrome.fileSystem.chooseEntry");
    a.supports.fileSystem = !a.userAgent.nodewebkit && !!g(window, "requestFileSystem")
  };
  a.supports.fn.detectPixelRatio = function(c) {
    c = g(c, "backingStorePixelRatio") ||
      1;
    return a.canvas2d.pixelRatio = (window.devicePixelRatio || 1) / c
  };
  a.supports.fn.detectPixelRatioSupport = function(c) {
    if (a.userAgent.ios && a.userAgent.iosVersion.isLessThan("8.0")) return a.canvas2d.pixelRatio = 1;
    c = a.util.Canvas.getContext(c);
    var b = c.canvas,
      h = a.supports.fn.detectPixelRatio(c);
    if (1 === h) return h;
    var d = (new Date).getTime();
    b.width = window.innerWidth * h;
    b.height = window.innerHeight * h;
    c.drawImage(b, 0, 0);
    36 < (new Date).getTime() - d && (a.canvas2d.pixelRatio = 1);
    b.width = b.height = 1;
    return a.canvas2d.pixelRatio
  };
  var c = {
    blendModes: "normal multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity".split(" "),
    compositeModes: "source-over source-in source-out source-atop destination-over destination-in destination-out destination-atop lighter darker copy xor".split(" ")
  };
  a.supports.fn.detectCanvas2dFeatures = function(f) {
    var b = a.util.Canvas.getContext(f, 1, 1);
    f = function(f, d) {
      a.supports[f] = {};
      for (var e = !1, m = a.supports[f], k = c[d], l = 1; l < k.length; l++) {
        var r =
          k[l];
        b.globalCompositeOperation = r;
        !0 === (m[r] = b.globalCompositeOperation === r) && (e = !0)
      }
      m.__enabled = e
    };
    f("composite", "compositeModes");
    f("blend", "blendModes");
    a.supports.imageSmoothing = "boolean" === typeof b.imageSmoothingEnabled
  };
  a.supports.fn.detectExport = function(c, b) {
    var h = a.util.Canvas.getContext(c, 1, 1).canvas,
      d = 0,
      e = function() {
        !--d && b && b()
      },
      m = function(b, c) {
        ++d;
        var f = h.toDataURL(c).split(";")[0].substr(5);
        a.supports.io[b] = f === c;
        window.setTimeout(e, 1)
      };
    a.supports.io = {};
    a.supports.io.__enabled = !0;
    m("jpeg",
      "image/jpeg");
    m("png", "image/png");
    m("webp", "image/webp");
    m("bmp", "image/bmp");
    (function(b, c) {
      try {
        ++d, h.toBlob(function(b) {
          var d = new Image;
          d.onload = function() {
            a.supports.io.blob = !(0 === this.width && 0 === this.height);
            e()
          };
          d.onerror = function() {
            a.supports.io.blob = !1;
            e()
          };
          d.src = URL.createObjectURL(b)
        })
      } catch (f) {
        a.supports.io.blob = !1, window.setTimeout(e, 1)
      }
    })()
  };
  a.supports.fn.detectFeature = function() {
    var c = a.feature;
    !1 === c.vector.record && (c.vector.edit = !1);
    !1 === c.vector.edit && (c.history.vector = !1);
    c.palette.composite =
      c.palette.composite && !1 !== a.supports.composite.__enabled;
    c.palette.blend = c.palette.blend && !1 !== a.supports.blend.__enabled
  }
};
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.History = function(a) {
    var c = this;
    this.reset = function(b, d) {
      a.__modified = !1;
      a.__modifiedOnline = !1;
      var k = a.feature.history;
      k.vector && c.resetActionHistory(d);
      k.bitmap && c.resetBitmapHistory(d);
      return this
    };
    this.store = function(b, d) {
      a.__modified = (new Date).getTime();
      a.__modifiedOnline = (new Date).getTime();
      var k = a.feature.history;
      k.vector && c.storeAction(b, d);
      k.bitmap && c.storeBitmap(d);
      a.on.addHistory && a.on.addHistory(b);
      return this
    };
    this.redo = function(b, d) {
      f("redo", b, d);
      a.on.redo && a.on.redo(b);
      return c
    };
    this.undo = function(b, d) {
      f("undo", b, d);
      a.on.undo && a.on.undo(b);
      return c
    };
    var f = function(b, d, k) {
      --d;
      var l = a.feature.history;
      if (l.vector) c[b + "Action"](d, k);
      if (l.bitmap) c[b + "Bitmap"](d, k);
      d && f(b, d, k)
    };
    this.history = {};
    this.history.bitmap = {
      max: a.feature.history.limit,
      current: -1,
      data: []
    };
    this.resetBitmapHistory = function(b) {
      var d = c.history.bitmap;
      d.current = 0;
      d.data = d.data.splice(0, 1);
      a.setSize();
      c.storeBitmap(b);
      return this
    };
    this.storeBitmap = function(b) {
      b = a.feature.debugHistory;
      var d = c.history.bitmap,
        k = d.data.length - 1,
        l = k - d.current;
      if (l) {
        if (b)
          for (var f = 0; f < l; f++) {
            var h = d.data[k - f];
            document.body.removeChild(h)
          }
        d.data = d.data.splice(0, k - l + 1)
      }
      d.data.length === d.max ? d.data.push(d.data.shift()) : d.data.push(a.util.Canvas());
      d.current = d.data.length - 1;
      h = a.canvas2d.layers.layer0;
      d = d.data[d.current].ctx;
      d.canvas.width = d.canvas.width;
      d.drawImage(h, 0, 0);
      b && document.body.appendChild(d.canvas);
      return this
    };
    this.undoBitmap = function(b, d) {
      var k = a.canvas2d.layers.layer0.ctx,
        l = c.history.bitmap;
      l.current = Math.max(0,
        --l.current);
      k.canvas.width = k.canvas.width;
      k.drawImage(l.data[l.current], 0, 0);
      "eraser" === a.tool.type && (k = a.canvas2d.layers.active.ctx, k.canvas.width = k.canvas.width, k.drawImage(l.data[l.current], 0, 0));
      return this
    };
    this.redoBitmap = function(b, d) {
      var k = a.canvas2d.layers.layer0.ctx,
        l = c.history.bitmap;
      l.current = Math.min(l.data.length - 1, ++l.current);
      k.canvas.width = k.canvas.width;
      k.drawImage(l.data[l.current], 0, 0);
      "eraser" === a.tool.type && (k = a.canvas2d.layers.active.ctx, k.canvas.width = k.canvas.width, k.drawImage(l.data[l.current],
        0, 0));
      return this
    };
    this.history.vector = {
      max: a.feature.history.limit,
      current: -1,
      data: []
    };
    this.resetActionHistory = function(a) {
      c.history.vector.data = [];
      c.history.vector.current = -1;
      return this
    };
    this.popAction = function() {
      c.history.vector.data.pop();
      return this
    };
    this.getLastAction = function() {
      var a = c.history.vector.data;
      return a[a.length - 1]
    };
    this.storeAction = function(e, f) {
      if (e.from && e.to) {
        var k = c.history.vector,
          l = k.data.length - 1,
          h = l - k.current;
        h && (k.data = k.data.splice(0, l - h + 1));
        k.data.length === k.max && k.data.shift();
        !e.uid && a.socket && (e.uid = a.socket.user.id);
        l = a.scene.clone(e, !0);
        k.data.push(l);
        k.current = k.data.length - 1;
        b = k.current;
        if (f || a.fromServer) {
          k = c.history.vector;
          if (!k.data[k.current]) return;
          b = void 0;
          d(e, !1, f)
        } else a.dataChannel && (a.feature.stream.sketch && !f) && a.dataChannel.sendPriority(["history.store", a.scene.clone(e, !0)]);
        return this
      }
    };
    this.undoAction = function(b, f) {
      a.active && a.active.canvas && (a.active.canvas.width = a.active.canvas.width, a.canvas2d.layers.draw.width = a.canvas2d.layers.draw.width);
      var k =
        c.history.vector;
      if (-1 === k.current) return !1;
      k.current = Math.max(-1, --k.current);
      k = k.data[k.current + 1];
      if (!k) return !1;
      d(k, !0, f, b);
      a.dataChannel && (a.feature.stream.sketch && !f) && (a.dataChannel.sendPriority(["history.undo", b, !0]), a.dataChannel.send(["history.undo", b]));
      return this
    };
    this.redoAction = function(b, f) {
      var k = c.history.vector;
      if (k.current === k.data.length - 1) return !1;
      k.current = Math.min(k.data.length - 1, ++k.current);
      k = k.data[k.current];
      if (!k) return !1;
      d(k, !1, f, b);
      a.dataChannel && (a.feature.stream.sketch &&
        !f) && (a.dataChannel.sendPriority(["history.redo", b, !0]), a.dataChannel.send(["history.redo", b]));
      return this
    };
    var b = 0,
      h = {
        add: "add",
        remove: "remove",
        replace: "replace"
      };
    this.cmds = {};
    this.registerFunction = function(a) {
      var b = a.type;
      this.cmds[b] = a.fn;
      h[b] = b
    };
    this.registerFunction({
      type: "VOBNodeList",
      fn: function(b, d, c, f) {
        for (b = 0; b < d.length; b++) {
          var h = d[b];
          if (f = a.scene.getById(h.id)) {
            var p = a.assets.getItem(f.src);
            if (p) {
              var q = {},
                t;
              for (t in h) "id" !== t && "uida" !== t && (q[t] = h[t]);
              for (var h = h.uida, s = 0; s < h.length; s++) {
                var w =
                  h[s],
                  v = p.getLayerBy("uid", w.uid);
                if (v)
                  if (c)
                    for (t in w) "uid" !== t && (v.style[t] = w[t]);
                  else
                    for (t in q) v.style[t] = q[t]
              }
              f.dirtyCacheForce = !0;
              f.dirtyRender = !0
            }
          }
        }
      }
    });
    this.registerFunction({
      type: "add",
      fn: function(b, d, c, f, h) {
        for (b = 0; b < d.length; b++)
          if (c = d[b], !a.scene.getById(c.id)) {
            var p = a.scene.clone(c);
            a.scene.decompress(p);
            a.fromServer || a.toolkit.setToolkit(p);
            a.scene.data.splice(c.zIndex, 0, p);
            f && a.area && a.area.inGenesis ? (a.scene.deselect(a.selection.idx), a.selection.idx = a.scene.getById(a.util.INFINITY).zIndex +
              1) : a.feature.history.autoSelect && !1 === f && "select" === a.tool.type && a.scene.selectByIndex(c.zIndex, !1)
          }
        h || a.fromServer || !1 !== a.feature.vector.edit && a.render.preload({
          fromSocket: !0
        })
      }
    });
    this.registerFunction({
      type: "remove",
      fn: function(b, d, c, f, h) {
        b = a.scene.data;
        for (c = 0; c < d.length; c++) {
          h = d[c].id;
          var p = a.scene.getById(h);
          if (p)
            for (f && p.zIndex === a.selection.idx && (a.scene.deselectAll(), window.alertify && alertify.log(f + " removed the layer you had selected.")), p = 0; p < b.length; p++)
              if (b[p].id === h) {
                b.splice(p, 1);
                break
              }
        }
      }
    });
    this.registerFunction({
      type: "replace",
      fn: function(a, c, k, f) {
        k ? (b = void 0, d({
          from: c[1],
          to: "remove"
        }, !1, f, 1), b = void 0, d({
          from: "add",
          to: c[0]
        }, !1, f, 0)) : (b = void 0, d({
          from: c[0],
          to: "remove"
        }, !1, f, 1), b = void 0, d({
          from: "add",
          to: c[1]
        }, !1, f, 0))
      }
    });
    this.registerFunction({
      type: "zoom",
      fn: function(a, b, d, c, f) {
        console.log("zoom", a, b, d)
      }
    });
    var d = function(d, f, k, l) {
      var r = d.from,
        p = d.to;
      k = k || !1;
      if (b !== c.history.vector.current) {
        b = c.history.vector.current;
        var q = h[r.cmd || r],
          t = h[p.cmd || p],
          s = q ? r : t ? p : null,
          w = q || t,
          q = f ?
          r : p,
          t = f ? p : r;
        "remove" === w ? (f && (w = "add"), q = t = r) : "add" === w && (f && (w = "remove"), q = t = p);
        if (c.cmds[w]) {
          if (f) c.cmds[w](s, t, !0, k, l, d.uid);
          else c.cmds[w](s, q, !1, k, l, d.uid);
          a.fromServer || a.render && !l && a.render("sketch.history: " + (f ? "undo" : "redo") + " '" + w + "'")
        } else {
          d = a.detect.refreshPixelData || {};
          f = a.selection.items;
          if (q[0] && isFinite(q[0].zIndex) && t[0] && isFinite(t[0].zIndex) && !q[0].bbox)
            if (0 < t[0].zIndex - q[0].zIndex)
              for (r = 0, p = q.length; r < p; r++) s = q[r], k = t[r], a.scene.data.splice(s.zIndex, 0, a.scene.data.splice(k.zIndex,
                1)[0]), (w = a.scene.data[s.zIndex]) && d[w.type] && (w.dirtyCacheForce = !0), a.selection.idx === k.zIndex && (a.selection.idx = s.zIndex), f[k.zIndex] && "select" === a.tool.type && (a.scene.selectByIndex(s.zIndex, !1), a.scene.deselect(k.zIndex));
            else
              for (r = q.length; r--;) s = q[r], k = t[r], a.scene.data.splice(s.zIndex, 0, a.scene.data.splice(k.zIndex, 1)[0]), (w = a.scene.data[s.zIndex]) && d[w.type] && (w.dirtyCacheForce = !0), f[k.zIndex] && "select" === a.tool.type && (a.scene.selectByIndex(s.zIndex, !1), a.scene.deselect(k.zIndex)), a.selection.idx ===
                k.zIndex && (a.selection.idx = s.zIndex);
          else if (isFinite(q.length))
            for (r = 0, p = q.length; r < p; r++) {
              if (s = q[r], w = a.scene.getById(s.id)) s.labels && (w.labels = []), a.util.mergeObject(s, w), a.scene.decompress(w), a.feature.history.autoSelect && !1 === k && "select" === a.tool.type && a.scene.selectByIndex(w.zIndex, !1), a.feature.vector.edit && (d[w.type] ? w.dirtyCacheForce = !0 : s.content ? (delete w.__textMetrics, w.dirty = !0) : s.color || s.fillStyle || s.bbox && s.bbox.scale ? (w.dirty = !0, w.dirtyTransform = !0, delete w.inbounds) : (w.dirty = !0, w.dirtyResource = !0))
            } else a.util.mergeObject(q, a.project);
          l || (a.scene.reindex(), a.fromServer || !1 !== a.feature.vector.edit && a.render.preload({
            fromSocket: !0
          }))
        }
      }
    }
  }
})(sketch);
"undefined" !== typeof module && module.exports && (module.exports = sketch.History);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.server && (sketch.server = {});
(function(a) {
  var g;
  a.server.servers = [];
  a.server.addHost = function(c) {
    a.util.mergeObject([c], a.server.servers)
  };
  a.server.getHost = function(c) {
    for (var b = a.server.servers, h = 0, d = c.length, e = b.length; d--;) h += c[d].charCodeAt();
    return b[h % e]
  };
  a.server.getResource = function() {
    return a.loc.GET ? a.loc.getRoomID() || a.loc.getRandomID() : "new"
  };
  a.server.open = function(c) {
    if (a.feature.stream.sketchRTC && "PeerServer" === sharefest.server) c && c();
    else {
      var b = a.loc.GET,
        h = a.server.getResource();
      if (!h) return (b = a.configure.sync) ?
        a.loc.setHash("sketch", b) : (b = a.configure.defaultSketch) ? (b = b.replace("sketch=", ""), a.loc.setHash("sketch", b)) : a.loc.setHash("sketch", "new");
      if ("new" === h) return a.scene && a.scene.reset(!0), a.history && a.history.reset(), delete a.configure.sync, a.on.sketchReady();
      if (a.feature.stream.sketch && a.socketIO && !a.socket) return -1 === h.indexOf("/") && (h = "room/" + h), a.socketIO(h);
      if (!a.userAgent.nodewebkit) {
        a.loader.thread = a.loader.add("downloading sketch...");
        a.configure.sync = h;
        var d = function() {
          c && c();
          a.on.sketchReady();
          a.loader.stop()
        };
        a.util.request({
          url: b + h + "&format=" + a.project.format + "&timestamp=" + (new Date).getTime(),
          onerror: function(b) {
            a.loader.update(a.loader.thread, "downloading sketch...", 100);
            a.feature.debug ? console.log("server connection error", b) : a.loc.setHash("sketch", "new")
          },
          onload: function(b) {
            b = b.responseText;
            if ("<?xml" === b.substr(0, 5) || "<svg" === b.substr(0, 4)) a.loader.update(a.loader.thread, "downloading sketch...", 99), a.open.svg(b, d, d);
            else if ("<" === b.substr(0, 1)) a.loader.update(a.loader.thread, "downloading sketch...",
              100), a.feature.debug ? console.log("invalid data from server", b) : a.loc.setHash("sketch", "new");
            else if ("{" === b.substr(0, 1)) a.loader.update(a.loader.thread, "downloading sketch...", 99), a.open.json(b, d, d);
            else if (a.open.zip) {
              for (var c = new Uint8Array(b.length), k = 0; k < b.length; k++) c[k] = b.charCodeAt(k) & 255;
              a.loader.update(a.loader.thread, "downloading sketch...", 99);
              a.open.zip(new Blob([c.buffer], {
                type: "application/zip"
              }))
            } else a.loader.update(a.loader.thread, "downloading sketch...", 100), d()
          },
          onprogress: function(b) {
            var d =
              b.total || parseInt(this.getResponseHeader("Content-xlength"));
            isNaN(d) || a.loader.update(a.loader.thread, "downloading sketch...", Math.max(0, (100 * (b.loaded / d) >> 0) - 1))
          }
        })
      }
    }
  };
  a.server.auth = function(c) {
    a.feature.requireAuth ? a.util.request({
      url: a.loc.host + "check-login.html",
      onload: function(a) {
        c("true" === a.responseText)
      }
    }) : c(!0)
  };
  a.server.enabled = function() {
    if (a.userAgent.nodewebkit) return !1;
    var c = a.project.format,
      b = a.feature.sync;
    if (!b[c] && b.useDefaultFormat) return b[c] = !0;
    for (var h in b) switch (h) {
      case "zip":
      case "svg":
      case "json":
      case "thumb":
      case "image":
        if (b[h]) return !0
    }
    return !1
  };
  a.server.save = function(f, b) {
    "function" === typeof f && (f = {
      onsave: f
    });
    f = f || {};
    250 > (new Date).getTime() - g || (g = (new Date).getTime(), a.loader.syncing = a.loader.message("syncing...", function() {
      f.onsave = b || f.onsave;
      f.onprogress = function(b) {
        a.loader.update(a.loader.syncing, "syncing...", b / 2)
      };
      f.onload = function(a) {
        f.metadata = f.metadata || {};
        for (var b in a)
          if ("folder" === b)
            for (var e = 0; e < a.folder.length; e++) {
              var m = a.folder[e];
              f.metadata[m.filename] = m.blob
            } else f.metadata[b] = a[b];
        c(f)
      };
      a.server.auth(function(b) {
        b ?
          a.save.syncData(f) : a.exec("login")
      })
    }))
  };
  a.server.saveData = function(f) {
    f = f || {};
    a.loader.syncing = a.loader.message("syncing...", function() {
      a.server.auth(function(b) {
        b ? c(f) : a.exec("login")
      })
    })
  };
  var c = function(c) {
    var b = c.callback || c.onsave;
    if (c && a.util.count(c.metadata)) {
      var h = {
          action: c.url || a.loc.POST,
          confirm: "text",
          files: []
        },
        d = function(a, b) {
          h.files.push({
            name: a,
            data: b
          })
        };
      a.feature.sync.hash && a.configure.sync && d("sync", a.configure.sync);
      for (var e in c.metadata) d(e, c.metadata[e]);
      "string" !== typeof c.metadata.fileName &&
        d("fileName", a.project.title);
      h.onProgress = function(b) {
        a.loader.update(a.loader.syncing, "syncing...", 50 + b.transferPercent / 2 >> 0)
      };
      h.onUpload = function(d, c) {
        a.loader.update(a.loader.syncing, "syncing...", 100);
        a.feature.debug && console.log(d.transferTotal, c, d);
        "false" === c || "<" === c[0] ? a.feature.debug && console.log("invalid server response", c) : (window.alertify && alertify.log("All changes saved!"), (a.feature.sync.json || a.feature.sync.zip || a.feature.sync.svg) && a.feature.sync.hash && (a.loc.setHash("sketch", c),
          a.setItem("sync", c)), b && b(c))
      };
      new a.util.uploader.upload(h)
    } else console.log("server sync is not setup")
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.Style = function(a) {
  a.style = a.style || {};
  a.style.Fill = function(b) {
    b = b || a.configure.defaultFill;
    g(b, this);
    return this
  };
  a.style.Stroke = function(b) {
    b = b || a.configure.defaultStroke;
    g(b, this);
    c(b, this);
    return this
  };
  a.style.createStyle = function(b, d) {
    if ("stroke" === b) return new a.style.Stroke(d);
    if ("fill" === b) return new a.style.Fill(d)
  };
  var g = function(b, d) {
      if ("string" === typeof b) {
        var c = a.style.parseStyle(b);
        if (c) var e = c.type,
          c = c.dna;
        else e = "color", c = "#000000";
        b = {};
        b.type = e;
        b[e] = c
      }
      d.type = b.type || "color";
      d.opacity = b.opacity || 1;
      d.noise = b.noise || !1;
      d.mode = b.mode || "linear";
      d.color = b.color || "#000000";
      d.gradient = b.gradient || "0,fffa6c0c,0.04,fff6300a,0.08,fff6300a,0.145,ffd11b7e,0.21,ffd11b7e,0.28,ff7425b1,0.35,ff7425b1,0.42,ff0a62da,0.49,ff0a62da,0.56,ff00c000,0.63,ff00c000,0.715,fff6ef2a,0.8,fff6ef2a,0.9,fffa6c0c,1,fffa6c0c";
      d.pattern = b.pattern || "data:image/gif;base64,R0lGODlhDgAOAID/ANDu/FOdvCwAAAAADgAOAAACHYwDh5fazqKcj05rar5q+w961diVi9g9jaaGkFEAADs=";
      d.__colors = void 0;
      d.__color = void 0;
      d.__pattern = void 0;
      d.__gradient = void 0;
      return d
    },
    c = function(b, d) {
      var c = a.style.stroke || {};
      d.lineWidth = isFinite(b.lineWidth) ? b.lineWidth : isFinite(c.lineWidth) ? c.lineWidth : 0;
      d.lineCap = b.lineCap || c.lineCap || "butt";
      d.lineJoin = b.lineJoin || c.lineJoin || "miter";
      d.miterLimit = isFinite(b.miterLimit) ? b.miterLimit : isFinite(c.miterLimit) ? c.miterLimit : 4;
      d.dashArray = b.dashArray || c.dashArray || "none";
      d.dashOffset = isFinite(b.dashOffset) ? b.dashOffset : isFinite(c.dashOffset) ? c.dashOffset : 0;
      return d
    };
  a.style.init = function() {
    a.style.stroke =
      new a.style.Stroke;
    a.style.fill = new a.style.Fill;
    a.style.loadDefault()
  };
  a.style.setParam = function(b, d, c) {
    "undefined" === typeof c ? (c = {}, c[b] = d, a.toolkit.setDefaultConfigure(c), a.toolkit.setTool()) : a.toolkit.setParam({
      param: b,
      data: d,
      selection: a.selection.parse(c)
    })
  };
  a.setFont = a.style.setFont = function(b, d, c) {
    if ("object" === typeof b) {
      d = a.selection.parse(d || b.selection);
      c = c || b.textarea;
      delete b.selection;
      delete b.textarea;
      a.vector.text.supports[b.fontFamily] || a.toolkit.text.loadFont({
        fontFamily: b.fontFamily
      });
      if (c) {
        var e = a.scene.getSelected();
        e && "text" === e.type || a.scene.fromConfigure(a.configure.tools.text);
        a.vector.text.setFontStyle(b, c)
      }
      for (var f in b) a.toolkit.setParam({
        tool: "text",
        param: f,
        data: b[f],
        selection: d
      })
    }
  };
  var f = {
    color: function(b) {
      if (0 === b.indexOf("#") || 0 === b.indexOf("hsl") || 0 === b.indexOf("hsla") || 0 === b.indexOf("rgb") || 0 === b.indexOf("rgba") || a.color.webcolors[b]) return !0
    },
    pattern: function(a) {
      if (0 === a.indexOf("#asset") || 0 === a.indexOf("data") || 0 === a.indexOf("./") || 0 === a.indexOf("http")) return !0
    },
    gradient: function(a) {
      if (-1 !== a.indexOf(",") && isFinite(parseInt(a[0]))) return !0
    }
  };
  a.style.validate = function(a, b) {
    if ("string" !== typeof a) return !1;
    var d = a.toLowerCase();
    return b ? f[b](d) || !1 : f.color(d) ? "color" : f.pattern(d) ? "pattern" : f.gradient(d) ? "gradient" : !1
  };
  a.style.parseStyle = function(b) {
    if ("none" === b) return {
      dna: "none",
      type: "gradient"
    };
    if (f.color(b)) return {
      dna: b,
      type: "color"
    };
    if (f.pattern(b)) return {
      dna: b,
      type: "pattern"
    };
    if (f.gradient(b) || -1 !== b.indexOf("linear-gradient") && (b = a.style.parseGradient(b))) return {
      dna: b,
      type: "gradient"
    }
  };
  a.style.parseGradient = function(b) {
    if (b && window.LinearGradient) {
      b = window.LinearGradient.parse(b).stops;
      for (var d = b.length, c = [], e = 0; e < d; e++) {
        var f = b[e],
          h = (new a.color.spacex(f.color)).toHEX32String().substr(1),
          f = f.position;
        null === f && (f = void 0);
        f && -1 !== f.indexOf("%") && (f = parseFloat(f.replace("%", "")) / 100);
        c.push(isFinite(f) ? f : e / (d - 1));
        c.push(h)
      }
      return c.join(",")
    }
  };
  a.style.parseTextShadow = function(a) {};
  a.setFill = a.style.setFill = function(b) {
    "string" === typeof b && (b = {
      dna: b
    });
    b.paintMethod =
      "fill";
    b.useRender = !0;
    a.style.apply(b)
  };
  a.setStroke = a.style.setStroke = function(b, d, c, e, f, h, m) {
    "string" === typeof b && (b = {
      dna: b
    }, b.lineWidth = isFinite(d) ? d : 0, b.lineCap = c || "butt", b.lineJoin = e || "miter", b.miterLimit = isFinite(f) ? f : 4, b.dashArray = h || "none", b.dashOffset = isFinite(m) ? m : 0);
    b.paintMethod = "stroke";
    b.useRender = !0;
    a.style.apply(b)
  };
  a.style.apply = function(b) {
    var d = b.dna || b.color || b.gradient || b.pattern || "#000",
      e = b.paintMethod || b.method || "fill",
      f = b.paintType || b.type;
    if (!f) {
      var h = a.style.parseStyle(d);
      if (!h) return;
      f = h.type;
      d = h.dna
    }
    var g = "stroke" === e,
      s = b.useRender || !1,
      w = b.useRecord || null,
      v = b.useColorPicker || !1,
      u = a.selection.parse(b.selection || a.selection.items),
      y = a.configure.tools[a.tool.type],
      x = y && y[e];
    x && (x.type = f, x[f] = d, g && c(b, x), a.style[e] = a.util.clone(x));
    var y = !0 === w || "up" === w || "update" === w,
      w = !0 === w || "down" === w,
      z = a.scene,
      A = "__" + f,
      h = !1,
      B = [],
      D = [],
      G;
    for (G in u)
      if (u = (x = z.data[G]) && x[e]) {
        if (!u[A] || w) u[A] = u[f];
        u[A] === d && u.type === f ? x.dirtyControl = !0 : "clipart" === x.type ? (u[A] = d, h = !0) : (y && (u[f] = u[A],
          u[A] = d, h = {
            id: x.id
          }, h[e] = a.util.clone(u), B.push(h)), u.type = f, u[f] = d, g && c(b, u), h = {
          id: x.id
        }, h[e] = a.util.clone(u), D.push(h), h = !0, x.dirty = !0, x.dirtyControl = !0, u = m(e, x), x.brush && (x = x.brush[e], x.type = f, x[f] = d, g && c(b, x), x.__colors = u))
      }
    a.toolkit.text && a.toolkit.text.updateCSSStyle(d);
    D.length && (B.length && a.history && a.history.store({
      from: B,
      to: D,
      name: "Update Style"
    }), a.dataChannel && a.feature.stream.sketchLive && a.dataChannel.send(["scene.update", D]));
    a.colorPicker.update && ("color" === f && v) && ("none" !== d && a.colorPicker.update(d),
      s = !1);
    a.tool.device && (v = a.tool.device, v.brush ? (x = v.brush[e], x.type = f, x[f] = d, g && c(b, x), m(e, v.brush)) : v[e] && (x = v[e], x.type = f, x[f] = d, g && c(b, x), m(e, v)));
    s && h && a.render("root.style.apply");
    a.palette && a.palette.setIndicator();
    a.tool.interval = 0
  };
  a.style.updateFromObject = function(b, d) {
    d = d || a.configure.tools[a.tool.type];
    var c = a.style[b],
      e = d[b];
    if (e && c) {
      switch (e.type) {
        case "color":
          var f = e.color || d[b + "Style"] || c.color;
          a.colorPicker.update && "none" !== f && a.colorPicker.update(f);
          c.color = f;
          break;
        case "gradient":
          if (!e.gradient) break;
          c.gradient = e.gradient;
          break;
        case "pattern":
          if (!e.pattern) break;
          c.pattern = e.pattern;
          a.style.loadPattern(e.pattern)
      }
      a.palette && a.palette.update(e.type)
    }
  };
  a.style.hexFromColor = function(b) {
    "string" === typeof b ? "hsla" === b.substr(0, 4) ? b = a.color.space(b, "W3>HSLA>RGBA>HEX24>W3") : "rgba" === b.substr(0, 4) ? b = a.color.space(b, "W3>RGBA>HEX24>W3") : "rgb" === b.substr(0, 3) ? b = a.color.space(b, "W3>RGB>HEX24>W3") : a.color.webcolors[b] && (b = a.color.webcolors[b]) : isFinite(b.R) ? b = a.color.space(b, "RGB>HEX24>W3") : isFinite(b.H) &&
      (b = a.color.space(b, "HSLA>RGBA>HEX24>W3"));
    return b
  };
  a.style.blendModes = "normal multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity disco".split(" ");
  a.style.isBlendMode = a.util.array2object(a.style.blendModes);
  a.style.compositeModes = "source-over source-in source-out source-atop destination-over destination-in destination-out destination-atop lighter darker copy xor".split(" ");
  a.style.isCompositeMode = a.util.array2object(a.style.compositeModes);
  a.style.getBlendMode = function() {
    var b = a.scene.data[a.selection.idx];
    return b ? b.composite : a.ui.blendSelectMenu ? a.ui.blendSelectMenu.getValue() : "source-over"
  };
  a.style.setBlendMode = function(b) {
    var d = a.ui.blendSelectMenu;
    if (d) {
      b = b || d.getValue();
      var c = a.tool.device;
      if (c = c && c.brush || c || a.tool.style) {
        var e = a.configure.tools[a.tool.type];
        "eraser" !== e.type && ("normal" === b && (b = "source-over"), e.composite = c.composite = b, b = a.style.blendModes.indexOf(b), -1 !== b && (d.selectedIndex = b))
      }
    }
  };
  a.style.getComposite = function(a,
    d, c) {
    c && b[a] && (a = "source-over");
    return "disco" === a ? 0 === d % 2 ? "lighter" : "source-over" : h[a] || a
  };
  var b = a.util.array2object("source-in source-out source-atop destination-over destination-in destination-out destination-atop copy xor".split(" ")),
    h = {
      erase: "destination-out"
    };
  a.style.renderSwatch = function(b, d, c, e, f, h) {
    if ("undefined" !== typeof d) {
      var s = h || d.offsetWidth || 19,
        g = a.canvas2d.pixelRatio;
      f = d.width = (f || d.offsetWidth || 19) * g;
      h = d.height = s * g;
      s = Math.max(f, h);
      if ("color" === c) d.style.background = e;
      else if (d.getContext) {
        var v =
          d.getContext("2d");
        d = v.createLinearGradient(0, 0, s, s);
        switch (c) {
          case "color":
            v.fillStyle = e;
            v.fillRect(0, 0, f, h);
            break;
          case "gradient":
            s = {};
            s[b] = {};
            s[b].type = c;
            s[b][c] = e;
            b = m(b, s);
            for (c = 0; c < b.length; c += 2) d.addColorStop(b[c], b[c + 1]);
            v.fillStyle = d;
            v.fillRect(0, 0, f, h);
            break;
          case "pattern":
            a.style.loadPattern(e, function(a) {
              Math.min(3, Math.max(1, a.width / f, a.height / h));
              v.save();
              v.rect(0, 0, f, h);
              v.fillStyle = a;
              v.fill();
              v.restore()
            })
        }
      } else "gradient" === c && (d.style.cssText = a.style.getGradientCSS(e, "left top"))
    }
  };
  (function() {
    if ("undefined" !== typeof document) {
      var b = document.createElement("canvas"),
        d = b.getContext("2d");
      b.width = 2;
      b.height = 2
    }
    a.style.loadPattern = function(b, c) {
      var e = a.style.patternCtx[b];
      if (e) c && c(e, !1);
      else {
        b || (b = a.style.fill.pattern);
        var k = new Image;
        k.onerror = function() {
          a.feature.debug && console.log("missing pattern", b);
          c && c(!1)
        };
        k.onload = function() {
          var e = d.createPattern(k, "repeat");
          a.style.patternCtx[b] = e;
          e.width = k.width;
          e.height = k.height;
          c && c(e, k)
        };
        k.src = b
      }
    }
  })();
  a.style.setGradientCSS = function(a,
    b, c) {
    if (b) {
      if ("none" === b) return a.background = "none";
      c = c || "left top";
      b = d(b, c);
      a.background = "linear-gradient(" + c + "," + b + ");";
      a.background = "-webkit-linear-gradient(" + c + "," + b + ");";
      a.background = "-ms-linear-gradient(" + c + "," + b + ");";
      a.background = "-moz-linear-gradient(" + c + "," + b + ");";
      a.background = "-o-linear-gradient(" + c + "," + b + ");"
    }
  };
  a.style.getGradientCSS = function(a, b) {
    if (a) {
      if ("none" === a) return "background: none";
      b = b || "left top";
      var c = d(a, b);
      return "\t\t\tbackground: linear-gradient(" + b + "," + c + ");\t\t\tbackground: -webkit-linear-gradient(" +
        b + "," + c + ");\t\t\tbackground: -ms-linear-gradient(" + b + "," + c + ");\t\t\tbackground: -moz-linear-gradient(" + b + "," + c + ");\t\t\tbackground: -o-linear-gradient(" + b + "," + c + ");"
    }
  };
  var d = function(a, b) {
    for (var d = [], c = a.split(","), e = 0, f = c.length; e < f;) {
      var h = 100 * c[e],
        m = c[e + 1],
        g = parseInt(m.substr(2, 2), 16),
        u = parseInt(m.substr(4, 2), 16),
        y = parseInt(m.substr(6, 2), 16),
        m = parseInt(m.substr(0, 2), 16) / 255;
      d.push("rgba(" + g + "," + u + "," + y + "," + m + ") " + h + "%");
      e += 2
    }
    return d.join(", ")
  };
  a.style.getGradientStops = function(a) {
    if (a) {
      if ("none" ===
        a) return "background: none";
      var b = [];
      a = a.split(",");
      for (var d = 0, c = a.length; d < c;) {
        var e = 100 * a[d],
          f = a[d + 1],
          h = parseInt(f.substr(2, 2), 16),
          m = parseInt(f.substr(4, 2), 16),
          g = parseInt(f.substr(6, 2), 16),
          f = parseInt(f.substr(0, 2), 16) / 255;
        b.push({
          color: "rgba(" + h + "," + m + "," + g + "," + f + ")",
          offset: e / 100
        });
        d += 2
      }
      return b
    }
  };
  a.style.load = function(b, d) {
    var c = e("fill", b);
    "pattern" === c.type && c.pattern ? a.style.loadPattern(c.pattern, function(c) {
      c && (c = a.style.updateCache(b), d && d(c))
    }) : (c = a.style.updateCache(b), d && d(c))
  };
  a.style.updateCache =
    function(a) {
      a.fill && m("fill", a);
      a.stroke && m("stroke", a)
    };
  var e = function(b, d) {
      var c;
      if (d[b]) c = "string" === typeof d[b] ? d[b] = new a.style.createStyle(b, d) : d[b];
      else {
        c = a.configure.tools[d.type];
        if (!c[b]) return "";
        c = c[b]
      }
      var e = c.type;
      "string" !== typeof c[e] && (c[e] = a.style[b][e]);
      return c
    },
    m = function(b, d) {
      var c = e(b, d),
        f = c.noise;
      if ("none" === c[c.type]) var h = [0, 0];
      else switch (c.type) {
        case "color":
          if (!f) return c.__colors = [0, c.color];
          var m = parseInt("0xFF" + c.color),
            h = [0, m, 1, m];
          break;
        case "gradient":
          h = c.gradient.split(",");
          if (!h.length) return c.__colors = [0, c.color];
          for (var s = 0; s < h.length; s += 2) m = h[s + 1], "#" === m[0] && (m = m.substr(1)), 6 === m.length && (m = "ff" + m), 3 === m.length && (m = "ff" + m[0] + m[0] + m[1] + m[1] + m[2] + m[2]), h[s] = parseFloat(h[s]), h[s + 1] = parseInt("0x" + m, 16);
          break;
        case "pattern":
          if (!c.pattern) return c.__colors = [0, c.color];
          a.style.loadPattern(c.pattern);
          return c.__colors = [0, a.style.patternCtx[c.pattern]]
      }
      if (!f && !a.detect.generativeColor[d.type]) {
        if (h) {
          c.__colors = [];
          for (f = 0; f < h.length; f += 2) c.__colors.push(h[f]), c.__colors.push(a.color.space(h[f +
            1], "HEX32>RGBA>W3"));
          return c.__colors
        }
        return c.__colors = [0, c.color]
      }
      m = f ? 10 : 0;
      s = f ? 20 : 0;
      f = f ? 10 : 0;
      if (a.color.gradient) return c.__colors = a.color.gradient.getColors({
        seed: d.seed,
        dna: h,
        length: 500,
        resolution: 1,
        blend: "Luminosity",
        H: m,
        S: s,
        L: f
      }), c.__colors;
      a.feature.debug && console.log("missing gradient.js");
      return c.__colors = [0, c.color]
    };
  a.style.createGradient = function(b, d, c, e, f, h, s) {
    var g = s[b];
    if (g) {
      var v = g.type,
        u = g.mode,
        y = g[v];
      if ("none" === y) return "rgba(0,0,0,0)";
      if ("color" === v && "cycle" !== u) return y;
      if ("pattern" ===
        v) return a.style.patternCtx[y];
      if ("erase" === s.composite) return "#000";
      if ("cycle" === u) return b = g.__colors, b[(2 * (s.time || 0) + 1) % b.length];
      "radial" === u ? (v = (c + f) / 2, u = (e + h) / 2, c = Math.sqrt(Math.pow(f - c, 2) + Math.pow(h - e, 2)) / 2, d = d.createRadialGradient(v, u, 0, v, u, c)) : d = d.createLinearGradient(c, e, f, h);
      b = g.__colors || (g.__colors = m(b, s));
      for (s = 0; s < b.length; s += 2) g = b[s], (c = b[s + 1]) && d.addColorStop(g, c);
      return d
    }
  };
  return a.style
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.Style);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.color && (sketch.color = {});
"undefined" === typeof sketch.color.space && (sketch.color.space = {});
"undefined" === typeof sketch.color.spacex && (sketch.color.spacex = {});
(function() {
  var a = {},
    g = {
      "HEX24>HSL": "HEX24>RGB>HSL",
      "HEX32>HSLA": "HEX32>RGBA>HSLA",
      "HEX24>CMYK": "HEX24>RGB>CMY>CMYK",
      "RGB>CMYK": "RGB>CMY>CMYK"
    },
    c = sketch.color.space = function(b, f) {
      g[f] && (f = g[f]);
      var d = f.split(">");
      if ("object" === typeof b && 0 <= b[0]) {
        for (var e = d[0], m = {}, k = 0; k < e.length; k++) {
          var l = e.substr(k, 1);
          m[l] = b[k]
        }
        b = m
      }
      if (a[f]) return a[f](b);
      e = 1;
      for (m = d[0]; e < d.length; e++) 1 < e && (m = m.substr(m.indexOf("_") + 1)), m += (0 === e ? "" : "_") + d[e], b = c[m](b);
      return b
    },
    f = sketch.color.spacex = function(a, f) {
      a = (a || "").replace(/ /g,
        "");
      a = a.toLowerCase();
      var d = {
          "#": function(a, b) {
            a.hex = c.W3_HEX24(b);
            a.type = "hex";
            var d = c.HEX24_RGB(a.hex);
            a.R = d.R;
            a.G = d.G;
            a.B = d.B;
            a.A = d.A
          },
          rgba: function(a, b) {
            var d = c.W3_RGBA(b);
            a.R = d.R;
            a.G = d.G;
            a.B = d.B;
            a.A = d.A;
            a.type = "rgba"
          },
          rgb: function(a, b) {
            var d = c.W3_RGB(b);
            a.R = d.R;
            a.G = d.G;
            a.B = d.B;
            a.type = "rgb"
          },
          hsla: function(a, b) {
            var d = c.W3_HSLA(b);
            a.H = d.H;
            a.S = d.S;
            a.L = d.L;
            a.A = d.A;
            a.type = "hsla"
          },
          hsl: function(a, b) {
            var d = c.W3_HSL(b);
            a.H = d.H;
            a.S = d.S;
            a.L = d.L;
            a.type = "hsl"
          }
        },
        e;
      for (e in d)
        if (0 === a.indexOf(e)) return d[e](this,
          a), this;
      if (sketch.color.webcolors[a]) d["#"](this, sketch.color.webcolors[a]);
      return this
    };
  f.prototype.toRGBA = function() {};
  f.prototype.toRGB = function() {
    switch (this.type) {
      case "hex":
        var a = c.HEX_RGB(this.hex);
        this.R = a.R;
        this.G = a.G;
        this.B = a.B;
        return this;
      case "rgb":
        return this;
      case "rgba":
        return this
    }
  };
  f.prototype.toHSLA = function() {};
  f.prototype.toHSL = function() {
    switch (this.type) {
      case "hex":
        return c.RGB_HSL(c.HEX24_RGB(this.hex));
      case "rgb":
        return c.RGB_HSL(this);
      case "rgba":
        return c.RGBA_HSLA(this)
    }
  };
  f.prototype.toHEX24 = function() {
    switch (this.type) {
      case "hex":
        return this.hex;
      case "rgb":
      case "rgba":
        return c.RGB_HEX24(this);
      case "hsl":
      case "hsla":
        return c.RGB_HEX24(c.HSL_RGB(this))
    }
  };
  f.prototype.toHEX32 = function() {
    switch (this.type) {
      case "hex":
        return this.hex + 4278190080;
      case "rgb":
      case "rgba":
        return c.RGBA_HEX32(this);
      case "hsl":
      case "hsla":
        return c.RGBA_HEX32(c.HSLA_RGBA(this))
    }
  };
  f.prototype.toHEX24String = function() {
    return c.HEX32_W3(this.toHEX24())
  };
  f.prototype.toHEX32String = function() {
    return c.HEX32_W3(this.toHEX32())
  };
  f.prototype.isW3Contrast = function(a, c, d) {
    c = c || 125;
    d = d || 500;
    a = a ? (new f(a)).toRGB() : {
      r: 0,
      g: 0,
      b: 0
    };
    c = this.isW3Brightness(a) <= c;
    d = this.isW3Difference(a) <= d;
    return !(c && d)
  };
  f.prototype.isW3Brightness = function(a) {
    return Math.abs((299 * this.R + 587 * this.G + 114 * this.B) / 1E3 - (299 * a.R + 587 * a.G + 114 * a.B) / 1E3)
  };
  f.prototype.isW3Difference = function(a) {
    var c = Math.max(this.R, a.R) - Math.min(this.R, a.R),
      d = Math.max(this.G, a.G) - Math.min(this.G, a.G);
    a = Math.max(this.B, a.B) - Math.min(this.B, a.B);
    return c + d + a
  };
  c.W3Brightness = function(a,
    c) {
    return Math.abs((299 * a.R + 587 * a.G + 114 * a.B) / 1E3 - (299 * c.R + 587 * c.G + 114 * c.B) / 1E3)
  };
  c.W3Difference = function(a, c) {
    var d = Math.max(a.R, c.R) - Math.min(a.R, c.R),
      e = Math.max(a.G, c.G) - Math.min(a.G, c.G);
    c = Math.max(a.B, c.B) - Math.min(a.B, c.B);
    return d + e + c
  };
  c.isW3Contrast = function(a, f) {
    f = f || {
      R: 255,
      G: 255,
      B: 255
    };
    var d = 125 >= c.W3Brightness(a, f),
      e = 500 >= c.W3Difference(a, f);
    return !(d && e)
  };
  c.RGB_W3 = function(a) {
    return "rgb(" + (a.R >> 0) + "," + (a.G >> 0) + "," + (a.B >> 0) + ")"
  };
  c.RGBA_W3 = function(a) {
    return "rgba(" + (a.R >> 0) + "," + (a.G >> 0) +
      "," + (a.B >> 0) + "," + ("number" === typeof a.A ? a.A / 255 : 1) + ")"
  };
  c.W3_RGB = function(a) {
    a = a.substr(4, a.length - 5).split(",");
    return {
      R: parseInt(a[0], 10),
      G: parseInt(a[1], 10),
      B: parseInt(a[2], 10)
    }
  };
  c.W3_RGBA = function(a) {
    a = a.substr(5, a.length - 6).split(",");
    return {
      R: parseInt(a[0], 10),
      G: parseInt(a[1], 10),
      B: parseInt(a[2], 10),
      A: 255 * parseFloat(a[3] || 1)
    }
  };
  c.HSL_W3 = function(a) {
    return "hsl(" + (a.H + 0.5 >> 0) + "," + (a.S + 0.5 >> 0) + "%," + (a.L + 0.5 >> 0) + "%)"
  };
  c.HSLA_W3 = function(a) {
    return "hsla(" + (a.H + 0.5 >> 0) + "," + (a.S + 0.5 >> 0) + "%," + (a.L + 0.5 >>
      0) + "%," + ("number" === typeof a.A ? a.A / 255 : 1) + ")"
  };
  c.W3_HSL = function(a) {
    var c = a.indexOf("(") + 1,
      d = a.indexOf(")");
    a = a.substr(c, d - c).split(",");
    return {
      H: parseInt(a[0], 10),
      S: parseInt(a[1], 10),
      L: parseInt(a[2], 10)
    }
  };
  c.W3_HSLA = function(a) {
    var c = a.indexOf("(") + 1,
      d = a.indexOf(")");
    a = a.substr(c, d - c).split(",");
    return {
      H: parseInt(a[0], 10),
      S: parseInt(a[1], 10),
      L: parseInt(a[2], 10),
      A: 255 * parseFloat(a[3], 10)
    }
  };
  c.W3_HEX = c.W3_HEX24 = function(a) {
    "#" === a.substr(0, 1) && (a = a.substr(1));
    3 === a.length && (a = a[0] + a[0] + a[1] + a[1] + a[2] +
      a[2]);
    return parseInt("0x" + a, 16)
  };
  c.W3_HEX32 = function(a) {
    "#" === a.substr(0, 1) && (a = a.substr(1));
    3 === a.length && (a = a[0] + a[0] + a[1] + a[1] + a[2] + a[2]);
    return 6 === a.length ? parseInt("0xFF" + a, 16) : parseInt("0x" + a, 16)
  };
  c.HEX_W3 = c.HEX24_W3 = function(a, c) {
    c || (c = 6);
    a || (a = 0);
    var d, e = a.toString(16);
    for (d = e.length; d < c;) e = "0" + e, d++;
    for (d = e.length; d > c;) e = e.substr(1), d--;
    return "#" + e
  };
  c.HEX32_W3 = function(a) {
    return c.HEX_W3(a, 8)
  };
  c.HEX_RGB = c.HEX24_RGB = function(a) {
    return {
      R: a >> 16,
      G: a >> 8 & 255,
      B: a & 255
    }
  };
  c.HEX32_RGBA = function(a) {
    return {
      R: a >>>
        16 & 255,
      G: a >>> 8 & 255,
      B: a & 255,
      A: a >>> 24
    }
  };
  c.RGBA_HEX32 = function(a) {
    return (a.A << 24 | a.R << 16 | a.G << 8 | a.B) >>> 0
  };
  c.RGB_HEX24 = c.RGB_HEX = function(a) {
    0 > a.R && (a.R = 0);
    0 > a.G && (a.G = 0);
    0 > a.B && (a.B = 0);
    255 < a.R && (a.R = 255);
    255 < a.G && (a.G = 255);
    255 < a.B && (a.B = 255);
    return a.R << 16 | a.G << 8 | a.B
  };
  c.RGB_CMY = function(a) {
    return {
      C: 1 - a.R / 255,
      M: 1 - a.G / 255,
      Y: 1 - a.B / 255
    }
  };
  c.RGBA_HSLA = c.RGB_HSL = function(a) {
    var c = a.R / 255,
      d = a.G / 255,
      e = a.B / 255,
      f = Math.min(c, d, e),
      k = Math.max(c, d, e),
      l = k - f,
      r, p = (k + f) / 2;
    if (0 === l) f = r = 0;
    else {
      var f = 0.5 > p ? l / (k + f) : l / (2 - k -
          f),
        q = ((k - c) / 6 + l / 2) / l,
        g = ((k - d) / 6 + l / 2) / l,
        l = ((k - e) / 6 + l / 2) / l;
      c === k ? r = l - g : d === k ? r = 1 / 3 + q - l : e === k && (r = 2 / 3 + g - q);
      0 > r && (r += 1);
      1 < r && (r -= 1)
    }
    return {
      H: 360 * r,
      S: 100 * f,
      L: 100 * p,
      A: a.A
    }
  };
  c.RGBA_HSVA = c.RGB_HSV = function(a) {
    var c = a.R / 255,
      d = a.G / 255,
      e = a.B / 255,
      f = Math.min(c, d, e),
      k = Math.max(c, d, e),
      l = k - f,
      r;
    if (0 === l) f = r = 0;
    else {
      var f = l / k,
        p = ((k - c) / 6 + l / 2) / l,
        q = ((k - d) / 6 + l / 2) / l,
        l = ((k - e) / 6 + l / 2) / l;
      c === k ? r = l - q : d === k ? r = 1 / 3 + p - l : e === k && (r = 2 / 3 + q - p);
      0 > r && (r += 1);
      1 < r && (r -= 1)
    }
    return {
      H: 360 * r,
      S: 100 * f,
      V: 100 * k,
      A: a.A
    }
  };
  c.CMY_RGB = function(a) {
    return {
      R: Math.max(0,
        255 * (1 - a.C)),
      G: Math.max(0, 255 * (1 - a.M)),
      B: Math.max(0, 255 * (1 - a.Y))
    }
  };
  c.CMY_CMYK = function(a) {
    var c = a.C,
      d = a.M;
    a = a.Y;
    var e = Math.min(a, Math.min(d, Math.min(c, 1))),
      c = Math.round(100 * ((c - e) / (1 - e))),
      d = Math.round(100 * ((d - e) / (1 - e)));
    a = Math.round(100 * ((a - e) / (1 - e)));
    e = Math.round(100 * e);
    return {
      C: c,
      M: d,
      Y: a,
      K: e
    }
  };
  c.CMYK_CMY = function(a) {
    return {
      C: a.C * (1 - a.K) + a.K,
      M: a.M * (1 - a.K) + a.K,
      Y: a.Y * (1 - a.K) + a.K
    }
  };
  c.HSLA_RGBA = c.HSL_RGB = function(a) {
    var c = a.H / 360,
      d = a.S / 100,
      e = a.L / 100,
      f, k, l;
    0 === d ? e = d = c = e : (k = 0.5 > e ? e * (1 + d) : e + d - d * e, f = 2 * e -
      k, l = c + 1 / 3, 0 > l && (l += 1), 1 < l && (l -= 1), e = 1 > 6 * l ? f + 6 * (k - f) * l : 1 > 2 * l ? k : 2 > 3 * l ? f + 6 * (k - f) * (2 / 3 - l) : f, l = c, 0 > l && (l += 1), 1 < l && (l -= 1), d = 1 > 6 * l ? f + 6 * (k - f) * l : 1 > 2 * l ? k : 2 > 3 * l ? f + 6 * (k - f) * (2 / 3 - l) : f, l = c - 1 / 3, 0 > l && (l += 1), 1 < l && (l -= 1), c = 1 > 6 * l ? f + 6 * (k - f) * l : 1 > 2 * l ? k : 2 > 3 * l ? f + 6 * (k - f) * (2 / 3 - l) : f);
    return {
      R: 255 * e,
      G: 255 * d,
      B: 255 * c,
      A: a.A
    }
  };
  c.HSVA_RGBA = c.HSV_RGB = function(a) {
    var c = a.H / 360,
      d = a.S / 100,
      e = a.V / 100,
      f, k, l, r, p;
    if (0 === d) f = k = l = Math.round(255 * e);
    else switch (1 <= c && (c = 0), c *= 6, r = c - Math.floor(c), p = Math.round(255 * e * (1 - d)), l = Math.round(255 * e * (1 -
      d * r)), d = Math.round(255 * e * (1 - d * (1 - r))), e = Math.round(255 * e), Math.floor(c)) {
      case 0:
        f = e;
        k = d;
        l = p;
        break;
      case 1:
        f = l;
        k = e;
        l = p;
        break;
      case 2:
        f = p;
        k = e;
        l = d;
        break;
      case 3:
        f = p;
        k = l;
        l = e;
        break;
      case 4:
        f = d;
        k = p;
        l = e;
        break;
      case 5:
        f = e, k = p
    }
    return {
      R: f,
      G: k,
      B: l,
      A: a.A
    }
  };
  sketch.color.webcolors = {
    aliceblue: "f0f8ff",
    antiquewhite: "faebd7",
    aqua: "00ffff",
    aquamarine: "7fffd4",
    azure: "f0ffff",
    beige: "f5f5dc",
    bisque: "ffe4c4",
    black: "000000",
    blanchedalmond: "ffebcd",
    blue: "0000ff",
    blueviolet: "8a2be2",
    brown: "a52a2a",
    burlywood: "deb887",
    cadetblue: "5f9ea0",
    chartreuse: "7fff00",
    chocolate: "d2691e",
    coral: "ff7f50",
    cornflowerblue: "6495ed",
    cornsilk: "fff8dc",
    crimson: "dc143c",
    cyan: "00ffff",
    darkblue: "00008b",
    darkcyan: "008b8b",
    darkgoldenrod: "b8860b",
    darkgray: "a9a9a9",
    darkgreen: "006400",
    darkgrey: "a9a9a9",
    darkkhaki: "bdb76b",
    darkmagenta: "8b008b",
    darkolivegreen: "556b2f",
    darkorange: "ff8c00",
    darkorchid: "9932cc",
    darkred: "8b0000",
    darksalmon: "e9967a",
    darkseagreen: "8fbc8f",
    darkslateblue: "483d8b",
    darkslategray: "2f4f4f",
    darkslategrey: "2f4f4f",
    darkturquoise: "00ced1",
    darkviolet: "9400d3",
    deeppink: "ff1493",
    deepskyblue: "00bfff",
    dimgray: "696969",
    dimgrey: "696969",
    dodgerblue: "1e90ff",
    firebrick: "b22222",
    floralwhite: "fffaf0",
    forestgreen: "228b22",
    fuchsia: "ff00ff",
    fuscia: "ff00ff",
    gainsboro: "dcdcdc",
    ghostwhite: "f8f8ff",
    gold: "ffd700",
    goldenrod: "daa520",
    gray: "808080",
    green: "008000",
    greenyellow: "adff2f",
    grey: "808080",
    honeydew: "f0fff0",
    hotpink: "ff69b4",
    indianred: "cd5c5c",
    indigo: "4b0082",
    ivory: "fffff0",
    khaki: "f0e68c",
    lavender: "e6e6fa",
    lavenderblush: "fff0f5",
    lawngreen: "7cfc00",
    lemonchiffon: "fffacd",
    lightblue: "add8e6",
    lightcoral: "f08080",
    lightcyan: "e0ffff",
    lightgoldenrodyellow: "fafad2",
    lightgray: "d3d3d3",
    lightgreen: "90ee90",
    lightgrey: "d3d3d3",
    lightpink: "ffb6c1",
    lightsalmon: "ffa07a",
    lightseagreen: "20b2aa",
    lightskyblue: "87cefa",
    lightslategray: "778899",
    lightslategrey: "778899",
    lightsteelblue: "b0c4de",
    lightyellow: "ffffe0",
    lime: "00ff00",
    limegreen: "32cd32",
    linen: "faf0e6",
    magenta: "ff00ff",
    maroon: "800000",
    mediumaquamarine: "66cdaa",
    mediumblue: "0000cd",
    mediumorchid: "ba55d3",
    mediumpurple: "9370db",
    mediumseagreen: "3cb371",
    mediumslateblue: "7b68ee",
    mediumspringgreen: "00fa9a",
    mediumturquoise: "48d1cc",
    mediumvioletred: "c71585",
    midnightblue: "191970",
    mintcream: "f5fffa",
    mistyrose: "ffe4e1",
    moccasin: "ffe4b5",
    navajowhite: "ffdead",
    navy: "000080",
    oldlace: "fdf5e6",
    olive: "808000",
    olivedrab: "6b8e23",
    orange: "ffa500",
    orangered: "ff4500",
    orchid: "da70d6",
    palegoldenrod: "eee8aa",
    palegreen: "98fb98",
    paleturquoise: "afeeee",
    palevioletred: "db7093",
    papayawhip: "ffefd5",
    peachpuff: "ffdab9",
    peru: "cd853f",
    pink: "ffc0cb",
    plum: "dda0dd",
    powderblue: "b0e0e6",
    purple: "800080",
    red: "ff0000",
    rosybrown: "bc8f8f",
    royalblue: "4169e1",
    saddlebrown: "8b4513",
    salmon: "fa8072",
    sandybrown: "f4a460",
    seagreen: "2e8b57",
    seashell: "fff5ee",
    sienna: "a0522d",
    silver: "c0c0c0",
    skyblue: "87ceeb",
    slateblue: "6a5acd",
    slategray: "708090",
    slategrey: "708090",
    snow: "fffafa",
    springgreen: "00ff7f",
    steelblue: "4682b4",
    tan: "d2b48c",
    teal: "008080",
    thistle: "d8bfd8",
    tomato: "ff6347",
    turquoise: "40e0d0",
    violet: "ee82ee",
    wheat: "f5deb3",
    white: "ffffff",
    whitesmoke: "f5f5f5",
    yellow: "ffff00",
    yellowgreen: "9acd32"
  }
})();
"undefined" !== typeof module && module.exports && (module.exports = sketch.color);
"undefined" === typeof sketch && (sketch = {});
sketch.StylePalette = function(a) {
  a.style = a.style || {};
  a.style.defaultColors = "#ffffff #e2e2e2 #c6c6c6 #aaaaaa #8d8d8d #717171 #555555 #383838 #1c1c1c #000000 #a8f1ff #aedbff #bcb8ff #e0a6ff #ffb4de #ffbcbc #ffd1b4 #ffeeaa #ffff9a #e4f9c1 #63e5ff #6ebeff #877fff #c661ff #ff79c2 #ff8888 #ffac79 #ffe067 #ffff49 #cef28f #2bd5ff #3aa1ff #5a51ff #ab29ff #ff48a6 #ff5b5b #ff8a47 #ffce2f #fffd07 #b6e565 #00c1f7 #1285ff #362cff #9000ff #f3228a #ff3737 #ff6c20 #ffba04 #fff200 #9dd241 #00a8e0 #006af5 #1b11ff #7400f4 #d7066f #ff1b1b #ff5103 #eea300 #ffdc00 #83b925 #008cc1 #004fcf #0800da #5800cb #b10053 #e90808 #f43900 #d08800 #d6b700 #689a10 #00668c #00369b #000094 #3a0087 #800037 #ac0000 #c42500 #9f6700 #ab9200 #4c7602".split(" ");
  a.style.defaultGradients =
    "0,ffff0000,0.25,ffffff00,0.5,ffffff00,0.75,ff00ff00,1,ff00ff00 0,ff000000,0.167,ff000000,0.333,ffff0000,0.5,ffff0000,0.667,ffffff00,0.833,ffffff00,1,ffffff00 0,ff9e0142,0.046,ff9e0142,0.091,ffd53e4f,0.136,ffd53e4f,0.182,fff46d43,0.227,fff46d43,0.273,fffdae61,0.318,fffdae61,0.364,fffee08b,0.409,fffee08b,0.455,ffffffbf,0.5,ffffffbf,0.546,ffe6f598,0.591,ffe6f598,0.636,ffabdda4,0.682,ffabdda4,0.727,ff66c2a5,0.773,ff66c2a5,0.818,ff3288bd,0.864,ff3288bd,0.909,ff5e4fa2,0.955,ff5e4fa2,1,ff5e4fa2 0,fffa6c0c,0.04,fff6300a,0.08,fff6300a,0.145,ffd11b7e,0.21,ffd11b7e,0.28,ff7425b1,0.35,ff7425b1,0.42,ff0a62da,0.49,ff0a62da,0.56,ff00c000,0.63,ff00c000,0.715,fff6ef2a,0.8,fff6ef2a,0.9,fffa6c0c,1,fffa6c0c 0,ff9c2224,0.09,ffc42d25,0.18,ffc42d25,0.255,ffe23f30,0.33,ffe23f30,0.415,ffef5d41,0.5,ffef5d41,0.55,fff38d4e,0.6,fff38d4e,0.67,fff59a3a,0.74,fff59a3a,0.815,fffabf58,0.89,fffabf58,0.945,fffccfa0,1,fffccfa0 0.06567889822065,ff0c0126,0.1176747,ff19022a,0.22994306504649997,ff27032e,0.37598319999999996,ff43013a,0.43984393878431993,ff5f0046,0.544758,ff7e003a,0.6070303324195799,ff9e002f,0.7105123,ffce1129,0.77393466551848,fffe2323,0.8197397,fff6441a,0.8692658678592999,ffee6611,0.930715,fff68617,0.9802042847244999,ffffa61e 0,ff607e80,0.25,ff9fd962,0.5,ff9fd962,0.75,fff3fa58,1,fff3fa58 0,ff000000,0.1458854,ff000000,0.16999999999999998,ff000000,0.1941146,ff2b0700,0.21807295,ff560e00,0.2420313,ff8d1e00,0.25648445000000003,ffc42f00,0.2709376,ffd84600,0.2988543,ffec5e00,0.326771,ffde4800,0.3423439,ffd13200,0.3579168,ffe65c11,0.36890635,fffb8623,0.37989589999999995,fffd6919,0.39893229999999996,ffff4d0f,0.41796869999999997,ffc8511f,0.42578119999999997,ff915530,0.43359369999999997,ffc8aa97,0.44140619999999997,ffffffff,0.44921869999999997,ffffffff,0.47153435,ffffffff,0.49384999999999996,ffcdf1ff,0.5277562499999999,ff9be3ff,0.5616625,ff5aa2f1,0.7015583,ff1a61e4,0.7015583,ff1736a4,0.7653604744791199,ff150b64,0.8291626999999999,ff0a0532,0.91458135,ff000000 0.06279181820714999,ff030101,0.1259619,ff0d000a,0.1884619,ff180013,0.25096189999999996,ff65024e,0.31346189999999996,ffb2048a,0.37596189999999996,ffb20356,0.43846189999999996,ffb20323,0.5009619,ffb20319,0.5634619,ffb2030f,0.6259619,ff8d0230,0.6902920499999999,ff680251,0.7546222,ffaf1e4b,0.8247415191252401,fff63b46,0.8750691,ffa71e45,0.95131794026088,ff590245 0,ffffbbd9,0.125,ffdac1df,0.25,ffb6c8e6,0.375,ffc7c9b6,0.55625,ffd9cb86,0.7375,ff819569,0.8609375,ff295f4d,0.984375,ff17423c,1,ff06252c 0,ff15aeeb,0.3333333,ff8157ba,0.50818891461434,ffed008a,0.6717635,fff47961,1,fffbf239 0,ff5b2600,0.5,ff8b5600,1,ffbb8600 0,ff395fa5,0.17,ff51485c,0.277,ff51485c,0.292,ffa47472,0.307,ffa47472,0.332,ff632d02,0.449,ff632d02,0.554,ff494d47,0.695,ff494d47,0.843,ff2e2426,1,ff2e2426 0,ff285f88,0.165,ff9eb9d4,0.33,ff9eb9d4,0.495,fff9947e,0.66,fff9947e,0.83,ffe45d61,1,ffe45d61 0,ff000022,0.175,ff191024,0.28333335,ff322027,0.3916667,ff4c322d,0.5000000499999999,ff664433,0.6083334,ff8a5d3d,0.71666675,ffae7747,0.8250001,ffce9056,1,ffeeaa66 0.125,ff5b49af,0.25,ffa92c77,0.375,fff81040,0.5,fffb5f36,0.58653845,ffffae2d,0.75,ff9f9044,0.797337275,ff40725b 0,ffdb2962,0.3300781,ffe98431,0.54206764604626,fff8df00,0.6728514999999999,ffa4ac33,0.9999998999999999,ff517a67 0,fffe4d01,0.245,fffe7701,0.49,ffffa101,0.745,ff92a470,1,ff26a8e0 0,ff4c36b3,0.15,ffa1207d,0.24734265,fff60a48,0.3446853,fffa7e3b,0.43132864374999996,fffff32e,0.5326573,ff87f874,0.6721152827415,ff0ffebb,0.8,ff26a0be,1,ff3d43c1 0,ffca0020,0.125,ffca0020,0.25,fff4a582,0.375,fff4a582,0.5,ff92c5de,0.625,ff92c5de,0.75,ff0571b0,0.875,ff0571b0,1,ff0571b0 0,ffff67d0,0.036,ffff3e6c,0.072,ffff3e6c,0.127,ffff579e,0.181,ffff579e,0.247,ffff3958,0.313,ffff3958,0.368,ffff3958,0.422,ffff3958,0.482,ffff3958,0.542,ffff3958,0.584,ffff4189,0.627,ffff4189,0.681,ffc41c57,0.735,ffc41c57,0.795,ffff4246,0.855,ffff4246,0.928,ffc2275e,1,ffc2275e 0,ffffff88,0.5,ffffff88,1,ffffff88 0,fff1e767,0.5,fff7ce56,1,fffeb645 0,ffffd65e,0.5,fffeca31,1,fffebf04 0,fff6e6b4,0.5,fff1bb65,1,ffed9017 0,fff6f8f9,0.25,ffedf1f3,0.5,ffe5ebee,0.5,ffdee4e8,0.5,ffd7dee3,0.75,ffe6eaee,1,fff5f7f9 0,ffffffff,0.25,fff9f9f9,0.5,fff3f3f3,0.5,fff0f0f0,0.5,ffededed,0.75,fff6f6f6,1,ffffffff 0,ffffffff,0.25,fff8f8f8,0.5,fff1f1f1,0.5,ffe9e9e9,0.5,ffe1e1e1,0.75,ffebebeb,1,fff6f6f6 0,ffffffff,0.5,fff2f2f2,1,ffe5e5e5 0,ffffffff,0.473029,fff6f6f6,1,ffededed 0,ff499bea,0.5,ff348be7,1,ff207ce5 0,ffdeefff,0.5,ffbbd6ee,1,ff98bede 0,ffa7cfdf,0.5,ff6591b4,1,ff23538a 0,ffb2e1ff,0.5,ff8ccbfd,1,ff66b6fc 0,ff93cede,0.410788,ff6eb9ce,1,ff49a5bf 0,ffa9e4f7,0.5,ff5cccef,1,ff0fb4e7 0,ff63b6db,0.5,ff49a9d5,1,ff309dcf 0,ffe9f6fd,0.5,ffdef2fc,1,ffd3eefb 0,ffd6f9ff,0.5,ffbaf0fc,1,ff9ee8fa 0,fff7fbfc,0.40249,ffd2eaf0,1,ffadd9e4 0,ffc5deea,0.307054,ff65a5ca,1,ff066dab 0,ffaebcbf,0.25,ff8e9999,0.5,ff6e7774,0.5,ff3c423f,0.5,ff0a0e0a,0.75,ff0a0b09,1,ff0a0809 0,ff959595,0.460581,ff4b4b4b,0.502075,ff010101,0.502075,ff272727,0.763485,ff4e4e4e,0.763485,ff343434,1,ff1b1b1b 0,ff7d7e7d,0.5,ff454645,1,ff0e0e0e 0,ff45484d,0.5,ff222426,1,ff000000 0,fffcfff4,0.40249,ffd7ded0,1,ffb3bead 0,fffcfff4,0.5,fff2f4e1,1,ffe9e9ce 0,ffe0f3fa,0.25,ffdcf1fb,0.5,ffd8f0fc,0.5,ffc8e9f9,0.5,ffb8e2f6,0.75,ffb7e0f9,1,ffb6dffd 0,ffb7deed,0.25,ff94d6ee,0.5,ff71ceef,0.5,ff49c1e8,0.5,ff21b4e2,0.75,ff6cc9e7,1,ffb7deed 0,fff3c5bd,0.25,ffed988a,0.5,ffe86c57,0.5,ffe94a2d,0.5,ffea2803,0.625,fff44701,0.75,ffff6600,0.75,ffe34400,1,ffc72200 0,fff85032,0.25,fff45f47,0.5,fff16f5c,0.5,fff34c34,0.5,fff6290c,0.709544,ffee3019,1,ffe73827 0,ffcc0000,0.5,ffcc0000,1,ffcc0000 0,ffff1a00,0.5,ffff1a00,1,ffff1a00 0,ffff3019,0.5,ffe71a0e,1,ffcf0404 0,fff2825b,0.25,ffeb6e43,0.5,ffe55b2b,0.5,ffea6638,1,fff07146 0,fffebbbb,0.452282,fffe8b8b,1,ffff5c5c 0,ffebe9f9,0.25,ffe1dcf4,0.5,ffd8d0ef,0.5,ffd3cbed,0.5,ffcec7ec,0.75,ffc7c3eb,1,ffc1bfea 0,fffcecfc,0.25,fffbc9ee,0.5,fffba6e1,0.5,fffc97dc,0.5,fffd89d7,0.75,fffe82d7,1,ffff7cd8 0,ffff0084,0.5,ffff0084,1,ffff0084 0,ffe570e7,0.46888,ffc65cc5,1,ffa849a3 0,fffb83fa,0.5,fff25ff3,1,ffe93cec 0,ffff5db1,0.5,fff72f96,1,ffef017c 0,ffffb76b,0.25,ffffaf54,0.5,ffffa73d,0.5,ffff911e,0.5,ffff7c00,0.75,ffff7d02,1,ffff7f04 0,ffff7400,0.5,ffff7400,1,ffff7400 0,ffffa84c,0.5,ffff912c,1,ffff7b0d 0,fffceabb,0.25,fffcdb84,0.5,fffccd4d,0.5,fffac126,0.5,fff8b500,0.75,fff9ca49,1,fffbdf93 0,fff9c667,0.5,fff8ae44,1,fff79621 0,ffffc578,0.5,fffdb14d,1,fffb9d23 0,fffac695,0.46888,fff4a963,1,ffef8d31 0,ffffaf4b,0.5,ffffa02a,1,ffff920a 0,ff73880a,0.5,ff73880a,1,ff73880a 0,ff627d4d,0.5,ff405c2a,1,ff1f3b08 0,ffa4b357,0.5,ff8c9e31,1,ff75890c 0,ffe4efc0,0.5,ffc7d699,1,ffabbd73 0,fffefefd,0.423237,ffd6deb9,1,ffaebf76 0,ffd2ff52,0.5,ffb1f34a,1,ff91e842 0,ffc3d9ff,0.414938,ffadc4ec,1,ff98b0d9 0,fff9fcf7,0.5,fff7faf3,1,fff5f9f0 0,fff3e2c7,0.25,ffdac097,0.5,ffc19e67,0.5,ffbb9559,0.5,ffb68d4c,0.75,ffcfb07f,1,ffe9d4b3 0,ffd4e4ef,0.5,ffadc9dd,1,ff86aecc 0,ffe2e2e2,0.25,ffdedede,0.5,ffdbdbdb,0.5,ffd6d6d6,0.5,ffd1d1d1,0.75,ffe7e7e7,1,fffefefe 0,ffeeeeee,0.5,ffeeeeee,1,ffeeeeee 0,ffd2dfed,0.261411,ffc8d7eb,0.506224,ffbed0ea,0.506224,ffb2c8e6,0.506224,ffa6c0e3,0.6182570000000001,ffb0c8e9,0.7510370000000001,ffbad0ef,0.7510370000000001,ff99b5db,1,ff799bc8 0,ffcfe7fa,0.5,ff99bddd,1,ff6393c1 0,ffb8c6df,0.5,ff92a7cb,1,ff6d88b7 0,ffb5bdc8,0.360996,ff6e7881,1,ff28343b 0,ffd8e0de,0.224066,ffb8c7c4,0.333333,ff99afab,0.333333,ff8da6a1,0.666667,ff829d98,0.666667,ff485553,1,ff0e0e0e 0,fff2f5f6,0.365145,ffdde6e9,1,ffc8d7dc 0,ffb0d4e3,0.5,ff9cc7d9,1,ff88bacf 0,ff606c88,0.5,ff4f5c79,1,ff3f4c6b 0,ffcedce7,0.5,ff93a3ac,1,ff596a72 0,ffeeeeee,0.5,ffdddddd,1,ffcccccc 0,ffb4df5b,0.5,ffb4df5b,1,ffb4df5b 0,ffe6f0a3,0.25,ffdceb6d,0.5,ffd2e638,0.5,ffcadf2e,0.5,ffc3d825,0.75,ffcfe434,1,ffdbf043 0,ff9dd53a,0.25,ff9fd544,0.5,ffa1d54f,0.5,ff90cb33,0.5,ff80c217,0.75,ff7ebf10,1,ff7cbc0a 0,ffb6e026,0.5,ffb0de27,1,ffabdc28 0,ff6bba70,0.5,ff6bba70,1,ff6bba70 0,ff8fc800,0.5,ff8fc800,1,ff8fc800 0,ffb4e391,0.25,ff8ad355,0.5,ff61c419,0.5,ff8ad355,1,ffb4e391 0,ffa9db80,0.5,ff9fd077,1,ff96c56f 0,fff8ffe8,0.327801,ffd7ef8a,1,ffb7df2d 0,ffc9de96,0.439834,ff81b065,1,ff398235 0,ffcdeb8e,0.5,ffb9da72,1,ffa5c956 0,ffb4ddb4,0.166667,ff83c783,0.333333,ff52b152,0.333333,ff299d29,0.666667,ff008a00,0.666667,ff005700,1,ff002400 0,fff0b7a1,0.25,ffbe7558,0.5,ff8c3310,0.5,ff802a08,0.5,ff752201,0.75,ff9a4827,1,ffbf6e4e 0,ffd5cea6,0.39834,ffc6bd8b,1,ffb7ad70 0,ffb3dced,0.25,ff6ecae9,0.5,ff29b8e5,0.5,ff72cce9,1,ffbce0ee 0,ffd0e4f7,0.236515,ff6dade6,0.502075,ff0a77d5,0.502075,ff4899df,1,ff87bcea 0,ff3f4c6b,0.5,ff3f4c6b,1,ff3f4c6b 0,ffa7c7dc,0.5,ff96bcd7,1,ff85b2d3 0,ffcedbe9,0.166667,ff97bad8,0.502075,ff6199c7,0.502075,ff4d8ec5,0.502075,ff3a84c3,0.5892120000000001,ff429ed9,0.7095440000000001,ff4bb8f0,0.7095440000000001,ff3886bd,1,ff26558b 0,ffe4f5fc,0.25,ffd1eefa,0.5,ffbfe8f9,0.5,ffafe0f4,0.5,ff9fd8ef,0.75,ff64c4ee,1,ff2ab0ed 0,ffebf1f6,0.25,ffcbe2f2,0.5,ffabd3ee,0.5,ff9acbec,0.5,ff89c3eb,0.75,ffafd7f3,1,ffd5ebfb 0,ff6db3f2,0.25,ff60abf0,0.5,ff54a3ee,0.5,ff4599ef,0.5,ff3690f0,0.75,ff2a7ce7,1,ff1e69de 0,ff3b679e,0.25,ff3377bb,0.5,ff2b88d9,0.5,ff2582d1,0.5,ff207cca,0.75,ff4e9ad9,1,ff7db9e8 0,ff4096ee,0.5,ff4096ee,1,ff4096ee 0,fffeffff,0.352697,ffcfebf7,1,ffa0d8ef 0,fff0f9ff,0.46888,ffc8eaff,1,ffa1dbff 0,ff87e0fd,0.40249,ff46c5ee,1,ff05abe0 0,ff4c4c4c,0.124481,ff595959,0.253112,ff666666,0.253112,ff494949,0.502075,ff2c2c2c,0.502075,ff161616,0.502075,ff000000,0.6016600000000001,ff151515,0.7593360000000001,ff2b2b2b,0.7593360000000001,ff1f1f1f,1,ff131313 0,fff5f6f6,0.207469,ffd6d8de,0.487552,ffb8bac6,0.487552,ffd6d8de,1,fff5f6f6 0,ffb8e1fc,0.095436,ffa4cdf0,0.253112,ff90bae4,0.253112,ff90bcea,0.502075,ff90bff0,0.502075,ff7db3ea,0.502075,ff6ba8e5,0.8333330000000001,ff94cdf1,1,ffbdf3fd 0,ffefc5ca,0.25,ffe08892,0.5,ffd24b5a,0.5,ffc63948,0.5,ffba2737,0.75,ffd55a68,1,fff18e99 0,ffa90329,0.439834,ff8b0121,1,ff6d0019 0,ffe5e696,0.5,ffdbdc7b,1,ffd1d360 0,ffeaefb5,0.5,ffe5ecaa,1,ffe1e9a0 0,ff49c0f0,0.5,ff3ab7e9,1,ff2cafe3 0,ff258dc8,0.5,ff258dc8,1,ff258dc8 0,ffeab92d,0.5,ffd8a81e,1,ffc79810 0,ff7abcff,0.439834,ff5da9f6,1,ff4096ee 0,ffcb60b3,0.25,ffc653aa,0.5,ffc146a1,0.5,ffb4238c,0.5,ffa80077,0.75,ffc11b8d,1,ffdb36a4 0,fff2f9fe,0.5,ffe4f4fd,1,ffd6f0fd 0,ffbfd255,0.25,ffa6c53f,0.5,ff8eb92a,0.5,ff80b115,0.5,ff72aa00,0.75,ff88ba16,1,ff9ecb2d 0,fffeffe8,0.5,ffeaedd3,1,ffd6dbbf 0,fffefcea,0.5,fff7eb90,1,fff1da36 0,fff2f6f8,0.25,ffe5ebef,0.5,ffd8e1e7,0.5,ffc6d3db,0.5,ffb5c6d0,0.75,ffcadae4,1,ffe0eff9 0,ffcb60b3,0.25,ffbc399b,0.5,ffad1283,0.5,ffc52c97,1,ffde47ac 0,fffebf01,0.5,fffebf01,1,fffebf01 0,ffe1ffff,0.06639,ffe1ffff,0.120332,ffe1ffff,0.120332,ffefffff,0.120332,fffdffff,0.302905,ffe2f6fd,0.5435679999999999,ffc8eefb,0.5435679999999999,ffbce3f8,1,ffb1d8f5 0,fffeccb1,0.25,fff7a071,0.5,fff17432,0.5,ffed641c,0.5,ffea5507,0.75,fff27532,1,fffb955e 0,fffeffff,0.5,ffe8f5fc,1,ffd2ebf9 0,ff88bfe8,0.5,ff7cb7e4,1,ff70b0e0 0,ff00b7ea,0.5,ff00aad6,1,ff009ec3 0,ff8989ba,0.5,ff8989ba,1,ff8989ba 0,ff4c4c4c,0.125,ff666666,0.253,ff666666,0.386,ff2c2c2c,0.502,ff000000,0.602,ff2b2b2b,0.759,ff2b2b2b,0.913,ff131313,1,ff131313 0,fff0f9ff,0.469,ffa1dbff,1,ffa1dbff 0,ff7abcff,0.44,ff4096ee,1,ff4096ee 0,ff00b7ea,0.5,ff009ec3,1,ff009ec3 0,fffeffff,0.353,ffa0d8ef,1,ffa0d8ef 0,ffb8e1fc,0.095,ff90bae4,0.253,ff90bae4,0.373,ff90bff0,0.502,ff6ba8e5,0.833,ffbdf3fd,1,ffbdf3fd 0,ff3b679e,0.25,ff2b88d9,0.5,ff207cca,0.75,ff7db9e8,1,ff7db9e8 0,ff6db3f2,0.25,ff54a3ee,0.5,ff3690f0,0.75,ff1e69de,1,ff1e69de 0,ffebf1f6,0.25,ffabd3ee,0.5,ff89c3eb,0.75,ffd5ebfb,1,ffd5ebfb 0,ffe4f5fc,0.25,ffbfe8f9,0.5,ff9fd8ef,0.75,ff2ab0ed,1,ff2ab0ed 0,ffd0e4f7,0.237,ff0a77d5,0.502,ff0a77d5,0.793,ff87bcea,1,ff87bcea 0,ffb3dced,0.25,ff29b8e5,0.5,ff29b8e5,0.75,ffbce0ee,1,ffbce0ee 0,ffb4ddb4,0.167,ff52b152,0.333,ff52b152,0.5,ff008a00,0.667,ff008a00,0.833,ff002400,1,ff002400 0,ffcdeb8e,0.5,ffa5c956,1,ffa5c956 0,ffc9de96,0.44,ff398235,1,ff398235 0,fff8ffe8,0.328,ffb7df2d,1,ffb7df2d 0,ffa9db80,0.5,ff96c56f,1,ff96c56f 0,ffb4e391,0.25,ff61c419,0.5,ff61c419,0.75,ffb4e391,1,ffb4e391 0,ff299a0b,0.5,ff299a0b,1,ff299a0b 0,ff006e2e,0.5,ff006e2e,1,ff006e2e 0,ffcdeb8b,0.5,ffcdeb8b,1,ffcdeb8b 0,ff8fc400,0.5,ff8fc400,1,ff8fc400 0,ffb6e026,0.5,ffabdc28,1,ffabdc28 0,ff9dd53a,0.25,ffa1d54f,0.5,ff80c217,0.75,ff7cbc0a,1,ff7cbc0a 0,ffe6f0a3,0.25,ffd2e638,0.5,ffc3d825,0.75,ffdbf043,1,ffdbf043 0,ffbfd255,0.25,ff8eb92a,0.5,ff72aa00,0.75,ff9ecb2d,1,ff9ecb2d 0,ffeeeeee,0.5,ffcccccc,1,ffcccccc 0,ffcedce7,0.5,ff596a72,1,ff596a72 0,ff606c88,0.5,ff3f4c6b,1,ff3f4c6b 0,ffb0d4e3,0.5,ff88bacf,1,ff88bacf 0,fff2f5f6,0.365,ffc8d7dc,1,ffc8d7dc 0,ffb8c6df,0.5,ff6d88b7,1,ff6d88b7 0,ffd2dfed,0.261,ffbed0ea,0.506,ffa6c0e3,0.618,ffbad0ef,0.751,ffbad0ef,0.876,ff799bc8,1,ff799bc8 0,ffe2e2e2,0.25,ffdbdbdb,0.5,ffd1d1d1,0.75,fffefefe,1,fffefefe 0,fff2f6f8,0.25,ffd8e1e7,0.5,ffb5c6d0,0.75,ffe0eff9,1,ffe0eff9 0,ffd4e4ef,0.5,ff86aecc,1,ff86aecc 0,fffefefd,0.423,ffaebf76,1,ffaebf76 0,ffe4efc0,0.5,ffabbd73,1,ffabbd73 0,ffa4b357,0.5,ff75890c,1,ff75890c 0,ff627d4d,0.5,ff1f3b08,1,ff1f3b08 0,ffffaf4b,0.5,ffff920a,1,ffff920a 0,fffac695,0.469,ffef8d31,1,ffef8d31 0,ffffc578,0.5,fffb9d23,1,fffb9d23 0,fff9c667,0.5,fff79621,1,fff79621 0,fffceabb,0.25,fffccd4d,0.5,fff8b500,0.75,fffbdf93,1,fffbdf93 0,ffff670f,0.5,ffff670f,1,ffff670f 0,ffff5db1,0.5,ffef017c,1,ffef017c 0,fffb83fa,0.5,ffe93cec,1,ffe93cec 0,ffe570e7,0.469,ffa849a3,1,ffa849a3 0,ffcb60b3,0.25,ffad1283,0.5,ffad1283,0.75,ffde47ac,1,ffde47ac 0,fffcecfc,0.25,fffba6e1,0.5,fffd89d7,0.75,ffff7cd8,1,ffff7cd8 0,ffebe9f9,0.25,ffd8d0ef,0.5,ffcec7ec,0.75,ffc1bfea,1,ffc1bfea 0,fffebbbb,0.452,ffff5c5c,1,ffff5c5c 0,fff2825b,0.25,ffe55b2b,0.5,ffe55b2b,0.75,fff07146,1,fff07146 0,fff85032,0.25,fff16f5c,0.5,fff6290c,0.71,ffe73827,1,ffe73827 0,fffeccb1,0.25,fff17432,0.5,ffea5507,0.75,fffb955e,1,fffb955e 0,ffefc5ca,0.25,ffd24b5a,0.5,ffba2737,0.75,fff18e99,1,fff18e99 0,fffeffe8,0.5,ffd6dbbf,1,ffd6dbbf 0,fffcfff4,0.403,ffb3bead,1,ffb3bead 0,ffe5e696,0.5,ffd1d360,1,ffd1d360 0,ff45484d,0.5,ff000000,1,ff000000 0,ff7d7e7d,0.5,ff0e0e0e,1,ff0e0e0e 0,ff959595,0.461,ff010101,0.502,ff010101,0.531,ff4e4e4e,0.764,ff4e4e4e,0.867,ff1b1b1b,1,ff1b1b1b 0,ffaebcbf,0.25,ff6e7774,0.5,ff0a0e0a,0.75,ff0a0809,1,ff0a0809 0,ffc5deea,0.307,ff066dab,1,ff066dab 0,fff7fbfc,0.403,ffadd9e4,1,ffadd9e4 0,ffd6f9ff,0.5,ff9ee8fa,1,ff9ee8fa 0,ffe9f6fd,0.5,ffd3eefb,1,ffd3eefb 0,ff63b6db,0.5,ff309dcf,1,ff309dcf 0,ff2c539e,0.5,ff2c539e,1,ff2c539e 0,ffa9e4f7,0.5,ff0fb4e7,1,ff0fb4e7 0,ff93cede,0.411,ff49a5bf,1,ff49a5bf 0,ffb2e1ff,0.5,ff66b6fc,1,ff66b6fc 0,ffa7cfdf,0.5,ff23538a,1,ff23538a 0,ff4f85bb,0.5,ff4f85bb,1,ff4f85bb 0,ffdeefff,0.5,ff98bede,1,ff98bede 0,fffeffff,0.5,ffd2ebf9,1,ffd2ebf9 0,ff356aa0,0.5,ff356aa0,1,ff356aa0 0,ffffffff,0.25,fff1f1f1,0.5,ffe1e1e1,0.75,fff6f6f6,1,fff6f6f6 0,fff6e6b4,0.5,ffed9017,1,ffed9017 0,ffeab92d,0.5,ffc79810,1,ffc79810 0,ffffd65e,0.5,fffebf04,1,fffebf04".split(" ");
  a.style.defaultPatterns = "pattern/HybridGenesis/0-original.png pattern/HybridGenesis/1-original.png pattern/HybridGenesis/10-original.png pattern/HybridGenesis/11-original.png pattern/HybridGenesis/12-original.png pattern/HybridGenesis/13-original.png pattern/HybridGenesis/14-original.png pattern/HybridGenesis/15-original.png pattern/HybridGenesis/16-original.png pattern/HybridGenesis/17-original.png pattern/HybridGenesis/18-original.png pattern/HybridGenesis/19-original.png pattern/HybridGenesis/2-original.png pattern/HybridGenesis/20-original.png pattern/HybridGenesis/21-original.png pattern/HybridGenesis/22-original.png pattern/HybridGenesis/23-original.png pattern/HybridGenesis/24-original.png pattern/HybridGenesis/25-original.png pattern/HybridGenesis/26-original.png pattern/HybridGenesis/27-original.png pattern/HybridGenesis/28-original.png pattern/HybridGenesis/29-original.png pattern/HybridGenesis/3-original.png pattern/HybridGenesis/30-original.png pattern/HybridGenesis/31-original.png pattern/HybridGenesis/32-original.png pattern/HybridGenesis/33-original.png pattern/HybridGenesis/34-original.png pattern/HybridGenesis/35-original.png pattern/HybridGenesis/36-original.png pattern/HybridGenesis/37-original.png pattern/HybridGenesis/38-original.png pattern/HybridGenesis/39-original.png pattern/HybridGenesis/4-original.png pattern/HybridGenesis/40-original.png pattern/HybridGenesis/41-original.png pattern/HybridGenesis/42-original.png pattern/HybridGenesis/43-original.png pattern/HybridGenesis/44-original.png pattern/HybridGenesis/45-original.png pattern/HybridGenesis/46-original.png pattern/HybridGenesis/47-original.png pattern/HybridGenesis/48-original.png pattern/HybridGenesis/49-original.png pattern/HybridGenesis/5-original.png pattern/HybridGenesis/50-original.png pattern/HybridGenesis/51-original.png pattern/HybridGenesis/52-original.png pattern/HybridGenesis/53-original.png pattern/HybridGenesis/54-original.png pattern/HybridGenesis/55-original.png pattern/HybridGenesis/56-original.png pattern/HybridGenesis/57-original.png pattern/HybridGenesis/58-original.png pattern/HybridGenesis/59-original.png pattern/HybridGenesis/6-original.png pattern/HybridGenesis/60-original.png pattern/HybridGenesis/61-original.png pattern/HybridGenesis/62-original.png pattern/HybridGenesis/63-original.png pattern/HybridGenesis/64-original.png pattern/HybridGenesis/65-original.png pattern/HybridGenesis/66-original.png pattern/HybridGenesis/67-original.png pattern/HybridGenesis/68-original.png pattern/HybridGenesis/69-original.png pattern/HybridGenesis/7-original.png pattern/HybridGenesis/70-original.png pattern/HybridGenesis/71-original.png pattern/HybridGenesis/72-original.png pattern/HybridGenesis/73-original.png pattern/HybridGenesis/74-original.png pattern/HybridGenesis/75-original.png pattern/HybridGenesis/76-original.png pattern/HybridGenesis/77-original.png pattern/HybridGenesis/78-original.png pattern/HybridGenesis/79-original.png pattern/HybridGenesis/8-original.png pattern/HybridGenesis/80-original.png pattern/HybridGenesis/81-original.png pattern/HybridGenesis/82-original.png pattern/HybridGenesis/83-original.png pattern/HybridGenesis/84-original.png pattern/HybridGenesis/85-original.png pattern/HybridGenesis/86-original.png pattern/HybridGenesis/87-original.png pattern/HybridGenesis/88-original.png pattern/HybridGenesis/89-original.png pattern/HybridGenesis/9-original.png pattern/HybridGenesis/90-original.png pattern/HybridGenesis/91-original.png pattern/HybridGenesis/92-original.png pattern/HybridGenesis/93-original.png pattern/HybridGenesis/94-original.png pattern/HybridGenesis/95-original.png pattern/HybridGenesis/96-original.png pattern/HybridGenesis/97-original.png pattern/Squidfingers/0-original.png pattern/Squidfingers/1-original.png pattern/Squidfingers/10-original.png pattern/Squidfingers/100-original.png pattern/Squidfingers/101-original.png pattern/Squidfingers/102-original.png pattern/Squidfingers/103-original.png pattern/Squidfingers/104-original.png pattern/Squidfingers/105-original.png pattern/Squidfingers/106-original.png pattern/Squidfingers/107-original.png pattern/Squidfingers/108-original.png pattern/Squidfingers/109-original.png pattern/Squidfingers/11-original.png pattern/Squidfingers/110-original.png pattern/Squidfingers/111-original.png pattern/Squidfingers/112-original.png pattern/Squidfingers/113-original.png pattern/Squidfingers/114-original.png pattern/Squidfingers/115-original.png pattern/Squidfingers/116-original.png pattern/Squidfingers/117-original.png pattern/Squidfingers/118-original.png pattern/Squidfingers/119-original.png pattern/Squidfingers/12-original.png pattern/Squidfingers/120-original.png pattern/Squidfingers/121-original.png pattern/Squidfingers/122-original.png pattern/Squidfingers/123-original.png pattern/Squidfingers/124-original.png pattern/Squidfingers/125-original.png pattern/Squidfingers/126-original.png pattern/Squidfingers/127-original.png pattern/Squidfingers/128-original.png pattern/Squidfingers/129-original.png pattern/Squidfingers/13-original.png pattern/Squidfingers/130-original.png pattern/Squidfingers/131-original.png pattern/Squidfingers/132-original.png pattern/Squidfingers/133-original.png pattern/Squidfingers/134-original.png pattern/Squidfingers/135-original.png pattern/Squidfingers/136-original.png pattern/Squidfingers/137-original.png pattern/Squidfingers/138-original.png pattern/Squidfingers/139-original.png pattern/Squidfingers/14-original.png pattern/Squidfingers/140-original.png pattern/Squidfingers/141-original.png pattern/Squidfingers/142-original.png pattern/Squidfingers/143-original.png pattern/Squidfingers/144-original.png pattern/Squidfingers/145-original.png pattern/Squidfingers/146-original.png pattern/Squidfingers/147-original.png pattern/Squidfingers/148-original.png pattern/Squidfingers/149-original.png pattern/Squidfingers/15-original.png pattern/Squidfingers/150-original.png pattern/Squidfingers/151-original.png pattern/Squidfingers/152-original.png pattern/Squidfingers/153-original.png pattern/Squidfingers/154-original.png pattern/Squidfingers/155-original.png pattern/Squidfingers/156-original.png pattern/Squidfingers/157-original.png pattern/Squidfingers/158-original.png pattern/Squidfingers/159-original.png pattern/Squidfingers/16-original.png pattern/Squidfingers/17-original.png pattern/Squidfingers/18-original.png pattern/Squidfingers/19-original.png pattern/Squidfingers/2-original.png pattern/Squidfingers/20-original.png pattern/Squidfingers/21-original.png pattern/Squidfingers/22-original.png pattern/Squidfingers/23-original.png pattern/Squidfingers/24-original.png pattern/Squidfingers/25-original.png pattern/Squidfingers/26-original.png pattern/Squidfingers/27-original.png pattern/Squidfingers/28-original.png pattern/Squidfingers/29-original.png pattern/Squidfingers/3-original.png pattern/Squidfingers/30-original.png pattern/Squidfingers/31-original.png pattern/Squidfingers/32-original.png pattern/Squidfingers/33-original.png pattern/Squidfingers/34-original.png pattern/Squidfingers/35-original.png pattern/Squidfingers/36-original.png pattern/Squidfingers/37-original.png pattern/Squidfingers/38-original.png pattern/Squidfingers/39-original.png pattern/Squidfingers/4-original.png pattern/Squidfingers/40-original.png pattern/Squidfingers/41-original.png pattern/Squidfingers/42-original.png pattern/Squidfingers/43-original.png pattern/Squidfingers/44-original.png pattern/Squidfingers/45-original.png pattern/Squidfingers/46-original.png pattern/Squidfingers/47-original.png pattern/Squidfingers/48-original.png pattern/Squidfingers/49-original.png pattern/Squidfingers/5-original.png pattern/Squidfingers/50-original.png pattern/Squidfingers/51-original.png pattern/Squidfingers/52-original.png pattern/Squidfingers/53-original.png pattern/Squidfingers/54-original.png pattern/Squidfingers/55-original.png pattern/Squidfingers/56-original.png pattern/Squidfingers/57-original.png pattern/Squidfingers/58-original.png pattern/Squidfingers/59-original.png pattern/Squidfingers/6-original.png pattern/Squidfingers/60-original.png pattern/Squidfingers/61-original.png pattern/Squidfingers/62-original.png pattern/Squidfingers/63-original.png pattern/Squidfingers/64-original.png pattern/Squidfingers/65-original.png pattern/Squidfingers/66-original.png pattern/Squidfingers/67-original.png pattern/Squidfingers/68-original.png pattern/Squidfingers/69-original.png pattern/Squidfingers/7-original.png pattern/Squidfingers/70-original.png pattern/Squidfingers/71-original.png pattern/Squidfingers/72-original.png pattern/Squidfingers/73-original.png pattern/Squidfingers/74-original.png pattern/Squidfingers/75-original.png pattern/Squidfingers/76-original.png pattern/Squidfingers/77-original.png pattern/Squidfingers/78-original.png pattern/Squidfingers/79-original.png pattern/Squidfingers/8-original.png pattern/Squidfingers/80-original.png pattern/Squidfingers/81-original.png pattern/Squidfingers/82-original.png pattern/Squidfingers/83-original.png pattern/Squidfingers/84-original.png pattern/Squidfingers/85-original.png pattern/Squidfingers/86-original.png pattern/Squidfingers/87-original.png pattern/Squidfingers/88-original.png pattern/Squidfingers/89-original.png pattern/Squidfingers/9-original.png pattern/Squidfingers/90-original.png pattern/Squidfingers/91-original.png pattern/Squidfingers/92-original.png pattern/Squidfingers/93-original.png pattern/Squidfingers/94-original.png pattern/Squidfingers/95-original.png pattern/Squidfingers/96-original.png pattern/Squidfingers/97-original.png pattern/Squidfingers/98-original.png pattern/Squidfingers/99-original.png".split(" ");
  a.style.add = function(g, c, f) {
    "string" === typeof g && (g = [g]);
    var b = a.style[c + "Hash"],
      h = a.style[c + "Official"];
    c = a.style[c];
    if (g && g.length)
      for (var d = 0; d < g.length; d++) {
        var e = g[d];
        if (e) {
          var m = e.dna || e;
          0 === m.indexOf("pattern/") && (m = a.loc.MEDIA + m);
          var k = a.style.hashDNA(m);
          b[k] || (e.dna && (h[k] = !0), b[k] = !0, f ? c.unshift(m) : c.push(m))
        }
      }
  };
  a.style.addFromBlob = function(g, c) {
    a.convert.blobToText(g, function(f) {
      0 === f.indexOf("GIMP Gradient") ? a.style.add(Color.open.GGR(f).join(","), "gradient", !0) : 0 === f.indexOf("GIMP Palette") ?
        a.style.add(Color.open.GPL(f), "color", !0) : a.feature.debug && console.log("un-handled method", g);
      c && c()
    })
  };
  a.style.loadDefault = function() {
    !a.style.color && a.style.defaultColors && (a.style.reset("color"), a.style.add(a.style.defaultColors, "color"));
    !a.style.gradient && a.style.defaultGradients && (a.style.reset("gradient"), a.style.add(a.style.defaultGradients, "gradient"));
    !a.style.pattern && a.style.defaultPatterns && (a.style.reset("pattern"), a.style.add(a.style.defaultPatterns, "pattern"))
  };
  a.style.reset = function(g) {
    g ?
      (a.style[g + "Official"] = {}, a.style[g + "Hash"] = {}, a.style[g] = [], "pattern" === g && (a.style.patternCtx = {})) : (a.style.gradientOfficial = {}, a.style.gradientHash = {}, a.style.gradient = [], a.style.colorOfficial = {}, a.style.colorHash = {}, a.style.color = [], a.style.patternCtx = {}, a.style.patternOfficial = {}, a.style.patternHash = {}, a.style.pattern = [])
  };
  a.style.hashDNA = function(a) {
    if (a && a.toLowerCase) return a = a.toLowerCase().split("#").join(""), a = Math.abs(sketch.util.createHash(a)).toString(16).substr(0, 6), STRING.rpad(a, "0",
      6)
  };
  a.style.generateColorBlock = function() {
    var a = {
        Cyan: [12, 6, 9.7],
        Azure: [33, 6.9, 9.2],
        Indigo: [62, 9, 8.6],
        Purple: [92, 6, 9],
        Pink: [150, 8, 9],
        Red: [180, 10, 9],
        Orange: [196, 7.7, 9.7],
        Orange3: [224, 6.2, 10],
        Yellow: [234, 4.7, 11],
        Green: [261, 11, 9.5]
      },
      c = 0,
      f;
    for (f in a) c++;
    for (var b = 0, h, d = [], e = 1; 8 >= e; e++)
      for (f in a) {
        if (1 === e) h = sketch.color.space.HSL_RGB({
          H: 0,
          S: 0,
          L: 100 - 100 * (b / (c - 1))
        }), b++;
        else {
          n = e - 1;
          h = a[f];
          var m = Math.min(1, n / h[1]),
            k = Math.min(1, 1 - n / h[2]);
          h = sketch.color.space.HSI_RGB({
            H: (h[0] + 180) % 360,
            S: 150 * m,
            I: 250 * k
          })
        }
        d.push(sketch.color.space(h,
          "RGB>HEX24>W3"))
      }
    return d
  }
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.StylePalette);
"undefined" === typeof sketch && (sketch = {});
sketch.color = sketch.color || {};
sketch.color.gradient = sketch.color.gradient || {};
(function(a) {
  a.color.gradient.getColors = function(g) {
    var c = a.color.space,
      f = new a.util.Random(g.seed || 1),
      b = g.dna,
      h = g.resolution,
      d = g.length,
      e = !1,
      m = g.blend || "Normal",
      k;
    a.color.blend ? (e = a.color.blend.isAlphaRequired[m], k = a.color.blend[m]) : k = function(a, b) {
      return a * b / 255
    };
    var l = g.H || 0,
      r = g.S || 0;
    g = g.L || 0;
    if (b) {
      "string" === typeof b && (b = b.split(","));
      for (var p = [], q = 0; q < b.length; q += 2) p.push({
        hex: b[q + 1],
        stop: parseFloat(b[q], 10)
      });
      var b = 0,
        t = p[b].hex,
        q = "string" === typeof t ? "W3>HEX32>RGBA" : "HEX32>RGBA",
        t = c(t, q),
        s =
        p[b].stop,
        w = p[b + 1];
      if (!w) return p;
      for (var v = c(w.hex, q), w = p[b + 1].stop, u = [], y = 0; y <= d; y += h) {
        var x;
        x = y / d;
        x > w && (b++, p[b] && (t = v, s = w, p[b + 1] && (v = c(p[b + 1].hex, q), w = p[b + 1].stop)));
        x = (x - s) / (w - s);
        Infinity === x && (x = 0);
        if ("Normal" === m && 0 === l && 0 === r && 0 === g) x = c.RGB_W3({
          R: t.R * (1 - x) + v.R * x,
          G: t.G * (1 - x) + v.G * x,
          B: t.B * (1 - x) + v.B * x
        });
        else {
          var z = c.RGB_HSL({
            R: t.R * (1 - x) + v.R * x,
            G: t.G * (1 - x) + v.G * x,
            B: t.B * (1 - x) + v.B * x
          });
          x = c.HSLA_RGBA({
            H: (z.H + f.toDouble() * l + 360) % 360,
            S: Math.min(100, Math.max(0, z.S - f.toDouble() * r)),
            L: Math.min(100, Math.max(0,
              z.L - f.toDouble() * g)),
            A: 255
          });
          z = c.HSLA_RGBA({
            H: (z.H + f.toDouble() * l + 360) % 360,
            S: Math.min(100, Math.max(0, z.S + f.toDouble() * r)),
            L: Math.min(100, Math.max(0, z.L + f.toDouble() * g)),
            A: 255
          });
          e ? (x = k(x, z), x = c(x, "HEX32>RGBA>W3")) : x = c.RGBA_W3({
            R: k(x.R, z.R),
            G: k(x.G, z.G),
            B: k(x.B, z.B),
            A: k(x.A, z.A)
          })
        }
        u.push(y / d);
        u.push(x)
      }
      return u
    }
  }
})(sketch);
RegExp.create = function(a, g, c) {
  for (var f in g) {
    var b = g[f],
      h = RegExp("{{" + f + "}}", "gi");
    b.source && (b = b.source.replace(/^\^|\$$/g, ""));
    a = a.replace(RegExp("\\(" + h.source + "\\)", "gi"), "(" + b + ")");
    a = a.replace(h, "(?:" + b + ")")
  }
  return RegExp(a, c)
};
(function() {
  var a = window.LinearGradient = function(a) {
    this.direction = a.direction;
    this.stops = a.stops;
    this.fromString = a.fromString
  };
  a.parse = function(g) {
    if (!g) return null;
    var c = g.match(a.regex.linearGradient);
    if (!c) return null;
    var f = c[1] || "top";
    stops = c[2].match(a.regex.colorStop);
    c = parseFloat(f);
    if (!isNaN(c)) switch ((c % 360 + 360) % 360) {
      case 0:
        f = "left";
        break;
      case 90:
        f = "bottom";
        break;
      case 180:
        f = "right";
        break;
      case 240:
        f = "top"
    }
    for (c = 0; c < stops.length; c++) {
      var b = stops[c],
        h = b.match(a.regex.color)[0],
        b = (b = b.substr(h.length).match(a.regex.length)) &&
        b[0];
      stops[c] = {
        color: h,
        position: b
      }
    }
    return new LinearGradient({
      direction: f,
      stops: stops,
      fromString: g
    })
  };
  a.regex = {};
  a.regex.number = /^-?[0-9]*\.?[0-9]+$/;
  a.regex.keyword = /^(?:top\s+|bottom\s+)?(?:right|left)|(?:right\s+|left\s+)?(?:top|bottom)$/;
  a.regex.direction = RegExp.create("^(?:{{keyword}}|{{number}}deg|0)$", {
    keyword: a.regex.keyword,
    number: a.regex.number
  });
  a.regex.color = RegExp.create("(?:{{keyword}}|{{func}}|{{hex}})", {
    keyword: /^(?:red|tan|grey|gray|lime|navy|blue|teal|aqua|cyan|gold|peru|pink|plum|snow|[a-z]{5,20})$/,
    func: RegExp.create("^(?:rgb|hsl)a?\\((?:\\s*{{number}}%?\\s*,?\\s*){3,4}\\)$", {
      number: a.regex.number
    }),
    hex: /^#(?:[0-9a-f]{1,2}){3}$/i
  }, "i");
  a.regex.percentage = RegExp.create("^(?:{{number}}%|0)$", {
    number: a.regex.number
  });
  a.regex.length = RegExp.create("{{number}}{{unit}}|0", {
    number: a.regex.number,
    unit: /%|px|mm|cm|in|em|rem|en|ex|ch|vm|vw|vh/
  });
  a.regex.colorStop = RegExp.create("{{color}}\\s*{{length}}?", {
    color: a.regex.color,
    length: a.regex.length
  }, "gi");
  a.regex.linearGradient = RegExp.create("^linear-gradient\\(\\s*(?:({{direction}})\\s*,)?\\s*({{colorstop}}\\s*(?:,\\s*{{colorstop}}\\s*)+)\\)$", {
    direction: a.regex.direction,
    colorStop: a.regex.colorStop
  }, "i")
})();
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.detect = function(g, c) {
    var f = a.detect[g];
    return f && f[c] || !1
  };
  a.detect.add = function(g, c) {
    var f = a.detect[g] || (a.detect[g] = {});
    if ("string" === typeof c) f[c] = !0;
    else
      for (; c.length;) f[c.pop()] = !0
  };
  a.detect.add("brush", []);
  a.detect.add("shape", []);
  a.detect.add("media", []);
  a.detect.add("refreshPixelData", ["floodfill"]);
  a.detect.add("area", "select svg clipart media image text".split(" "));
  a.detect.add("mediaKit", ["clipart", "image", "symbol"]);
  a.detect.add("shapeConstrain", "triangle circle square roundSquare imperfectSquare imperfectCircle regularPolygon gear star burst radialBurst spiral wedge supershape".split(" "));
  a.detect.add("noConfigure", ["move", "vectorfill"]);
  a.detect.add("useLocalAlpha", "oil pastel stamp crayon chrome fur hair shader sketchy web spirograph spraypaint".split(" "));
  a.detect.add("generativeColor", "spraypaint calligraphy crayon streamer chrome fur hair shader sketchy web spirograph".split(" "));
  a.detect.add("useOffsetCache", "calligraphy pencil arrow fur chrome hair shader sketchy web".split(" "));
  a.detect.add("useTrackGradient", ["arrow", "calligraphy", "paintbrush", "pencil"]);
  a.detect.add("useAutoClear", ["arrow", "eraser", "paintbrush", "pencil"]);
  a.detect.add("useCleanVector", ["polygon", "polyline", "path"]);
  a.detect.add("catmullRomSpline", ["eraser", "paintbrush", "pencil"]);
  a.detect.add("stampResource", ["crayon", "stamp", "spraypaint"]);
  a.detect.add("srcRequired", ["stamp", "spraypaint", "image", "clipart"])
})(sketch);
"undefined" !== typeof module && module.exports && (module.exports = sketch.detect);
"undefined" === typeof sketch && (sketch = {});
sketch.setup = sketch.setup || {};
sketch.toolkit = sketch.toolkit || {};
sketch.toolkit.__init = sketch.toolkit.__init || {};
sketch.toolkit.__icons = sketch.toolkit.__icons || {};
sketch.configure = sketch.configure || {};
sketch.configure.tools = sketch.configure.tools || {};
(function(a) {
  a.toolkit.register = function(c, b) {
    if ("object" === typeof c && c.length)
      for (; c.length;) a.toolkit.register(c.shift(), b);
    else a.toolkit.__init[c] || (a.toolkit.__init[c] = b), a.configure.tools[c] || (a.configure.tools[c] = {
      toolkit: c,
      type: c
    })
  };
  a.toolkit.init = function(c) {
    c.rendering = !1;
    c.device = {};
    c.deviceProxy = {};
    c.deviceLastRecord = null;
    c.deviceLastRecordId = null;
    c.gestures = 0;
    c.interval = 0;
    c.timeSent = null;
    c.setColor = function(b) {
      a.style.apply.call(c, "color", b)
    };
    c.setGradient = function(b) {
      a.style.apply.call(c,
        "gradient", b)
    };
    c.setStyle = function(b) {
      if (b.color || b.gradient) {
        var h = b.color ? "color" : "gradient";
        a.style.apply.call(c, h, b[h]);
        delete b.color;
        delete b.gradient
      }
      var h = c.device,
        d;
      for (d in b) {
        var e = typeof h[d],
          m = typeof b[d];
        "undefined" !== e && e === m && (h[d] = b[d])
      }
    };
    c.addObject = a.addObject;
    return c
  };
  a.setTool = function(c, b, h) {
    h = "select" === c;
    !1 === h && a.scene.deselectAll();
    a.ui.setToolMenu && c !== a.ui.buildConfigure.type && (a.ui.setToolMenu(c), a.ui.buildConfigure(c, !0));
    a.feature.vector.edit && (h && a.scene.setDirtyControl(),
      a.active.canvas.width = a.active.canvas.width, a.render.clean("root.exec('" + c + "');"));
    a.toolkit.setTool(c, b);
    a.setItem("tool.type", c)
  };
  a.toolkit.setTool = function(c, b) {
    c = c || a.tool.type;
    b = b || {};
    "function" === typeof b && (b = {
      callback: b
    });
    var h = a.configure.tools[c];
    if ("undefined" === typeof h) a.feature.debug && console.log("missing configure", arguments);
    else {
      var d = a.toolkit[h.toolkit];
      if ("undefined" === typeof d) a.feature.debug && console.log("missing toolkit", arguments);
      else {
        for (var e in b) h[e] = b[e];
        a.tool.reset &&
          a.tool.reset();
        a.tool.disable && a.tool.disable();
        e = a.tool.type;
        d.type = c;
        d.lastType = e || c;
        a[b.tid || "tool"] = d;
        a.feature.cursorCSS && a.ui.setCursor();
        a.feature.style.lockToGlobal && a.style && (a.style.fill && (h.fill = a.util.clone(a.style.fill)), a.style.stroke && (h.stroke = a.util.clone(a.style.stroke)), a.style.setBlendMode(null));
        a.render.dirtyControls = !0;
        e = function() {
          d.enable();
          a.on.setTool && a.on.setTool(c);
          b.callback && b.callback()
        };
        d.style ? (h.src && (d.style.src = h.src), d.style.type = h.type, d.loadResource({
          action: d.style,
          onload: e
        })) : d.changeDevice ? d.changeDevice(h, c, e) : e()
      }
    }
  };
  a.toolkit.getMouseId = function(c, b) {
    var h = "",
      d = "";
    c && (h = window.rtc && rtc._me && rtc._me.index, d = a.socket && a.socket.user && a.socket.user.id, h = (isFinite(h) ? h : d || 0) + ":");
    d = b.identifier;
    d = Infinity === d ? "A" : d;
    return h + ("Infinity" === d ? "A" : d)
  };
  a.toolkit.setDefaultConfigure = function(c) {
    var b = a.configure.tools[a.tool.type],
      h;
    for (h in c) {
      var d = c[h],
        e = b[h];
      "undefined" !== typeof e && ("number" === typeof d ? "undefined" !== typeof e.max ? (e.min = d, e.max = d) : e.value = d : (e.min =
        d.min, e.max = d.max))
    }
  };
  a.toolkit.setConfigure = function(c, b, h) {
    var d = c[b];
    if (!d) a.feature.debug && console.log("missing tool: " + b);
    else if ("eraser" !== c.type || "composite" !== b) {
      if ("string" === typeof d) c[b] = h;
      else if (c = d.format, b = "undefined" !== typeof d.max, "undefined" !== typeof d.min && b)
        if (h.length) {
          b = h[0] && isFinite(h[0].value) ? h[0].value : 0;
          var e = h[1] && isFinite(h[1].value) ? h[1].value : 0;
          1 === h.length ? d.min = d.max = g(c, b) : 2 === h.length && (d.min = g(c, b), d.max = g(c, e))
        } else d.min = g(c, h.min), d.max = g(c, h.max);
      else h.length ?
        (h = isFinite(h[0].value) ? h[0].value : 0, d.value = g(c, h)) : d.value = g(c, h.value);
      return d
    }
  };
  var g = function(a, b) {
      switch (a) {
        case "int":
          return Math.round(b);
        default:
          return b
      }
    },
    c = function(c, b, h) {
      c = glfx.filters[c];
      b = c.paramIndex[b];
      var d = a.video.shader2;
      if (d && d.activeFilter) {
        h = h.value;
        var e = d.activeFilter.data;
        switch (c.param[b].format.replace(")", "").split("(")[0]) {
          case "int":
            h = Math.round(h)
        }
        e[b] !== h && (d.activeFilter.data[b] = h, glfx.animationId || glfx.render());
        a.histogram && a.histogram.enabled && a.histogram.createAnalyze()
      }
    };
  a.toolkit.setActionData = a.toolkit.setParam = function(f, b) {
    var h = f;
    "string" === typeof f && (h = {
      tool: a.tool.type,
      param: f,
      data: b
    });
    var d = h.tool || "*",
      e = "*" === d;
    f = h.param;
    var m = h.selection || a.selection && a.selection.items,
      k = h.cacheObject || {},
      l = a.feature.tools.image.filter,
      r = !k.state || "start" === k.state,
      p = !k.state || "end" === k.state,
      q = a.configure.tools[d];
    if (h.thumbs && !e) {
      if (b = a.toolkit.setConfigure(q, f, h.thumbs), !b) return
    } else b = h.data, "object" === typeof b && b.length && (b = {
        min: b[0],
        max: b[1]
      }), "number" === typeof b &&
      (b = {
        value: b
      }), !e && q && a.toolkit.setConfigure(q, f, b);
    var q = [],
      g = [],
      s = e || a.detect.useLocalAlpha[d],
      h = 0;
    if (!e && 0 === d.indexOf("gl_")) return c(d.substr(3), f, b);
    if (a.scene && a.scene.data) {
      for (var w in m) {
        var v = a.scene.data[w];
        if (v) {
          m = v.type;
          if (!l && (m = "image" === v.type ? "clipart" : v.type, !e && m !== d)) continue;
          r && (k["data" + v.id] = a.util.clone(v[f]));
          v[f] = "undefined" !== typeof b.max ? a.util.clone(b) : isFinite(b.value) ? b.value : b;
          v.toolkit && (v.dirty = !0, v.toolkit.updateObjectSize(v));
          if (p) {
            var m = {
                id: v.id
              },
              u = {
                id: v.id
              };
            m[f] =
              k["data" + v.id];
            u[f] = v[f];
            q.push(m);
            g.push(u)
          }
          h++
        }
      }
      q.length && g.length && a.history && a.history.store({
        from: q,
        to: g,
        name: "Update Object Data"
      });
      p && "undefined" === typeof v && ((d = !e && a.toolkit.getToolkit(d)) && d.device && (d.device[f] = "undefined" !== typeof b.max ? a.util.clone(b) : b.value), a.toolkit.setTool(a.tool.type, {
        useLoader: !1
      }));
      a.feature.bruteForce ? (a.render.dirtyControls = !0, a.render("toolkit.setParam.realtime")) : (1 < h && (s = !0), window.clearTimeout(k.interval), k.interval = setTimeout(function() {
        if (!s || s && p) a.render.dirtyControls = !0, a.render("toolkit.setParam.end")
      }, 75))
    }
  };
  a.toolkit.setType = function(c, b) {
    b = b || a.selection.items;
    if (!a.feature.vector.edit) return a.exec(c);
    var h = a.util.count(b);
    if (0 === h) return a.exec(c.replace(" ", "_"));
    var d = [],
      e = [],
      m = a.scene.fromConfigure(a.configure.tools[c]),
      k = a.scene.copyAttributes,
      l;
    for (l in b) {
      var r = a.scene.data[l];
      if (r) {
        if (a.detect.shape[r.type]) {
          if (!a.detect.shape[c]) continue
        } else if (a.detect.brush[r.type]) {
          if (!a.detect.brush[c]) continue
        } else continue;
        var p = r.toolkit;
        p && (d.push(k(p._attributes,
          r, {
            id: r.id,
            type: r.type
          })), e.push(k(p._attributes, m, {
          id: r.id,
          type: c
        })), r.type = c, "undefined" === typeof m.spacing && delete r.spacing, delete r.diameter, delete m.fill, delete m.stroke, k(p.attributes, m, r), p.loadResource({
          action: r,
          onload: function() {
            r.dirty = !0;
            p.updateObjectSize(r);
            --h || (a.history && a.history.store({
              from: d,
              to: e,
              name: "Convert to " + STRING.ucwords(c)
            }), a.render.dirtyControls = !0, a.render("toolkit.setType"), a.ui.setToolMenu(c, !0), a.ui.buildConfigureOptions(c))
          }
        }))
      }
    }
  };
  a.toolkit.getDimensionConstraint =
    function(c, b, h) {
      var d = !1;
      c = c || a.scene.getOneSelected() || {};
      var e = a.feature[c.type] || a.feature.tools[c.type] || a.feature.tools,
        m = c.useMinWidth || e.minWidth,
        k = c.useMinHeight || e.minHeight,
        l = c.useMaxWidth || e.maxWidth,
        r = c.useMaxHeight || e.maxHeight;
      e.constrainToCanvas && (e = a.ctx.canvas, e = Math.min(e.height, e.width) / a.canvas2d.pixelRatio, r = Math.min(e, r), l = Math.min(e, l));
      c = c.bbox;
      var e = c.width,
        p = c.height;
      if (b) return b.x * c.width < m && (d = !0, b.x = m / c.width, b.y = b.x), b.y * c.height < k && (d = !0, b.y = k / c.height, b.x = b.y), b.x *
        c.width > l && (d = !0, b.x = l / c.width, b.y = b.x), b.y * c.height > r && (d = !0, b.y = r / c.height, b.x = b.y), {
          constrained: d,
          x: b.x,
          y: b.y
        };
      p < k && (p = k);
      p > r && (p = r);
      p !== c.height && h && (d = !0, e = p / c.height * c.width);
      e < m && (e = m);
      e > l && (e = l);
      e !== c.width && h && (d = !0, p = e / c.width * c.height);
      return {
        constrained: d,
        width: e,
        height: p
      }
    };
  a.toolkit.setup = function() {
    var c = a.configure.tools,
      b;
    for (b in c) {
      var h = c[b].toolkit,
        d = !a.util.exists("sketch.toolkit.__init." + h),
        e = void 0 !== a.toolkit[h];
      a.toolkit.__init[h + "." + b] ? a.detect.add(h, b) : a.vector.shape[b] ?
        a.detect.add(h, b) : -1 === b.indexOf(".") && ("media" === h && a.toolkit.media) && (0 === b.indexOf("gl_") ? window.glfx && a.detect.add(h, b) : a.detect.add(h, b));
      d || e || (a.detect.add(h, b), d = {}, e = a.canvas2d.layers, d.active = e.active, d.draw = e.draw, d.cache = e.cache, d.layer0 = e.layer0, d.type = h, a.detect.area[h] && (e = a.feature[h] || a.feature.tools[h] || a.feature.tools, d.minWidth = e.minWidth, d.minHeight = e.minHeight, d.maxWidth = e.maxWidth, d.maxHeight = e.maxHeight, d.defaultWidth = e.defaultWidth, d.defaultHeight = e.defaultHeight), d = new a.toolkit.__init[h](d),
        a.toolkit[h] = d, d.construct && d.construct())
    }
  };
  a.toolkit.loadResource = function(c, b) {
    var h = c.toolkit || a.toolkit.setToolkit(c.type);
    h && h.loadResource({
      action: c,
      onload: b
    })
  };
  a.toolkit.getToolkit = function(c) {
    if (a.detect.shape[c]) return a.toolkit.shape;
    if (a.detect.brush[c]) return a.toolkit.brush;
    if (a.detect.media[c]) return a.toolkit.media;
    if (a.toolkit[c]) return a.toolkit[c];
    console.log("missing toolkit:", c)
  };
  a.toolkit.setToolkit = function(c) {
    var b = a.toolkit.getToolkit(c.type);
    if (b) return c.toolkit = b
  };
  a.toolkit.exists =
    function(c) {
      return (c = a.configure.tools[c]) ? !!a.toolkit[c.toolkit] : !1
    };
  a.toolkit.getCenterPoint = function() {
    var c = a.canvas2d;
    return {
      x: c.width / 2 + a.project.scrollLeft - 1,
      y: c.height / 2 + a.project.scrollTop - 1
    }
  };
  a.toolkit.getToolCategory = function(c) {
    if (c) {
      c = c.replace("_", " ");
      var b = a.toolkit.__icons,
        h;
      for (h in b) {
        var d = b[h];
        if (d.children && (d.children.length && (d.children = a.util.array2object(d.children)), d.children[c])) return h
      }
    }
  };
  a.toolkit.getToolIcon = function(c) {
    c = a.toolkit.getToolCategory(c) || c;
    var b = a.toolkit.__icons,
      h;
    for (h in b)
      if (c === h) return c = b[h], c.src || c
  }
})(sketch);
(function(a) {
  a.toolkit.register("crop", function(g) {
    var c = this,
      f = 0,
      b = 0,
      h = 0,
      d = 0,
      e = 0,
      m = 0,
      k = null,
      l = null,
      r = null;
    this.type = "crop";
    this.active = g.active.ctx;
    this.cache = g.cache.ctx;
    this.ctx = g.layer0.ctx;
    this.params = {
      aspect: "portrait",
      constrain: !0,
      ratio: {
        width: 377,
        height: 197,
        units: "px",
        res: 72
      }
    };
    this.construct = function() {
      a.history.registerFunction({
        type: "crop",
        fn: function(b, d, e, f, h) {
          a.project.setData(e ? d[0] : d[1]);
          e ? (k = d[2], l = d[3], v(c.active, k, l, {
            state: "update"
          })) : c.unset()
        }
      });
      a.history.registerFunction({
        type: "crop-draw",
        fn: function(b, d, e, f, h) {
          b = e ? d[0] : d[1];
          k = b.start;
          l = b.end;
          a.project.setScroll(b.scrollLeft, b.scrollTop);
          a.orient.reset();
          a.orient.setZoom(b.zoom || 1);
          v(c.active, b.start, b.end, {
            state: "update"
          })
        }
      })
    };
    this.enable = function() {
      c.__mouse = eventjs.add({
        target: c.active.canvas,
        dbltap: c.onDblTap,
        drag: c.onDrag,
        mousemove: c.onCursor
      });
      c.__key = eventjs.add({
        target: window,
        keydown: a.keyboard.keydown,
        keyup: a.keyboard.keyup
      })
    };
    this.disable = function() {
      p(this.__mouse);
      p(this.__key);
      this.unset()
    };
    var p = function(a) {
      for (var b in a) {
        var d =
          a[b].remove;
        d && d()
      }
    };
    this.unset = function() {
      c.active.canvas.width = c.active.canvas.width;
      k = l = {
        x: 0,
        y: 0
      }
    };
    this.onDrag = function(b, d) {
      c.isMoving = !("up" === d.state || "update" === d.state);
      c.event = d;
      var e = a.util.clone(d.start);
      t(e, {
        x: d.x,
        y: d.y,
        state: d.state
      }, d.state, b)
    };
    this.onDblTap = function(a) {
      setTimeout(function() {
        c.apply()
      }, 0)
    };
    this.onCursor = function(a) {};
    this.onResize = function(b) {
      if (k && l) {
        var d = a.canvas2d.zoom;
        b = e - (a.canvas2d.x + a.project.x * d);
        d = m - (a.canvas2d.y + a.project.y * d);
        k.y -= d;
        k.x -= b;
        l.y -= d;
        l.x -= b;
        v(c.active, k, l, {
          state: "move"
        })
      }
    };
    this.onRenderControls = function(a) {
      k && l && (k.x === l.x && k.y === l.y || v(c.active, k, l, {
        state: "move"
      }))
    };
    this.onDownKey = this.onUpKey = this.onLeftKey = this.onRightKey = function(a) {
      var b = eventjs.shiftKey ? 10 : 1;
      switch (a.name) {
        case "down":
          q(0, 1 * b, a.state);
          break;
        case "up":
          q(0, -1 * b, a.state);
          break;
        case "left":
          q(-1 * b, 0, a.state);
          break;
        case "right":
          q(1 * b, 0, a.state)
      }
      return !0
    };
    this.onAKey = function(b) {
      if (eventjs.metaKey) {
        var d = a.canvas2d.zoom;
        b = a.canvas2d.x + a.project.x * d;
        d = a.canvas2d.y + a.project.y *
          d;
        c.rect(b, d, b + a.project.bounds.width, d + a.project.bounds.height);
        return !0
      }
    };
    this.onEnterKey = function(a) {
      if ("up" !== a.state) return !0;
      c.apply();
      return !0
    };
    this.onEscapeKey = function(a) {
      if ("up" !== a.state) return !0;
      c.rect(0, 0, 0, 0);
      return !0
    };
    this.update = function(a) {
      if (isFinite(k.x) && isFinite(l.x)) {
        var b = c.params;
        "boolean" === typeof a.constrain && b.constrain !== a.constrain && (b.constrain = a.constrain);
        "string" === typeof a.aspect && b.aspect !== a.aspect && (b.aspect = a.aspect);
        "object" === typeof a.ratio && b.ratio !== a.ratio &&
          (b.ratio = a.ratio);
        !0 === b.constrain && (c.updateAspectRatio(k, l), c.updateTransform(k, l));
        t(k, l, "update")
      }
    };
    this.apply = function(b, d, e, f) {
      isFinite(b) && isFinite(d) && c.rect(b, d, e, f);
      b = k;
      d = l;
      if (b && d && 0 !== b.x - d.x && 0 !== b.y - d.y) {
        e = a.project.getData();
        var h = a.canvas2d;
        f = h.zoom;
        var p = h.x,
          m = h.y,
          h = p + a.project.x * f,
          q = m + a.project.y * f,
          r = Math.max(b.x, d.x) / f,
          g = Math.max(b.y, d.y) / f,
          s = Math.min(b.x, d.x) / f,
          w = Math.min(b.y, d.y) / f,
          p = r - p - (s - p),
          m = g - m - (w - m);
        a.project.units = "px";
        a.project.x += s - h / f;
        a.project.y += w - q / f;
        a.orient.reset();
        a.project.setSize(p, m);
        a.orient.reset();
        a.orient.setZoom(e.zoom);
        a.history && (f = a.project.getData(), a.history.store({
          from: "crop",
          to: [e, f, b, d],
          name: "Apply Crop"
        }));
        c.unset()
      }
    };
    this.rect = function(a, b, d, c) {
      isFinite(a) && (this.__rect = {
        start: {
          x: a,
          y: b
        },
        x: a + d,
        y: b + c
      });
      this.__rect.state = "update";
      this.onDrag({}, this.__rect)
    };
    var q = function(a, b, d) {
        k && l && ("up" === d ? t(k, l, "update") : (k.x += a, k.y += b, l.x += a, l.y += b, t(k, l, d)))
      },
      t = function(e, p, m, q) {
        if (!e || !p) return w("");
        var s = a.active,
          g = "down" === m || "update" === m;
        m = "up" ===
          m || "update" === m;
        var t = e.x !== p.x || e.y !== p.y;
        !g && k && l || (k = k || {
          x: 0,
          y: 0
        }, l = l || {
          x: 0,
          y: 0
        });
        g && (self.__from = a.project.getData(), self.__from.start = a.util.clone(k), self.__from.end = a.util.clone(l));
        if (q) var u = a.project.scrollLeft,
          C = a.project.scrollTop;
        else C = u = 0;
        var E = a.canvas2d.zoom,
          H = a.project.bounds.width * E,
          J = a.project.bounds.height * E,
          I = a.canvas2d.x + a.project.x * E,
          L = a.canvas2d.y + a.project.y * E,
          O = I + H,
          P = L + J;
        e.x -= u * (1 - E);
        e.y -= C * (1 - E);
        p.x -= u * (1 - E);
        p.y -= C * (1 - E);
        var E = a.util.clone(p),
          N = l.x - k.x,
          Q = l.y - k.y;
        g && (a.tool.coord =
          a.util.clone(p), f = p.x - k.x, b = p.y - k.y, h = u, d = C, s.beginPath(), s.rect(k.x, k.y, N, Q), r = s.isPointInPath(E.x, E.y) ? "move" : "crop");
        u -= h;
        C -= d;
        "move" !== r && (N += u, Q += C);
        w(r);
        switch (r) {
          case "north":
            e.x = k.x;
            e.y = l.y;
            p.x = l.x;
            p.y -= b;
            e.y < p.y && (k.y = l.y, b = f = 0, w("south"));
            break;
          case "north-east":
            e.x = k.x;
            e.y = l.y;
            p.x = p.x - f + N;
            p.y -= b;
            e.y < p.y ? (k.y = l.y, l.x -= N, b = f = 0, w("south-east")) : e.x > p.x && (l.x = k.x, b = f = 0, w("north-west"));
            break;
          case "east":
            e.x = k.x;
            e.y = k.y;
            p.x = Math.min(O, p.x - f + N);
            p.y = l.y;
            e.x > p.x && (l.x = k.x, b = f = 0, w("west"));
            break;
          case "south-east":
            e.x = k.x;
            e.y = k.y;
            p.x = Math.min(O, p.x - f + N);
            p.y = Math.min(P, p.y - b + Q);
            e.x > p.x && e.y > p.y ? w("north-west") : e.y > p.y ? (l.y = k.y, l.x -= N, b = f = 0, w("north-east")) : e.x > p.x ? (l.x = k.x, l.y -= Q, b = f = 0, w("south-west")) : w("south-east");
            break;
          case "south":
            e.x = k.x;
            e.y = k.y;
            p.x = l.x;
            p.y = Math.min(P, p.y - b + Q);
            e.y > p.y && (l.y = k.y, b = f = 0, w("north"));
            break;
          case "south-west":
            e.x = l.x;
            e.y = k.y;
            p.x = Math.max(I, p.x - f);
            p.y = Math.min(P, p.y - b + Q);
            e.y > p.y ? (l.y = k.y, b = f = 0, w("north-west")) : e.x < p.x && (k.x = l.x, l.y -= Q, b = f = 0, w("south-east"));
            break;
          case "west":
            e.x = l.x;
            e.y = k.y;
            p.x = Math.max(I, p.x - f);
            p.y = l.y;
            e.x < p.x && (k.x = l.x, b = f = 0, w("east"));
            break;
          case "north-west":
            e.x = l.x;
            e.y = l.y;
            p.x = Math.max(I, p.x - f);
            p.y = Math.max(L, p.y - b);
            e.y < p.y ? (k.y = l.y, b = f = 0, w("south-west")) : e.x < p.x && (k.x = l.x, b = f = 0, w("north-east"));
            break;
          case "move":
            var K = Math.max(I, p.x - f),
              R = Math.max(L, p.y - b),
              K = K - Math.max(I, K + N - H) + I,
              R = R - Math.max(L, R + Q - J) + L;
            e.x = K + u;
            e.y = R + C;
            p.x = N + K + u;
            p.y = Q + R + C;
            break;
          default:
            p.x += u, p.y += C
        }
        N = c.params;
        (N.constrain || eventjs.shiftKey) && q && t && (q = p.x - e.x || 1,
          t = p.y - e.y || 1, Q = N.constrain ? N.ratio : {
            width: J,
            height: H
          }, N = "portrait" === N.aspect ? {
            x: Q.height / Q.width,
            y: Q.width / Q.height
          } : {
            x: Q.width / Q.height,
            y: Q.height / Q.width
          }, Math.abs(q) * N.x > Math.abs(t) ? p.y = e.y + t / Math.abs(t) * Math.abs(q) * N.x : p.x = e.x + q / Math.abs(q) * Math.abs(t) * N.y, p.x > e.x ? 0 > p.y - L ? p.x = e.x - (L - Math.max(e.y, p.y)) * N.y : p.y - L > J && (p.x = e.x + (P - Math.min(e.y, p.y)) * N.y) : 0 > p.y - L ? p.x = e.x + (L - Math.max(e.y, p.y)) * N.y : p.y - L > J && (p.x = e.x - (P - Math.min(e.y, p.y)) * N.y), p.y > e.y ? 0 > p.x - I ? p.y = e.y - (I - Math.max(e.x, p.x)) * N.x : p.x - I > H &&
          (p.y = e.y + (O - Math.min(e.x, p.x)) * N.x) : 0 > p.x - I ? p.y = e.y + (I - Math.max(e.x, p.x)) * N.x : p.x - I > H && (p.y = e.y - (O - Math.min(e.x, p.x)) * N.x), p.x = Math.round(p.x), p.y = Math.round(p.y));
        p.x < e.x && (e.x ^= p.x, p.x ^= e.x, e.x ^= p.x);
        p.y < e.y && (e.y ^= p.y, p.y ^= e.y, e.y ^= p.y);
        e = {
          x: e.x < I ? I : e.x > O ? O : e.x,
          y: e.y < L ? L : e.y > P ? P : e.y
        };
        p = {
          x: p.x < I ? I : p.x > O ? O : p.x,
          y: p.y < L ? L : p.y > P ? P : p.y
        };
        v(s, e, p, E);
        if (m || g || "crop" === r)
          if (k = e, l = p, a.history && m && self.__from) {
            e = a.project.getData();
            e.start = a.util.clone(k);
            e.end = a.util.clone(l);
            p = [self.__from, e];
            var S;
            try {
              S =
                a.history.getLastAction().to[1], S = S.start && S.end ? S : ""
            } catch (T) {
              S = ""
            }
            s = eventjs.proxy.hasDistance;
            (S && s(S.start, S.end) || s(e.start, e.end)) && JSON.stringify(S) !== JSON.stringify(e) && a.history.store({
              from: "crop-draw",
              to: p,
              name: "Create Crop Area"
            })
          }
        m && w("")
      },
      s = {
        "south-east": "se",
        south: "s",
        north: "n",
        east: "e",
        west: "w",
        "south-west": "sw",
        "north-east": "ne",
        "north-west": "nw"
      },
      w = function(b) {
        a.active.canvas.style.cursor = b ? s[b] + "-resize" : "default"
      },
      v = function(b, d, k, f) {
        if (d && k) {
          var h = "up" === f.state || "update" === f.state,
            l = a.canvas2d.zoom,
            p = a.project.bounds.width * l,
            q = a.project.bounds.height * l,
            r = a.project.scrollLeft,
            s = a.project.scrollTop,
            g = a.canvas2d.x + (a.project.x + r) * l,
            t = a.canvas2d.y + (a.project.y + s) * l;
          e = g;
          m = t;
          var w = 0 === d.x - k.x || 0 === d.y - k.y;
          if (w && h) return c.unset();
          b.save();
          b.translate(-r * l, -s * l);
          b.globalCompositeOperation = "copy";
          b.fillStyle = "rgba(0, 0, 0, 0.75)";
          b.fillRect(g - 1, t - 1, p + 2, q + 2);
          if (!w) {
            l = k.x - d.x;
            p = k.y - d.y;
            q = d.x + 0.5;
            r = k.x - 0.5;
            s = d.y + 0.5;
            k = k.y - 0.5;
            b.beginPath();
            b.globalCompositeOperation = "destination-out";
            b.fillStyle = "rgba(0, 0, 0, 1)";
            b.rect(q, s, l, p);
            b.fill();
            26 < Math.abs(q - r) && 16 < Math.abs(s - k) && (g = ((r + q) / 2 >> 0) + 0.5, u(b, f, g - 4, s, 8, 8, "north"), u(b, f, g - 4, k - 8, 8, 8, "south"));
            26 < Math.abs(s - k) && 16 < Math.abs(q - r) && (g = ((k + s) / 2 >> 0) + 0.5, u(b, f, r - 8, g - 4, 8, 8, "east"), u(b, f, q, g - 4, 8, 8, "west"));
            16 < Math.abs(q - r) && 16 < Math.abs(s - k) && (u(b, f, q, s, 8, 8, "north-west"), u(b, f, r - 8, s, 8, 8, "north-east"), u(b, f, q, k - 8, 8, 8, "south-west"), u(b, f, r - 8, k - 8, 8, 8, "south-east"));
            b.save();
            b.rect(d.x + 0.5, d.y + 0.5, l, p);
            b.clip();
            b.lineWidth = 1;
            b.strokeStyle =
              "rgba(0, 0, 0, 0.25)";
            b.shadowColor = "rgba(255, 255, 255, 1)";
            b.shadowOffsetX = 1;
            b.shadowOffsetY = 1;
            b.shadowBlur = 0;
            if (!1 === h) {
              h = Math.round(l / 2);
              k = Math.round(p / 2);
              b.beginPath();
              for (f = 0; 3 >= f; f++) b.moveTo(f * l / 3 + d.x, d.y), b.lineTo(f * l / 3 + d.x, d.y + p);
              for (f = 0; 3 >= f; f++) b.moveTo(d.x, f * p / 3 + d.y), b.lineTo(d.x + l, f * p / 3 + d.y);
              b.stroke();
              b.beginPath();
              b.strokeStyle = "rgba(255, 255, 255, 0.5)";
              b.shadowColor = "rgba(0, 0, 0, 0.25)";
              b.moveTo(d.x + h - 7.5, d.y + k + 0.5);
              b.lineTo(d.x + h + 8.5, d.y + k + 0.5);
              b.moveTo(d.x + h + 0.5, d.y + k - 7.5);
              b.lineTo(d.x +
                h + 0.5, d.y + k + 8.5);
              b.stroke()
            }
            b.restore()
          }
          b.restore()
        }
      },
      u = function(b, d, c, e, k, f, h) {
        var l = a.canvas2d.zoom,
          p = a.project.scrollLeft,
          m = a.project.scrollTop;
        b.beginPath();
        b.globalCompositeOperation = "source-over";
        b.fillStyle = "rgba(100, 100, 100, 0.8)";
        b.strokeStyle = "rgba(255, 255, 255, 0.5)";
        b.rect(c, e, k, f);
        b.fill();
        b.stroke();
        var q = d || a.tool.coord,
          p = q.x - p * l,
          l = q.y - m * l;
        b.beginPath();
        b.rect(c - 5, e - 5, k + 10, f + 10);
        b.isPointInPath(p, l) && "down" === d.state && (r = h)
      };
    this.updateAspectRatio = function(a, b) {
      var d = Math.abs(a.x -
          b.x),
        e = Math.abs(a.y - b.y);
      (d > e ? "landscape" : "portrait") !== c.params.aspect && (c.updateCenter(a, b, {
        x: 0.5 * d,
        y: 0.5 * e
      }), c.updateClamp(a, b))
    };
    this.updateClamp = function(b, d) {
      var e = d.x - b.x,
        k = d.y - b.y,
        f = k / e,
        h = a.project.width,
        l = a.project.height,
        p = 0 > b.y,
        m = d.y > l,
        q = d.x > h,
        r = 0 > b.x;
      if (p || m) p && (k += b.y, b.y = 0), m && (k += l - d.y - 1, d.y = l), e = k / f;
      if (q || r) r && (e += b.x, b.x = 0), q && (e += h - d.x - 1, d.x = h), k = e * f;
      c.updateCenter(b, d, {
        x: e / 2,
        y: k / 2
      })
    };
    this.updateTransform = function(a, b) {
      var d = c.params,
        e = Math.abs(b.x - a.x),
        k = Math.abs(b.y - a.y),
        d = d.ratio,
        k = k / e,
        d = d.width / d.height;
      if (1 > k && 1 < d || 1 < k && 1 > d) d = 1 / d;
      e = Math.sqrt(1 / d * k * e * e);
      c.updateCenter(a, b, {
        x: e / 2,
        y: d * e / 2
      });
      c.updateClamp(a, b)
    };
    this.updateCenter = function(a, b, d) {
      var c = 0.5 * (b.x - a.x) + a.x,
        e = 0.5 * (b.y - a.y) + a.y;
      a.x = Math.round(c - d.x);
      a.y = Math.round(e - d.y);
      b.x = Math.round(c + d.x);
      b.y = Math.round(e + d.y)
    };
    return this
  })
})(sketch);
(function(a) {
  a.toolkit.register("group", function(g) {
    var c = this;
    this.type = "group";
    this.active = g.active.ctx;
    this.cache = g.cache.ctx;
    this.ctx = g.layer0.ctx;
    this.attributes = a.util.mergeObject(a.attributes.basicObject, {
      opened: !1
    });
    this.enable = function() {};
    this.disable = function() {};
    this.loadResource = function(a) {
      if (a.onload) a.onload(a.action)
    };
    this.createObject = function(f, b) {
      var h = f.action,
        d = a.scene.addObject({
          type: c.type,
          composite: h.composite,
          opacity: h.opacity,
          groupId: h.groupId,
          bbox: f.bbox
        });
      a.currentGroupId =
        h.groupId;
      if (h.children) {
        var e = function() {
            var c = m[k++];
            c ? ("group" !== c.type && (c.groupId = h.groupId, h.x && (c.x = (c.x || 0) + h.x), h.y && (c.y = (c.y || 0) + h.y)), a.addObject(c, e, e)) : b && b(d)
          },
          m = h.children,
          k = 0;
        e()
      } else b && b(d)
    };
    return a.toolkit.init(this)
  })
})(sketch);
(function(a) {
  a.toolkit.register("media", function(g) {
    var c = this;
    g.defaultWidth = g.defaultWidth || 100;
    g.defaultHeight = g.defaultHeight || 100;
    g.minWidth = g.minWidth || 1E-8;
    g.minHeight = g.minHeight || 1E-8;
    this.id = "media";
    this.ctx = g.layer0.ctx;
    this.active = g.active.ctx;
    this.cache = g.cache.ctx;
    this.enable = function() {
      var c = a.toolkit.select;
      a.tool !== c && c && c.enable({
        cursor: !0,
        search: this.id
      })
    };
    this.disable = function() {
      var c = a.toolkit.select;
      a.tool !== c && c && c.disable({
        cursor: !0
      })
    };
    this.loadResource = function(f) {
      var b = f.action,
        h = f.onload,
        d = f.onprogress;
      if (!b.src) return h(b);
      var e = b.src,
        m = b.bbox,
        k = m.owidth || m.width,
        l = m.oheight || m.height,
        r = a.scene.fromConfigure(a.configure.tools[b.type]),
        p;
      for (p in r) "undefined" === typeof b[p] && (b[p] = r[p]);
      var q = {
        src: e,
        action: b,
        onError: function() {
          var d = "&ldquo;" + e.split("/").pop() + "&rdquo; unavailable.";
          h && h(b, d);
          if ("undefined" !== typeof image) {
            var d = a.cache,
              c = d.canvas;
            c.width = b.bbox.width;
            c.height = b.bbox.height;
            d.fillStyle = "#000";
            d.fillRect(0, 0, c.width, c.height);
            image.src = c.toDataURL()
          }
        },
        onComplete: h,
        scaleBBox: function(a, b) {
          k / a > l / b && (l = k / a * b);
          k / a < l / b && (k = l / b * a);
          m.width = k;
          m.height = l;
          m.owidth || (m.owidth = k);
          m.oheight || (m.oheight = l)
        },
        useDirtyCache: f.useDirtyCache
      };
      a.assets.add({
        src: q.src,
        type: b.type,
        width: k,
        height: l,
        onprogress: function(b) {
          d && d(b.loaded / b.total);
          a.feature.debug && console.log(b.loaded / b.total, d)
        },
        onload: function(a, d) {
          this.setAttribute || "image" === b.type ? c.loadImageResource(q, a, this) : c.loadSVGResource(q, a, this)
        }
      })
    };
    this.loadImageResource = function(a, b, h) {
      b = a.action;
      var d = "default" ===
        h.className ? [0, 0, b.bbox.width, b.bbox.height] : [0, 0, h.width, h.height];
      a.scaleBBox(d[2] - d[0], d[3] - d[1]);
      b.dirtyTransform = !0;
      b.canvas = h;
      b.bbox.viewBox = d;
      b.render = function(a, b) {
        this.canvas = h;
        this.dirty && c.updateObjectSize(this);
        var d = this.bbox.width * this.bbox.scale.x,
          f = this.bbox.height * this.bbox.scale.y;
        a.save();
        a.drawImage(this.canvas, 0, 0, d, f);
        a.restore()
      };
      c.updateObjectSize(b, a.onComplete)
    };
    this.loadSVGResource = function(c, b, h) {
      if (!a.util.exists("sketch.vector.SVG")) throw "Requires sketch.vector.SVG library.";
      var d = c.action;
      b = d.bbox.width;
      var e = d.bbox.height,
        m = h.viewBox || [0, 0, b, e];
      c.scaleBBox(m[2] - m[0], m[3] - m[1]);
      if ("objectBoundingBox" === d.bbox.units) {
        var k = d.bbox.scale,
          l = d.bbox.height;
        d.bbox.x += (1 - d.bbox.width / b) * b / 2 * k.x;
        d.bbox.y += (1 - l / e) * e / 2 * k.y
      }
      d.svg = h;
      d.dirty = !0;
      d.bbox.viewBox = m;
      d.render = function(a, b, c) {
        a = {
          ctx: a
        };
        "symbol" === d.type && (a.defaultFill = this.fill && this.fill.color ? this.fill.color : "#000000");
        !1 !== c && (a.matrix = b.matrix);
        a.calcStroke = d.useStretchToEdge;
        h.render ? h.render(a) : console.log(h)
      };
      if (c.onComplete) c.onComplete(d)
    };
    this.changeColor = function(a) {
      c.style.fillStyle = a
    };
    this.updateObjectSize = function(a, b) {
      b && b(a)
    };
    this.updateTimeout = function(f, b) {
      var h = a.scene.data[a.selection.idx];
      if (h) {
        c.sizeAtRender = Math.sqrt(h.bbox.width * h.bbox.height);
        h.dirty = !0;
        h.bbox.scaleCache = {
          x: 1,
          y: 1
        };
        a.scene.updateConstrain(h);
        a.scene.updateTransform(h);
        var d = a.active;
        d.canvas.width = d.canvas.width;
        f ? a.render.clean("media.updateTimeout") : ("source-over" !== c.style.composite && d.drawImage(a.ctx.canvas, 0, 0), a.render.action(a.active, h), a.area.renderControls(a.selection.idx))
      }
    };
    this.record = function(f, b, h) {
      f && eventjs.prevent(f);
      if ((!f || a.feature.placement.drag) && "eyeDropper" !== a.colorPicker.state) {
        var d = c.style;
        if ("function" !== typeof d.render) b.pause && b.pause(), !d.src && (a.lib[d.type] && a.lib[d.type].paths) && (d.src = a.lib[d.type].paths[0].filepath), c.loadResource({
          action: d,
          onload: function(a) {
            if (!a.src) return console.log("missing src", a);
            b.resume && b.resume();
            c.record(f, b, h)
          }
        });
        else {
          var e = !!b.action,
            m = a.canvas2d,
            k = m.zoom,
            l = (k - 1) / k,
            r = k * m.pixelRatio,
            p = a.project.scrollLeft * l,
            q = a.project.scrollTop *
            l,
            l = b.start.x / k + p,
            t = b.start.y / k + q;
          b.y = b.y / k + q;
          b.x = b.x / k + p;
          q = d.bbox;
          Math.min(l, b.x);
          Math.min(t, b.y);
          k = 2 * (Math.abs(l - b.x) || 1);
          p = 2 * (Math.abs(t - b.y) || 1);
          if (b.action && b.action.bbox) {
            var s = b.action.bbox;
            isFinite(s.width) && (k = s.width);
            isFinite(s.height) && (p = s.height)
          } else k / q.width > p / q.height ? p = k / q.width * q.height : k = p / q.height * q.width;
          if ("down" === b.state) e = a.scene.fromConfigure(a.configure.tools[c.type]), b.action && a.util.mergeObject(b.action, e), e.bbox = a.util.clone(q), e.render = d.render, e.dirty = !0, e.visible = !1, (q = a.lib[c.type].byPath[d.src]) && a.scene.copyRules(q, e), (q = a.scene.addObject(e, d, b.action ? !1 : !0)) ? (s = q.bbox, s.units = "objectBoundingBox", s.scale = {
            x: 1,
            y: 1
          }, s.x = l - 1 * m.x / r, s.y = t - 1 * m.y / r, s.width = k, s.height = p) : b.action && h(), c.sizeAtRender = Math.sqrt(k * p);
          else if (q = a.scene.data[a.selection.idx]) {
            s = q.bbox;
            q.dirtyTransform = !0;
            q.dirtyControl = !0;
            s.x = l - 1 * m.x / r;
            s.y = t - 1 * m.y / r;
            s.width = k;
            s.height = p;
            m = a.toolkit.getDimensionConstraint(q, null, !0);
            s.width = s.owidth = k = m.width;
            s.height = s.oheight = p = m.height;
            r = Math.sqrt(k *
              p) / c.sizeAtRender;
            s.scaleCache = {
              x: r,
              y: r
            };
            if (b.action && b.action.bbox) a.util.mergeObject(b.action.bbox, q.bbox), s.width = k, s.height = p;
            else if ("undefined" === typeof b.rotate || !0 === b.rotate) l = -Math.atan2(b.x - l, b.y - t) * a.util.RAD_DEG, s.rotate = (l + 360) % 360;
            l = s.scale.y * p / 2;
            s.x -= s.scale.x * k / 2;
            s.y -= l;
            if ("up" === b.state && (!1 === e && (a.area.inGenesis = !0), q.visible = !0, q.svg = d.svg, s.width * s.height < g.minWidth * g.minHeight))
              if (a.feature.placement.click) 5 >= k && 5 >= p ? (l = g.defaultWidth, t = g.defaultHeight) : (l = g.minWidth, t = g.minHeight),
                l / k > t / p && (t = l / k * p), l / k < t / p && (l = t / p * k), s.width = l, s.height = t, s.owidth = l, s.oheight = t, s.x -= (l - k) / 2, s.y -= (t - p) / 2;
              else {
                d = a.selection.id;
                a.scene.deselectAll();
                a.scene.removeById(d);
                a.render("root.toolkit.media.record");
                alertify.log("dimensions are out of range");
                return
              }
            clearTimeout(a.area.timeout);
            k = "up" === b.state;
            p = m.constrained && r || 0.5 > r || 3 < r || k;
            if (e) {
              if (k) return h()
            } else k || p ? (c.updateTimeout(k, e), b.action && h()) : (a.scene.updateConstrain(q), a.scene.updateTransform(q), !1 === e && (e = a.active, e.clearRect(0,
              0, e.canvas.width, e.canvas.height), "source-over" !== d.composite && e.drawImage(a.ctx.canvas, 0, 0), e = a.active, a.render.action(e, q), a.area.renderControls(a.selection.idx), a.area.timeout = setTimeout(c.updateTimeout, 250)))
          }
        }
      }
    };
    this.onEnterKey = function() {
      a.exec("deselect-all")
    };
    this.style = {
      bbox: {
        x: 0,
        y: 0,
        width: 100,
        height: 100,
        rotate: 0,
        scale: {
          x: 1,
          y: 1
        }
      }
    };
    return a.toolkit.init(this)
  })
})(sketch);
(function(a) {
  a.toolkit.register("select", function(g) {
    var c = this;
    this.type = this.id = "select";
    this.rect = {};
    this.isMoving = !1;
    this.points = {};
    this.copied = {};
    this.enabled = !1;
    this.events = {};
    this.usePreventSelection = !1;
    this.ctx = g.layer0.ctx;
    this.active = g.active.ctx;
    this.cache = g.cache.ctx;
    this.enable = function(b) {
      if (!c.enabled) return b = b || {}, c.usePreventSelection = b.cancelSelection || !1, c.search = b.search || "", "boolean" !== typeof b.mouse && (b.mouse = !0), "boolean" !== typeof b.key && (b.key = !0), "boolean" !== typeof b.cursor &&
        (b.cursor = !0), b.mouse && (c.events = eventjs.add({
          fingers: 1,
          target: this.active.canvas,
          longpress: {
            timeout: 950,
            driftDeviance: eventjs.isTouch ? 5 : 1,
            listener: this.contextMenu
          },
          drag: this.mouseEvent,
          contextmenu: this.contextMenu,
          mousemove: b.cursor ? this.cursorEvent : void 0
        })), b.key && (eventjs.add(window, "keydown", a.keyboard.keydown), eventjs.add(window, "keyup", a.keyboard.keyup)), c.enabled = !0, c
    };
    this.disable = function(b) {
      if (c.enabled) {
        b || (b = {});
        "undefined" === typeof b.mouse && (b.mouse = !0);
        "undefined" === typeof b.key &&
          (b.key = !0);
        "undefined" === typeof b.cursor && (b.cursor = !0);
        if (b.mouse)
          for (var d in c.events) c.events[d].remove && c.events[d].remove();
        b.key && (eventjs.remove(window, "keydown", a.keyboard.keydown), eventjs.remove(window, "keyup", a.keyboard.keyup));
        a.setTooltip("");
        c.enabled = !1
      }
    };
    this.findInRect = function(b, d, c, e, h, q) {
      e = a.canvas2d;
      var g = e.zoom,
        s = e.pixelRatio,
        w = g / s,
        v = e.container,
        u = e.layers;
      d = u.active;
      var y = d.ctx,
        u = u.draw.ctx,
        x = (a.project.scrollLeft + v.scrollLeft) / w,
        v = (a.project.scrollTop + v.scrollTop) / w,
        x = x + 1 *
        e.x / g,
        v = v + 1 * e.y / g,
        w = {
          x: (Math.min(b.x1, b.x2) - x) / s,
          y: (Math.min(b.y1, b.y2) - v) / s
        };
      b = {
        x: (Math.max(b.x1, b.x2) - x) / s,
        y: (Math.max(b.y1, b.y2) - v) / s
      };
      var x = {
          x: b.x,
          y: w.y
        },
        v = {
          x: w.x,
          y: b.y
        },
        z = (b.x - w.x) / s,
        A = (b.y - w.y) / s,
        B = (new Date).getTime();
      y.clearRect(0, 0, d.width, d.height);
      "source-over" !== a.tool.device.composite && y.drawImage(a.ctx.canvas, 0, 0);
      y.fillStyle = "rgba(0,0,255,1)";
      a.hovered.reset();
      u.rect(w.x + 0.5, w.y + 0.5, z, A);
      z = 0;
      A = a.area.padding;
      d = a.scene.data;
      for (var D = {}, G = a.selection.length, F = d.length; F--;) {
        var C = d[F];
        if (!1 !== C.selectable) {
          var E = C.placement;
          if (E && E.point2d) {
            var H = C.bbox;
            if ("text" === C.type) var J = 1,
              I = H.width,
              L = H.height;
            else J = H.viewBox[2] / H.width, I = H.viewBox[2], L = J * H.height;
            var O = -A / H.scale.x * J,
              J = -A / H.scale.y * J,
              I = I - 2 * O,
              L = L - 2 * J,
              P = E.point2d(O, J),
              N = E.point2d(O + I, J),
              Q = E.point2d(O + I, J + L),
              K = E.point2d(O, J + L);
            if (P.x > w.x && P.x < b.x && P.y > w.y && P.y < b.y || N.x > w.x && N.x < b.x && N.y > w.y && N.y < b.y || Q.x > w.x && Q.x < b.x && Q.y > w.y && Q.y < b.y || K.x > w.x && K.x < b.x && K.y > w.y && K.y < b.y || f(P, N, w, b) || f(Q, K, w, b) || f(N, Q, w, b) || f(P, K, w, b) || f(P,
                N, x, v) || f(Q, K, x, v) || f(N, Q, x, v) || f(P, K, x, v))
              if ((a.feature[C.type] || a.feature.tools).usePointInPath && !q)
                for (H = C.data, O = 0; O < H.length; O++) {
                  if (J = E.point2d(H[O].x, H[O].y), u.isPointInPath(J.x, J.y)) {
                    if (c && G) {
                      if (!a.selection.items[F]) continue;
                      z++;
                      D[F] = !1
                    } else z++, D[F] = !0;
                    a.render.action(C.ctx, C);
                    break
                  }
                } else {
                  if (c && G) {
                    if (!a.selection.items[F]) continue;
                    P = "rgba(0,0,0,0.20)";
                    N = "rgba(255,255,255,0.20)";
                    z++;
                    D[F] = !1
                  } else P = "rgba(255,255,255,0.20)", N = "rgba(0,0,0,0.20)", z++, D[F] = !0, C.dirtyControl = !0;
                  h && (y.save(), y.beginPath(),
                    y.translate(e.x, e.y), y.scale(1 / s * g, 1 / s * g), E.apply(y, !0), y.rect(O, J, I, L), y.fillStyle = P, y.lineWidth = 1 / H.scale.x / g, y.strokeStyle = N, y.stroke(), y.fill(), y.restore())
                }
          }
        }
      }
      a.feature.debug && console.log("select-time", B - (new Date).getTime());
      if (z) return D
    };
    var f = function(a, b, d, c) {
        return (c.y - a.y) * (d.x - a.x) > (d.y - a.y) * (c.x - a.x) !== (c.y - b.y) * (d.x - b.x) > (d.y - b.y) * (c.x - b.x) && (d.y - a.y) * (b.x - a.x) > (b.y - a.y) * (d.x - a.x) !== (c.y - a.y) * (b.x - a.x) > (b.y - a.y) * (c.x - a.x)
      },
      b = {
        selectable: !0
      };
    this.findSingleAction = function(d, e, f, h, p) {
      e =
        e || d.actions || a.scene.data;
      f = f || d.pointerUp || !1;
      h = h || d.searchParam || b;
      p = p || d.searchType || c.search || "";
      var q = "select" === a.tool.id,
        g = a.feature.vector.edit,
        s = eventjs.metaKey;
      d = a.scene.getPointInCanvas(d);
      for (var w = a.area.padding, v = a.render.cache.padding, u = a.selection.items, y = 1 < a.selection.length, x = !1, z, A, B = e.length; B--;) {
        var D = e[B],
          G = D.bbox;
        if (!(!G || h.findable && !0 !== D.findable || h.selectable && !1 === D.selectable)) {
          var F = "button" === D.type;
          if (F) {
            if (s && "anchor" === D.id) continue
          } else {
            if (!g) continue;
            if (p && D.toolkit &&
              D.toolkit.id !== p) continue;
            if (!x && !s && y) {
              if (x = a.scene.getHovered()) {
                var C = a.scene.getPointInAction(x, d),
                  E = C.bbox_x,
                  H = C.bbox_y,
                  J = C.bbox_width,
                  I = C.bbox_height;
                if (C.x > E && C.y > H && C.x < E + J && C.y < H + I) return x.zIndex
              }
              x = !0
            }
          }
          C = a.scene.getPointInAction(D, d);
          E = C.bbox_x;
          H = C.bbox_y;
          J = C.bbox_width;
          I = C.bbox_height;
          if (C.x > E && C.y > H && C.x < E + J && C.y < H + I) {
            var L = a.feature[D.type] || a.feature.tools;
            if (F)
              if (!1 === f && "anchor" === D.id && q) continue;
              else return B;
            else {
              if (f && u[D.zIndex]) return B;
              if ((!y || s) && (L.usePointInPath || L.usePointInImageData) &&
                D.ctx) {
                if (D = D.ctx, E = ((C.x - E) * G.scale.x >> 0) - w + v, C = ((C.y - H) * G.scale.y >> 0) - w + v, L.usePointInPath && D.isPointInPath(E, C) || L.usePointInImageData && 8 < D.getImageData(E, C, 1, 1).data[3]) return B
              } else if (L.usePointNearest && !s) return B
            }
            L.usePointInBoundingBox && !s && (G = J * G.scale.x * I * G.scale.y, void 0 === A || A >= G) && (z = B, A = G)
          }
        }
      }
      return z
    };
    this.findMultipleActions = function(b, e) {
      if (!1 !== a.feature.vector.edit) {
        if (e.start.x === e.x && e.start.y === e.y)
          if ("up" === e.state) c.isSelecting = !1;
          else return;
        b || (b = c.tmp.event);
        e || (e = c.tmp.self);
        c.tmp.event = b;
        c.tmp.self = e;
        var f = "down" === e.state,
          h = "up" === e.state,
          p = a.canvas2d,
          q = p.zoom / p.pixelRatio,
          g = c.rect;
        f || !c.isSelecting ? (c.isSelecting = !h, eventjs.cancel(b), g.x1 = g.x2 = e.x / q, g.y1 = g.y2 = e.y / q) : (eventjs.prevent(b), h ? c.isSelecting = !1 : (g.x2 = e.x / q, g.y2 = e.y / q));
        isFinite(a.selection.idx) && (a.area.hide(), a.render("findMultipleActions"));
        var s = p.container,
          p = p.layers.active.ctx,
          w = (a.project.scrollLeft + s.scrollLeft) / q,
          v = (a.project.scrollTop + s.scrollTop) / q,
          s = Math.min(g.x1, g.x2) - w,
          u = Math.min(g.y1, g.y2) -
          v,
          w = Math.max(g.x1, g.x2) - w,
          v = Math.max(g.y1, g.y2) - v,
          w = w - s,
          v = v - u;
        f && a.setTooltip("");
        var f = eventjs.metaKey,
          y = eventjs.shiftKey,
          f = c.findInRect(g, a.scene.data, f, y, !0, !1);
        if (h) {
          a.selection.idx = void 0;
          a.hovered.reset();
          a.on.hover && a.on.hover();
          var h = [],
            p = [],
            x;
          for (x in f) f[x] ? h.push(x) : p.push(x);
          h.length && a.scene.selectByIndex(h, !1);
          p.length && a.scene.deselect(p);
          g.x1 === e.x / q && g.y1 === e.y / q && (f = eventjs.metaKey, y = eventjs.shiftKey, q = c.getCoord(b), q = c.findSingleAction(q, a.scene.data, !1), d(q, f, y));
          a.scene.checkForSingleSelection();
          a.scene.fireOnSelect();
          a.render.clean("root.select.findMultipleActions")
        } else a.selection.idx = void 0, a.on.hover && a.on.hover(), p.save(), p.globalCompositeOperation = "destination-over", eventjs.metaKey && a.selection.length ? (p.fillStyle = "rgba(255,50,100,0.20)", p.strokeStyle = "rgba(255,50,100,1)") : (p.fillStyle = "rgba(0,240,100,0.20)", p.strokeStyle = "rgba(0,240,100,1)"), p.beginPath(), p.scale(a.canvas2d.zoom, a.canvas2d.zoom), p.rect(s + 0.5, u + 0.5, w, v), p.lineWidth = 1 / a.canvas2d.zoom, p.stroke(), p.fill(), p.restore()
      }
    };
    this.tmp = {};
    this.cursorEvent = function(b) {
      if (c.isMoving || c.isSelecting || "eyeDropper" === a.colorPicker.state) a.setTooltip("");
      else {
        var d = c.getCoord(b),
          e = 0;
        c.usePreventSelection ? b = a.util.clone(a.scene.controls) : (b = a.scene.data.concat(a.scene.controls), e = a.scene.data.length);
        b = c.findSingleAction(d, b, !1);
        var f = a.scene.data[b],
          h = 0 > b - e,
          e = Math.max(0, b - e),
          e = a.scene.controls[e] || {};
        a.tool.coord = d;
        var q = d = "",
          g = a.feature.vector.edit,
          s = a.selection,
          w = 1 === s.length,
          v = a.hovered,
          s = w ? s.idx : v.idx,
          u = "undefined" !== typeof b ||
          isFinite(s);
        u || w ? h ? (d = e.title, q = e.cursor, a.area.hoverControl = "", s = f.zIndex, u = !!v.items[s], g && (u || (v.reset(), v.select(s), a.on.hover && a.on.hover(f)), a.area.renderControls(b, !1, !0))) : (d = e.title || e.id, q = e.cursor || "", a.area.hoverControl = e.id, u = !!v.items[s], g && (!u && isFinite(s) && (v.reset(), v.select(s), a.on.hover && a.on.hover(a.scene.data[s])), a.area.renderControls(null, !1, !0))) : (a.area.hoverControl = "", g && v.length && (v.reset(), a.on.hover && a.on.hover(), a.area.renderControls(null, !1, !0)));
        d ? a.setTooltip(a.language.translate(d),
          q) : a.setTooltip("", q);
        a.ui.setCursor(q)
      }
    };
    this.contextMenu = function(b) {
      if (window.contextmenu && (eventjs.cancel(b), "contextmenu" === b.type || !eventjs.isMouse)) {
        var d, e = a.selection.length;
        a.ui.menuSelectMultiple && 1 < e ? d = "menuSelectMultiple" : a.ui.menuSelect && e ? d = "menuSelect" : a.ui.menuSelectDefault && (d = "menuSelectDefault");
        d && (c.events.drag && c.events.drag.cancel(), c.events.gesture && c.events.gesture.cancel(), b = eventjs.proxy.getCoord(b), contextmenu.show(a.ui[d], b.x + 5, b.y + 5, !0))
      }
    };
    this.isMoving = this.isModified =
      this.isSelecting = !1;
    this.mouseEvent = function(b, k, f) {
      eventjs.prevent(b);
      if (2 !== k.fingers && "eyeDropper" !== a.colorPicker.state) {
        var g = a.scene,
          p = a.selection.length,
          q = "down" === k.state,
          t = "up" === k.state,
          s = eventjs.metaKey,
          w = eventjs.shiftKey;
        if (q || t) {
          q && (c.isModified = !1);
          if (c.usePreventSelection) var v = a.util.clone(g.controls),
            u = 0;
          else v = g.data.concat(g.controls), u = g.data.length;
          var y = c.getCoord(b),
            v = c.findSingleAction(y, v, t)
        }
        var x = "undefined" !== typeof v,
          z = k.start.x !== k.x || k.start.y !== k.y;
        if (g.controls[v - u]) {
          var A =
            g.controls[v - u];
          if ("anchor" === A.id && a.selection.length)
            if (t) {
              c.isMoving = !1;
              v = c.findSingleAction(y, g.data, !1);
              y = g.data[v];
              if (a.selection.idx === v) {
                if (c.isModified) return;
                !1 === a.__editing && "text" === y.type ? (a.area.show(y), a.toolkit.text.updateCSS(), a.toolkit.text.focus(), a.toolkit.text.selectAll()) : (a.scene.deselectAll(), a.ui.buildConfigure(), a.render.clean("root.select.moveEvent"));
                return
              }
              if (!w && !s && y) {
                e(v, !0);
                a.render.clean("root.select.moveEvent");
                return
              }
            } else c.isMoving = !0;
          else {
            if (t) return;
            if (A.event) {
              g =
                a.hovered.idx;
              (!1 === isFinite(g) || g !== a.selection.idx) && (y = a.scene.getHovered()) && a.selection.select(y.zIndex);
              c.isMoving = !1;
              A.event(b);
              k.pause();
              return
            }
          }
        } else if (t && (y = g.data[v]) && (a.feature[y.type] || a.feature.tools).usePointInPath) {
          c.isMoving = !1;
          a.render("root.select.mouseEvent.usePointInPath.pointUp");
          return
        }
        if (!f)
          if (!t || !c.isMoving || z || c.isModified || w || s) {
            f = a.toolkit.text && a.toolkit.text.dragging;
            !q || (x || !p || w || s || f) || (a.scene.deselectAll(), a.render.clean("root.select.mouseEvent.cancelSelection.b"));
            if (q && a.selection.items[v] && !s || c.isMoving) return h(b, k);
            if (!x || w || s) {
              if ("select" === a.tool.id && q) return k.proxy(c.findMultipleActions);
              if (a.tool.record) return sketch.scene.deselectAll(), k.proxy(function(b, d) {
                c.isMoving = "up" !== d.state;
                a.tool.record(b, d)
              })
            }
            if (0 > v - u)
              if (eventjs.stop(b), (w || s) && a.feature.vector.edit) d(v, s, w), g.checkForSingleSelection(), g.fireOnSelect(), a.render.clean("root.select.moveActions");
              else return e(v), c.isModified = !0, h(b, k)
          } else eventjs.cancel(b), c.isMoving = !1, e(v)
      }
    };
    var h = function(b,
        d) {
        a.area.moveEvent(b);
        return d.proxy(function(a, b) {
          c.isMoving = "up" !== b.state;
          c.isMoving || b.start.x === b.x && b.start.y === b.y && c.mouseEvent(a, b, !0)
        })
      },
      d = function(b, d, c) {
        "undefined" !== typeof b && (d && a.selection.items[b] ? a.scene.deselect(b) : a.scene.selectByIndex(b, !1))
      },
      e = function(b, d) {
        var c = a.scene.data[b];
        if (c && c.toolkit) {
          var e = c.toolkit;
          a.scene.selectByIndex(b);
          a.scene.checkForSingleSelection();
          e.updateBBox && (e.updateBBox(), setTimeout(function() {
              a.toolkit.text.textarea.blur();
              a.toolkit.text.textarea.focus()
            },
            10));
          a.style && a.style.updateFromObject("fill", c);
          d && a.ui.buildConfigure && a.ui.buildConfigure(c.type)
        }
      };
    this.getCoord = function(a) {
      var b = eventjs.proxy.getCoord(a),
        d = eventjs.proxy.getBoundingBox(c.active.canvas);
      b.x += d.scrollLeft - d.x1;
      b.y += d.scrollTop - d.y1;
      b.state = a.type;
      return b
    };
    return a.toolkit.init(this)
  });
  a.getCoord = function(g) {
    var c = eventjs.proxy.getCoord(g),
      f = eventjs.proxy.getBoundingBox(a.active.canvas);
    c.x += f.scrollLeft - f.x1;
    c.y += f.scrollTop - f.y1;
    c.state = g.type;
    return c
  };
  a.getElementsInRect =
    function(a, c, f) {};
  a.getObjectFromPoint = function(g, c, f) {
    var b;
    if (isFinite(g)) b = g, g = c, c = f || {};
    else if (isFinite(g.x)) b = g.x, g = g.y, c = c || {};
    else return;
    return a.toolkit.select.findSingleAction({
      x: b || 0,
      y: g || 0,
      actions: c.actions || a.scene.data,
      pointerUp: c.pointerUp || !1,
      searchParam: c.searchParam || null,
      searchType: c.searchType || null
    })
  }
})(sketch);
(function(a) {
  a.toolkit.register("zoom", function(g) {
    var c = this;
    this.type = "zoom";
    this.enable = function() {
      dom.setClass("#sk-orientation", "sk-opened", !0);
      a.active.canvas.width = a.active.canvas.width;
      a.orient.enable();
      c.onGesture = eventjs.add({
        fingers: 2,
        target: window,
        type: "gesture",
        listener: this.gesture
      });
      a.toolkit.select.enable({
        key: !0,
        mouse: !1,
        cursor: !1
      })
    };
    this.disable = function() {
      dom.setClass("#sk-orientation", "sk-opened", !1);
      a.orient.disable();
      c.onGesture && c.onGesture.remove();
      a.toolkit.select.disable()
    };
    this.gesture = function(c, b) {
      var h = a.orient.events;
      "start" === b.state ? (h.drag && h.drag.enabled && h.drag.remove(), b.startScale = a.canvas2d.zoom, b.__x = b.x, b.__y = b.y) : "end" === b.state && h.drag && h.drag.add();
      var h = a.orient,
        d = eventjs.proxy.getBoundingBox(h.canvas),
        e = a.canvas2d.pixelRatio,
        m = a.canvas2d.zoom;
      h.mouse.x = b.x * e - d.x1;
      h.mouse.y = b.y * e - d.y1;
      h.offset.x += (b.x - b.__x) / m;
      h.offset.y += (b.y - b.__y) / m;
      sketch.orient.setZoom(b.startScale * b.scale);
      b.__x = b.x;
      b.__y = b.y
    };
    return a.toolkit.init(this)
  })
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.Scene = function(a) {
  var g = this;
  a.render && (this.render = a.render.clean);
  this.add = a.addObject;
  this.push = function(a, b) {
    b && g.decompress(a);
    this.data.push(a);
    this.dataById[a.id] = a
  };
  this.setData = function(a, b) {
    this.data = [];
    this.dataById = {};
    for (var d = 0; d < a.length; d++) this.push(a[d], b)
  };
  this.addObject = function(b, d, c) {
    d = d || {};
    if (!1 === this.ensureMaxCopies(b)) g.deselectAll();
    else return b = a.util.mergeObject(b, {
        id: this.createId(null, c),
        zIndex: this.data.length,
        bbox: {
          rotate: 0,
          scale: {
            x: 1,
            y: 1
          }
        }
      }), c = b.bbox, "undefined" ===
      typeof c.viewBox && (c.viewBox = [0, 0, c.width, c.height]), d.canvasCtx && (b.canvasCtx = d.canvasCtx), d.canvas && (b.canvas = d.canvas), this.copyRules(d, b), this.ensureStickyIndex(b), this.push(b), this.sort(), this.reindex(), c = this.getById(b.id).zIndex, this.selection.id = b.id, this.selection.idx = c, this.selection.items[c] = !0, this.selection.length++, this.updateSelectionInfo(), a.toolkit.setToolkit(b), d.src && d.src !== b.src ? (b.src = d.src, a.assets.add({
        type: b.type,
        src: d.src,
        onload: function(d) {
          b.src = d;
          a.toolkit.loadResource(b,
            function(a) {
              g.fireOnActionAdd(a)
            });
          if (a.peer && a.peer.sendFile) {
            var c = a.assets.getBlob(d);
            a.peer.sendFile(c, d)
          }
        }
      })) : a.toolkit.loadResource(b, function(a) {
        g.fireOnActionAdd(a)
      }), b
  };
  this.removeById = function(a, b) {
    var d = this.getById(a);
    d && this.removeByIndex(d.zIndex, b);
    return this
  };
  this.remove = this.removeByIndex = function(b, d) {
    d = !1 !== d;
    switch (typeof b) {
      case "undefined":
        return this;
      case "number":
        var c = {};
        c[b] = !0;
        b = c;
        break;
      default:
        b = a.util.clone(b)
    }
    for (var c = {}, e = [], k = [], f = this.selection.items, h = this.data.length,
        l = 0; l < h; l++) {
      var m = this.data[l];
      b[l] ? (k.push(this.clone(m)), a.render.cache.clean(m)) : (e.push(m), c[m.id] = m);
      f[m.zIndex] && (delete f[m.zIndex], this.selection.length--)
    }
    d && (this.fireOnActionRemove(b), a.history && a.history.store({
      from: k,
      to: "remove",
      name: "Remove Object(s)"
    }));
    this.data = e;
    this.dataById = c;
    this.reindex();
    this.updateSelectionInfo();
    return this
  };
  this.removeByName = function(a, b) {
    var d = this.getByName(a);
    d.length && (d = this.selection.fromObjects(d), this.removeByIndex(d, b));
    return this
  };
  this.removeSelection =
    function(a, b) {
      a = a || this.selection.items;
      this.removeByIndex(a, b);
      this.deselectAll();
      return this
    };
  this.removeAll = function(a) {
    var b = this.selection.fromObjects(this.data);
    this.removeByIndex(b, a);
    this.deselectAll();
    return this
  };
  this.clear = function(b) {
    b = !1 !== b;
    a.active.canvas.width = a.active.canvas.width;
    a.ctx.clearRect(0, 0, a.ctx.canvas.width, a.ctx.canvas.height);
    this.removeAll(b);
    return this
  };
  this.reset = function(b) {
    this.deselectAll();
    this.data = [];
    this.dataById = {};
    a.history && a.history.resetActionHistory();
    a.render && a.render("root.scene.reset");
    if (b || a.fromServer) return this;
    a.dataChannel && (a.feature.stream.sketch && !b) && a.dataChannel.send(["scene.reset"]);
    return this
  };
  this.deselectById = function(a) {
    (a = this.getById(a)) && this.deselectByIndex(a.zIndex);
    return this
  };
  this.deselect = this.deselectByIndex = function(a, b) {
    "undefined" === typeof a && (a = this.selection.idx);
    if ("object" === typeof a)
      for (var d = 0; d < a.length; d++) this.deselect(a[d], !0);
    else {
      this.selection.items[a] && (delete this.selection.items[a], this.selection.length--);
      if (a === this.selection.idx) {
        if (1 === this.selection.length) return this;
        this.selection.id = void 0;
        this.selection.idx = void 0;
        this.controls = []
      }
      b || this.fireOnDeselect()
    }
    return this
  };
  this.deselectByName = function(a) {
    a = this.getByName(a);
    a.length && (a = this.selection.fromObjects(a), this.deselectByIndex(a));
    return this
  };
  this.deselectAll = function() {
    var b = a.util.clone(this.selection.items);
    a.area && a.area.hide();
    this.selection.reset();
    this.hovered.reset();
    this.controls = [];
    this.fireOnDeselect(b);
    return this
  };
  this.selectById =
    function(a, b) {
      var d = this.getById(a);
      d && this.selectByIndex(d.zIndex, b);
      return this
    };
  this.select = this.selectByIndex = function(b, d, c) {
    d = !1 !== d;
    if (!a.feature.vector.edit) return this;
    if ("object" === typeof b)
      if (d && this.deselectAll(), b.length)
        if (1 === b.length) this.selectByIndex(b[0], d, !0);
        else
          for (var e = 0; e < b.length; e++) this.selectByIndex(b[e], !1, !0);
    else
      for (e in b) this.selectByIndex(e, !1, !0);
    else if (this.data[b]) {
      e = this.data[b];
      if (!1 === e.selectable) return this;
      e.dirtyControl = !0;
      if (d) {
        d = e.toolkit;
        a.tool.type !==
          e.type && (this.toolkit && (this.toolkit.disable(), delete this.toolkit), "text" === e.type && d && (this.toolkit = d, this.toolkit.enable()));
        if (1 === this.selection.getLength() && this.selection.items[b]) return this.selection.id = e.id, this.selection.idx = b, this.selection.length = 1, this;
        this.deselectAll();
        this.selection.id = e.id;
        this.selection.idx = b;
        this.selection.items[b] = !0;
        this.selection.length = 1;
        this.toConfigure(e);
        a.style && e.fill && (b = e.fill, d = b.type, a.style.apply({
          paintMethod: "fill",
          paintType: d,
          dna: b[d],
          useColorPicker: !0
        }));
        a.ui.blendSelectMenu && (a.ui.blendSelectMenu.selectedIndex = a.style.isBlendMode[e.composite] || 0);
        this.fireOnSelect();
        a.ui.setToolMenu && a.ui.setToolMenu(e.type, !0);
        return this
      }
      if (this.selection.items[b]) return this;
      this.selection.items[b] = !0;
      this.selection.length++;
      if (1 === this.selection.length) return this;
      this.selection.id = void 0;
      this.selection.idx = void 0;
      this.controls = [];
      c || this.fireOnSelect()
    }
    return this
  };
  this.selectByName = function(a, b) {
    var d = this.getByName(a);
    d.length ? (d = this.selection.fromObjects(d),
      this.selectByIndex(d, b)) : b && this.deselectAll();
    return this
  };
  this.selectAll = function() {
    c();
    return this
  };
  this.selectInverse = function() {
    c(!0);
    return this
  };
  var c = function(b) {
    if (a.feature.vector.edit) {
      var d = g.selection.items,
        c = 0,
        e = g.data,
        k = e.length;
      g.selection.id = void 0;
      g.selection.idx = void 0;
      g.controls = [];
      for (var f = 0; f < k; f++) !1 !== e[f].selectable && (b && d[f] ? delete d[f] : (d[f] = !0, c++));
      g.checkForSingleSelection();
      g.selection.length = c;
      g.fireOnSelect()
    }
  };
  this.getById = function(a) {
    for (var b = this.data, d = 0; d < b.length; d++)
      if (b[d].id ===
        a) return b[d]
  };
  this.getByIndex = function(a) {
    return this.data[a]
  };
  var f = function(a) {
    return function(b) {
      for (var d = [], c = this.data, e = 0; e < c.length; e++) {
        var k = c[e];
        "undefined" !== typeof k[a] && k[a] === b && d.push(k)
      }
      return d
    }
  };
  this.getByName = new f("name");
  this.getBySrc = new f("src");
  this.getLast = function() {
    return this.data[this.data.length - 1]
  };
  this.getFocused = function() {
    return this.data[this.selection.idx]
  };
  this.getOneSelected = function() {
    if (isFinite(this.selection.idx)) return this.data[this.selection.idx];
    for (var a in this.selection.items) return this.data[a]
  };
  this.getHovered = function() {
    var a = this.hovered.items,
      b;
    for (b in a) break;
    return this.data[b]
  };
  this.getSelection = function(a, b) {
    return this.selection.toObjects(a, b)
  };
  this.find = function(a, b) {
    b = b || {};
    var d = this.data,
      c = b.selection || this.selection.items,
      e = null,
      k = [],
      f;
    for (f in c)
      if (e = d[f]) {
        var c = !0,
          h;
        for (h in a) e[h] !== a[h] && (c = !1);
        c && k.push(e)
      }
    return k
  };
  this.traverse = function(b, d, c) {
    var e = this.data;
    if ("function" === typeof b) a.util.each(e, b);
    else {
      c = c || this.selection.items;
      for (var k in c)(c = e[k]) && (c[b] = d)
    }
  };
  this.setDirtyCache = function(a) {
    a = a || this.selection.items;
    for (var b in a)
      if (a = this.data[b]) a.dirtyCacheForce = !0
  };
  this.setDirtyControl = function(a) {
    a = a || this.selection.items;
    for (var b in a)
      if (a = this.data[b]) a.dirtyControl = !0
  };
  this.setDirtyTransform = function(a) {
    a = a || this.selection.items;
    for (var b in a)
      if (a = this.data[b]) a.dirtyTransform = !0
  };
  this.getDataAsAbsolute = function(a) {
    for (var b = [], d = this.data, c = d.length, e = 0; e < c; e++) b.push(this.getActionDataAsAbsolute(d[e]));
    return a ? JSON.stringify(b) : b
  };
  this.getActionDataAsAbsolute =
    function(b, d) {
      var c = new a.vector.Transform,
        e = b.bbox,
        k = e.x,
        f = e.y,
        h = e.scale.x,
        l = e.scale.y,
        m = e.rotate * a.util.DEG_RAD,
        g = e.width / 2 * h,
        e = e.height / 2 * l,
        r = a.area && a.area.padding || 0,
        B = r * h,
        D = r * l,
        G = b.diameter || 0,
        r = r + r / 2 * (h - 1),
        r = r - G / 2 * (h - 1);
      c.translate(k, f);
      c.translate(g, e);
      m && c.rotate(m);
      c.translate(-g + B - r, -e + D - r);
      c.scale(h, l);
      k = [
        []
      ];
      f = 0;
      if (h = b.data)
        for (l = h.length, m = 0; m < l; m++) h = b.data[m], g = c.point2d(h.x, h.y), k[f] || (k[f] = []), k[f].push({
          x: g.x,
          y: g.y
        }), "z" === h.cmd && ++f;
      return d ? JSON.stringify(k) : k
    };
  this.getBoundingBox =
    function(b) {
      b = b || {};
      var d = b.clampToLayer || !1,
        c = b.selection || this.selection.items,
        e = !!b.selection || b.fromSelection || !1,
        k = b.hovered || this.hovered.items,
        f = !!b.hovered || b.fromHovered || !1;
      b = Infinity;
      var h = -Infinity,
        l = Infinity,
        m = -Infinity;
      e || f || (e = !0, c = this.data);
      for (var g = 0; g < this.data.length; g++) {
        var r = this.data[g];
        if (r.trx) {
          var B = r.zIndex,
            D = k[B];
          if (c[B] && e || D && f) {
            var G = r.trx,
              r = r.bbox,
              D = r.width,
              F = r.height,
              r = G.point2d(0, 0),
              B = G.point2d(D, 0),
              D = G.point2d(D, F),
              C = G.point2d(0, F),
              G = Math.min(r.x, B.x, D.x, C.x) -
              1,
              F = Math.min(r.y, B.y, D.y, C.y) - 1,
              E = Math.max(r.x, B.x, D.x, C.x) + 2,
              r = Math.max(r.y, B.y, D.y, C.y) + 2;
            G < b && (b = G);
            F < l && (l = F);
            E > h && (h = E);
            r > m && (m = r)
          }
        }
      }
      d ? (b = Math.max(0, b), l = Math.max(0, l), d = a.canvas2d.layers.layer0, D = Math.min(d.width - b, h - b), F = Math.min(d.height - l, m - l)) : (D = h - b, F = m - l);
      return {
        x: isFinite(b) ? b : 0,
        y: isFinite(l) ? l : 0,
        width: isFinite(D) ? D : 0,
        height: isFinite(F) ? F : 0,
        units: "objectBoundingBox",
        scale: {
          x: 1,
          y: 1
        }
      }
    };
  this.getBoundingOrigin = function(b) {
    b = b.units ? b : this.getBoundingBox(b);
    var d = a.canvas2d.pixelRatio;
    return "objectBoundingBox" ===
      b.units ? {
        x: (b.x + b.width / 2 * b.scale.x) * d,
        y: (b.y + b.height / 2 * b.scale.y) * d
      } : {
        x: b.x * d,
        y: b.y * d
      }
  };
  this.getPointInCanvas = function(b) {
    var d = a.canvas2d,
      c = d.container,
      e = d.zoom,
      k = e * d.pixelRatio;
    return {
      x: (b.x - a.project.scrollLeft + c.scrollLeft) / e - 1 * d.x / k,
      y: (b.y - a.project.scrollTop + c.scrollTop) / e - 1 * d.y / k
    }
  };
  this.getPointInAction = function(b, d) {
    var c = a.area.padding,
      e = b.bbox,
      k = e.width,
      f = e.height,
      h = e.x,
      l = e.y,
      m = 0,
      g = 0,
      r = 1 / e.scale.x,
      B = 1 / e.scale.y;
    b.placement && b.placement.clone && (l = b.placement.point2d(0, 0), h = l.x, l = l.y);
    "button" !==
    b.type && (m = c * r, g = c * B);
    var k = k + 2 * m,
      f = f + 2 * g,
      c = e.rotate * a.util.DEG_RAD,
      D = a.vector.Transform.__default.reset();
    D.translate(h + m, l + g);
    c && D.rotate(-c);
    D.translate(-h * r, -l * B);
    D.scale(r, B);
    m = D.point2d(d.x, d.y);
    m.x -= e.left || 0;
    m.y -= e.top || 0;
    m.bbox_x = h;
    m.bbox_y = l;
    m.bbox_width = k;
    m.bbox_height = f;
    return m
  };
  this.fromConfigure = function(a) {
    if (a && a.constructor && !a.childNodes && !a.getImageData) {
      var b = new a.constructor;
      if ("undefined" !== typeof a.value) return a.value;
      for (var d in a)
        if ("clamp" !== d) {
          var c = a[d];
          b[d] = "object" !==
            typeof c ? c : c && "undefined" !== typeof c.value ? c.value : this.fromConfigure(c)
        }
      return b
    }
  };
  this.getConfigure = function(b) {
    var d = this.clone(a.configure.tools[b.type]);
    return this.toConfigure(b, d)
  };
  this.toConfigure = function(b, d) {
    d = d || a.configure.tools[b.type];
    for (var c in b) {
      var e = d[c];
      if (e) {
        var k = b[c];
        if ("fill" === c) d[c] = a.util.clone(b[c]);
        else if ("string" === typeof k) d[c] = b[c];
        else switch (e.type) {
          case "clamp":
            "number" === typeof k ? e.value = k : k && "undefined" !== typeof k.min && (e.min = k.min, e.max = k.max)
        }
      }
    }
    return d
  };
  this.detectInBounds = function() {
    for (var a = this.data, b = a.length, d = 0; d < b; d++) this.isInBounds(a[d])
  };
  this.isInBounds = function(b) {
    var d, c, e, k;
    b.dirtyTransform && this.updateTransform(b);
    k = a.canvas2d;
    d = b.bbox;
    var f = d.width,
      h = d.height,
      l = b.trx;
    if (!l || !l.point2d) return !0;
    c = a.project.scrollLeft;
    d = a.project.scrollTop;
    l = l.clone();
    l.matrix.x += c;
    l.matrix.y += d;
    var m = l.point2d(0, 0),
      g = l.point2d(f, 0),
      f = l.point2d(f, h),
      h = l.point2d(0, h),
      r = k.zoom,
      l = (Math.min(m.x, g.x, f.x, h.x) - a.project.x) * r,
      B = (Math.min(m.y, g.y, f.y, h.y) - a.project.y) *
      r,
      D = Math.max(m.x, g.x, f.x, h.x) * r,
      m = Math.max(m.y, g.y, f.y, h.y) * r,
      G = k.x,
      g = k.y,
      f = k.width,
      h = k.height;
    e = a.area.padding;
    k = a.project.bounds;
    var F = k.width * r + 2 * e,
      C = k.height * r + 2 * e;
    k = -(2 * e) + Math.max(0, c * r - G);
    e = -(2 * e) + Math.max(0, d * r - g);
    c = Math.min(F, f + Math.abs(G)) + c * r;
    d = Math.min(C, h + Math.abs(g)) + d * r;
    b.inbounds = l < c && D > k && B < d && m > e;
    return b.inbounds
  };
  this.updateBBox = function() {
    var b = g.getFocused();
    "undefined" !== typeof b && (g.updateConstrain(b), "text" === b.type ? a.toolkit.text && a.toolkit.text.updateCSSTransform(b) : b.brush &&
      (b.brush.bbox = b.bbox))
  };
  this.updateTransform = function(b) {
    var d = b.bbox;
    b.data && !b.dataHash && (b.dataHash = g.createHash(b.data));
    if (b.useStretchToEdge) {
      var c = a.project.width,
        e = a.project.height;
      if (d.width !== c || d.height !== e) d.width = c, d.height = e, d.x = 0, d.y = 0, b.dirtyCacheForce = !0
    }
    if (b.dirtyTransform || b.dirty || !b.placement) {
      b.dirtyControl = !0;
      b.dirtyTransform = !1;
      var k = a.canvas2d,
        e = k.zoom / k.pixelRatio,
        f = a.project.scrollLeft,
        h = a.project.scrollTop,
        l = d.x - 0 - f,
        e = d.y - 0 - h,
        k = d.scale.x,
        m = d.scale.y,
        r = d.rotate * a.util.DEG_RAD;
      b.placement = a.scene.placement({
        trx: b.placement,
        bbox: d,
        pt0: {
          x: l,
          y: e
        },
        pt1: {
          x: l + d.width,
          y: e
        },
        rotate: d.rotate * a.util.DEG_RAD,
        scale: d.scale,
        doRotate: !0,
        doScale: !0,
        doLockRatio: !0
      });
      e = 1;
      l = b.trx || new a.vector.Transform;
      d = b.bbox;
      k = d.scale.x;
      m = d.scale.y;
      r = d.rotate * a.util.DEG_RAD;
      f = d.x - f;
      h = d.y - h;
      c = d.width * e * k;
      e = d.height * e * m;
      d = c / 2;
      e /= 2;
      l.reset();
      l.translate(f, h);
      l.translate(d, e);
      r && l.rotate(r);
      l.translate(-d, -e);
      l.scale(k, m);
      b.trx = l
    }
  };
  this.updateConstrain = function(b) {
    var d = a.project.bounds,
      c = d.width,
      d = d.height,
      e = b.bbox;
    if ((b.useConstrain || b.useConstrainX || b.useConstrainY) && b.trx) {
      var k = b.trx,
        f = e.width,
        h = e.height;
      if ("objectBoundingBox" === b.bbox.units) var l = k.point2d(0, 0),
        m = k.point2d(f, 0),
        g = k.point2d(f, h),
        r = k.point2d(0, h),
        h = Math.min(l.x, m.x, g.x, r.x),
        k = Math.min(l.y, m.y, g.y, r.y),
        f = Math.max(l.x, m.x, g.x, r.x),
        m = Math.max(l.y, m.y, g.y, r.y);
      else l = e, f = l.x, m = l.y, h = l.x, k = l.y;
      var l = e.x,
        g = e.y,
        r = l - h,
        B = g - k,
        h = c - Math.max(0, f - h) + r,
        k = d - Math.max(0, m - k) + B;
      b.useConstrain ? (e.x = Math.max(r, Math.min(h, l)), e.y = Math.max(B, Math.min(k,
        g)), b.dirtyTransform = !0) : b.useConstrainX ? (e.x = Math.max(r, Math.min(h, l)), e.y = g, b.dirtyTransform = !0) : b.useConstrainY && (e.x = l, e.y = Math.max(B, Math.min(k, g)), b.dirtyTransform = !0)
    }
    if (b.useAlignX)
      if (b.dirtyTransform = !0, "right" === b.useAlignX) {
        var D = e.width * e.scale.x;
        e.x = c - D
      } else e.x = "left" === b.useAlignX ? 0 : (c - D) / 2;
    b.useAlignY && (b.dirtyTransform = !0, "bottom" === b.useAlignY ? (c = e.height * e.scale.y, e.y = d - c) : "top" === b.useAlignY ? e.y = 0 : (c = e.height * e.scale.y, e.y = (d - c) / 2));
    b.dirtyTransform && this.updateTransform(b)
  };
  this.fireOnActionRemove =
    function(b) {
      a.on.remove && (b = this.selection.toObjects(b), a.on.remove(b))
    };
  this.fireOnActionAdd = function(b) {
    a.on.add && a.on.add(b)
  };
  this.fireOnHover = function(b) {
    a.on.hover && g.hoverID !== b.id && (g.hoverID = b.id, a.on.hover(b))
  };
  this.fireOnSelect = function() {
    this.updateSelectionInfo();
    if (a.on.select) {
      var b = this.selection.toObjects();
      b.length && a.on.select(b)
    }
  };
  this.fireOnDeselect = function(b) {
    this.updateSelectionInfo();
    a.on.deselect && (b = this.selection.toObjects(b), a.on.deselect(b))
  };
  this.updateSelectionInfo =
    function() {
      if ("undefined" === typeof document) return this;
      var a = document.querySelector(".sk-selection-count");
      a && (a.innerHTML = this.selection.length ? "<p>" + this.selection.length + " items selected.</p>" : "<p>Use the Select tool to Move, Rotate, Scale, Delete, and reorganize the layers of your design.<br><br>");
      return this
    };
  this.checkForSingleSelection = function() {
    if (!a.feature.vector.edit) return this;
    var b = 0,
      d = g.selection.items,
      c;
    for (c in d) b++;
    if (0 === b) return a.ui.buildConfigure && a.ui.buildConfigure(), this;
    if (1 < b) {
      g.selection.id = void 0;
      g.selection.idx = void 0;
      g.controls = [];
      if (a.ui.buildConfigure) {
        var e, b = !0,
          k;
        for (k in d)
          if (d = g.data[k].type, e = e || d, e !== d) {
            b = !1;
            a.ui.buildConfigure();
            break
          }
        b && a.ui.buildConfigure(e)
      }
      return this
    }
    g.selectByIndex(parseInt(c));
    e = g.data[g.selection.idx];
    if (!e) return a.feature.debug && console.log(g.selection.idx, d, g.data), this;
    a.ui.buildConfigure && a.ui.buildConfigure(e.type);
    "text" === e.type && a.toolkit.text.textarea && (a.toolkit.text.textarea.innerHTML = e.content, a.toolkit.text.textarea.style.color =
      e.fillStyle, e.toolkit.updateObjectSize());
    return e
  };
  var b = /[^a-zA-Z]/g,
    h = /[^0-9]/g,
    d = function(a, b) {
      return a.zIndex > b.zIndex ? 1 : -1
    },
    e = function(a, b) {
      return a.id > b.id ? 1 : -1
    },
    m = function(a, d) {
      var c = a.name || "",
        e = d.name || "",
        k = c.replace(b, ""),
        f = e.replace(b, "");
      return k === f ? (k = parseInt(c.replace(h, ""), 10), f = parseInt(e.replace(h, ""), 10), k === f ? 0 : k > f ? 1 : -1) : k > f ? 1 : -1
    };
  this.sort = function(a) {
    switch (a) {
      case "name":
        this.data.sort(m);
        break;
      case "id":
        this.data.sort(e);
        break;
      default:
        this.data.sort(d)
    }
  };
  this.reindex = function() {
    for (var a =
        this.data, b = this.selection.items, d = [], c = 0, e; c < a.length; c++)
      if (e = a[c]) b[e.zIndex] && (delete b[e.zIndex], d.push(c), this.selection.length--), e.zIndex = c;
    for (c = 0; c < d.length; c++) b[d[c]] = !0, this.selection.length++;
    this.hovered.reset();
    this.updateSelectionInfo()
  };
  this.createId = function(b, d) {
    var c = this.data;
    if (d) {
      for (var e = a.util.INFINITY_MINUS_8bit, k = 0; k < c.length; k++) {
        var f = c[k].id;
        f > e && (e = c[k].id)
      }
      return e + 1
    }
    if (b && (e = typeof b, ("string" === e || "number" === e) && !this.getById(b))) return b;
    for (k = e = 0; k < c.length; k++) f =
      c[k].id, !(f > a.util.INFINITY_MINUS_8bit) && f > e && (e = c[k].id);
    return e + 1
  };
  var k = a.util.array2object(["id", "zIndex", "clamp", "data"]);
  this.createHash = function(b, d) {
    for (var c = "", e = [b], f = a.detect.useLocalAlpha; e.length;) {
      b = e.shift();
      for (var h in b) {
        var l = b[h];
        if (null !== l && void 0 !== l && !r[h] && !k[h])
          if ("fill" === h || "stroke" === h)(l = l[l.type]) && (c += l.substr(0, 256));
          else if ("opacity" === h) f[b.type] && (c += h + ":" + l);
        else if ("scale" !== h || b.type)
          if ("src" === h) c += l.substr(0, 256);
          else if ("bbox" === h) c += "width:" + b.bbox.width,
          c += "height:" + b.bbox.height, c += "padding:" + b.bbox.padding, b.bbox.scale && (l = b.bbox.scale, c += "scale:" + l.x + "," + l.y);
        else {
          var m = typeof l;
          "string" === m ? c += h + ":" + l.substr(0, 256) : "number" === m ? c += h + ":" + l : "object" !== m ? c += h + ":" + l : l.childNodes || l.getImageData || l && e.push(l)
        }
      }
    }
    e = 5381;
    f = 0;
    for (h = c.length; f < h; f++) e = (e << 5) + e + c.charCodeAt(f);
    return e
  };
  this.clone = function(a, b) {
    if (!a || !a.constructor || "object" !== typeof a) return a;
    if (!a.childNodes && !a.getImageData) {
      var d = new a.constructor,
        c;
      for (c in a) {
        var e = a[c];
        if (!r[c]) {
          if (b &&
            "string" !== typeof e)
            if ("fill" === c) {
              d[c] = e[e.type];
              continue
            } else if ("stroke" === c) {
            d[c] = e[e.type];
            continue
          }
          d[c] = e && "object" === typeof e ? this.clone(e, b) : e
        }
      }
      return d
    }
  };
  this.decompress = function(b) {
    "string" === typeof b.fill && (b.fill = new a.style.Fill(b.fill));
    "string" === typeof b.stroke && (b.stroke = new a.style.Stroke(b.stroke));
    return b
  };
  this.getJSON = this.stringify = function(a) {
    a = a || g.data;
    return JSON.stringify(g.clone(a, !0))
  };
  this.copyAttributes = function(b, d, c) {
    if (d && c) {
      for (var e in b) {
        var k = b[e],
          f = d[e],
          h = c[e];
        if ("undefined" !== typeof f)
          if ("style" === k) {
            if (h && h.color === f.color && h.gradient === f.gradient && h.pattern === f.pattern && h.type === f.type)
              if (h instanceof a.style.Stroke) {
                if (h.lineWidth === f.lineWidth) continue
              } else continue;
            c[e] = a.util.clone(f)
          } else "object" === k ? h && h.min === f.min && h.max === f.max || (c[e] = a.util.clone(f)) : h !== f && (c[e] = "undefined" === typeof f.value ? f : f.value)
      }
      return c
    }
    a.feature.debug && console.log("sk.scene.copyAttributes", arguments)
  };
  this.copyRules = function(b, d) {
    return this.copyAttributes(a.attributes.rules,
      b, d)
  };
  this.ensureStickyIndex = function(b) {
    b.useStickToBack && (b.zIndex = -1);
    b = a.util.INFINITY_MINUS_8bit;
    for (var d = 0; d < this.data.length; d++) {
      var c = this.data[d];
      c.useStickToFront && (c.zIndex = b++)
    }
  };
  var l = function(b) {
    if (!alertify.log_visible()) {
      b = b.useMaxCopies;
      var d = 1 < b ? "copies" : "copy",
        c = a.language.translate("useMaxCopies-alert");
      alertify.log(c.split("{maxCopies}").join(b).split("{plural}").join(d))
    }
  };
  this.ensureMaxCopies = function(b) {
    if ("string" !== typeof b.src) return !0;
    var d = this.data,
      c = {},
      e = b.src,
      k = a.lib[b.type],
      f = k && k.getEntry(e);
    if (f) {
      var h = f.folder;
      if ((f = k.meta[h]) && f.useMaxCopies) {
        for (var m = k.tree[h], k = 0; k < m.length; k++)
          for (var h = m[k].filepath, g = 0; g < d.length; g++) {
            var r = d[g];
            if ("undefined" !== typeof r.src && r.id !== b.id && (e = r.src, e !== h && (e = (e = a.assets.getItem(r.src, r.type)) && e.src || r.src), e === h && (c[e] || (c[e] = 0), e = ++c[e], e >= f.useMaxCopies))) return b.useMaxCopies = f.useMaxCopies, l(b), !1
          }
        return !0
      }
    }
    h = e;
    for (k = 0; k < d.length; k++)
      if (r = d[k], "undefined" !== typeof r.src && (r.id !== b.id && (b.useMaxCopies || r.useMaxCopies)) &&
        (e = (f = a.lib[r.type].getEntry(r.src)) && f.src || r.src, a.assets.isEqual(e, h) && (c[e] || (c[e] = 0), e = ++c[e], e >= r.useMaxCopies))) return l(b), !1;
    return !0
  };
  var r = a.util.array2object("callback hash render renderCache scaleCache breaks brush element canvas canvasCtx dirty dirtyCache dirtyCacheForce dirtyTransform dirtyControl dirtyResource selected hovered inbounds placement placementRelative ctx trx svg toolkit __pattern __gradient __color __colors __textMetrics".split(" "));
  this.data = [];
  this.dataById = {};
  this.copies = [];
  this.controls = [];
  this.selection = new sketch.SceneSelection(a);
  this.hovered = new sketch.SceneSelection(a);
  return this
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.Scene);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.toolkit && (sketch.toolkit = {});
(function(a) {
  a.toolkit.setMedia = function(b) {
    var c = b.type,
      f = b.src,
      k = b.onload,
      h = b.onprogress,
      g = b.onerror;
    !1 === a.feature.vector.edit && "text" !== a.tool.type && a.scene.deselectAll();
    var p = a.selection.items,
      q = "select" === a.tool.type,
      t = a.scene.data[a.selection.idx],
      t = a.configure.tools,
      s = [],
      w = [];
    switch (c) {
      case "text":
        var v = b.fontFamily || b.name;
        a.toolkit.text.style.fontFamily = v;
        t[c].fontFamily = v;
        for (var u in p)(t = a.scene.data[u]) && "text" === t.type && (s.push({
            id: t.id,
            fontFamily: t.fontFamily
          }), w.push({
            id: t.id,
            fontFamily: v
          }),
          t.fontFamily = v, t.dirtyResource = !0);
        break;
      case "image":
      case "clipart":
      case "stamp":
        for (u in "stamp" === c ? (f = f.replace("thumb", "live"), t[c].src = f) : (f = f.replace(".png", ".svg").replace("-preview", ""), t[c].src = f, t = a.toolkit.media, t.style.src = f, t.style.render = void 0), p)
          if (t = a.scene.data[u], "image" === t.type && "clipart" === c ? t.type = "clipart" : "clipart" === t.type && "image" === c && (t.type = "image"), t && t.type === c)
            if (p = t.src, t.src = f, !1 === a.scene.ensureMaxCopies(t)) t.src = p;
            else {
              var p = {
                  id: t.id,
                  src: p
                },
                y = {
                  id: t.id,
                  src: f
                },
                x =
                a.lib[t.type].getEntry(t.src);
              if (x)
                for (v in a.attributes.rules) "undefined" === typeof x[v] ? "undefined" !== typeof t[v] && (p[v] = t[v], y[v] = "", delete t[v]) : (p[v] = t[v], y[v] = x[v], t[v] = x[v]);
              s.push(p);
              w.push(y);
              t.dirtyResource = !0;
              t.dirty = !0
            }
    }
    s.length && w.length ? (a.selection.length && (a.active.canvas.width = a.active.canvas.width), a.history && a.history.store({
      from: s,
      to: w,
      name: "Change Media"
    }), a.render.preload({
      onerror: g,
      onprogress: h,
      onload: k
    })) : a.toolkit.setTool(c, function() {
      q ? a.toolkit.setTool("select") : a.ui.setToolMenu &&
        a.ui.setToolMenu(a.tool.type);
      if (b.onload) b.onload()
    })
  };
  a.addMedia = function(d, e, f, k) {
    var l = d.blob || d.element || d,
      r = l.slice && "string" === typeof l.type,
      p = !!d.openAsNew;
    e = e || d.onload;
    k = k || d.onprogress;
    f = f || d.onerror;
    var q = d.thumb,
      t;
    if (isFinite(d.x) && isFinite(d.y)) t = {
      x: d.x,
      y: d.y
    };
    else if (d.event) {
      var s = eventjs.proxy.getBoundingBox(a.canvas2d.container);
      t = a.scene.getPointInCanvas({
        x: t.x - s.x1 - s.scrollBodyLeft,
        y: t.y - s.y1 - s.scrollBodyTop
      })
    } else t = a.toolkit.getCenterPoint();
    var w, v;
    r ? l.lastModifiedDate ? (w = w ||
      l.src || l, v = STRING.extension(l.name)) : (w = URL.createObjectURL(l), v = (l.type || "image/png").split("/").pop()) : l.src ? (w = l.src, v = STRING.extension(w)) : w = l;
    w.indexOf && (0 === w.indexOf("<svg") && (w = '<?xml version="1.0" encoding="UTF-8"?>' + w), 0 === w.indexOf("<?xml") && (w = "data:image/svg+xml;base64," + btoa(w), v = "svg"));
    if (q) return q.width = q.width || d.width, q.height = q.height || d.height, !q.croparea || isFinite(q.width) && isFinite(q.height) || (q.width = q.croparea[2] - q.croparea[0], q.height = q.croparea[3] - q.croparea[1]), q.src =
      w, q.onload = function(b) {
        delete d.thumb;
        delete d.element;
        delete d.blob;
        delete d.src;
        d.element = b;
        a.addMedia(d, e, f, k)
      }, a.util.thumbnailer(q);
    if (l.toDataURL) return l.toBlob(function(b) {
      delete d.element;
      delete d.blob;
      delete d.src;
      d.blob = b;
      a.addMedia(d, e, f, k)
    });
    var u = {
      data: {},
      add: function(a) {
        u.data[a] = !0
      },
      run: function(b) {
        a.loader.stop();
        var d = u.data;
        d.clipart && d.stamp && delete d.clipart;
        for (var c in u.data) u.callbacks[c]();
        u.callbacks.callback(b)
      },
      callbacks: {
        callback: function(a) {
          if (e !== d.onload) d.onload();
          e && e(a)
        },
        text: function() {
          a.ui.setToolMenu && (a.ui.setToolMenu("text"), a.ui.buildConfigure("text", !0));
          a.toolkit.setTool("text")
        },
        stamp: function() {
          a.ui.setToolMenu && (a.ui.setToolMenu("stamp"), a.ui.buildConfigure("stamp", !0));
          a.toolkit.setTool("stamp")
        },
        clipart: function() {
          a.configure.tools.clipart.opacity.value = 100;
          a.toolkit.setTool("clipart");
          a.exec("select")
        },
        image: function() {
          a.configure.tools.clipart.opacity.value = 100;
          a.toolkit.setTool("clipart");
          a.exec("select")
        },
        color: function() {
          a.palette.update("color", !0);
          sk.windows.open("sk-palette")
        },
        gradient: function() {
          a.palette.update("gradient", !0);
          sk.windows.open("sk-palette")
        },
        pattern: function() {
          a.palette.update("pattern", !0);
          sk.windows.open("sk-palette")
        }
      }
    };
    if (r) switch (v) {
      case "zip":
        return c(l, u);
      case "json":
        return a.open.json(l, a.on.sketchReady, a.on.sketchReady);
      case "sketch":
        return a.open.zip(l);
      case "woff":
        return console.log("woff", l), u.run();
      case "pat":
        return console.log("pat", l), u.run();
      case "abr":
        return u.add("stamp"), g("ABR", l, u.run);
      case "gbr":
        return u.add("stamp"),
          g("GBR", l, u.run);
      case "ggr":
        return u.add("gradient"), a.style.addFromBlob(l, u.run);
      case "gpl":
        return u.add("color"), a.style.addFromBlob(l, u.run);
      case "pdf":
        return b(l, t, u.run, !0, p);
      case "psd":
        return h(l, t, u.run, !0, p)
    }
    if ("string" !== typeof w) return console.log("unrecognized", l);
    "{" === w.substr(0, 1) ? a.open.json(w, a.on.sketchReady, a.on.sketchReady) : (l = "function" === typeof a.toolkit.__init.media, r = function(b) {
      p ? a.exec("new-prompt", function() {
        a.open[v]({
          src: b,
          openAsNew: p,
          callback: function() {
            u.run()
          }
        })
      }) : a.scene.add({
        type: v,
        src: b,
        width: d.width,
        height: d.height,
        x: t.x,
        y: t.y
      }, function(a) {
        u.run(a)
      })
    }, "svg" === v ? l ? (u.add("clipart"), v = "clipart", a.assets.addClipart(w, r, f, k)) : a.open.svg(w) : l && (u.add("image"), v = "image", a.assets.addImage(w, r, f, k)))
  };
  var g = function(b, c, f) {
      var k = a.convert["blobTo" + b];
      if (k) {
        var h = "decoding ." + b;
        a.loader.decode = a.loader.decode || a.loader.add(h);
        a.loader.files = a.loader.files || a.loader.add("...");
        k(c, function(b, d, c, e) {
          a.loader.update(a.loader.decode, h, Math.max(0, c - 1) >> 0);
          a.loader.update(a.loader.files,
            d.name || "untitled");
          a.assets.addStamp(b, function(b, d) {
            100 === c ? (a.loader.update(a.loader.decode, h, 99), f && f()) : e && e()
          })
        })
      } else a.feature.debug && console.log("missing .abr support"), f && f()
    },
    c = function(b, c) {
      a.io.zip.getEntries(b, function(f) {
        if (f.some(function(a, b, d) {
            return "sketch.json" === a.filename
          })) a.io.zip.open(b);
        else {
          var k = a.loader.add("opening zip..."),
            h = a.loader.add("...");
          a.io.zip.decode({
            entries: f,
            oncomplete: function() {
              a.loader.stop();
              c.run()
            },
            onchange: function(f) {
              var m = f.blob,
                q = f.filename,
                t =
                f.next,
                s = STRING.extension(q),
                s = "undefined" === m.type ? s : m.type;
              a.loader.update(k, "opening zip...", f.percent);
              a.loader.update(h, STRING.basename(q));
              switch (s) {
                case "application/json":
                  "sketch.json" === q ? (a.loader.stop(), a.io.zip.open(b)) : t();
                  break;
                case "image/jpeg":
                case "image/gif":
                case "image/png":
                case "jpeg":
                case "png":
                case "gif":
                  c.add("clipart");
                  a.assets.addImage(m, t);
                  break;
                case "image/svg+xml":
                case "svg":
                  c.add("clipart");
                  a.assets.addClipart(m, t);
                  break;
                case "abr":
                  c.add("stamp");
                  g("ABR", m, t);
                  break;
                case "gbr":
                  c.add("stamp");
                  g("GBR", m, t);
                  break;
                case "ggr":
                  c.add("gradient");
                  a.style.addFromBlob(m, t);
                  break;
                case "gpl":
                  c.add("color");
                  a.style.addFromBlob(m, t);
                  break;
                default:
                  t()
              }
            },
            onprogress: function(b, d, c) {
              a.loader.update(k, "opening zip...", b);
              a.loader.update(h, STRING.basename(c))
            }
          })
        }
      })
    },
    f = function(b, c, f, k) {
      a.ui.confirm({
        message: "clear-confirm",
        callback: function(a) {
          a && b(c, f, k)
        },
        labels: {
          ok: "Open Project",
          cancel: "Cancel"
        }
      })
    },
    b = function(d, c, h, k, l) {
      if (k && l) return f(b, d, c, h);
      var g = a.loader.add("opening pdf...");
      d = URL.createObjectURL(d);
      PDFJS.getDocument(d).then(function(b) {
        var d = [],
          f = 0,
          k = 0,
          w = new a.util.Queue({
            range: {
              from: 1,
              to: b.numPages
            },
            callback: function() {
              a.loader.update(g, null, 100);
              if (l) {
                a.exec("new");
                var b = a.area.padding / 2;
                a.project.setSize(k, f);
                a.project.pages = {};
                a.project.pages.data = [];
                a.project.pages.current = 0;
                a.project.pages.length = d.length;
                var p = 0;
                new a.util.Queue({
                  items: d,
                  flatten: !0,
                  callback: function() {
                    a.exec("select");
                    a.exec("zoom-reset");
                    a.scene.selectByIndex(x, !1)
                  },
                  next: function(c, e, f) {
                    c = d[f];
                    a.project.pages.data[f] = {
                      src: c.src,
                      width: c.width,
                      height: c.height
                    };
                    a.scene.add({
                      type: "image",
                      src: c.src,
                      width: c.width,
                      height: c.height,
                      points: [{
                        x: a.canvas2d.x + c.width / 2 + b,
                        y: a.canvas2d.y + p + (c.height / 2 + b)
                      }]
                    }, this.next);
                    p += c.height
                  }
                })
              } else {
                var w = d.length - 1;
                c = c || a.toolkit.getCenterPoint();
                c.x -= 10 * w;
                c.y -= 10 * w;
                var x = {},
                  z = new a.util.Queue({
                    items: d,
                    flatten: !0,
                    callback: function() {
                      a.exec("select");
                      a.scene.selectByIndex(x, !1);
                      a.render("helpers.addPDF");
                      h && h()
                    },
                    next: function(b, d, f) {
                      z = this;
                      a.scene.add({
                        type: "image",
                        src: b.src,
                        points: [{
                          x: c.x +
                            10 * f,
                          y: c.y + 10 * f
                        }]
                      }, function(a) {
                        x[a.zIndex] = !0;
                        z.next()
                      })
                    }
                  })
              }
            },
            next: function(c) {
              w = this;
              b.getPage(c).then(function(e) {
                var h = e.getViewport(2),
                  l = a.util.Canvas(h.width, h.height);
                e.render({
                  canvasContext: l.ctx,
                  viewport: h,
                  callback: function() {
                    k = Math.max(l.width, k);
                    f += l.height;
                    l.toBlobURL(function(e) {
                      a.loader.update(g, null, 100 * (c / b.numPages) >> 0);
                      d.push({
                        src: e,
                        width: l.width,
                        height: l.height
                      });
                      w.next()
                    })
                  }
                }).then(function() {})
              })
            }
          })
      })
    },
    h = function(b, c, f, k, h) {
      f = new FileReader;
      f.onload = function(b) {
        b = new Uint8Array(b.target.result);
        b = new PSD.Parser(b);
        b.parse();
        a.addMedia({
          element: b.imageData.createCanvas(b.header, b.colorModeData),
          x: c.x,
          y: c.y
        })
      };
      f.readAsArrayBuffer(b)
    };
  a.toolkit.addBackground = function(b, c) {
    "string" === typeof b && (b = {
      src: b,
      name: b,
      type: b
    });
    var f = function(c, e, f, k) {
        c = {
          type: e,
          src: c,
          name: "background",
          useStickToBack: !0,
          selectable: !1
        };
        f / k < h / g ? (c.useConstrainX = !0, c.useAlignY = "top", c.bbox = {}, c.bbox.width = h, c.bbox.height = k / f * h) : (c.useConstrainY = !0, c.useAlignX = "left", c.bbox = {}, c.bbox.width = f / k * g, c.bbox.height = g);
        c.bbox.owidth =
          c.bbox.width;
        c.bbox.oheight = c.bbox.height;
        c.bbox.x = (h - c.bbox.width) / 2;
        c.bbox.y = (g - c.bbox.height) / 2;
        c.fill = {
          gradient: "",
          color: b.color || "rgba(0,0,0,1)",
          type: "color"
        };
        a.scene.removeByName("background");
        f = a.scene.addObject(c);
        a.feature.vector.edit && a.history && a.history.store({
          from: "add",
          to: [f],
          name: "Add Background"
        });
        return f
      },
      k = a.tool.type,
      h = a.canvas2d.width,
      g = a.canvas2d.height;
    b.type && -1 !== b.type.indexOf("svg") ? (a.toolkit.setTool("clipart"), a.tool.style.src = "#" + b.name, a.tool.loadResource({
      action: a.tool.style,
      onload: function() {
        f(a.tool.style.src, "clipart", a.tool.style.bbox.width, a.tool.style.bbox.height);
        c && c(action)
      }
    })) : dom.loadImage({
      src: b.src,
      onprogress: onprogress,
      onerror: function(c) {
        a.feature.debug && console.log("failed to load: " + b.src);
        onerror && onerror()
      },
      onload: function() {
        var h = "blob:" === b.src.substr(0, 5) ? this.toDataURL() : b.src,
          l = this.width,
          g = this.height,
          h = "#" + b.name;
        a.configure.tools.image.src = h;
        a.toolkit.setTool("image");
        var r = f(h, "image", l, g);
        r.toolkit.loadResource({
          action: r,
          onload: function() {
            a.toolkit.setTool(k);
            a.render("root.toolkit.addBackground");
            c && c(r)
          }
        })
      }
    })
  };
  a.toolkit.addBackgroundColor = function(b) {
    var c = a.tool.type;
    a.style && (a.style.fill.color = b);
    a.toolkit.setTool("rectangle");
    b = a.canvas2d.container;
    a.scene.add({
      type: "rectangle",
      points: [{
        x: b.offsetWidth / 2,
        y: b.offsetHeight / 2
      }, {
        x: b.offsetWidth / 2,
        y: 0
      }]
    });
    b = a.scene.data[a.scene.data.length - 1];
    b.zIndex = -1;
    b.useConstrain = !0;
    b.useStickToBack = !0;
    b.useStretchToEdge = !0;
    a.toolkit.setTool(c);
    a.scene.sort();
    a.render("root.toolkit.addBackgroundColor")
  };
  a.toolkit.addFromDrag =
    function(b) {
      -1 !== String(b).indexOf("Event") && (b = {
        target: this,
        src: this.src
      });
      var c = b.target,
        f = b.event,
        k = b.src || c.getAttribute("data-src") || c.src,
        h = b.type || c.getAttribute("data-type") || "clipart";
      a.assets.add(k);
      var g = c.cloneNode(!0);
      "[object HTMLCanvasElement]" === g.toString() && g.getContext("2d").drawImage(c, 0, 0);
      var p = (c.offsetWidth - parseInt(c.width)) / 2;
      g.id = "addFromDrag";
      g.style.position = "absolute";
      g.style.opacity = 1;
      g.style.zIndex = 1E6;
      g.style.display = "block";
      g.style.border = "1px solid transparent";
      g.style.margin = p + "px";
      var p = sk.util.getMetrics(c),
        q = p.padding,
        t = q[2] + q[3],
        s = p.border,
        w = q[0] + s[0],
        v = q[2] + s[2],
        u = p.width,
        y = p.height;
      g.style.width = u - (q[0] + q[1]) + "px";
      g.style.height = y - t + "px";
      return eventjs.proxy.drag({
        position: "move",
        target: c,
        event: f,
        listener: function(f, m) {
          if (!a.toolkit.media) return console.log("Missing 'sketch.toolkit.media'");
          var p = eventjs.proxy.getCoord(f);
          if ("down" === m.state) {
            var p = eventjs.proxy.getCoord(f),
              q = eventjs.proxy.getBoundingBox(m.target);
            m.offset = {};
            m.offset.x = q.width / 2 -
              (p.x - m.x);
            m.offset.y = q.height / 2 - (p.y - m.y);
            eventjs.prevent(f)
          }
          var s = m.bbox.scrollBodyTop,
            t = m.bbox.scrollBodyLeft;
          g.style.left = m.x + t + w - 1 + "px";
          g.style.top = m.y + s + v - 1 + "px";
          if (!g.addedToDOM) {
            var q = Math.abs(m.x - m.start.x),
              F = Math.abs(m.y - m.start.y);
            if (q > u / 2 || F > y / 2) g.addedToDOM = !0, document.body.appendChild(g)
          }
          if ("up" === m.state) {
            var F = p.x - t,
              C = p.y - s;
            g.style.display = "none";
            if ((q = document.elementFromPoint(F, C)) && "active" === q.id) {
              a.scene.deselectAll();
              a.render("root.toolkit.addFromDrag");
              q = a.toolkit.media;
              q.style.useMinWidth =
                1;
              q.style.useMaxWidth = 2E3;
              var q = eventjs.proxy.getBoundingBox(a.canvas2d.container),
                F = a.canvas2d.zoom,
                C = a.canvas2d.y + a.project.y * F,
                F = p.x - q.x1 - q.scrollBodyLeft + m.offset.x + t - (a.canvas2d.x + a.project.x * F),
                C = p.y - q.y1 - q.scrollBodyTop + m.offset.y + s - C,
                E = a.tool.type,
                q = eventjs.proxy.getBoundingBox(c);
              a.addObject({
                type: h,
                src: k,
                x: F,
                y: C,
                width: 100,
                height: 100,
                callback: function(c) {
                  a.tool.type !== E && a.toolkit.setTool(E);
                  if (b.ondrop) b.ondrop(c);
                  a.on.select && a.on.select([c])
                }
              })
            } else a.toolkit.exportDrop(k, F, C);
            g.addedToDOM &&
              document.body.removeChild(g)
          }
        }
      })
    };
  a.toolkit.exportDrop = function(b, c, f) {
    !a.feature.exportDrop || 0 < c && 0 < f && c < window.innerWidth && f < window.innerHeight || (c = a.scene.getFocused(), a.assets.add({
      src: b,
      type: c ? c.type : a.tool.type,
      onload: function(c) {
        var e = (STRING.basename(b) || "").split(".").shift();
        this.vob ? a.download.blob(new Blob([this.stringify()], {
          type: "image/svg+xml"
        }), e + ".svg") : a.assets.getBlob(c, function(b) {
          a.download.blob(b, e + ".png")
        })
      }
    }))
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.addObject = function(g, c, f, b) {
    if ("undefined" !== typeof g) {
      c = c || g.callback || function() {};
      f = f || g.onerror || function() {};
      var h = g.type;
      if (g.length || g.data && !h) {
        var d = g.data || g;
        c = g.onload || c;
        f = g.onerror || f;
        if (isFinite(g.scale))
          for (var e = g.scale, m = 0; m < d.length; m++) {
            var k = d[m];
            "undefined" === typeof k || k.useStretchToEdge || (k.bbox || (k.bbox = {
              x: 0,
              y: 0
            }), k.bbox.x *= e, k.bbox.y *= e, "text" === k.type ? k.fontSize *= e : (k.bbox.scale || (k.bbox.scale = {
              x: 1,
              y: 1
            }), k.bbox.scale.x *= e, k.bbox.scale.y *= e))
          }
        new a.util.Queue({
          items: d,
          flatten: !0,
          callback: function() {
            c && c()
          },
          next: function(d) {
            var c = this;
            a.addObject(d, function(a) {
              c.next()
            }, function(a) {
              c.next()
            }, b)
          }
        })
      } else {
        if (!a.toolkit.exists(h)) return a.feature.debug && console.log("'" + h + "' toolkit not found."), f();
        a.render.dirtyControls = !0;
        var l = a.configure.tools[h];
        if (!0 !== b) {
          if ("media" === l.toolkit && g.src) return a.assets ? a.assets.add({
              type: h,
              targetId: g.targetId,
              src: g.src,
              onload: function(b, d) {
                var e = a.toolkit.media;
                e.style.src = l.src = g.src = b;
                e.style.render = null;
                a.addObject(g, c, f, !0)
              }
            }) :
            console.log("missing 'sketch.assets'");
          if ("text" === l.toolkit && g.fontFamily && (!a.vector.text.supports[l.fontFamily] || l.fontFamily !== g.fontFamily)) return a.toolkit.text.loadFont({
            fontFamily: g.fontFamily,
            onload: function() {
              l.fontFamily = g.fontFamily;
              a.addObject(g, c, f, !0)
            }
          })
        }
        if (h && h !== a.tool.type) {
          var r = g.fromSocket ? "tool-socket" : "tool";
          return a.toolkit.setTool(h, {
            tid: r,
            callback: function() {
              a[r].addObject(g, c, f, b)
            }
          })
        }
        d = a.tool;
        for (k in g) switch (k) {
          case "style":
            d.setStyle(g.style);
            break;
          case "color":
            d.setColor(g.color);
            break;
          case "gradient":
            d.setGradient(g.gradient)
        }
        g.fillStyle && (a.configure.tools[h].fill.color = g.fillStyle);
        a.scene.decompress(g);
        var k = g.bbox = g.bbox || {},
          m = g.width,
          p = g.height,
          q = a.toolkit.getCenterPoint(),
          e = g.scale || k.scale || 1;
        isFinite(e) && (e = {
          x: e,
          y: e
        });
        k.scale = k.scale || e;
        k.rotate = k.rotate || g.rotate || 0;
        k.x = k.x || g.x || q.x;
        k.y = k.y || g.y || q.y;
        k.width = k.width || g.width;
        k.height = k.height || g.height;
        k.padding = k.padding || g.padding || 0;
        k.units = k.units || g.units || "objectBoundingBox";
        isFinite(k.x) && (k.x += a.project.x);
        isFinite(k.y) && (k.y += a.project.y);
        g.points || g.data ? (e = g.points || g.data, "string" === typeof e && (e = "M" === e[0] ? a.vector.SVGPath.toVOBPath(e) : a.vector.SVGPath.toVOBPolygon(e))) : e = [{
          x: k.x,
          y: k.y
        }];
        q = e[0];
        q.cmd = "M";
        if (1 === e.length)
          if (m && p) {
            var t = a.canvas2d.zoom;
            e.push({
              cmd: "L",
              x: q.x + m * t / 2,
              y: q.y + p * t / 2
            })
          } else if (a.detect.mediaKit[h]) {
          var p = a.canvas2d.layers.layer0,
            m = p.width,
            p = p.height,
            t = d.style.bbox.viewBox,
            s = t[2],
            w = t[3],
            v = s - t[0],
            u = w - t[1],
            t = v / u;
          s > w ? (m = Math.min(m / 4, v), p = m / v * u, v = k.scale.x || 1, 1 !== v && (v = m / 2 * (v -
            1), k.x -= v, k.y -= 1 / t * v)) : (p = Math.min(p / 4, u), m = p / u * v, v = k.scale.y || 1, 1 !== v && (v = p / 2 * (v - 1), q.x -= t * v, q.y -= v));
          "userSpaceOnUse" === k.units && (k.x += m / 2, k.y += p / 2);
          t = a.canvas2d.zoom;
          v = a.canvas2d.y + a.project.y * t;
          k.x -= a.canvas2d.x + a.project.x * t;
          k.y -= v;
          q.x -= m / 2;
          q.y -= p / 2;
          e.push({
            cmd: "L",
            x: q.x + m / 2,
            y: q.y + p / 2
          })
        } else if ("text" === h) {
          p = a.scene.fromConfigure(a.configure.tools.text);
          a.util.mergeObject(g, p);
          t = a.vector.text.getFontStyle(p);
          v = a.vector.text.textTransform(g.content, p.textTransform).split("\n");
          u = m || 0;
          for (m = s =
            0; m < v.length; m++) w = a.vector.text.format(v[m], p), w = a.vector.text.measureText(w, t), w.width > u && (u = w.width), s += w.height;
          m = a.util.clone(q);
          q.x -= u / 2 + 5;
          q.y -= s / 2;
          m.x += u / 2 + 5;
          m.y += s / 2;
          m.cmd = "L";
          e.push(m)
        } else if ("floodfill" === h) e.push(q);
        else if ("group" === h) e.push(q);
        else return c && c(), console.log("missing viewbox");
        2 === e.length && e.push({
          cmd: "z",
          x: e[1].x,
          y: e[1].y
        });
        if (a.detect.brush[h] || a.detect.shape[h]) q = d.getDevice(h), a.scene.copyAttributes(d.attributes, g, q), d.deviceProxy.place = q;
        var q = function() {
            y()
          },
          y =
          function(b) {
            (b = a.area.exitGenesis(!0) || a.scene.getOneSelected()) && a.scene.updateConstrain(b);
            b && "text" === b.type && a.scene.deselectAll();
            a.dataChannel && (a.feature.stream.sketch && b && "image" === b.type) && a.dataChannel.send(["scene.update", [{
              id: b.id,
              bbox: b.bbox
            }]]);
            c && c(b)
          },
          h = a.detect.shape[h] ? new d.record : d.record;
        if (d.createObject) return d.createObject({
          action: g,
          bbox: k,
          points: e,
          device: d.deviceProxy.place
        }, y);
        for (m = 0; m < e.length; m++) switch (d = e[m], p = d.cmd || d.state, "undefined" === typeof p && (p = 0 === m ? "M" : m ===
          e.length - 1 ? "z" : "L"), d = {
          identifier: "place",
          x: d.x,
          y: d.y,
          action: g,
          bbox: k,
          start: e[0]
        }, p) {
          case "down":
          case "M":
            d.state = "down";
            h(null, d, q);
            break;
          case "move":
          case "L":
            d.state = "move";
            h(null, d);
            break;
          case "up":
          case "z":
            d.state = "up", h(null, d, y)
        }
      }
    }
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.area && (sketch.area = {});
"undefined" === typeof sketch.events && (sketch.events = {});
(function(a) {
  a.area.contextEvent = function(b) {
    eventjs.cancel(b);
    a.area.hideArea();
    a.render("root.area.contextMenu");
    var c = eventjs.proxy.getCoord(b);
    b = eventjs.proxy.getBoundingBox(b.target);
    contextmenu.show(a.ui.menuSelect, c.x - b.scrollBodyLeft + 5, c.y - b.scrollBodyTop + 5, !0)
  };
  a.area.deleteEvent = function(b) {
    var c = b.target,
      d = function() {
        eventjs.remove(c, "mouseup", d);
        if ((a.scene.controls[1] || {}).hovered) {
          a.area.hide();
          a.selection.remove();
          var b = 0,
            f = setInterval(function() {
              a.active.save();
              a.active.globalAlpha =
                0.25;
              a.active.globalCompositeOperation = "destination-out";
              a.active.fillRect(0, 0, a.active.canvas.width, a.active.canvas.width);
              a.active.restore();
              10 < ++b && (clearInterval(f), a.render("root.deleteAction"))
            }, 25)
        }
      };
    eventjs.cancel(b);
    eventjs.add(c, "mouseup", d)
  };
  a.area.moveEvent = function(b) {
    var c = a.canvas2d.zoom;
    eventjs.proxy.drag({
      event: b,
      target: a.active.canvas,
      position: "absolute",
      listener: function(b, e) {
        eventjs.cancel(b);
        if (1 === a.selection.length) {
          var f = a.scene.getFocused();
          if (f.brush && f.brush.move) {
            f.brush.move(e);
            return
          }
        }
        window.contextmenu && contextmenu.visible && (e.pause(), e.state = "up");
        a.toolkit.select.isMoving = "up" !== e.state;
        switch (e.state) {
          case "down":
            a.selection.move(0, 0, "cache");
            break;
          case "move":
            a.selection.move((e.x - (e.px || 0)) / c, (e.y - (e.py || 0)) / c, "move");
            break;
          case "up":
            a.selection.move(0, 0, "record")
        }
        e.px = e.x;
        e.py = e.y
      }
    })
  };
  a.area.scaleEvent = function(b) {
    a.events.resize(b, !1, !0)
  };
  a.area.rotateEvent = function(b) {
    a.events.resize(b, !0, !1)
  };
  a.area.rotateScaleEvent = function(b) {
    a.events.resize(b, !0, !0)
  };
  a.events.resize =
    function(b, c, d) {
      a.area.hideArea();
      a.render("root.events.resize");
      var e = a.scene.getFocused() || a.scene.getHovered();
      if (e) {
        var f = a.canvas2d,
          k = e.bbox,
          l = a.util.clone(k),
          g = null,
          p = null,
          q = null,
          t = {};
        a.util.clone(k.scale);
        var s, w, v = {},
          u = eventjs.shiftKey,
          y = eventjs.altKey,
          x = a.feature.canvas.useGroupBoundingBox || y ? a.scene.getBoundingOrigin({
            fromSelection: !0
          }) : a.scene.getBoundingOrigin(k),
          z = "objectBoundingBox" === k.units,
          A, B;
        return eventjs.proxy.drag({
          position: "relative",
          event: b,
          target: a.active.canvas,
          listener: function(b,
            y) {
            eventjs.cancel(b);
            window.contextmenu && contextmenu.visible && (y.pause(), y.state = "up");
            A = "down" === y.state;
            B = "up" === y.state;
            a.toolkit.select.isMoving = !B;
            if (!a.__rendering || B) {
              var F = f.zoom / f.pixelRatio,
                C = (F - 1) / F,
                E = a.project.scrollTop * C;
              y.x = y.x / F + a.project.scrollLeft * C;
              y.y = y.y / F + E;
              y.x -= 1 * f.x / f.zoom;
              y.y -= 1 * f.y / f.zoom;
              A ? a.area.activeControl = a.area.hoverControl : B && (a.area.activeControl = "");
              C = x.x - y.x;
              F = x.y - y.y;
              if (0 !== C || 0 !== F) {
                if (!1 === c || !1 === e.rotatable) k.rotate = l.rotate;
                else {
                  var E = -Math.atan2(C, F) * a.util.RAD_DEG,
                    H = 0;
                  u && (E -= E % 5, H = e.bbox.rotate % 5);
                  null === g && (g = E);
                  null === p && (p = E);
                  q = E - p - H;
                  p = E
                }!1 === d || !1 === e.scalable ? (s = k.scale.x, w = k.scale.y) : (C = Math.sqrt(C * C + F * F), F = Math.sqrt(C * C + F * F), C = F = Math.max(C, F), isFinite(t.x) || (t.x = C, t.y = F), C = C / t.x * l.scale.x, F = F / t.y * l.scale.y, isFinite(s) || (s = C, w = F), v.x = C / s, v.y = F / w, s = C, w = F);
                a.selection.transform({
                  origin: x,
                  rotate: q,
                  scale: v
                }, y.state);
                z && (a.render.dirtyCenterPoint = {
                  origin: x,
                  bbox: e.bbox,
                  useRotate: c,
                  useScale: d
                })
              }
            }
          }
        })
      }
    };
  a.area.drawCenterPoint = function(b, c, d, e) {
    if (!1 !== a.feature.tools.drawCenterPoint) {
      var f =
        a.canvas2d,
        k = f.pixelRatio,
        l = f.zoom,
        g = f.x - a.project.scrollLeft * l,
        p = f.y - a.project.scrollTop * l,
        q = b.x * l,
        t = b.y * l;
      b = c.rotate;
      l = c.scale;
      f = a.active;
      f.save();
      f.beginPath();
      f.globalAlpha = 0.65;
      f.shadowOffsetX = 1;
      f.shadowOffsetY = 1;
      f.shadowColor = "#aaa";
      f.shadowBlur = 0;
      f.translate(q, t);
      f.translate(g, p);
      f.font = "13px helvetica, arial";
      d ? (c = (Math.round(b) + 360) % 360, f.fillText(c + String.fromCharCode(176), 10, 5)) : e && (d = c.height * l.y, f.fillText(Math.round(c.width * l.x) + "x" + Math.round(d), 10, 5));
      k *= 7, f.rotate(b * a.util.DEG_RAD),
        f.moveTo(0, -k), f.lineTo(0, k), f.moveTo(-k, 0), f.lineTo(k, 0), f.strokeStyle = "#000", f.stroke();
      f.restore()
    }
  };
  a.area.renderControls = function(b, c, d) {
    if (isFinite(b)) {
      var e = {};
      e[b] = !0;
      b = e
    } else b = {};
    var f = a.selection.items,
      k = 1 === a.selection.length,
      f = c || f !== JSON.stringify(f);
    if (c || d && f) e = a.active, c = e.canvas, e.clearRect(0, 0, c.width, c.height), "source-over" !== a.tool.device.composite && e.drawImage(a.ctx.canvas, 0, 0);
    a.scene.controls = [];
    e = a.scene.data;
    for (c = 0; c < e.length; c++) {
      d = a.scene.data[c];
      f && (d.dirtyControl = !0);
      isFinite(a.selection.idx);
      var l = a.selection.idx === c;
      a.hovered.items[c] && !k || k && l ? a.area.drawControls(a.active, d) : (b[c] || l) && a.area.drawControls(a.active, d, !0)
    }
  };
  a.area.drawControls = function(b, c, d) {
    if (c && c.dirtyControl && c.placement && c.placement.apply) {
      delete c.dirtyControl;
      var e = c.brush,
        f = a.selection.idx === c.zIndex;
      if (e && e.drawControl) {
        var k = e.drawControl(c);
        f && (a.scene.controls = k)
      } else {
        var l = c.placement,
          e = c.bbox,
          r, p, q = 1;
        "text" === c.type ? (r = e.width, p = e.height) : (q = e.viewBox[2] / e.width, r = e.viewBox[2],
          p = q * e.height);
        var t = a.canvas2d,
          q = t.pixelRatio,
          s = t.zoom * q,
          w = e.scale.x,
          v = e.scale.y,
          u = a.feature[c.type] || a.feature.tools,
          k = u.controls,
          k = k.anchor;
        if (u.drawBoundingBox) {
          var y = 0,
            x = 0;
          b.save();
          b.translate(t.x, t.y);
          b.scale(s, s);
          l.apply(b, !0);
          b.beginPath();
          b.rect(-y, -x, r + 2 * y, p + 2 * x);
          b.restore();
          b.save();
          f ? (l = k.focus || {}, l.lineWidth = l.lineWidth || 2, l.strokeStyle = l.strokeStyle || "#0080C2") : (l = k.normal || {}, l.shadowOffsetX = l.shadowOffsetX || 1, l.shadowOffsetY = l.shadowOffsetY || 1, l.shadowBlur = l.shadowBlur || 0);
          k.focus &&
            k.normal || ("light" === a.configure.theme ? (l.shadowColor = "rgba(255,255,255,0.5)", l.strokeStyle = l.strokeStyle || "rgba(0,0,0,0.75)") : (l.shadowColor = "rgba(0,0,0,0.5)", l.strokeStyle = l.strokeStyle || "rgba(255,255,255,1)"));
          b.shadowOffsetX = l.shadowOffsetX || 1;
          b.shadowOffsetY = l.shadowOffsetY || 1;
          b.shadowBlur = l.shadowBlur || 0;
          b.shadowColor = l.shadowColor;
          b.strokeStyle = l.strokeStyle;
          b.lineWidth = l.lineWidth * q;
          b.stroke();
          b.restore()
        }
        if (!d) {
          d = !1 !== c.useControlNW && (u.controls.nw || c.useControlNW);
          var f = !1 !== c.useControlSW &&
            (u.controls.sw || c.useControlSW),
            t = !1 !== c.useControlSE && (u.controls.se || c.useControlSE),
            u = !1 !== c.useControlNE && (u.controls.ne || c.useControlNE),
            k = a.theme.getControls(),
            l = c.placement.clone(),
            y = k.padding / 2 / w,
            x = k.padding / 2 / v,
            z = 0.5 / w,
            A = 0.5 / v,
            B = l.point2d(-z + y, -A + x),
            D = l.point2d(r - y, p - x);
          p = l.point2d(-z + y, p - x);
          r = l.point2d(r - y, -A + x);
          y = {
            x: 1,
            y: 1
          };
          a.scene.controls = [];
          if (k.anchor) {
            var x = k.anchor,
              A = x.padding,
              z = 1 * x.padding * q / s,
              G = "";
            a.selection.items[c.zIndex] && (G = x["title." + c.type + ":selected"] || x["title:selected"]);
            "" === G && (G = x["title." + c.type] || x.title || "");
            a.scene.controls.push({
              id: "anchor",
              actionId: c.id,
              type: "button",
              cursor: x.cursor,
              title: a.language.translate(G),
              event: x.command,
              padding: x.padding,
              bbox: {
                units: e.units,
                x: B.x,
                y: B.y,
                left: 1.5 * -A,
                top: 1.5 * -A,
                width: w * e.width + z,
                height: v * e.height + z,
                rotate: e.rotate,
                scale: y
              }
            })
          }
          d && k.nw && (x = k.nw, A = x.padding || k.padding, z = 1 * (A + x.width) * q / s, g(b, l, e, {
            direction: "nw",
            x: B.x,
            y: B.y,
            left: -z / 2,
            top: -z / 2,
            bbox: {
              units: e.units,
              x: B.x,
              y: B.y,
              left: -(z + A) / 2,
              top: -(z + A) / 2,
              width: z,
              height: z,
              rotate: e.rotate,
              scale: y
            }
          }));
          f && (x = k.sw, A = x.padding || k.padding, z = 1 * (A + x.width) * q / s, g(b, l, e, {
            direction: "sw",
            x: p.x,
            y: p.y,
            left: -z / 2,
            top: -z / 2 + A,
            bbox: {
              units: e.units,
              x: p.x,
              y: p.y,
              left: -(z + A) / 2,
              top: -(z - A) / 2,
              width: z,
              height: z,
              rotate: e.rotate,
              scale: y
            }
          }));
          t && (x = k.se, A = x.padding || k.padding, z = 1 * (A + x.width) * q / s, g(b, l, e, {
            direction: "se",
            x: D.x,
            y: D.y,
            left: -z / 2 + A,
            top: -z / 2 + A,
            bbox: {
              units: e.units,
              x: D.x,
              y: D.y,
              left: -(z - A) / 2,
              top: -(z - A) / 2,
              width: z,
              height: z,
              rotate: e.rotate,
              scale: y
            }
          }));
          u && (x = k.ne, A = x.padding || k.padding, z = 1 * (A + x.width) * q / s, g(b,
            l, e, {
              direction: "ne",
              x: r.x,
              y: r.y,
              left: -z / 2 + A,
              top: -z / 2,
              bbox: {
                units: e.units,
                x: r.x,
                y: r.y,
                left: -(z - A) / 2,
                top: -(z + A) / 2,
                width: z,
                height: z,
                rotate: e.rotate,
                scale: y
              }
            }))
        }
      }
    }
  };
  var g = function(b, c, d, e) {
      var f = e.direction,
        k;
      k = a.area.hoverControl === f || a.area.activeControl === f ? "hover" : "normal";
      var l;
      l = a.theme.getControls();
      if (l = l[f + "-" + k] || l[f]) {
        var g = l.command || {};
        a.scene.controls.push({
          id: f,
          title: a.language.translate(l.title),
          type: "button",
          cursor: "pointer",
          hovered: "hover" === k,
          event: g,
          bbox: e.bbox
        });
        f = a.canvas2d;
        k = f.zoom *
          f.pixelRatio;
        b.save();
        b.beginPath();
        b.translate(f.x, f.y);
        b.scale(k, k);
        c.reset();
        c.translate(e.x, e.y);
        c.rotate(d.rotate * a.util.DEG_RAD);
        c.translate(e.left || 0, e.top || 0);
        c.apply(b, !0);
        c = l.width / l.viewBox[2];
        l.render({
          ctx: b,
          matrix: {
            a: c,
            b: 0,
            c: 0,
            d: c,
            x: 0,
            y: 0
          }
        });
        a.feature.debugMouse && (b.fillStyle = "rgba(255,255,0,1)", b.fillRect(0, 0, e.bbox.width, e.bbox.height));
        b.restore()
      }
    },
    c = {},
    f = String.fromCharCode(65279);
  a.area.exitGenesis = function(b) {
    if (a.area.inGenesis || b)
      if (a.area.inGenesis = !1, b = a.scene.getFocused()) {
        if ("text" !==
          b.type || b.content) {
          var h = b.svg,
            d = a.scene.clone(b);
          d.id = a.scene.createId();
          d.dirty = !0;
          d.render = b.render;
          a.scene.removeByIndex(b.zIndex, !1);
          if (b = a.scene.addObject(d)) h && (b.svg = h), a.render("root.area.hide"), a.history && !a.area.inGenesisChannel && a.history.store({
            from: "add",
            to: sk.scene.clone([b]),
            name: "Create " + STRING.ucwords(b.type)
          });
          a.area.inGenesisChannel = !1;
          return b
        }
        h = textkit.cleanText(textkit.textarea.innerHTML);
        h !== f && (b.content = h, textkit.updateObjectSize(b));
        a.scene.removeByIndex(a.selection.idx, !1);
        a.scene.deselectAll();
        c = {}
      }
  };
  a.area.hide = function() {
    var b = a.scene.getFocused();
    a.__editing = !1;
    var h = a.toolkit.text;
    if (h && b && "text" === b.type) {
      h.textarea || h.createTextarea();
      var d = h.cleanText(h.textarea.innerHTML);
      a.area.hideArea();
      d !== f && (b.content = d, h.updateObjectSize(b));
      if (b.content.trim()) b.dirty = !0;
      else if (a.area.inGenesis) {
        a.scene.removeByIndex(a.selection.idx, !1);
        a.scene.deselectAll();
        a.area.inGenesis = !1;
        c = {};
        return
      }
    } else a.area.hideArea();
    if (a.area.inGenesis) {
      if (a.area.inGenesis = !1, b) {
        h =
          a.scene.clone(b);
        h.id = a.scene.createId();
        h.dirty = !0;
        h.render = b.render;
        var e;
        b.svg && (e = b.svg);
        a.scene.removeByIndex(b.zIndex, !1);
        a.scene.addObject(h);
        e && (b.svg = e);
        a.scene.deselectAll();
        a.render("root.area.hide");
        a.history && !a.area.inGenesisChannel && a.history.store({
          from: "add",
          to: sk.scene.clone([h]),
          name: "Transform Object"
        });
        a.area.inGenesisChannel = !1
      }
    } else "undefined" !== typeof c.id && ("text" === c.type && h) && ((b = a.scene.getById(c.id)) && (c.content !== b.content && a.history) && a.history.store({
      from: [{
        id: b.id,
        content: c.content
      }],
      to: [{
        id: b.id,
        content: b.content
      }],
      name: "Update Text"
    }), h.createTextarea(), c = {})
  };
  a.area.show = function(b) {
    b = b || a.scene.getOneSelected();
    if ("undefined" !== typeof b) {
      c = a.scene.clone(b);
      var h = a.toolkit.text;
      "text" === b.type && h ? (a.__editing = !0, h.textarea || h.createTextarea(), h.textarea.innerHTML = b.content ? b.content : f, h.blur = b.blur || 0, h.container.style.opacity = 1, h.container.style.display = "block", b.dirtyControl = !0, a.render("root.area.show")) : a.area.hideArea()
    }
  };
  a.area.hideArea = function() {
    a.__editing = !1;
    var b = String.fromCharCode(65279),
      c = a.toolkit.text;
    c && (c.textarea && (c.textarea.innerHTML = b, c.textarea.blur()), c.container && (c.container.style.opacity = 0, c.container.style.display = "none"))
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  var g = a.Scene.prototype;
  g.sendLayer = function(a, f) {
    a < f ? sk.scene.sendForwards({
      distance: Math.floor(f - a),
      record: !0
    }) : sk.scene.sendBackwards({
      distance: Math.floor(a - f),
      record: !0
    });
    return this
  };
  g.sendForwards = function(c) {
    c = c || {};
    var f = a.detect.refreshPixelData,
      b = c.toFront || !1,
      h = c.distance || 1,
      d = c.selection || this.selection.items;
    c = c.record || !1;
    var e = this.data,
      g = e.length,
      k;
    for (k in d)
      if (parseInt(k) === g - 1) return this;
    k = [];
    var l = [];
    if (b) {
      for (var h = [], r = [], p = [], b = 0; b < g; b++) {
        var q = e[b];
        q.useStickToFront ?
          p.push(q) : q.useStickToBack ? r.push(q) : d[b] ? h.push(q) : r.push(q)
      }
      r = r.concat(h);
      r = r.concat(p);
      d = this.clone(h);
      this.data = r;
      this.reindex();
      b = 0;
      for (g = h.length; b < g; b++) q = h[b], f[q.type] && (q.dirtyCacheForce = !0), c && (k.push({
        id: q.id,
        zIndex: d[b].zIndex
      }), l.push({
        id: q.id,
        zIndex: q.zIndex
      }))
    } else {
      for (b = g; b--;) d[b] && b !== g - 1 && (q = e[b], q.useStickToBack || (f[q.type] && (q.dirtyCacheForce = !0), e.splice(b + h, 0, e.splice(b, 1)[0]), c && (k.push({
        id: q.id,
        zIndex: b
      }), l.push({
        id: q.id,
        zIndex: b + h
      }))));
      this.reindex()
    }
    this.checkForSingleSelection();
    a.on.sendForwards && a.on.sendForwards();
    a.history && (c && k.length) && a.history.store({
      from: k,
      to: l,
      name: "Send Forwards"
    });
    return this
  };
  g.sendBackwards = function(c) {
    c = c || {};
    var f = a.detect.refreshPixelData,
      b = c.distance || 1,
      h = c.toBack || !1,
      d = c.selection || this.selection.items;
    c = c.record || !1;
    for (var e = this.data, g = e.length, k = 0, l = 0; l < g && e[l].useStickToBack; l++) k++;
    for (var r in d)
      if (parseInt(r) === k) return this;
    r = [];
    k = [];
    if (h) {
      for (var b = [], p = [], q = [], l = 0; l < g; l++) h = e[l], h.useStickToFront ? q.push(h) : d[l] || h.useStickToBack ?
        b.push(h) : p.push(h);
      d = this.clone(b);
      b = b.concat(p);
      this.data = b = b.concat(q);
      this.reindex();
      l = 0;
      for (g = d.length; l < g; l++) h = b[l], f[h.type] && (h.dirtyCacheForce = !0), c && (r.push({
        id: h.id,
        zIndex: d[l].zIndex
      }), k.push({
        id: h.id,
        zIndex: h.zIndex
      }))
    } else {
      for (l = 0; l < g; l++) d[l] && 0 !== l && (h = e[l], h.useStickToFront || (f[h.type] && (h.dirtyCacheForce = !0), p = e.splice(l, 1)[0], q = e[l - b] || e[0], c && (r.push({
        id: h.id,
        groupId: p.groupId,
        zIndex: l
      }), k.push({
        id: h.id,
        groupId: q.groupId,
        zIndex: l - b
      })), e.splice(l - b, 0, p), p.groupId = q.groupId));
      this.reindex()
    }
    this.checkForSingleSelection();
    a.on.sendBackwards && a.on.sendBackwards();
    a.history && (c && r.length) && a.history.store({
      from: r,
      to: k,
      name: "Send Backwards"
    });
    return this
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.orientation = function(a, c) {
    var f = this;
    this.mirrorY = this.mirrorX = 1;
    this.zoom = {
      clampFormat: "px",
      fromCenter: !0,
      value: 1,
      min: 20,
      max: 100
    };
    this.rotate = {
      clampFormat: "degree",
      value: 0,
      min: 0,
      max: 0
    };
    this.mouse = {};
    this.origin = {};
    this.offset = {};
    for (var b in c) this[b] = c[b];
    this.ctx = this.canvas.getContext("2d");
    this.trx = {};
    this.trx.scale = new a.vector.Transform;
    this.trx.rotate = new a.vector.Transform;
    this.trx.mirror = new a.vector.Transform;
    this.render = function() {
      h();
      a.render.clipped = !1;
      a.setBounds();
      a.render("root.orientation.render");
      return this
    };
    var h = function() {
      var b = new a.vector.Transform;
      b.combine(f.trx.mirror);
      b.combine(f.trx.scale);
      b.combine(f.trx.rotate);
      b.translate(f.offset.x, f.offset.y);
      var c = new CSSMatrix,
        b = b.matrix;
      c.a = b.a;
      c.b = b.b;
      c.c = b.c;
      c.d = b.d;
      c.e = b.x;
      c.f = b.y;
      c = c.decompose();
      b = f.zoom.value;
      a.canvas2d.zoom = b;
      a.canvas2d.x = c.translate.x - sk.project.x * b;
      a.canvas2d.y = c.translate.y - sk.project.y * b;
      a.alignDummy()
    };
    this.reset = function(b) {
      this.media = a.project.bounds;
      b || (this.zoom.value = 1, this.rotate.value = 0, this.mirrorY = this.mirrorX =
        1, this.offset.x = 0, this.offset.y = 0);
      this.center && this.setCenter();
      this.scale = 1;
      this.mouse.x = 0;
      this.mouse.y = 0;
      this.origin.x = 0;
      this.origin.y = 0;
      this.setCenterMouse();
      this.mirrorTo(this.mirrorX, this.mirrorY);
      this.rotateTo(this.rotate.value);
      this.zoomTo(this.zoom.value, !0);
      h();
      return this
    };
    this.setCenter = function() {
      var b = a.canvas2d.pixelRatio,
        c = parseFloat(this.canvas.style.width) || this.canvas.width,
        f = parseFloat(this.canvas.style.height) || this.canvas.height;
      this.center.x = c / 2;
      this.center.y = f / 2;
      this.offset.x =
        Math.max(0, this.center.x - this.media.width / 2) * b;
      this.offset.y = Math.max(0, this.center.y - this.media.height / 2) * b;
      this.mouse.x = 0;
      this.mouse.y = 0;
      this.origin.x = 0;
      this.origin.y = 0;
      return this
    };
    this.setPan = function(a, b) {
      this.offset.x += isFinite(a) ? a : 0;
      this.offset.y += isFinite(b) ? b : 0;
      this.setCenterMouse();
      this.render();
      return this
    };
    this.setRotate = function(a) {
      this.rotate.value = 360 === a ? 360 : (a + 360) % 360;
      this.rotateTo(this.rotate.value);
      this.render();
      return this
    };
    this.setZoom = function(b, c) {
      var f = this.zoom.value,
        k =
        Math.max(this.media.width, this.media.width);
      if ("px" === this.zoom.clampFormat) var h = this.zoom.min / k,
        k = this.zoom.max / k;
      else h = this.zoom.min, k = this.zoom.max;
      h = Math.min(k, Math.max(h, b));
      f = 1 + (h - f) / f;
      this.zoom.value = h;
      f && this.zoomTo(f);
      if (!c) return this.render(), a.toolkit.text && a.toolkit.text.updateCSSTransform(), this
    };
    this.mirrorTo = function(a, b) {
      var c = this.media,
        f = -1 === a ? c.width : 0,
        c = -1 === b ? c.height : 0;
      this.trx.mirror.reset();
      this.trx.mirror.translate(f, c);
      this.trx.mirror.scale(a, b);
      return this
    };
    this.rotateTo =
      function(a) {
        var b = this.trx.rotate,
          c = this.media,
          f = c.width / 2 + this.offset.x,
          c = c.height / 2 + this.offset.y;
        b.reset();
        b.translate(f, c);
        b.rotate(a * Math.PI / 180);
        b.translate(-f, -c);
        return this
      };
    this.zoomTo = function(a, b) {
      if (!this.origin) return console.log("not initialized");
      var c = this.trx.scale;
      b && (c.reset(), this.origin.x = 0, this.origin.y = 0, this.scale = 1);
      c.translate(this.origin.x, this.origin.y);
      c.scale(a, a);
      this.origin.x = this.mouse.x / this.scale + this.origin.x - this.mouse.x / (this.scale * a);
      this.origin.y = this.mouse.y /
        this.scale + this.origin.y - this.mouse.y / (this.scale * a);
      c.translate(-this.origin.x, -this.origin.y);
      this.scale *= a;
      return this
    };
    this.events = {};
    this.enabled = !1;
    this.enable = function() {
      if (!this.enabled) return this.enabled = !0, f.events.mousedown = eventjs.add(c.mouseLayer, "mousedown", this.mousedown), f.events.wheel = eventjs.add([c.mouseLayer], "wheel", this.mousewheel), f.events.key = eventjs.add(window, "keyup keydown", eventjs.proxy.metaTracker), f.events.keydown = eventjs.add(window, "keydown", this.keydown), this
    };
    this.disable =
      function() {
        if (this.enabled) {
          this.enabled = !1;
          for (var a in f.events) f.events[a].remove();
          return this
        }
      };
    this.ly = this.lx = 0;
    this.drag = function(b, c) {
      eventjs.prevent(b);
      if (f.zoom.fromCenter) f.setZoomFromCenter();
      else {
        var h = eventjs.proxy.getCoord(b),
          k = eventjs.proxy.getBoundingBox(f.canvas);
        f.mouse.x = h.x - k.x1;
        f.mouse.y = h.y - k.y1
      }
      h = a.canvas2d.pixelRatio;
      f.offset.x += (c.x - f.lx) / f.zoom.value * f.mirrorX * h;
      f.offset.y += (c.y - f.ly) / f.zoom.value * f.mirrorY * h;
      f.lx = c.x;
      f.ly = c.y;
      f.render();
      f.runCallback();
      return this
    };
    this.mousedown =
      function(a) {
        eventjs.proxy.getBoundingBox(f.canvas);
        f.lx = 0;
        f.ly = 0;
        f.events.drag = eventjs.proxy.drag({
          fingers: 1,
          event: a,
          position: "difference",
          target: f.canvas,
          listener: f.drag
        });
        return this
      };
    this.mousewheel = function(b, c) {
      eventjs.cancel(b);
      var h = c.wheelDelta / 120,
        k = eventjs.proxy.getCoord(b),
        l = eventjs.proxy.getBoundingBox(f.canvas),
        r = a.canvas2d.pixelRatio;
      f.mouse.x = k.x * r - l.x1;
      f.mouse.y = k.y * r - l.y1;
      b.shiftKey ? (f.rotate.value = (f.rotate.value + 2 * h + 360) % 360, f.rotateTo(f.rotate.value)) : f.setZoom(f.zoom.value * (1 +
        h / 2), !0);
      h = a.orientation.getKnobOffset(f.zoom.value);
      a.orientation.setControllerCSS(h);
      f.render();
      f.runCallback();
      return this
    };
    this.keydown = function(a) {
      var b = f.zoomMin,
        b = f.zoom.value / (f.zoomMax - b + b),
        c = a.shiftKey ? 10 : 1;
      switch (a.keyCode) {
        case 37:
          eventjs.metaKey ? (eventjs.cancel(a), f.setRotate(f.rotate.value + 1 * c)) : f.setPan(-1 * c, 0);
          f.runCallback();
          break;
        case 39:
          eventjs.metaKey ? (eventjs.cancel(a), f.setRotate(f.rotate.value - 1 * c)) : f.setPan(1 * c, 0);
          f.runCallback();
          break;
        case 38:
          eventjs.metaKey ? (eventjs.cancel(a),
            f.setZoom(b - 0.01 * c)) : f.setPan(0, -1 * c);
          f.runCallback();
          break;
        case 40:
          eventjs.metaKey ? (eventjs.cancel(a), f.setZoom(b + 0.01 * c)) : f.setPan(0, 1 * c), f.runCallback()
      }
      return this
    };
    this.toString = function() {
      return JSON.stringify(this.getValues())
    };
    this.setCenterMouse = function() {
      var b = a.canvas2d.pixelRatio,
        c = Math.min(this.canvas.width, this.media.width * b),
        b = Math.min(this.canvas.height, this.media.height * b);
      this.mouse.x = c / 2 + this.offset.x;
      this.mouse.y = b / 2 + this.offset.y;
      return this
    };
    this.setZoomFromCenter = function() {
      var a =
        this.zoom.value,
        b = Math.min(this.canvas.width, this.media.width),
        c = Math.min(this.canvas.height, this.media.height),
        f = this.trx.scale.matrix;
      this.mouse.x = (f.x / a + this.offset.x) * a + b * a / 2;
      this.mouse.y = (f.y / a + this.offset.y) * a + c * a / 2;
      return this
    };
    this.getValues = function() {
      var a = this.zoom.value,
        b = this.trx.scale.matrix;
      return {
        x: b.x + this.offset.x * a,
        y: b.y + this.offset.y * a,
        zoom: a,
        rotate: this.rotate.value,
        mirror: {
          x: f.mirrorX,
          y: f.mirrorY
        }
      }
    };
    this.setMedia = function(a) {
      var b = this;
      "string" === typeof a ? (this.media = new Image,
        this.media.onload = function() {
          b.reset(!0)
        }, this.media.src = a) : (this.media = a, this.reset(!0));
      return this
    };
    this.runCallback = function(a) {
      this.callback && this.callback({
        rotate: f.rotate.value,
        zoom: f.zoom.value,
        mirrorX: f.mirrorX,
        mirrorY: f.mirrorY
      });
      return this
    };
    this.setMedia(this.src);
    return this
  };
  a.orientation.init = function() {
    var g = a.feature.canvas.zoom || "",
      c = g.min || 0.25,
      f = g.max || 6,
      g = g.increment || 0.1;
    a.orientation.reset = function() {
      a.orient.reset().render();
      var b = this.getKnobOffset(1);
      this.setController(b)
    };
    a.orientation.setZoom = function(a) {
      a = this.getKnobOffset(a || 1);
      this.setController(a)
    };
    a.orientation.getKnobOffset = function(c) {
      var d = a.orient.zoom.max;
      c = c || a.canvas2d.zoom;
      var f = b.offsetHeight || 150;
      c = 2 + Math.log(c) / Math.log(2);
      d = 2 + Math.log(d) / Math.log(2);
      return (1 - c / d) * f
    };
    a.orientation.zoomOut = function() {
      var b = Math.max(a.orient.zoom.min, a.canvas2d.zoom - a.orient.zoom.increment),
        b = this.getKnobOffset(b);
      this.setController(b)
    };
    a.orientation.zoomIn = function() {
      var b = Math.max(a.orient.zoom.min, a.canvas2d.zoom +
          a.orient.zoom.increment),
        b = this.getKnobOffset(b);
      this.setController(b)
    };
    a.orientation.setControllerCSS = function(a) {
      var c = b.offsetHeight || 150;
      if (h) {
        var d = h.offsetHeight;
        h.style.top = Math.min(c - d, Math.max(0, a - d / 2)) + "px"
      }
    };
    a.orientation.setController = function(c) {
      a.orientation.setControllerCSS(c);
      var d = b.offsetHeight || 150,
        f = a.orient.zoom.max,
        h = 2 + Math.log(f) / Math.log(2);
      c = Math.min(f, Math.pow(2, (1 - c / d) * h - 2));
      a.orient.setZoom(c);
      b && (b.title = Math.round(100 * c) + "%")
    };
    var b, h = null,
      d = a.$("#sk-orientation");
    d &&
      (eventjs.add(d, "mousedown,dblclick", eventjs.stop), d.appendChild(dom.create('<div class="icon-plus"></div>', {
        onmousedown: function(b, c) {
          eventjs.cancel(b);
          a.orientation.zoomIn()
        }
      })), b = d.appendChild(dom.create('<div class="controller"><div><span id="controller" style="top: 0px"></span></div></div>', {
        ondrag: function(b, c) {
          eventjs.cancel(b);
          a.orientation.setController(c.y);
          var d = Math.round(100 * a.orient.zoom.value) + "%";
          a.setTooltip(d)
        }
      })), d.appendChild(dom.create('<div class="icon-minus"></div>', {
        onmousedown: function(b,
          c) {
          eventjs.cancel(b);
          a.orientation.zoomOut()
        }
      })));
    a.orient = new a.orientation(a, {
      src: a.project.bounds,
      canvas: a.ctx.canvas,
      mouseLayer: a.active.canvas,
      center: {
        x: a.ctx.canvas.width / 2,
        y: a.ctx.canvas.height / 2
      },
      rotate: {
        clampFormat: "degree",
        value: 0,
        min: 0,
        max: 0
      },
      zoom: {
        clampFormat: "%",
        fromCenter: !0,
        value: 1,
        min: c,
        max: f,
        increment: g
      }
    });
    b && (eventjs.add({
        target: b,
        mouseover: function(b) {
          eventjs.stop(b);
          b = Math.round(100 * a.orient.zoom.value) + "%";
          a.setTooltip(b)
        },
        mouseout: function(b) {
          eventjs.stop(b);
          a.setTooltip("")
        }
      }),
      h = b.firstChild.firstChild, h.style.top = a.orientation.getKnobOffset() + "px")
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.Scene.prototype.placement = function(g) {
    var c = g.trx && g.trx.reset ? g.trx.reset() : new a.vector.Transform,
      f = g.bbox,
      b = g.pt0,
      h = g.pt1,
      d = h.x,
      e = h.y,
      h = b.x,
      b = b.y,
      m = d - h || 0.001,
      k = e - b || 0.001,
      l = !g.doRotate && 0 > m,
      r = !g.doRotate && 0 > k,
      p = 0 > m ? 1 : -1,
      q = 0 > k ? 1 : -1,
      t = l ? -1 : 1,
      s = r ? -1 : 1,
      w = "undefined" === typeof g.rotate ? -Math.atan2(h - d, b - e) : g.rotate,
      v = f.viewBox[2],
      e = f.viewBox[3],
      u = m / v || 0,
      d = k / e || 0;
    g.doLockRatio && (u = Math.max(Math.abs(d), Math.abs(u)), d = u * q, u *= p);
    0 < k && (d *= -1);
    0 < m && (u *= -1);
    g.doRotate && (m = f.width / 2 * f.scale.x,
      k = f.height / 2 * f.scale.y, "objectBoundingBox" === f.units ? (c.translate(h + m, b + k), c.rotate(w), c.translate(-h - m, -b - k)) : (c.translate(h, b), c.rotate(w), c.translate(-h, -b)), l && (h += -v * u), r && (b += -e * d));
    g.doScale && (g.doCenter ? (f = t * u * v / 2, l = s * d * e / 2) : l = f = 0, c.translate(h - f, b - l), c.scale(u * t, d * s));
    g.scale && c.scale(g.scale.x, g.scale.y);
    return c
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.render = sketch.render || {};
(function(a) {
  a.render.clipped = !1;
  a.render.forOutput = !1;
  a.render.from = "";
  a.render.selected = !1;
  a.render.speed = 0;
  a.render.state = "preload";
  a.render.dirty = !1;
  a.render.dirtyCenterPoint = !1;
  a.render.dirtyControls = !1;
  a.render = function(b, c) {
    c && f.push(c);
    a.render.dirty = !0;
    a.render.from = b;
    "root.render.preload" === b && (a.render.state = "preload");
    return this
  };
  a.render.clean = function(b, c) {
    a.render.dirtyControls = !0;
    a.render(b, c);
    return this
  };
  a.render.output = function(b, c) {
    a.render.forOutput = !0;
    h();
    a.render.forOutput = !1;
    return this
  };
  var g = !1,
    c = function() {
      a.render.dirty && h();
      !1 !== g && requestAnimationFrame(c)
    };
  a.render.start = function() {
    g || (g = !0, c())
  };
  a.render.stop = function() {
    g = !1
  };
  var f = {
      callbacks: [],
      push: function(a) {
        "function" === typeof a && f.callbacks.push(a)
      },
      run: function() {
        a.render.dirtyControls && (a.render.dirtyControls = !1, a.detect.area[a.tool.type] ? a.area.renderControls(null, !0) : a.toolkit.callOverride("onRenderControls"));
        if (a.render.dirtyCenterPoint) {
          var b = a.render.dirtyCenterPoint;
          a.render.dirtyCenterPoint = !1;
          a.detect.area[a.tool.type] ? a.area.drawCenterPoint(b.origin, b.bbox, b.useRotate, b.useScale) : a.toolkit.callOverride("onRenderCenterPoint")
        }
        for (a.__rendering = !1; f.callbacks.length;) f.callbacks.shift()()
      }
    },
    b = {
      perf: null,
      gco: "source-over",
      useMultiRender: {
        "root.scene.reset": !0,
        "root.render.preload": !0,
        "root.render.resize": !0,
        "root.render.everything": !0
      }
    },
    h = function() {
      a.__rendering = !0;
      a.render.dirty = !1;
      b.perf = b.perf || a.perf();
      if (a.feature.vector.edit || "preload" === a.render.state) {
        var c = a.ctx,
          d = c.canvas.width,
          e = c.canvas.height;
        a.render.clipped || (a.ctx.canvas.width = d, a.render.drawClipArea(c), c.clip());
        c.clearRect(0, 0, d, e);
        c.beginPath();
        c.rect(0, 0, d, e);
        c.clip();
        c.save();
        k()
      } else {
        d = a.render.from;
        c = a.scene.data;
        e = c.length;
        if (!b.useMultiRender[d] && e) {
          d = isFinite(a.selection.idx) && "root.area.hide" !== d ? a.active : a.ctx;
          for (e = 0; e < c.length; e++) {
            var h = c[e];
            !h.dirty && !h.dirtyTransform || h.error || (a.scene.updateTransform(h), a.render.action(d, h), a.render.dirtyControls = !0)
          }
          "source-over" !== a.tool.device.composite && a.active.drawImage(a.ctx.canvas,
            0, 0)
        }
        f.run()
      }
    },
    d = function(b, c) {
      c && (c.lineWidth || c.strokeStyle) && (b.lineWidth = (c.lineWidth || 1) / a.canvas2d.zoom, b.strokeStyle = c.strokeStyle || "#000", b.stroke())
    },
    e = -1,
    m = 0,
    k = function() {
      var c = a.scene.data,
        h = c.length,
        g = "preload" === a.render.state,
        t = ++e - m,
        s = 0 === e % ((g ? 6 : 2048) + 2),
        w = t > h - 1,
        s = 0 !== e && s;
      g && (s || w) && a.loader.update(a.loader.thread, "rendering sketch...", 100 * (h && !w ? t / h : 100) >> 0);
      if (s) ++m, setTimeout(k, 1);
      else if (w) {
        m = 0;
        e = -1;
        a.__rendering = !1;
        a.render.state = "loaded";
        t = a.ctx;
        l.id && l.canvas && (l.render(t),
          l.id = null);
        t.restore();
        if (a.feature.canvas.clearWithBackground && a.render.cache.enabled && !a.render.forOutput) {
          var h = a.canvas2d,
            g = h.zoom * h.pixelRatio,
            c = a.project.bounds,
            w = c.width,
            s = c.height,
            v = a.project.scrollLeft,
            u = a.project.scrollTop;
          t.save();
          t.translate(h.x, h.y);
          t.scale(g, g);
          t.globalAlpha = 1;
          t.globalCompositeOperation = "destination-over";
          t.translate(-v, -u);
          t.rect(0, 0, w, s);
          c.style.fillStyle = a.configure.backgroundRaw;
          (h = c.style) && h.fillStyle && (t.fillStyle = h.fillStyle, t.fill());
          t.globalCompositeOperation =
            "source-over";
          d(t, c.style);
          t.restore()
        }
        a.render.setBlendMode(null);
        f.run();
        b.perf && (a.render.speed = b.perf());
        b.perf = null;
        a.feature.debug && console.log("render", a.render.speed + "ms", a.render.from)
      } else {
        c = c[t];
        if (c.error) return k();
        if (h = c.toolkit) {
          a.scene.updateTransform(c);
          if ("group" !== c.type && (!1 === c.visible || !isFinite(c.inbounds) && !a.scene.isInBounds(c)) || a.render.selected && !a.render.selected[t]) return k();
          if (a.selection.idx === t) {
            if (!a.feature.useCanvasTextRender && "text" === c.type && a.__editing) return a.area.drawControls(a.active,
              c), k();
            h.renderAction ? h.renderAction(c, !1, a.render.from, k) : a.render.action(h.ctx, c, k);
            a.area.drawControls(a.active, c)
          } else h.renderAction ? h.renderAction(c, !0, a.render.from, k) : a.render.action(h.ctx, c, k)
        } else {
          a.feature.debug && console.log("toolkit was not loaded", t, c.id, c.type);
          if (!a.toolkit.getToolkit(c.type)) return k();
          m = 0;
          e = -1;
          a.__rendering = !1;
          setTimeout(a.render.preload, 0)
        }
      }
    },
    l = {
      id: null,
      canvas: null,
      composite: null,
      opacity: null,
      render: function(a) {
        a.globalCompositeOperation = l.composite;
        a.globalAlpha =
          l.opacity / 100;
        a.drawImage(l.canvas, 0, 0)
      }
    };
  a.render.action = function(b, c, d) {
    if (b && c) {
      var e = a.canvas2d,
        f = e.pixelRatio,
        k = e.zoom * f,
        h = a.selection.items,
        g = c.zIndex - m;
      c.selected = h[g];
      c.hovered = a.hovered.items[g];
      c.groupId ? (l.id !== c.groupId && (l.id && l.canvas && l.render(b), l.id = c.groupId, l.canvas = l.canvas || a.util.Canvas(b.canvas.width, b.canvas.height), l.canvas.width = b.canvas.width, l.canvas.height = b.canvas.height, l.composite = c.composite, l.opacity = c.opacity), l.id && (b = l.canvas.ctx)) : l.id && l.canvas && (l.render(b),
        l.id = null);
      var y = a.render.cache;
      if (y.enabled && (!c.ctx || c.dirty || c.dirtyCacheForce) && (c.dirtyControl = !0, y.add(c), !c.ctx || !c.ctx.canvas.width || !c.ctx.canvas.height)) {
        d && d();
        return
      }
      b.save();
      b.translate(e.x, e.y);
      b.scale(k, k);
      b.globalCompositeOperation = a.style.getComposite(c.composite);
      b.globalAlpha = a.detect.useLocalAlpha[c.type] ? 1 : isFinite(c.opacity) ? c.opacity / 100 : 1;
      var x = c.bbox,
        z = x.viewBox[2] / x.width,
        A = x.scaleCache,
        B = A && A.x || 1,
        D = A && A.y || 1,
        A = B * (z / x.scale.x),
        G = D * (z / x.scale.y),
        F = 0,
        C = 0,
        E = !(y.enabled && !0 !==
          c.useHighRes);
      if (E) {
        var H = c.placement,
          e = c.bbox.padding || 0,
          J = (y.padding || 0) + e,
          f = -J,
          y = -J,
          I = x.width * z + 2 * J,
          z = x.height * z + 2 * J;
        H.apply(b, !0);
        b.translate(e, e);
        b.beginPath();
        b.rect(f, y, I, z);
        b.clip();
        c.render(b, H, !1)
      } else H = c.placement.clone(), F = y.padding * A, C = y.padding * G, H.translate(-F, -C), H.scale(A / f, G / f), H.apply(b, !0), f = z = 0, a.detect.useOffsetCache[c.type] && (z = H.matrix.x, f = H.matrix.y, z = Math.round(z) - z - e.x % 1, f = Math.round(f) - f - e.y % 1), H = c.ctx.canvas, H.width && H.height && b.drawImage(H, z, f), F /= A, C /= G;
      (a.feature[c.type] ||
        a.feature.tools).drawBoundingBox && (h[g] && !isFinite(a.selection.idx) && !a.render.forOutput) && (h = x.scale.x / B, g = x.scale.y / D, b.beginPath(), b.globalAlpha = 0.5, b.globalCompositeOperation = "source-over", b.lineWidth = 0.5 / k / B, E && b.scale(A, G), b.translate(F, C), b.rect(0, 0, x.width * h, x.height * g), b.shadowOffsetX = 1, b.shadowOffsetY = 1, "dark" === a.configure.theme ? (b.shadowColor = "#000", b.strokeStyle = "#fff") : (b.shadowColor = "#fff", b.strokeStyle = "#000"), b.stroke());
      b.restore();
      d && d()
    } else a.feature.debug && console.log("missing argument in root.render.action(ctx, action, callback)",
      arguments)
  };
  a.render.drawClipArea = function(b) {
    a.render.clipped = !0;
    var c = a.project.clip,
      e = a.canvas2d,
      f = e.zoom,
      k = f * e.pixelRatio;
    b.beginPath();
    var h = a.project.scrollLeft - a.project.x,
      l = a.project.scrollTop - a.project.y;
    if (c.path) h = e.x - h * f, e = e.y - l * f, b.save(), b.translate(h, e), b.scale(k, k), a.vector.shape.VOBPath(b, c.path), b.restore();
    else {
      if (a.render.forOutput) e = h = 0, f = b.canvas.width, k = b.canvas.height;
      else var g = a.project.bounds,
        h = (c.x || 0) * k + e.x - h * f,
        e = (c.y || 0) * k + e.y - l * f,
        f = Math.min(g.width, c.width || Infinity) *
        k,
        k = Math.min(g.height, c.height || Infinity) * k;
      b.rect(h - 0.5, e - 0.5, f + 1, k + 1)
    }
    c.style && ((k = c.style) && k.fillStyle && (b.fillStyle = k.fillStyle, b.fill()), d(b, c.style))
  };
  a.render.Cache2d = function(a) {
    var b = this;
    this.data = {};
    this.padding = 2;
    this.enabled = a.feature.cache2D;
    this.clean = function(c) {
      var d = c.ctx;
      if (d) {
        var e = d.canvas;
        d.copies--;
        0 >= d.copies && (e.width = 1, e.height = 1, delete b.data[c.hash], a.feature.debugCache && document.body.removeChild(e))
      }
    };
    this.getContext = function(a) {
      this.data[a] ? (a = this.data[a], a.copies++) :
        (a = document.createElement("canvas"), a.className = "cache" + Math.round(16777215 * Math.random()), a = a.getContext("2d"), a.copies = 1);
      return a
    };
    this.add = function(c) {
      if (c && c.render) {
        var d = a.scene.createHash(c),
          e = b.data[d];
        if (e && !c.dirtyCacheForce) c.dirty = !1, c.ctx = e, "undefined" === typeof c.hash && (c.hash = d, c.ctx.copies++);
        else {
          this.clean(c);
          c.hash = d;
          c.ctx = this.getContext(d);
          c.canvas = c.ctx.canvas;
          b.data[d] = c.ctx;
          var d = a.render.cache.padding,
            f = c.ctx.canvas,
            k = c.bbox,
            e = k.scale.x,
            h = k.scale.y,
            l = a.canvas2d.pixelRatio,
            g = (k.width * e + 2 * d) * l,
            m = (k.height * h + 2 * d) * l;
          a.feature.cache257 && a.detect.generativeColor[c.type] && (g = Math.max(257, g), m = Math.max(257, m));
          f.width = Math.min(8192, g);
          f.height = Math.min(8192, m);
          a.feature.debugCache && (document.body.appendChild(f), f.title = c.zIndex, f.onclick = function(a) {
            return function() {
              console.log(a)
            }
          }(c));
          g = c.bbox.scale;
          f = c.placement.clone();
          f.matrix.x = 0;
          f.matrix.y = 0;
          f.scale(1 / g.x, 1 / g.y);
          f.rotate(-k.rotate * a.util.DEG_RAD);
          f.scale(g.x, g.y);
          c.ctx.save();
          c.ctx.imageSmoothingEnabled = a.detect.brush[c.type];
          a.feature.debugCache && (k = c.bbox.width * e, h *= c.bbox.height, c.ctx.fillStyle = "#ff0", c.ctx.fillRect(0, 0, k + 2 * d, h + 2 * d), c.ctx.clearRect(d, d, k, h));
          d += (c.bbox.padding || 0) * e;
          c.ctx.scale(l, l);
          c.ctx.translate(d, d);
          c.render(c.ctx, f, !0);
          c.ctx.restore();
          a.render.applyFilter(c);
          c.dirty = !1;
          c.dirtyCacheForce = !1
        }
      } else a.feature.debug && "group" !== c.type && console.log("missing data on object", c)
    };
    return this
  };
  a.render.applyFilter = function(b, c, d) {
    d = !1 !== d;
    if (window.glfx && a.supports.webgl && b.canvas && b.filters) {
      var e = a.render.cache,
        f = e.padding,
        k = b.canvas,
        e = e.glfx || (e.glfx = glfx.applyShader(k)),
        k = b.bbox.width * b.bbox.scale.x >> 0,
        h = b.bbox.height * b.bbox.scale.y >> 0,
        k = k * a.canvas2d.pixelRatio,
        h = h * a.canvas2d.pixelRatio;
      e.source = b.canvas;
      e.msaa = !1;
      e.viewport(0, 0, k, h);
      e.setFilter(b.filters);
      var l = c ? function() {
        c && c(b)
      } : null;
      b.ctx && !d || e.render(l);
      d ? b.ctx && (d = e.getComposite(), b.ctx.globalCompositeOperation = "copy", e.msaa ? d && b.ctx.drawImage(d, 2 * f, 2 * f, 2 * k, 2 * h, f, f, k, h) : d && b.ctx.drawImage(d, f, f, k, h)) : e.loadStack(b.filters, l)
    }
  };
  a.render.setBlendMode =
    function(c) {
      var d = a.tool.type;
      if (d) {
        if (!c) {
          var e = a.tool.device;
          if (e && e.brush && e.brush.composite) c = e.brush.composite;
          else if (e && e.composite) c = e.composite;
          else {
            var f = a.configure.tools[d];
            if (!f) return;
            d = f.type
          }
        }
        switch (d) {
          case "crop":
          case "zoom":
          case "snapshot":
          case "text":
            c = "source-over";
            break;
          case "eraser":
            c = "destination-out";
            break;
          default:
            if (c) break;
            a.ui.blendSelectMenu ? (c = a.ui.blendSelectMenu.getValue(), "normal" === c && (c = "source-over"), f.composite = c) : c = f.composite
        }
        b.gco = c;
        f = a.canvas2d.layers;
        d = f.layer0;
        e = f.draw;
        f = f.active;
        c && "source-over" !== c && "normal" !== c ? (d.style.display = "none", e.style.background = d.style.background, f.ctx.canvas.width = f.ctx.canvas.width, f.ctx.drawImage(d, 0, 0)) : (d.style.display = "block", e.style.background = "", f.ctx.canvas.width = f.ctx.canvas.width)
      }
    };
  a.render.preload = function(b) {
    function c(k, m) {
      k.dirtyResource = !1;
      k.error ? a.feature.debug && console.log("action did not load properly", k) : m || !1 === k ? (h.push(m || "Action missing."), k.error = !0) : k.toolkit && k.toolkit.updateObjectSize && (a.feature.vector.edit ?
        k.toolkit.updateObjectSize(k) : "text" === k.toolkit.type && k.toolkit.updateObjectSize(k));
      d && d(1 - (g - 1) / l);
      --g || (a.__rendering = !1, b.norender ? e && e() : f ? a.render("root.render.preload", e) : a.render("root.render.load", e), h.length && window.alertify && alertify.log(h[0]))
    }
    b = b || {};
    var d = b.onprogress || b.onProgress,
      e = b.onload || b.onLoad;
    if (a.__rendering) e && e();
    else {
      !e && (a.feature.history && a.feature.history.autoSelect) && (e = a.scene.checkForSingleSelection);
      var f = "preload" === a.render.state,
        k = a.scene.data;
      if (0 === k.length) a.render("root.render.preload.ignore"),
        e && e();
      else {
        var h = [],
          l = k.length,
          g = l;
        a.__rendering = !0;
        a.scene.sort();
        for (var m = 0; m < l; m++) {
          var z = k[m];
          z.error ? c(z) : z.render && !z.dirtyResource ? c(z) : (a.toolkit.setToolkit(z), z.toolkit ? z.toolkit.loadResource({
            action: z,
            onload: c,
            onprogress: function(a) {},
            useLoader: !b.fromSocket
          }) : c(z, "Missing '" + z.type + "' toolkit"))
        }
      }
    }
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  var g = a.Scene.prototype,
    c = 0,
    f = {},
    b = g.clipboard = {
      loadCopies: function() {
        a.getItem("copies", function(b) {
          b && (a.scene.copies = JSON.parse(b))
        });
        a.getItem("copies-paths", function(a) {
          try {
            f = JSON.parse(a)
          } catch (b) {}
        })
      },
      addFocusEvent: function() {
        eventjs.add(window, "focus", b.loadCopies);
        b.loadCopies()
      }
    };
  g.cut = function(b) {
    a.setItem("useNativePaste", !1);
    b = b || this.selection.items;
    for (var c = this.data, f = [], k = c.length; k--;)
      if (b[k]) {
        var l = c[k];
        f.push(l);
        c.splice(k, 1);
        a.render.cache.clean(l)
      }
    f.length && (this.reindex(),
      this.copies = this.clone(f), h(), this.deselectAll(), b = this.clone(f).reverse(), a.history && a.history.store({
        from: b,
        to: "remove",
        name: "Cut Object(s)"
      }));
    a.on.cut && a.on.cut(this.copies);
    return this
  };
  g.copy = function(b) {
    a.setItem("useNativePaste", !1);
    b = b || this.selection.items;
    for (var c = this.data, f = [], k = c.length; k--;) b[k] && f.push(c[k]);
    f.length && (this.copies = this.clone(f), h(), a.on.copy && a.on.copy(this.copies));
    return this
  };
  g.paste = function(b) {
    if (this.copies && this.copies.length) {
      this.deselectAll();
      for (var c =
          this, h = this.data, k = this.copies, l = k.length, g = function() {
            --l || (c.reindex(), 1 === k.length ? c.checkForSingleSelection() : c.render("root.scene.paste"), c.fireOnSelect(), b && b())
          }, p = function(b) {
            var c = a.assets.data[b.src];
            c && c.clone && "clipart" === b.type && !1 === a.feature.cacheSVG ? c.clone(function(c) {
              a.assets.add(c.toDataURL(), function(a) {
                b.src = a;
                q(b)
              })
            }, !0) : q(b)
          }, q = function(b) {
            h.push(b);
            c.selectByIndex(h.length - 1, !1);
            a.toolkit.setToolkit(b);
            b.toolkit.loadResource({
              action: b,
              onload: g,
              useLoader: !1
            })
          }, t = l; t--;) {
        var s =
          this.clone(k[t]);
        this.getById(s.id) && (k[t].id = s.id = this.createId());
        var w = s.src;
        "string" === typeof w && 0 === w.indexOf("#") && !a.assets.data[w] && f[w] ? a.assets.add({
          type: s.type,
          data: f[w],
          onerror: g,
          onload: function(a, b) {
            s.src = a;
            p(s)
          }
        }) : p(s)
      }
      a.history && (t = this.clone(k), a.history.store({
        from: "add",
        to: t,
        name: "Paste Object(s)"
      }));
      a.on.paste && a.on.paste(this.copies);
      return this
    }
  };
  g.onCutNative = function(b) {
    eventjs.cancel(b);
    a.exec("layer-cut");
    var c = a.scene.stringify(a.scene.copies);
    b.clipboardData ? (b.clipboardData.clearData(),
      b.clipboardData.setData("application/json", c)) : window.clipboardData && (window.clipboardData.clearData(), window.clipboardData.setData("text", c))
  };
  g.onCopyNative = function(b) {
    eventjs.cancel(b);
    a.exec("layer-copy");
    var c = a.scene.stringify(a.scene.copies);
    b.clipboardData ? (b.clipboardData.clearData(), b.clipboardData.setData("application/json", c)) : window.clipboardData && (window.clipboardData.clearData(), window.clipboardData.setData("text", c))
  };
  g.onPasteNative = function(b) {
    if (!a.__rendering && !eventjs.isEditingText()) {
      eventjs.cancel(b);
      var e = a.scene;
      b = b.clipboardData.items;
      var f = [],
        k = 0,
        h = 0;
      if (b)
        for (var g = function() {
            --h || (k !== c && (a.setItem("useNativePaste", !0), c = k), a.getItem("useNativePaste", function(b) {
              if ("true" === b) {
                if (k) {
                  for (b = 0; b < f.length; b++) a.addMedia(f[b], null, function() {
                    a.exec("select")
                  });
                  a.on.paste && a.on.paste(e.copies)
                }
              } else a.exec("layer-paste")
            }))
          }, p = 0; p < b.length; p++) {
          ++h;
          var q = b[p];
          switch (q.type) {
            case "application/json":
              q.getAsString(function(b) {
                try {
                  b = JSON.parse(b), e.copies = b, a.exec("layer-paste")
                } catch (c) {
                  console.log(c)
                }
              });
              break;
            case "text/html":
              q.getAsString(function(b) {
                a.feature.debug && console.log(b);
                0 === b.indexOf("blob:") ? setTimeout(g, 1) : -1 !== b.indexOf("blob:http%3A//") ? setTimeout(g, 1) : a.convert.htmlToCanvas({
                  html: b,
                  onerror: g,
                  onload: function(a) {
                    k += b.length;
                    f.push(a);
                    g()
                  }
                })
              });
              break;
            default:
              if (-1 === q.type.indexOf("image")) {
                setTimeout(g, 1);
                break
              }
              q = q.getAsFile();
              f.push(q);
              k += q.size;
              setTimeout(g, 1)
          }
        }
    }
  };
  g.duplicate = function(a) {
    a = a || this.selection.items;
    this.copies = [];
    this.copy(a).paste();
    return this
  };
  var h = function() {
    var b =
      a.scene.copies;
    f = {};
    a.setItem("copies", JSON.stringify(b));
    a.setItem("copies-paths", JSON.stringify({}));
    a.save.assets({
      toBlobURL: !0,
      actions: b,
      callback: function(b) {
        a.setItem("copies-paths", JSON.stringify(b))
      }
    })
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.SceneSelection = function(a) {
  a.render && (this.render = a.render.clean);
  this.remove = function(g) {
    a.scene.removeSelection(this.items, g);
    return this
  };
  this.idx = this.id = void 0;
  this.length = 0;
  this.items = {};
  this.select = function(g) {
    var c = a.scene.data[g];
    if (!c) return this;
    this.items[g] || (this.items[g] = !0, ++this.length);
    1 === this.length ? (this.id = c.id, this.idx = g) : this.idx = this.id = void 0;
    return this
  };
  this.setData = function(a) {
    this.length = 0;
    for (var c in a) this.select(c);
    return this
  };
  this.deselect = function(a) {
    this.items[a] &&
      (delete this.items[a], --this.length);
    return this
  };
  this.reset = this.deselectAll = function() {
    this.idx = this.id = void 0;
    this.items = {};
    this.length = 0;
    return this
  };
  this.getLength = function() {
    var a = 0,
      c = this.items,
      f;
    for (f in c) a++;
    return a
  };
  this.toObjects = function(g, c) {
    g = g || this.items;
    var f = [],
      b;
    for (b in g) f.push(a.scene.data[b]);
    return c ? a.scene.clone(f) : f
  };
  this.fromObjects = function(a) {
    for (var c = {}, f = 0, b = a.length; f < b; f++) c[a[f].zIndex] = !0;
    return c
  };
  this.parse = function(g) {
    if (g && 0 !== g.length) return Array.isArray(g) ?
      isFinite(g[0].zIndex) ? this.fromObjects(g) : a.util.array2object(g) : "number" === typeof g ? a.util.array2object([g]) : g
  };
  this.rotate = function(a, c) {
    return this.transform({
      rotate: a
    }, c)
  };
  this.scale = function(a, c, f) {
    return this.transform({
      scale: {
        x: a,
        y: c
      }
    }, f)
  };
  this.move = this.translate = function(a, c, f) {
    return this.transform({
      translate: {
        x: a,
        y: c
      }
    }, f)
  };
  return this
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.SceneSelection);
"undefined" === typeof sketch && (sketch = {});
sketch.SceneTransform = function(a) {
  a.history.registerFunction({
    type: "transform",
    fn: function(c, f, b, h) {
      var d = c.origin,
        e = c.rotate,
        g = c.translate;
      c = c.scale;
      if (!h) var k = a.selection.reset().items;
      var l, r;
      "number" === typeof c ? r = l = c : c && (l = c.x, r = c.y);
      var p, q;
      g && (p = g.x, q = g.y);
      b && (e && (e = 360 - e), c && (l = 1 / l, r = 1 / r), g && (p = -p, q = -q));
      for (b = 0; b < f.length; b++) {
        var t = a.scene.getById(f[b]);
        if (t) {
          var s = t.bbox;
          if (e) {
            var w = d.x - s.width / 2 * s.scale.x,
              v = d.y - s.height / 2 * s.scale.y,
              u = e * a.util.DEG_RAD,
              y = Math.cos(u) * (s.x - w) - Math.sin(u) *
              (s.y - v) + w,
              w = Math.sin(u) * (s.x - w) + Math.cos(u) * (s.y - v) + v;
            s.x = y;
            s.y = w;
            s.rotate += e;
            t.dirtyTransform = !0
          }
          c && (w = (d.x - s.x) * l, v = (d.y - s.y) * r, s.x = d.x - w, s.y = d.y - v, s.scale.x *= l, s.scale.y *= r, t.dirty = !0);
          g && (s.x += p, s.y += q, t.dirtyTransform = !0);
          h || (k[t.zIndex] = !0);
          delete t.inbounds
        }
      }
    }
  });
  var g = {};
  return function(c, f, b) {
    var h = c.rotate,
      d = c.scale,
      e = c.translate,
      m = isFinite(h),
      k = "undefined" !== typeof d,
      l = "undefined" !== typeof e,
      r = a.scene,
      p = r.data,
      q = c.abs || c.absolute,
      t = "move" === f || !f,
      s = "record" === f || "up" === f || !f;
    "cache" !== f &&
      "down" !== f && f || (g = {
        updated: 0
      }, g.origin = c.origin || r.getBoundingOrigin({
        fromSelection: !0,
        fromHovered: !0
      }), m && (g.deg = 0), k && (g.sx = 1, g.sy = 1), l && (g.x = 0, g.y = 0));
    f = sk.util.clone(g);
    if (t) {
      if (m) {
        if (0 === h && !k && !l) return;
        g.deg += h
      }
      if (k) {
        if (1 === d.x && 1 === d.y && !m && !l) return;
        isFinite(d) && (d = {
          x: d,
          y: d
        });
        isFinite(d.y) || isFinite(d.x) ? isFinite(d.y) ? isFinite(d.x) || (d.x = d.y) : d.y = d.x : (d.x = 1, d.y = 1);
        g.sx *= d.x;
        g.sy *= d.y
      }
      if (l) {
        if (0 === e.x && 0 === e.y && !m && !k) return;
        g.x += e.x;
        g.y += e.y
      }
    }
    if (Array.isArray(c.items)) {
      for (var w = {}, v = 0; v <
        c.items.length; v++) {
        var u = a.scene.dataById[c.items[v]];
        u && (w[u.zIndex] = !0)
      }
      c.items = w
    }
    var w = [],
      v = g.origin,
      u = c.items || this.items,
      y;
    for (y in u)
      if (u = p[y]) {
        c = u.bbox;
        var x = a.feature[u.type] || a.feature.tools;
        if (h && t)
          if (!1 === u.rotatable || !1 === x.rotatable) u.dirtyControl = !0;
          else {
            if (q) c.rotate = h;
            else {
              var z = v.x - c.width / 2 * c.scale.x,
                A = v.y - c.height / 2 * c.scale.y,
                B = h * a.util.DEG_RAD,
                D = Math.cos(B) * (c.x - z) - Math.sin(B) * (c.y - A) + z,
                z = Math.sin(B) * (c.x - z) + Math.cos(B) * (c.y - A) + A;
              c.x = D;
              c.y = z;
              c.rotate += h
            }
            u.dirtyTransform = !0;
            u.dirtyControl = !0;
            u.inbounds = void 0;
            g.updated = !0
          }
        d && (c.scaleCache = c.scaleCache || {
          x: 1,
          y: 1
        }, t && (!1 === u.scalable || !1 === x.scalable ? u.dirtyControl = !0 : (q ? (c.scale.x = d.x, c.scale.y = d.y) : (D = (v.y - c.y) * d.y, c.x = v.x - (v.x - c.x) * d.x, c.y = v.y - D, c.scale.x *= d.x, c.scale.y *= d.y, c.scaleCache.x *= d.x, c.scaleCache.y *= d.y), u.dirtyTransform = !0, u.dirtyControl = !0, u.inbounds = void 0, r.updateConstrain(u), g.updated = !0)), s && (u.dirty = !0, delete c.scaleCache));
        e && t && (!1 === u.movable || !1 === x.movable ? u.dirtyControl = !0 : (q ? (c.x = e.x, c.y = e.y) : (c.x += e.x, c.y +=
          e.y), u.dirtyTransform = !0, u.dirtyControl = !0, u.inbounds = void 0, r.updateConstrain(u), g.updated = !0));
        g.updated && (s && (d && (u.dirty = !0), u.dirtyControl = !0), w.push(u.id))
      }
    if (!1 === g.updated) return this;
    h = a.dataChannel && a.feature.stream.sketchLive && !b;
    a.history && s && (s = {
        cmd: "transform"
      }, s.origin = v, m && (s.rotate = g.deg), k && (s.scale = {
        x: g.sx,
        y: g.sy
      }), l && (s.translate = {
        x: g.x,
        y: g.y
      }), a.history.store({
        from: s,
        to: w,
        name: "Transform Object(s)"
      }, b), a.on.transform && a.on.transform(s, w), a.on.rotate && m && a.on.rotate(s, w), a.on.scale &&
      k && a.on.scale(s, w), a.on.move && l && a.on.move(s, w));
    h && (s = {}, s.items = w, m && (s.rotate = g.deg), k && (s.scale = {
      x: g.sx,
      y: g.sy
    }), l && (s.translate = {
      x: (g.x - f.x) / 2,
      y: (g.y - f.y) / 2
    }), a.dataChannel.send(["scene.transform", s]));
    a.scene.updateBBox();
    this.render("root.scene.transform");
    return this
  }
};
"undefined" !== typeof module && module.exports && (module.exports = sketch.SceneTransform);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.area && (sketch.area = {});
"undefined" === typeof sketch.theme && (sketch.theme = {});
(function(a) {
  var g = function(a, b) {
    for (var c in a) "undefined" === typeof b[c] && (b[c] = a[c])
  };
  a.area.buttons = {};
  a.area.padding = 0;
  a.theme.init = function() {
    var b = d(),
      f = b.controls;
    new a.util.Queue({
      items: f,
      flatten: !0,
      oncomplete: function() {
        a.area.buttons.mouse = b.mouse;
        a.area.buttons.touch = b.touch;
        c("mouse", f);
        c("touch", f)
      },
      next: function(b, c, d) {
        if (!b.src) return this.next();
        var e = this;
        if ("svg" !== (a.vector.SVG.isSVG(b.src) ? "svg" : b.type) && b.src) return dom.loadImage({
          src: b.src,
          onload: function() {
            f[c] = b;
            f[c].image =
              this;
            e.next()
          },
          onerror: this.next
        });
        new a.vector.SVG({
          skipRender: !0,
          src: b.src,
          onload: function(a) {
            a = f[c] = a;
            g(b, a);
            e.next()
          }
        })
      }
    })
  };
  a.theme.getControls = function() {
    var b = a.area.buttons,
      b = eventjs.isTouch ? b.touch : b.mouse;
    b.anchor && isFinite(b.anchor.padding) ? a.area.padding = b.anchor.padding : a.area.padding = b.padding || 0;
    return b
  };
  var c = function(b, c) {
      var d = a.area.buttons[b],
        h;
      for (h in c) {
        var g = h.split("-"),
          p = g.shift(),
          g = g.shift();
        d[h] = f(p, g, c[h], d.width, d.height)
      }
    },
    f = function(b, c, d, f, h) {
      var p = {};
      g(d, p);
      p.width =
        f;
      p.height = h;
      p.viewBox = [0, 0, f, h];
      p.type = b;
      p.render = function(b) {
        var e = b.ctx;
        e.save();
        "svg" === d.type ? (e.scale(f / d.vob.width, h / d.vob.height), d.render(b)) : "undefined" !== typeof p.image ? e.drawImage(p.image, 0, 0) : ("hover" === c ? (e.strokeStyle = "rgba(255,255,255,0.5)", e.fillStyle = "#0080C2") : (e.strokeStyle = "rgba(255,255,255,0.5)", e.fillStyle = "rgba(30,30,30,1)"), e.beginPath(), e.lineWidth = 1 / a.canvas2d.zoom, b = 1 * f / a.canvas2d.zoom, e.rect(0.5, 0.5, b, b), e.fill(), e.stroke());
        e.restore()
      };
      return p
    },
    b = {
      anchor: !0,
      n: !0,
      ne: !0,
      e: !0,
      se: !0,
      s: !0,
      sw: !0,
      w: !0,
      nw: !0
    },
    h = function(a) {
      a = a || {};
      a.padding = isFinite(a.padding) ? a.padding : 0;
      a.width = isFinite(a.width) ? a.width : 16;
      a.height = isFinite(a.height) ? a.height : 16;
      return a
    },
    d = function(c) {
      var d = a.feature.tools,
        f = {},
        l = f.controls = {};
      f.mouse = h(d.controls.mouse);
      f.touch = h(d.controls.touch);
      var g = function(b, c, d) {
          var e = d[c] || d.normal || {},
            f;
          for (f in d) "normal" !== f && "hover" !== f && "undefined" === typeof e[f] && (e[f] = d[f]);
          if (0 === a.util.count(e)) return {};
          d = e.command;
          !0 === d ? e.command = a.area.rotateScaleEvent :
            "string" === typeof d && (e.command = a.area[d + "Event"]);
          "normal" === c ? l[b] = e : l[b + "-" + c] = e
        },
        p = function(a, b) {
          l[a] = {
            command: b
          };
          l[a + "-hover"] = {
            command: b
          }
        };
      for (c in b) {
        var q = d.controls[c];
        "undefined" !== typeof q && ("string" === typeof q ? p(c, a.area[q]) : "boolean" === typeof q ? !1 !== q && p(c, a.area.rotateScaleEvent) : (g(c, "normal", q), g(c, "hover", q)))
      }
      return f
    }
})(sketch);
(function(a) {
  a.toolkit.register("brush", function(g) {
    function c() {
      if (-1 === b.dragging) b.rendering = !1;
      else {
        !1 === b.dragging && (b.dragging = -1);
        var d = b.deviceLastRecord,
          e = d && d.brush;
        if ("undefined" === typeof e) requestAnimationFrame(c), console.log("brush missing:", b.device, b.device.brush);
        else if (e && (e.dirty || e.speed)) {
          e.ctx = b.ctx;
          e.active = b.draw;
          e.cache = b.cache;
          var f, k = b.batches;
          f = a.canvas2d;
          f = f.zoom * f.pixelRatio;
          var l = e.prepare();
          l.save();
          l.scale(f, f);
          h(l, k);
          l.restore();
          e.postprocess && e.postprocess();
          b.rendering = !0;
          requestAnimationFrame(c);
          if (e.speed && e.isFromBrowser)
            for (var g in b.intervals)
              if (f = k[g])
                if (l = b.intervals[g], !(0 < f.length)) {
                  d.brush.state = "move";
                  var p = {
                    cmd: "L",
                    x: l.x,
                    y: l.y
                  };
                  a.dataChannel && a.dataChannel.send(["brush", e.type, "move," + l.x + "," + l.y + "," + g, eventjs.metaKey, eventjs.shiftKey]);
                  f.push(p);
                  f.path.push(p)
                }
        } else requestAnimationFrame(c)
      }
    }

    function f(c, e, f) {
      var k = this.brush;
      if ("undefined" === typeof k) console.log("brush missing:", k, this);
      else {
        this.dirty && a.scene.copyAttributes(b.attributes, this, k);
        var l = k.interval || this.interval;
        k.ctx = c;
        k.active = b.draw;
        k.cache = b.cache;
        k.isGhost = !1;
        k.isRecording = !1;
        k.interval = l;
        k.bbox = this.bbox;
        k.state = k.state || "up";
        var g = {};
        g[this.finger] = this.data;
        g[this.finger].interval = l;
        !1 !== f && (f = this.bbox, e.matrix.x = f.viewBox[0] * f.scale.x, e.matrix.y = f.viewBox[1] * f.scale.y, e.apply(c, !0));
        c = k.prepare();
        h(c, g, k, this);
        k.interval = l;
        k.postprocess && k.postprocess()
      }
    }
    var b = this;
    this.id = "brush";
    this.type = g.type || "brush";
    this.draw = g.draw.ctx;
    this.active = g.active.ctx;
    this.cache =
      g.cache.ctx;
    this.ctx = g.layer0.ctx;
    this.batches = {};
    this.position = {};
    this.intervals = {};
    this._attributes = {
      blur: "number",
      diameter: "number",
      distance: "number",
      increment: "number",
      innerRadius: "number",
      lineWidth: "number",
      movement: "string",
      outerRadius: "number",
      radius: "number",
      spacing: "object",
      spread: "number",
      src: "string",
      tolerance: "number"
    };
    this.attributes = a.util.mergeObject(a.attributes.styledObject, a.util.clone(this._attributes));
    this.enabled = !1;
    this.enable = function() {
      var c = this.device && this.device.brush;
      c && c.enable && c.enable();
      !0 !== this.enabled && (this.enabled = !0, this.enableGhost(), this.onDrag = eventjs.add(b.active.canvas, "drag", b.record), a.toolkit.select && a.tool !== a.toolkit.select && a.toolkit.select.enable({
        mouse: !1
      }))
    };
    this.disable = function() {
      var b = this.device && this.device.brush;
      b && b.disable && b.disable();
      !1 !== this.enabled && (this.enabled = !1, this.disableGhost(), this.onDrag && this.onDrag.remove(), a.toolkit.select && a.tool !== a.toolkit.select && a.toolkit.select.disable({
        mouse: !1
      }))
    };
    this.ghostEnabled = !1;
    this.enableGhost = function() {
      !b.ghostEnabled && eventjs.isMouse && (b.ghostEnabled = !0, eventjs.add(b.active.canvas, "mouseout", b.ghost), eventjs.add(b.active.canvas, "mousemove", b.ghost))
    };
    this.disableGhost = function() {
      b.ghostEnabled && (b.ghostEnabled = !1, eventjs.remove(b.active.canvas, "mouseout", b.ghost), eventjs.remove(b.active.canvas, "mousemove", b.ghost))
    };
    this.loadResource = function(c) {
      var e = c.action,
        h = c.onload;
      if (e)
        if ("string" === typeof e && (e = {
            type: e
          }), c = a.configure.tools[e.type]) {
          e.dirty = !0;
          e.render = f;
          var k =
            a.scene.copyAttributes(b.attributes, e, a.util.clone(c));
          a.style.updateCache(k);
          k.ctx = b.ctx;
          k.callback = function(c, d) {
            c.type = k.type;
            var f = e.brush = c;
            f.action = e;
            f.seed = f.seed || a.util.Random.seed();
            f.fill = k.fill || a.style.fill;
            f.stroke = k.stroke || a.style.stroke;
            f.composite = k.composite || "source-over";
            f.opacity = isFinite(k.opacity) ? k.opacity : 100;
            f.offset = b.getOffset(f);
            f.prepare = f.prepare || a.toolkit.prepareBrush;
            d && (d = "&ldquo;" + name + "&rdquo; " + c.type + " unavailable.");
            h && h(e, d)
          };
          if (a.toolkit.__init["brush." +
              k.type]) return new a.toolkit.__init["brush." + k.type](k);
          c = k.type + " unavailable.";
          h && h(e, c)
        } else h && h(e)
    };
    this.changeDevice = function(c, e, f) {
      e = e || b.type;
      c = c || a.configure.tools[e];
      this.device = a.util.clone(c);
      this.loadResource({
        action: this.device,
        onload: f
      })
    };
    this.changeColor = function(a) {
      this.device && this.device.brush && (this.device.brush.fill.color = a, this.device.brush.fill.type = "color", this.device.brush.fill.__colors = [0, a])
    };
    this.getDevice = function(b, c) {
      var f = "string" === typeof b ? a.util.clone(a.configure.tools[b]) :
        b;
      this.loadResource({
        action: f,
        onload: c
      });
      return f
    };
    this.getOffset = function(b, c) {
      var f = a.configure.tools[b.type],
        k = f.diameter && b.diameter || 0,
        k = f.diameter && b.diameter ? isFinite(b.diameter) ? b.diameter : b.diameter.value : 0;
      if ("spirograph" === b.type) var h = b.distance || 0,
        k = k + 2 * (Math.abs((b.outerRadius || 0) - (b.innerRadius || 0)) + h);
      else "streamer" === b.type && (k = 20);
      var h = f.scale && b.scale && b.scale.max || 1,
        g = f.translate && b.translate && b.translate.max || 0,
        g = 2 * Math.sqrt(g * g + g * g);
      return (2 * (f.blur && b.blur || 0) + k + (f.lineWidth &&
        b.lineWidth || 0)) * h + g + (a.area && a.area.padding || 0)
    };
    this.updateObjectSize = function(c) {
      if (c.brush && c.type === c.brush.type) {
        var e = c.bbox,
          f = !!e && e.scale.x || 1,
          k = b.getOffset(c, e),
          h = k / 2;
        if (a.detect.refreshPixelData[c.type]) var g = a.area.padding,
          k = -g,
          h = k / 2,
          p = {
            x1: -g,
            y1: -g,
            x2: a.canvas2d.width,
            y2: a.canvas2d.height
          };
        else p = a.detect.catmullRomSpline[c.type] ? new a.vector.BBox(a.vector.catmullRomSplineData({
          path: c.data,
          tension: 0
        })) : new a.vector.BBox(c.data);
        if (e) var q = (e.padding || 0) - h,
          g = e.x + q * f,
          t = e.y + q * f,
          q = 0;
        else q =
          h, g = p.x1, t = p.y1;
        var s = p.x2 - p.x1 + k,
          w = p.y2 - p.y1 + k,
          q = {
            x: g - q * f,
            y: t - q * f,
            width: s,
            height: w,
            padding: h,
            units: "objectBoundingBox",
            viewBox: [0, 0, s, w]
          };
        if (c.firstRecord && "undefined" === typeof e) {
          delete c.firstRecord;
          g = p.x1 + h * f - k / 2;
          t = p.y1 + h * f - k / 2;
          c = c.data;
          for (e = 0; e < c.length; e++) f = c[e], f.x -= g, f.y -= t;
          return q
        }
        q.scale = e.scale;
        q.rotate = e.rotate;
        return c.bbox = q
      }
      b.loadResource({
        action: c,
        onload: b.updateObjectSize
      })
    };
    this.ghost = function(c) {
      if (c && b.device && b.device.brush && "eyeDropper" !== a.colorPicker.state) {
        var e = b.device.brush;
        if ("mouseout" === c.type) delete e.px, delete e.py, delete e.event;
        else {
          e.event = c;
          var f = eventjs.proxy.getCoord(c),
            k = eventjs.proxy.getBoundingBox(a.canvas2d.container);
          c = a.canvas2d;
          var h = c.zoom;
          c = c.zoom * c.pixelRatio;
          c = (f.x - k.x1 - k.scrollLeft) / h;
          f = (f.y - k.y1 - k.scrollBodyTop - a.project.scrollTop) / h;
          if (e.ghostDistance && isFinite(e.px)) {
            var h = e.px - c,
              g = e.py - f,
              p = Math.sqrt(h * h + g * g),
              k = e.ghostDistance;
            p > k && (h = Math.atan2(g, h), e.x = c, e.y = f, e.px = c + Math.cos(h) * k, e.py = f + Math.sin(h) * k)
          } else e.x = c, e.y = f, e.px = c, e.py = f;
          e.finger =
            e.finger || "0:A";
          e.interval = e.interval || 0;
          e.seed = e.seed || 1234567;
          e.ctx = b.ctx;
          e.active = b.active;
          e.cache = b.cache;
          e.isGhost = !0;
          e.isRecording = !0;
          e.path = [{
            cmd: "M",
            x: e.px,
            y: e.py
          }, {
            cmd: "L",
            x: e.x,
            y: e.y
          }];
          c = a.canvas2d;
          c = c.zoom * c.pixelRatio;
          f = e.prepare();
          f.save();
          f.scale(c, c);
          e.render ? e.render() : (f.globalAlpha = e.opacity / 100, f.globalCompositeOperation = a.style.getComposite(e.composite, null, !e.isRecording), e.drawStart && e.drawStart(), e.draw && e.draw(null), e.drawEnd && e.drawEnd());
          f.restore()
        }
      }
    };
    this.record = function(d,
      e, h) {
      if ("eyeDropper" !== a.colorPicker.state) {
        var k = a.toolkit.getMouseId(d, e),
          l = d ? b.device : b.deviceProxy[k];
        if (l && l.brush) {
          b.deviceLastRecordId = k;
          b.deviceLastRecord = l;
          var g = l.type,
            p = l.brush,
            q = b.batches[k],
            t = p.state = e.state,
            s = "down" === t,
            w = "up" === t,
            v = "move" === t,
            t = !!d,
            u = eventjs.shiftKey,
            y = eventjs.metaKey,
            x = a.canvas2d,
            z = x.zoom,
            A = x.zoom * x.pixelRatio,
            B = a.project.scrollLeft,
            D = a.project.scrollTop,
            G = (e.x - B) / z,
            z = (e.y - D) / z;
          if (u && (e.start.x !== e.x || e.start.y !== e.y))
            if (e.lockY) G = e.start.x;
            else if (e.lockX) z = e.start.y;
          else {
            var F = Math.abs(e.start.x - e.x),
              C = Math.abs(e.start.y - e.y);
            F > C ? (G = e.start.x, e.lockX = !0) : (z = e.start.y, e.lockY = !0)
          }
          w && (delete e.lockX, delete e.lockY);
          eventjs.supports.touch ? (p.px = G, p.py = z) : p.px -= B;
          if (s || w) {
            if (p.onDoubleTap && w && !p.cancelListener && q) {
              if (2 < q.length && p.current) {
                var C = q[q.length - 1],
                  E = p.current,
                  F = Math.abs(E.x - C.x),
                  E = Math.abs(E.y - C.y),
                  F = Math.sqrt(F * F + E * E);
                if (500 > (new Date).getTime() - p.timestamp && 25 > F) return p.onDoubleTap()
              }
              p.timestamp = (new Date).getTime();
              p.current = q[q.length - 1]
            }
            if (p.addLineSegment &&
              (q || (p.clickCount = 0), s && p.clickCount++, q)) {
              var F = Math.abs(G - q[0].x),
                E = Math.abs(z - q[0].y),
                C = new a.vector.BBox(q),
                H = C.x2 - C.x1,
                C = C.y2 - C.y1,
                C = Math.sqrt(H * H + C * C),
                F = Math.sqrt(F * F + E * E);
              10 < C && 1 < q.length && (s = !1, v = !0);
              if (10 < F || 10 > C && 1 === p.clickCount) s = !1, w = p.cancelListener || !1, v = !0
            }
          }!q || s ? (q = b.batches[k] = [], q.path = [], q.interval = e.interval || b.interval || 0, p.seed = e.seed || p.seed, p.event = d, p.self = e, d && eventjs.prevent(d)) : d && eventjs.cancel(d);
          s ? (b.disableGhost(), b.dragging = !0, a.style.updateCache(p), 1 === e.fingers &&
            (b.cache.canvas.width = b.ctx.canvas.width, b.cache.canvas.height = b.ctx.canvas.height, b.active.canvas.width = b.ctx.canvas.width, b.active.canvas.height = b.ctx.canvas.height), t && isFinite(p.px) && isFinite(p.py) ? (d = {
              cmd: "M",
              beginPath: !0,
              interval: q.interval,
              x: p.px + B,
              y: p.py
            }, delete p.px, delete p.py) : d = {
              cmd: "M",
              beginPath: !0,
              interval: q.interval,
              x: G,
              y: z
            }, t && (a.dataChannel && a.feature.stream.sketchLive) && (v = e.state + "," + d.x + "," + d.y + "," + k, F = b.interval || 0, C = a.scene.copyAttributes(b.attributes, p, {}), C = a.scene.clone(C, !0), a.dataChannel.send(["brush", g, v, y, u, C, F])), !0 === p.click ? q[0] = d : (q.push(d), q.path.push(d)), p.ghostDistance && (d = {}, d.x = G, d.y = z, d.cmd = "L", q.push(d), q.path.push(d), t && (a.dataChannel && a.feature.stream.sketchLive) && (v = "move," + d.x + "," + d.y + "," + k, a.dataChannel.send(["brush", g, v, y, u])))) : (d = v ? {
            cmd: "L",
            x: G,
            y: z
          } : {
            cmd: "z",
            x: G,
            y: z
          }, t && (a.dataChannel && a.feature.stream.sketchLive) && (v = e.state + "," + d.x + "," + d.y + "," + k, a.dataChannel.send(["brush", g, v, y, u])), p.lineRecord ? (u = w ? Math.min(q.length, 2) : 1, q[u] = d, q.path[u] =
            d) : !0 === p.click ? "z" !== d.cmd && (q[0] = d) : (q.push(d), q.path.push(d)));
          p.dirty = !0;
          p.isGhost = !1;
          p.isRecording = !0;
          p.isFromBrowser = t;
          u = a.feature.vector.edit;
          y = e.action && e.action.bbox;
          if (w) {
            if (p.cancelPointerUp) return b.reset(k);
            if (p.onPointerUp) return b.reset(k), p.onPointerUp();
            var q = 0,
              J;
            for (J in b.batches) q++;
            1 === q && (b.dragging = !1);
            t && (b.gestures--, b.interval = p.interval || 0, 1 === e.fingers && b.enableGhost());
            J = t || a.peer.isStableStream();
            if (t || J || h) {
              var q = b.batches[k],
                I = a.detect.refreshPixelData[p.type] || "source-over" !==
                l.composite,
                l = a.scene.fromConfigure(a.configure.tools[g]),
                l = a.scene.copyAttributes(b.attributes, p, l);
              l.data = a.vector.clean && a.detect.useCleanVector[p.type] ? a.vector.clean(new a.vector.Polygon, q.path) : a.util.clone(q.path);
              l.brush = p;
              l.firstRecord = !0;
              y && a.util.mergeObject(e.action.bbox, l.bbox = {});
              C = b.updateObjectSize(l);
              C.x += 0 + B - 1 * x.x / A;
              C.y += 0 + D - 1 * x.y / A;
              var L;
              a.feature.vector.record && (d = l.data, g = a.scene.copyAttributes(b.attributes, p, {
                finger: k,
                type: g,
                data: d,
                interval: d[0].interval,
                bbox: C
              }), e.action ? (a.scene.copyAttributes(b.attributes,
                e.action, g), a.scene.copyRules(e.action, g)) : a.scene.copyRules(p, g), L = a.scene.addObject(g), u || I || (L.render = f, L.dirty = !1));
              t && (p.seed = p.seed || a.util.Random.seed())
            }
            a.feature.vector.edit && b.reset(k);
            if (t || J || h) {
              var O = function() {
                b.draw.canvas.width = b.draw.canvas.width;
                a.history && a.history.store({
                  from: "add",
                  to: sk.scene.clone([L]),
                  name: "Create " + STRING.ucwords(L.type)
                });
                h && h()
              };
              if (u) a.scene.deselectAll(), a.scene.updateTransform(L), a.scene.sort(), b.loadResource({
                action: L,
                onload: function() {
                  if (e.action) return O();
                  a.render("root.toolkit.brush", O)
                }
              });
              else {
                if (I || "place" === e.identifier) p.cmd = "z", p.render(p);
                a.ctx.globalAlpha = 1;
                a.ctx.globalCompositeOperation = "source-over";
                a.ctx.drawImage(a.canvas2d.layers.draw, 0, 0);
                a.scene.deselectAll();
                O()
              }
            } else b.draw.canvas.width = b.draw.canvas.width
          } else !1 === b.rendering && s && (b.rendering = !0, c())
        }
      }
    };
    this.reset = function(a) {
      a || (b.draw.canvas.width = b.draw.canvas.width);
      var c = b.deviceLastRecord,
        f = b.deviceLastRecordId;
      (a = a || f) && c && (c = c.brush, delete b.batches[a], delete b.intervals[a],
        delete b.position[a + "x"], delete b.position[a + "y"], delete c.cancelListener, delete c.cancelPointerUp, delete c.timestamp, delete c.current, delete c.event, delete c.self)
    };
    var h = function(c, e, f, k) {
      for (var h in e) {
        k || (f = (b.deviceProxy[h] || b.device).brush);
        var g = f.opacity / 100,
          p = a.style.getComposite(f.composite, null, !f.isRecording),
          q = "destination-out" === f.composite || "eraser" === f.type,
          t = f.isRecording,
          s = f.isGhost,
          w = "disco" === f.composite,
          v = a.detect.useLocalAlpha[f.type],
          u = "undefined" !== typeof f.draw,
          y = f.offset /
          2;
        f.dirty = !1;
        var x = e[h];
        if (0 !== x.length && (x.interval = x.interval || 0, f.path = x.path || x, f.finger = h, c = f.renderTo || f.ctx, t || c)) {
          c.save();
          t && a.detect.useOffsetCache[f.type] && (y = f.offset / 2 % 1, 0.5 < y && (y = -(0.5 - y)), c.translate(y, y));
          if (f.render) t = x[x.length - 1], f.cmd = t && t.cmd, f.render(k || f), f.interval = x.interval;
          else
            for (c.globalAlpha = v ? g : 1, c.globalCompositeOperation = q && !t ? "source-over" : p, g = 0, p = x.length; g < p; g++) {
              q = t || s ? x.shift() : x[g];
              v = q.x;
              y = q.y;
              f.x = v;
              f.y = y;
              if ("M" === q.cmd) {
                var z = b.position[h + "x"] = v,
                  A = b.position[h +
                    "y"] = y,
                  B = z,
                  D = A;
                x.increment = 0;
                f.cmd = q.cmd;
                f.px = B;
                f.py = D;
                t && b.gestures++;
                f.drawStart && (f.interval = ++x.interval, f.drawStart())
              } else {
                if ("z" === q.cmd) {
                  f.drawEnd && (f.cmd = q.cmd, f.interval = ++x.interval, f.drawEnd());
                  break
                }
                z = b.position[h + "x"];
                A = b.position[h + "y"];
                B = z;
                D = A;
                f.px = B;
                f.py = D
              }
              f.speed && (b.intervals[h] = q);
              if (u) {
                var G = f.spacing.min,
                  F = f.spacing.max,
                  C = v - z,
                  E = y - A,
                  H = Math.sqrt(C * C + E * E) + 1;
                if (!(H < G && "M" !== q.cmd)) {
                  G = C / H || 0;
                  E = E / H || 0;
                  C = F || 1;
                  for (F = F < H - 1 ? F : H - 1; F < H; F += C) v = z + G * F, y = A + E * F, w && (c.globalCompositeOperation =
                    0 === x.interval % 2 ? "lighter" : "source-over"), f.x = v, f.y = y, f.px = B, f.py = D, f.cmd = q.cmd, f.interval = ++x.interval, f.draw(x.increment), B = v, D = y;
                  b.position[h + "x"] = v;
                  b.position[h + "y"] = y;
                  x.increment++
                }
              }
            }
          c.restore()
        }
      }
    };
    return a.toolkit.init(this)
  });
  "undefined" === typeof a.vector && (a.vector = {});
  a.vector.catmullRomSplineData = function(g) {
    var c = a.util.clone(g.path),
      f = 1 - (g.tension || 0),
      b = c.length - 2;
    c.splice(0, 0, c[0]);
    c.push(c[c.length - 1]);
    c.push(c[c.length - 1]);
    if (0 >= b) return g.path;
    g = [];
    for (var h = 0; h < b; h++) {
      var d = c[h],
        e = c[h + 1],
        m = c[h + 2],
        k = c[h + 3];
      0 === h && g.push({
        beginPath: !0,
        interval: e.interval,
        cmd: "M",
        x: e.x,
        y: e.y
      });
      g.push({
        cmd: "C",
        x1: e.x + (f * m.x - f * d.x) / 6,
        y1: e.y + (f * m.y - f * d.y) / 6,
        x2: m.x + (f * e.x - f * k.x) / 6,
        y2: m.y + (f * e.y - f * k.y) / 6,
        x: m.x,
        y: m.y
      })
    }
    return g
  };
  a.vector.catmullRomSpline = function(g) {
    var c = a.util.clone(g.path),
      f = 1 - (g.tension || 0),
      b = g.ctx,
      h = c.length - 2;
    c.splice(0, 0, c[0]);
    c.push(c[c.length - 1]);
    c.push(c[c.length - 1]);
    if (0 >= h) {
      var d = c[0],
        e = c[1];
      b.moveTo(d.x, d.y);
      b.lineTo(e.x + 0.1, e.y + 0.1)
    } else {
      for (var m = 0; m < h; m++) {
        var d = c[m],
          e = c[m + 1],
          k = c[m + 2],
          l = c[m + 3];
        0 === m && (b.beginPath(), b.moveTo(e.x, e.y));
        b.bezierCurveTo(e.x + (f * k.x - f * d.x) / 6, e.y + (f * k.y - f * d.y) / 6, k.x + (f * e.x - f * l.x) / 6, k.y + (f * e.y - f * l.y) / 6, k.x, k.y)
      }
      if (g.offsetPath) {
        g = 17 * Math.cos(0.5);
        for (var r = 17 * Math.sin(0.5), m = h; 0 < m; m--) d = c[m], e = c[m + 1], k = c[m + 2], l = c[m + 3], 0 === m && (b.beginPath(), b.moveTo(e.x + g, e.y + g)), b.bezierCurveTo(e.x + (f * k.x - f * d.x) / 6 + g, e.y + (f * k.y - f * d.y) / 6 + r, k.x + (f * e.x - f * l.x) / 6 + g, k.y + (f * e.y - f * l.y) / 6 + r, k.x + g, k.y + r)
      }
    }
  };
  a.toolkit.applyStyle = function(g, c, f, b, h, d, e) {
    g.save();
    if (c.bbox) var m = -c.bbox.x,
      k = -c.bbox.y;
    else var k = c.offset || 0,
      l = sketch.canvas2d,
      m = 1 * l.x / l.zoom + k / 2,
      k = 1 * l.y / l.zoom + k / 2;
    g.translate(m, k);
    e && c.stroke.__colors && (e = c.stroke, e.__colors && (e.lineWidth || c.diameter) && (e = c.fill.__colors, m = e.length, k = 2 * c.interval + 1, g.strokeStyle = e[Math.abs(k % (2 * m) - m)], g.stroke()));
    d && c.fill.__colors && (e = c.fill.__colors, m = e.length, k = 2 * c.interval + 1, g.fillStyle = e[Math.abs(k % (2 * m) - m)], g.fill());
    g.restore();
    "gradient" === c.fill.type && "cycle" !== c.fill.mode && a.toolkit.trackGradient(g,
      c, b, h, f)
  };
  a.toolkit.trackGradient = function(g, c, f, b, h, d) {
    var e = c.blur || 0,
      m = (c.diameter || 0) + e,
      k = m / 2;
    if (c.bbox) d = a.render.cache.enabled ? {
      x1: -c.bbox.padding || 0,
      y1: -c.bbox.padding || 0,
      x2: c.bbox.width / c.bbox.scale.x,
      y2: c.bbox.height / c.bbox.scale.y
    } : {
      x1: c.bbox.x,
      y1: c.bbox.y,
      x2: c.bbox.x + c.bbox.width,
      y2: c.bbox.y + c.bbox.height
    };
    else if (c.isRecording && !d) {
      var l = c.path,
        r = l.length;
      2 >= r && delete c._bbox;
      d = c._bbox || {
        x1: Infinity,
        y1: Infinity,
        x2: -Infinity,
        y2: -Infinity
      };
      var p = k,
        e = k + e + a.area.padding,
        l = l[r - 1];
      l.x < d.x1 +
        p && (d.x1 = l.x - p);
      l.y < d.y1 + p && (d.y1 = l.y - p);
      l.x > d.x2 - e && (d.x2 = l.x + e);
      l.y > d.y2 - e && (d.y2 = l.y + e);
      c._bbox = d
    }
    g.save();
    g.beginPath();
    g.shadowBlur = 0;
    g.globalAlpha = 1;
    g.globalCompositeOperation = "source-atop";
    g.translate(f, b);
    f = d.x1;
    b = d.x2;
    p = d.y1;
    d = d.y2;
    c.isRecording ? (g.fillStyle = a.style.createGradient("fill", g, f, p, b, d, c), g.fillRect(f - k, p - k, b - f + m, d - p + m)) : (f += k, p += k, m += 0, k = m / 2 + 0, g.fillStyle = a.style.createGradient("fill", g, f * h + 0 - k, p * h + 0 - k, b * h + 0 - k, d * h + 0 - k, c), g.fillRect(f - k, p - k, b + 2 * m, d + 2 * m));
    g.restore()
  };
  a.toolkit.drawFromCache =
    function(g, c) {
      g.active.save();
      g.useBlendMode ? (g.active.globalAlpha = 1, g.active.globalCompositeOperation = "copy", g.active.drawImage(g.ctx.canvas, 0, 0)) : g.active.canvas.width = g.active.canvas.width;
      "up" !== g.state && (g.useAutoClear && (c = 1), g.active.globalAlpha = c || g.opacity / 100, g.active.globalCompositeOperation = a.style.getComposite(g.composite), g.active.drawImage(g.cache.canvas, 0, 0));
      g.active.restore()
    };
  a.toolkit.prepareBrush = function() {
    var g = this.type;
    this.useAutoClear = a.detect.useAutoClear[g] || this.isGhost;
    this.useBlendMode = "source-over" !== this.composite;
    this.useGlobalAlpha = !a.detect.useLocalAlpha[g];
    this.useTrackGradient = a.detect.useTrackGradient[g] && "color" !== this.fill.type;
    if (this.isRecording || this.isGhost) {
      var c = this.isGhost || "down" === this.state;
      if (c) {
        var f = this.active;
        f.clearRect(0, 0, f.canvas.width, f.canvas.height)
      }
      if (this.useTrackGradient) this.useCache = !0, f = this.cache;
      else if (this.useBlendMode) {
        if (a.detect.stampResource[g]) {
          f = this.renderTo = this.active;
          if (this.isGhost || "down" === this.state) f.clearRect(0,
            0, f.canvas.width, f.canvas.height), f.drawImage(a.ctx.canvas, 0, 0);
          return f
        }
        c && (f.globalAlpha = 1, f.drawImage(a.ctx.canvas, 0, 0));
        this.useCache = !0;
        f = this.cache
      } else this.useCache = !1, f = this.active;
      this.renderTo = f
    } else this.useCache = !1, this.renderTo = f = this.renderTo = this.ctx;
    this.useAutoClear && f.clearRect(0, 0, f.canvas.width, f.canvas.height);
    return f
  }
})(sketch);
(function(a) {
  a.toolkit.register("brush.arrow", function(g) {
    this.construct = function(a) {
      this.diameter = isFinite(a.diameter) ? a.diameter : 30;
      this.ghostDistance = isFinite(a.ghostDistance) ? a.ghostDistance : 10;
      this.lineRecord = !0;
      a.callback(this);
      return this
    };
    this.prepare = a.toolkit.prepareBrush;
    this.postprocess = function() {
      this.state && "up" !== this.state || this.active.clearRect(0, 0, this.active.canvas.width, this.active.canvas.height)
    };
    this.render = function(c) {
      var f = this.path.length;
      c = this.renderTo;
      var b = this.fill.__colors,
        h = b[1 % b.length],
        b = this.diameter,
        d = this.useTrackGradient;
      c.save();
      c.beginPath();
      if (this.isRecording) {
        var e = 1;
        c.globalAlpha = this.opacity / 100;
        c.globalCompositeOperation = a.style.getComposite(this.composite)
      } else e = this.bbox.scale.x, c.globalAlpha = 1;
      c.lineCap = "miter";
      c.miterLimit = 20;
      c.lineWidth = b / 4;
      c.strokeStyle = h;
      c.fillStyle = h;
      var g = this.path[0],
        f = this.path[f - 1];
      if (g && f) {
        var h = g.x,
          g = g.y,
          k = f.x,
          l = f.y,
          r = Math.PI / 8;
        c.beginPath();
        c.moveTo(h, g);
        c.lineTo(h + (k - h), g + (l - g));
        c.stroke();
        var p = Math.atan2(l - g, k - h),
          f =
          b,
          q = k + Math.cos(p) * b / 2,
          t = l + Math.sin(p) * b / 2,
          s = p + Math.PI + r,
          w = q + Math.cos(s) * f,
          s = t + Math.sin(s) * f,
          p = p + Math.PI - r,
          r = q + Math.cos(p) * f,
          f = t + Math.sin(p) * f;
        c.save();
        c.beginPath();
        c.moveTo(w, s);
        c.lineTo(q, t);
        c.lineTo(r, f);
        c.quadraticCurveTo((w + q + r) / 3, (s + t + f) / 3, w, s);
        c.closePath();
        c.fill();
        c.restore();
        d && (a.toolkit.trackGradient(c, this, 0, 0, e, {
          x1: Math.min(h, k) - b / 2,
          y1: Math.min(g, l) - b / 2,
          x2: Math.max(h, k) + b / 2 + a.area.padding,
          y2: Math.max(g, l) + b / 2 + a.area.padding
        }), a.toolkit.drawFromCache(this));
        c.restore()
      }
    };
    return this.construct(g)
  })
})(sketch);
(function(a) {
  a.toolkit.register("brush.streamer", function(g) {
    var c = {},
      f = function(b, f, d, e, g) {
        if (c[f]) {
          var k = 0.2 * c[f].thickness,
            l = c[f].cos,
            r = c[f].sin,
            p = c[f].color;
          b.beginPath();
          b.strokeStyle = p;
          b.arc(d, e, k, 0, 2 * Math.PI, !0);
          b.moveTo(c[f].x + l, c[f].y + r);
          b.lineTo(d + 0.2 * l, e + 0.2 * r);
          b.lineTo(d - 0.2 * l, e - 0.2 * r);
          b.lineTo(c[f].x - l, c[f].y - r);
          b.lineTo(c[f].x + l, c[f].y + r);
          a.toolkit.applyStyle(b, g, 1, 0, 0, !0, !1);
          b.stroke()
        }
      };
    this.construct = function(a) {
      this.spacing = a.spacing || [0, 0];
      a.callback(this)
    };
    this.prepare = function() {
      this.useTrackGradient =
        "color" !== this.fill.type;
      this.useBlendMode = "source-over" !== this.composite;
      if (this.isRecording) {
        if (this.useBlendMode || 100 !== this.opacity) {
          var b = this.renderTo = this.active;
          "down" === this.state && this.useBlendMode && (b.clearRect(0, 0, b.canvas.width, b.canvas.height), b.drawImage(a.ctx.canvas, 0, 0));
          this.useCache = !0;
          b = this.cache
        } else this.useCache = !1, b = this.active;
        return this.renderTo = b
      }
      this.useCache = !1;
      return this.renderTo = this.ctx
    };
    this.drawStart = function() {
      var a = this.finger;
      this.fill.mode = "cycle";
      c[a] = {};
      c[a].x = this.x;
      c[a].y = this.y;
      c[a].px = this.x;
      c[a].py = this.y;
      c[a].vectorx = 0;
      c[a].vectory = 0;
      c[a].cos = 0;
      c[a].sin = 0;
      c[a].time = (new Date).getTime();
      c[a].thickness = 0;
      c[a].rotation = Math.PI / 2;
      c[a].color = "#000"
    };
    this.draw = function() {
      var b = this.finger,
        h = this.fill.__colors;
      if (c[b] && h) {
        var d = this.useCache,
          e = h.length,
          h = h[Math.abs((2 * this.interval + 1) % (2 * e) - e)],
          e = this.renderTo,
          g = this.x - c[b].px,
          k = this.y - c[b].py,
          l = (new Date).getTime();
        if (5 < Math.abs(g) || 5 < Math.abs(k)) {
          c[b].color = h;
          0 > g * c[b].vectorx + k * c[b].vectory && (f(e,
            b, this.px, this.py, this), c[b].x = c[b].px = this.px, c[b].y = c[b].py = this.py, c[b].rotation += Math.PI, c[b].thickness *= 0.2);
          c[b].x += 0.42 * (this.x - c[b].x);
          c[b].y += 0.42 * (this.y - c[b].y);
          var r = c[b].x - c[b].px,
            p = c[b].y - c[b].py,
            q = Math.sqrt(r * r + p * p),
            r = 0 !== q ? Math.PI / 2 + Math.atan2(p, r) : 0,
            p = c[b].thickness + 0.42 * (0.25 + 0.12 * q - c[b].thickness),
            t = Math.sin(c[b].rotation),
            s = Math.cos(c[b].rotation),
            w = Math.sin(r),
            v = Math.cos(r),
            u = c[b].thickness * t,
            y = c[b].thickness * s,
            w = p * w,
            v = p * v,
            t = 0.33 * q * t,
            x = -0.33 * q * s,
            q = c[b].px + y + t,
            s = c[b].py + u + x,
            t =
            c[b].px - y + t,
            x = c[b].py - u + x;
          e.beginPath();
          e.strokeStyle = h;
          e.moveTo(c[b].px + y, c[b].py + u);
          e.quadraticCurveTo(q, s, c[b].x + v, c[b].y + w);
          e.lineTo(c[b].x - v, c[b].y - w);
          e.quadraticCurveTo(t, x, c[b].px - y, c[b].py - u);
          e.lineTo(c[b].px + y, c[b].py + u);
          a.toolkit.applyStyle(e, this, 1, 0, 0, !0, !1);
          e.stroke();
          c[b].px = c[b].x;
          c[b].py = c[b].y;
          c[b].rotation = r;
          c[b].thickness = p;
          c[b].vectorx = g;
          c[b].vectory = k;
          c[b].cos = v;
          c[b].sin = w;
          c[b].time = l;
          d && a.toolkit.drawFromCache(this)
        }
      }
    };
    this.drawEnd = function() {
      var a = this.finger;
      "undefined" !==
      typeof c[a] && (f(this.ctx, a, this.x, this.y, this), delete c[a])
    };
    this.construct(g)
  })
})(sketch);
(function(a) {
  a.toolkit.register("brush.calligraphy", function(g) {
    this.construct = function(a) {
      this.diameter = isFinite(a.diameter) ? a.diameter : 30;
      this.spacing = a.spacing || [0, 0];
      a.callback(this)
    };
    this.prepare = a.toolkit.prepareBrush;
    this.draw = function() {
      var c = this.fill.__colors.length;
      Math.abs((2 * this.interval + 1) % (2 * c) - c);
      var c = this.diameter,
        f = this.isRecording || this.isGhost,
        b = f ? this.cache : this.ctx;
      b.save();
      b.globalCompositeOperation = "source-over";
      b.beginPath();
      b.lineCap = "round";
      b.translate(-c / 2, 0);
      b.moveTo(this.px,
        this.py);
      b.lineTo(this.px + c, this.py - c / 2);
      b.lineTo(this.x + c, this.y - c / 2);
      b.lineTo(this.x, this.y);
      b.closePath();
      a.toolkit.applyStyle(b, this, 1, 0, 0, !0, !0);
      f && a.toolkit.drawFromCache(this);
      b.restore()
    };
    this.construct(g)
  });
  a.toolkit.register("brush.pencil", function(g) {
    this.construct = function(a) {
      this.diameter = isFinite(a.diameter) ? a.diameter : 30;
      this.spacing = a.spacing || [0, 0];
      this.useSmooth = !0;
      a.callback(this);
      return this
    };
    this.prepare = a.toolkit.prepareBrush;
    this.render = function(c) {
      c = this.path.length;
      var f =
        this.diameter,
        b = this.useCache,
        h = this.renderTo;
      h.save();
      h.beginPath();
      h.globalAlpha = this.isRecording ? this.opacity / 100 : 1;
      if (this.isRecording && !this.useSmooth)
        for (var d = 0; d < c; d++) {
          var e = this.path[d];
          "M" === e.cmd ? (h.moveTo(e.x, e.y), h.lineTo(e.x + 0.1, e.y + 0.1)) : h.lineTo(e.x, e.y)
        } else a.vector.catmullRomSpline({
          path: this.path,
          tension: 0,
          ctx: h
        });
      h.lineCap = "round";
      h.lineJoin = "round";
      h.lineWidth = f;
      a.toolkit.applyStyle(h, this, 1, 0, 0, !1, !0);
      b && a.toolkit.drawFromCache(this);
      h.restore()
    };
    return this.construct(g)
  });
  a.toolkit.register(["brush.eraser", "brush.paintbrush"], function(g) {
    this.bitmap = {};
    this.construct = function(a) {
      this.diameter = isFinite(a.diameter) ? a.diameter : 30;
      this.blur = isFinite(a.blur) ? a.blur : 10;
      this.spacing = a.spacing || [0, 0];
      this.useSmooth = !0;
      a.callback(this);
      return this
    };
    this.prepare = a.toolkit.prepareBrush;
    this.render = function(c) {
      var f = this.isRecording,
        b = this.path.length,
        h = this.useTrackGradient,
        d = this.useCache,
        e = this.renderTo,
        g = this.fill.__colors,
        g = "eraser" === this.type ? a.configure.backgroundRaw :
        g[1 % g.length],
        k = this.diameter,
        l = this.blur,
        r = 0,
        p = 0,
        q = a.canvas2d,
        t = q.pixelRatio;
      if (c && c.bbox) q = c.bbox.scale.x, l && (p = c.bbox.width + (2.5 + a.area.padding) / q, p = p * t + a.render.cache.padding);
      else if (q = q.zoom, l) {
        c = window.innerHeight;
        var s = window.innerWidth,
          p = s / q + k / 2,
          r = c / q + k / 2;
        r > p ? (r = 0, s - this.x > s / 2 && (p *= -1), p *= t) : (p = 0, c - this.y > c / 2 && (r *= -1), r *= t)
      }
      e.save();
      e.beginPath();
      e.globalAlpha = f ? this.opacity / 100 : 1;
      if (f && !this.useSmooth)
        for (f = 0; f < b; f++) t = this.path[f], "M" === t.cmd ? (e.moveTo(t.x, t.y), e.lineTo(t.x + 0.1, t.y + 0.1)) :
          e.lineTo(t.x, t.y);
      else l && e.translate(-p / t, -r / t), a.vector.catmullRomSpline({
        path: this.path,
        tension: 0,
        ctx: e
      });
      l ? (e.strokeStyle = "#000", e.shadowOffsetX = p * q, e.shadowOffsetY = r * q, e.shadowBlur = l * q, e.shadowColor = g.indexOf ? g : "#000") : e.strokeStyle = g;
      e.lineCap = "round";
      e.lineJoin = "round";
      e.lineWidth = k;
      e.stroke();
      h && a.toolkit.trackGradient(e, this, p, r, q);
      d && a.toolkit.drawFromCache(this);
      e.restore()
    };
    return this.construct(g)
  })
})(sketch);
(function(a) {
  a.toolkit.register("shape", function(c) {
    var f = this;
    this.type = "shape";
    this.active = c.active.ctx;
    this.cache = c.cache.ctx;
    this.ctx = c.layer0.ctx;
    this.device = {};
    this.device.fill = {};
    this.time = this.gid = 0;
    this.batches = {};
    this.events = {};
    this.path = {};
    this._attributes = {
      movement: "string",
      coils: "number",
      imperfection: "number",
      startAngle: "number",
      endAngle: "number",
      anticlockwise: "number",
      m: "number",
      n1: "number",
      n2: "number",
      n3: "number",
      points: "number",
      roundness: "number",
      sides: "number",
      slope: "number",
      spread: "number"
    };
    this.attributes = a.util.mergeObject(a.attributes.styledObject, a.util.clone(this._attributes));
    this.enable = function() {
      var b = this.active.canvas;
      this.disable();
      this.device.useGesture = !1;
      this.events[this.gid] = f.device.useGesture ? eventjs.add(b, "gesture", new this.record) : eventjs.add(b, "drag", new this.record);
      a.tool !== a.toolkit.select && a.toolkit.select.enable({
        mouse: !1
      })
    };
    this.disable = function() {
      for (var b in this.events) this.events[b].remove(), delete this.events[b];
      a.tool !== a.toolkit.select && a.toolkit.select.disable({
        mouse: !1
      })
    };
    this.updateObjectSize = function(b) {
      a.toolkit.updateObjectSize(b, f)
    };
    this.changeDevice = function(b, c, d) {
      c = a.util.clone(b);
      this.device = a.scene.copyAttributes(f.attributes, b, c);
      this.loadResource({
        action: this.device,
        onload: d
      })
    };
    this.changeColor = function(a) {
      this.device.fill.type = "color";
      this.device.fill.color = a;
      this.device.fill.__colors = [0, a]
    };
    this.getDevice = function(b, c) {
      var d = "string" === typeof b ? a.util.clone(a.configure.tools[b]) : b;
      this.cloneValues(d, d);
      this.loadResource({
        action: d,
        onload: c
      });
      return d
    };
    this.loadResource = function(b) {
      var c = b.action,
        e = b.onload;
      "string" === typeof c && (c = {
        type: c
      });
      (b = a.configure.tools[c.type]) ? (c.dirty = !0, c.render = d, b = a.scene.copyAttributes(f.attributes, c, a.util.clone(b)), c.fill = c.fill || b.fill || a.style.fill, c.stroke = c.stroke || b.stroke || a.style.stroke, c.composite = c.composite || b.composite || "source-over", c.movement = c.movement || b.movement || "placement", c.type = c.type || b.type || "star", c.seed = c.seed || a.util.Random.seed(), f.cloneValues(b, c), a.style.load(c, function(a) {
        e && e(c)
      })) :
      e && e(c)
    };
    this.cloneValues = function(a, b) {
      var c = this.attributes,
        d;
      for (d in c) switch (c[d]) {
        case "number":
          a[d] && isFinite(a[d].value) && (b[d] = a[d].value)
      }
    };
    this.createObject = function(b, c) {
      var d = b.device,
        e = b.bbox,
        k = {
          x: 0,
          y: 0
        },
        h = {
          x: 0,
          y: e.height / 2
        },
        l = {
          type: d.type,
          render: f.renderAction,
          data: {
            pt1: k,
            pt2: h,
            rotation: 0,
            time: 0
          },
          composite: d.composite,
          opacity: d.opacity,
          bbox: e
        },
        g = e.scale.x,
        e = e.scale.y,
        m = h.x - k.x,
        x = h.y - k.y,
        m = Math.max(0, Math.sqrt(m * m + x * x)),
        x = k.x - m * g,
        z = k.y - m * e,
        z = z + (g - 1) * m / 2 + (e - 1) * m;
      k.x -= x;
      k.y -= z;
      h.x -= x;
      h.y -= z;
      a.scene.copyRules(b.action, l);
      d = a.scene.copyAttributes(f.attributes, d, l);
      d = a.scene.addObject(d);
      c && c(d)
    };
    this.record = function() {
      var c = f.gid;
      return function(k, l, g) {
        var m = l.state,
          w = "down" === m || "start" === m,
          v = "up" === m || "end" === m,
          u = !!k,
          y = a.toolkit.getMouseId(k, l);
        if (m = u ? f.device : f.deviceProxy[y]) {
          f.deviceLastRecordId = y;
          f.deviceLastRecord = m;
          w ? (m.seed = a.util.Random.seed(), m.tmp = {}, m.tmp.start = {
            x: l.x,
            y: l.y
          }) : u && eventjs.cancel(k);
          var x = l.start || m.tmp.start,
            z = isFinite(l.shiftKey) ? l.shiftKey : eventjs.shiftKey,
            A = isFinite(l.metaKey) ? l.metaKey : eventjs.metaKey;
          m.metaKey = A;
          m.shiftKey = z;
          if (u && a.dataChannel && a.feature.stream.sketchLive)
            if (k = l.state + "," + l.x + "," + l.y + "," + y, w) {
              var B = a.scene.copyAttributes(f.attributes, m, {}),
                B = a.scene.clone(B, !0);
              a.dataChannel.send(["shape", m.type, k, A, z, B])
            } else a.dataChannel.send(["shape", m.type, k, A, z]);
          var D = f.batches[y];
          D || (D = f.batches[y] = [], D.time = f.time);
          k = a.canvas2d;
          var G = k.zoom,
            B = k.zoom * k.pixelRatio,
            F = (G - 1) / G,
            C = a.project.scrollLeft * F,
            F = a.project.scrollTop * F;
          if (m.useGesture)
            if (w) f.gestures++,
              f.events[++f.gid] = eventjs.add(f.active.canvas, "gesture", new f.record);
            else {
              v && (f.gestures--, f.events[c].remove(), f.time = D.time, delete f.events[c]);
              var E = {};
              E.pt1 = l.touches[0];
              E.pt2 = l.touches[1];
              E.rotation = l.rotation;
              E.state = l.state;
              E.time = f.time;
              D[0] = E
            } else {
            var E = {},
              w = x.x / G + C,
              H = x.y / G + F;
            l.y = l.y / G + F;
            l.x = l.x / G + C;
            if ("drag" === m.movement) {
              E.pt1 = {
                x: b[y],
                y: h[y]
              };
              b[y] = l.x;
              h[y] = l.y;
              if ("undefined" === typeof E.pt1.x) return;
              v && (delete b[y], delete h[y])
            } else E.pt1 = {
              x: w,
              y: H
            };
            E.pt2 = {
              x: l.x,
              y: l.y
            };
            E.rotation = -Math.atan2(l.x -
              E.pt1.x, l.y - E.pt1.y) * a.util.RAD_DEG + 180;
            E.state = l.state;
            E.time = f.time;
            D[0] = E
          }
          if (v && (v = u || a.peer.isStableStream(), u || v)) {
            if (!1 === (x.x !== l.x || x.y !== l.y)) return;
            y = !!A;
            x = !!z;
            a.detect.shapeConstrain[m.type] ? (y = !x, x = !0) : y && (x = !0);
            l = a.util.clone(E);
            u = l.pt1;
            z = l.pt2;
            m.useGesture ? (v = z.x - u.x, A = z.y - u.y, v = Math.max(0, Math.sqrt(v * v + A * A) - 75)) : (v = z.x - u.x, A = z.y - u.y, v = Math.max(0, Math.sqrt(v * v + A * A)));
            !1 === y && (E.rotation = 0);
            x ? x = y = 1 : (Math.abs(u.x - z.x) > Math.abs(u.y - z.y) ? (y = 1, x = Math.abs(u.y - z.y) / Math.abs(u.x - z.x)) : (y = Math.abs(u.x -
              z.x) / Math.abs(u.y - z.y), x = 1), isFinite(y) || (y = 0), isFinite(x) || (x = 0));
            A = u.x - v * y;
            w = u.y - v * x;
            u.x -= A;
            u.y -= w;
            z.x -= A;
            z.y -= w;
            E = a.scene.copyAttributes(f.attributes, m, {
              type: m.type,
              data: l,
              composite: m.composite,
              opacity: m.opacity,
              render: f.renderAction,
              bbox: {
                x: A + 0 - 1 * k.x / B,
                y: w + 0 - 1 * k.y / B,
                width: 2 * v,
                height: 2 * v,
                rotate: E.rotation,
                units: "objectBoundingBox",
                scale: {
                  x: y,
                  y: x
                }
              }
            });
            E = a.scene.addObject(E);
            E.render = d;
            E.dirty = !0;
            a.style.updateCache(E);
            a.scene.deselectAll();
            a.render("root.shape.record");
            a.history && a.history.store({
              from: "add",
              to: sk.scene.clone([E]),
              name: "Create " + STRING.ucwords(E.type)
            });
            g && setTimeout(g, 0);
            return
          }
          f.dirty = !0;
          f.rendering || requestAnimationFrame(e)
        }
      }
    };
    var b = {},
      h = {},
      d = function(b, c, d) {
        var e = this.data;
        if ("undefined" !== typeof e.pt1 && "undefined" !== typeof e.pt2) {
          this.isRecording = !1;
          if (!this) return console.log("missing device");
          var h = this.bbox,
            l = h.scale.x,
            m = h.scale.y,
            u = 1,
            y = 1;
          b.save();
          b.beginPath();
          !1 !== d ? (c.matrix.x = h.viewBox[0] * h.scale.x, c.matrix.y = h.viewBox[1] * h.scale.y, c.apply(b, !0)) : (u = l, y = m);
          if (f.device.useGesture) {
            c =
              e.pt1;
            d = e.pt2;
            var x = (c.x + d.x) / 2,
              z = (c.y + d.y) / 2,
              A = d.x - c.x,
              B = d.y - c.y,
              D = Math.max(0, Math.sqrt(A * A + B * B) - 75)
          } else c = e.pt1, d = e.pt2, x = c.x, z = c.y, A = d.x - x, B = d.y - z, D = Math.max(0, Math.sqrt(A * A + B * B));
          x = h.width / 2;
          z = h.height / 2;
          g(b, x, z, A, B, D, this);
          b.restore();
          b.save();
          b.globalCompositeOperation = a.style.getComposite(this.composite, e.time, !this.isRecording);
          k(b, "fill", c, d, A, B, u, y, l, m, this, this);
          e = this.stroke;
          e.lineWidth && e.opacity && (b.lineWidth = e.lineWidth, b.lineJoin = e.lineJoin, b.lineCap = e.lineCap, b.miterLimit = e.miterLimit,
            k(b, "stroke", c, d, A, B, u, y, l, m, this, this));
          b.restore()
        }
      },
      e = function() {
        if (f.dirty) {
          (new Date).getTime();
          var b = f.deviceLastRecord,
            c = !1,
            d = f.active;
          d.canvas.width = d.canvas.width;
          "source-over" !== b.composite && d.drawImage(a.ctx.canvas, 0, 0);
          var k = !!b.metaKey,
            h = !!b.shiftKey;
          a.detect.shapeConstrain[b.type] ? (k = !h, h = !0) : k && (h = !0);
          var m = a.project.scrollLeft,
            v = a.project.scrollTop;
          b.ctx = f.ctx;
          b.active = f.active;
          b.cache = f.cache;
          b.isRecording = !0;
          var u = a.canvas2d,
            u = u.zoom * u.pixelRatio;
          f.active.scale(u, u);
          for (var y in f.batches)
            for (var u =
                f.batches[y], x = 0; x < u.length; x++) {
              var z = u.shift(),
                A = "end" === z.state || "up" === z.state,
                c = !0;
              if ("placement" === b.movement) {
                if (A) continue;
                u[0] = z
              }
              d.save();
              d.beginPath();
              if (f.device.useGesture) var B = z.pt1,
                D = z.pt2,
                G = (B.x + D.x) / 2,
                F = (B.y + D.y) / 2,
                C = D.x - B.x,
                E = D.y - B.y,
                H = Math.max(0, Math.sqrt(C * C + E * E) - 75);
              else B = z.pt1, D = z.pt2, G = B.x, F = B.y, C = D.x - B.x, E = D.y - B.y, H = Math.max(0, Math.sqrt(C * C + E * E));
              !1 === k && (z.rotation = 0);
              if (h) var J = 1,
                I = 1;
              else Math.abs(B.x - D.x) > Math.abs(B.y - D.y) ? (J = 1, I = Math.abs(B.y - D.y) / Math.abs(B.x - D.x)) : (J =
                Math.abs(B.x - D.x) / Math.abs(B.y - D.y), I = 1), isFinite(J) || (J = 0), isFinite(I) || (I = 0);
              var L = new a.vector.Transform;
              L.translate(G - m, F - v);
              L.scale(J, I);
              L.rotate(z.rotation * a.util.DEG_RAD);
              L.translate(-G * J, -F * I);
              L.apply(d, !0);
              g(d, G * J, F * I, C, E, H, b);
              d.restore();
              d.save();
              d.globalAlpha = b.opacity / 100;
              d.globalCompositeOperation = a.style.getComposite(b.composite, u.time, !b.isRecording);
              l(d, "fill", B, D, C, E, J, I, m, v, k, b);
              (z = b.stroke) && (z.lineWidth && z.opacity) && (d.lineWidth = z.lineWidth, d.lineJoin = z.lineJoin, d.lineCap = z.lineCap,
                d.miterLimit = z.miterLimit, l(d, "stroke", B, D, C, E, J, I, m, v, k, b));
              d.restore();
              if (A) {
                f.time = f.batches[y].time;
                delete f.batches[y];
                break
              }
            }
          f.dirty = !1;
          "undefined" !== typeof y && c ? (requestAnimationFrame(e), f.rendering = !0) : f.rendering = !1
        } else requestAnimationFrame(e), f.rendering = !0
      },
      m = function(a, b, c, d) {
        c = c.__colors;
        d = (2 * d++ +1) % c.length;
        a[b + "Style"] = c[d];
        a[b]()
      },
      k = function(b, c, d, e, k, h, l, g, y, x, z, A) {
        z = z.bbox;
        var B = A[c];
        if ("color" === B.type) b[c + "Style"] = B.color, b[c]();
        else if ("cycle" === B.mode) m(b, c, B, A.time);
        else if (f.device.useGesture) k =
          d.x / l, d = d.y / g, l = e.x / l, e = e.y / g, b[c + "Style"] = a.style.createGradient(c, f.ctx, k, d, l, e, A), b[c]();
        else {
          k = (d.x - k) / l;
          d = (d.y - h) / g;
          l = e.x / l;
          e = e.y / g;
          h = g = 0;
          y > x ? h = (y - x) * (z.height / 2) / y : g = (x - y) * (z.width / 2) / x;
          var D = (k + l) / 2,
            G = (d + e) / 2;
          b.save();
          "pattern" === B.type && b.translate(-z.x, -z.y);
          b.scale(y, x);
          b.translate(D + g, G + h);
          b.translate(-D, -G);
          b[c + "Style"] = a.style.createGradient(c, f.ctx, k, d, l, e, A);
          b[c]();
          b.restore()
        }
      },
      l = function(b, c, d, e, k, h, l, g, y, x, z, A) {
        var B = A[c];
        if ("color" === B.type) b[c + "Style"] = B.color, b[c]();
        else if ("cycle" ===
          B.mode) m(b, c, B, A.time);
        else if (k = d.x - k - y, h = d.y - h - x, y = e.x - y, x = e.y - x, !1 !== z) {
          B = z = 0;
          l > g ? B = d.y / g - d.y : z = d.x / l - d.x;
          var D = (k + y) / 2,
            G = (h + x) / 2;
          b.save();
          b.scale(l, g);
          b.translate(D + z, G + B);
          b.rotate(-Math.atan2(e.x - d.x, e.y - d.y) - Math.PI);
          b.translate(-D, -G);
          "pattern" === A[c].type && (d = a.canvas2d, b.translate(d.x / d.zoom, d.y / d.zoom));
          b[c + "Style"] = a.style.createGradient(c, f.ctx, k, h, y, x, A);
          b[c]();
          b.restore()
        } else b[c + "Style"] = a.style.createGradient(c, f.ctx, k, h, y, x, A), b[c]()
      };
    return a.toolkit.init(this)
  });
  var g = function(c,
    f, b, h, d, e, g) {
    h = d = e;
    var k = a.vector.shape;
    switch (g.type) {
      case "wedge":
        k.wedge(c, f, b, e, g.startAngle * a.util.DEG_RAD, g.endAngle * a.util.DEG_RAD, g.anticlockwise);
        break;
      case "ellipse":
      case "circle":
        g.imperfection ? (e = g.imperfection / 2, k.imperfectCircle(c, f, b, h - e, d + e, 42, g.seed)) : k.ellipse(c, f, b, h, d);
        break;
      case "rectangle":
      case "square":
        g.roundness ? k.roundRect(c, f - h, b - d, 2 * h, 2 * d, g.roundness) : g.imperfection ? k.imperfectRect(c, f - h, b - d, 2 * h, 2 * d, g.imperfection, g.seed) : k.rect(c, f - h, b - d, f + h, b + d);
        break;
      case "triangle":
        g.sides =
          3;
      case "regularPolygon":
        k.regularPolygon(c, f, b, e, g.sides >> 0);
        break;
      case "gear":
        k.gear(c, f, b, e, g.sides >> 0, g.slope);
        break;
      case "star":
        k.star(c, f, b, e, g.sides >> 0, g.slope);
        break;
      case "burst":
        k.burst(c, f, b, e, g.sides >> 0, g.slope);
        break;
      case "radialBurst":
        k.radialBurst(c, f, b, e, g.sides >> 0, g.spread);
        break;
      case "spiral":
        k.spirals(c, f, b, e, g.sides >> 0, g.coils, 1 - g.spread / 100, g.fill.__colors);
        break;
      case "supershape":
        k.superformula(c, f, b, e, g.points, g.m >> 0, g.n1, g.n2, g.n3)
    }
  };
  a.toolkit.updateObjectSize = function(a, f) {}
})(sketch);
"undefined" === typeof sketch && (sketch = {});
sketch.vector = sketch.vector || {};
sketch.vector.shape = sketch.vector.shape || {};
(function(a) {
  var g = 2 * Math.PI;
  a.VOBNode = function(c, f) {
    switch (f.type) {
      case "image":
        c.drawImage(f.image, f.x, f.y, f.width, f.height);
        break;
      case "line":
        c.moveTo(f.x1, f.y1);
        c.lineTo(f.x2, f.y2);
        break;
      case "polyline":
      case "polygon":
      case "path":
        a.VOBPath(c, f.data);
        break;
      case "ellipse":
        a.ellipse(c, f.cx, f.cy, f.rx, f.ry);
        break;
      case "circle":
        a.ellipse(c, f.cx, f.cy, f.r, f.r);
        break;
      case "rect":
        isFinite(f.rx) ? a.roundRect(c, f.x, f.y, f.width, f.height, f.rx, f.ry) : a.rect(c, f.x, f.y, f.width + f.x, f.height + f.y)
    }
  };
  a.record = function() {
    this.data = [];
    this.moveTo = function(a, f) {
      this.data.push({
        cmd: "M",
        x: a,
        y: f
      })
    };
    this.lineTo = function(a, f) {
      this.data.push({
        cmd: "L",
        x: a,
        y: f
      })
    };
    this.bezierCurveTo = function(a, f, b, h, d, e) {
      this.data.push({
        cmd: "C",
        x1: a,
        y1: f,
        x2: b,
        y2: h,
        x: d,
        y: e
      })
    };
    this.quadraticCurveTo = function(a, f, b, h) {
      this.data.push({
        cmd: "Q",
        x1: a,
        y1: f,
        x: b,
        y: h
      })
    };
    this.arcTo = function(a, f, b, h, d) {
      this.data.push({
        cmd: "A",
        x1: a,
        y1: f,
        x2: b,
        y2: h,
        radius: d
      })
    };
    this.closePath = function() {
      this.data.push({
        cmd: "Z"
      })
    };
    this.stringify = function() {
      return sketch.vector.SVGPath.fromVOBPath(this.data)
    }
  };
  a.point = {};
  a.circle = function(c, f, b, h) {
    return a.ellipse(c, f, b, h, h)
  };
  a.ellipse = function(a, f, b, h, d) {
    a.moveTo(f, b - d);
    a.bezierCurveTo(f + 0.5522847498307936 * h, b - d, f + h, b - 0.5522847498307936 * d, f + h, b);
    a.bezierCurveTo(f + h, b + 0.5522847498307936 * d, f + 0.5522847498307936 * h, b + d, f, b + d);
    a.bezierCurveTo(f - 0.5522847498307936 * h, b + d, f - h, b + 0.5522847498307936 * d, f - h, b);
    a.bezierCurveTo(f - h, b - 0.5522847498307936 * d, f - 0.5522847498307936 * h, b - d, f, b - d);
    a.closePath()
  };
  a.line = function(a, f, b, h, d) {
    a.moveTo(f, b);
    a.lineTo(h, d)
  };
  a.SVGPath =
    function(c, f) {
      f = sketch.vector.SVG.toVOBPath(f);
      return a.VOBPath(c, f)
    };
  a.VOBPath = function(a, f) {
    for (var b, h = f && f.length, d = 0; d < h; d++)
      if (b = f[d]) switch (b.cmd) {
        case "M":
          a.moveTo(b.x, b.y);
          break;
        case "L":
          a.lineTo(b.x, b.y);
          break;
        case "Q":
          a.quadraticCurveTo(b.x1, b.y1, b.x, b.y);
          break;
        case "C":
          a.bezierCurveTo(b.x1, b.y1, b.x2, b.y2, b.x, b.y);
          break;
        case "A":
          a.arcTo(b.x1, b.y1, b.x2, b.y2, b.radius);
          break;
        case "Z":
        case "z":
          a.closePath()
      }
  };
  a.VOBPathDebug = function(a, f) {
    for (var b, h = "", d = f.length, e = 0; e < d; e++)
      if (b = f[i]) switch (b.cmd) {
        case "M":
          h +=
            "ctx.moveTo(" + b.x + "," + b.y + ");\n";
          break;
        case "L":
          h += "ctx.lineTo(" + b.x + "," + b.y + ");\n";
          break;
        case "Q":
          h += "ctx.quadraticCurveTo(" + b.x1 + "," + b.y1 + "," + b.x + "," + b.y + ");\n";
          break;
        case "C":
          h += "ctx.bezierCurveTo(" + b.x1 + "," + b.y1 + "," + b.x2 + "," + b.y2 + "," + b.x + "," + b.y + ");\n";
          break;
        case "A":
          h += "ctx.arcTo(" + b.x1 + "," + b.y1 + "," + b.x2 + "," + b.y2 + "," + b.radius + ");\n";
          break;
        case "Z":
        case "z":
          h += "ctx.closePath();\n"
      }
      console.log(h)
  };
  a.square = function(c, f, b, h, d) {
    a.rect(c, f, b, h, d)
  };
  a.rectangle = a.rect = function(a, f, b, h, d) {
    0 >= f - h !== 0 >=
      b - d ? (a.moveTo(f, b), a.lineTo(h, b), a.lineTo(h, d), a.lineTo(f, d)) : (a.moveTo(f, b), a.lineTo(f, d), a.lineTo(h, d), a.lineTo(h, b));
    a.lineTo(f, b);
    a.closePath()
  };
  a.roundRectangle = a.roundRect = function(a, f, b, h, d, e, g) {
    0 > h && (f += h, h = Math.abs(h));
    0 > d && (b += d, d = Math.abs(d));
    isFinite(g) || (g = e);
    var k = -Math.PI / 2,
      l = Math.PI / 4;
    e > Math.min(h, d) / 2 && (e = Math.min(h, d) / 2);
    g > Math.min(h, d) / 2 && (g = Math.min(h, d) / 2);
    a.moveTo(f + e, b);
    a.lineTo(f + h - e, b);
    a.quadraticCurveTo(f + h - e + Math.cos(k + l / 2) * e / Math.cos(l / 2), b + g + Math.sin(k + l / 2) * g / Math.cos(l /
      2), f + h - e + Math.cos(k + l) * e, b + g + Math.sin(k + l) * g);
    a.quadraticCurveTo(f + h - e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + h - e + Math.cos(k + l) * e, b + g + Math.sin(k + l) * g);
    a.lineTo(f + h, b + d - g);
    a.quadraticCurveTo(f + h - e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + d - g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + h - e + Math.cos(k + l) * e, b + d - g + Math.sin(k + l) * g);
    a.quadraticCurveTo(f + h - e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + d - g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + h - e + Math.cos(k + l) * e, b + d - g + Math.sin(k + l) * g);
    a.lineTo(f +
      e, b + d);
    a.quadraticCurveTo(f + e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + d - g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + e + Math.cos(k + l) * e, b + d - g + Math.sin(k + l) * g);
    a.quadraticCurveTo(f + e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + d - g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + e + Math.cos(k + l) * e, b + d - g + Math.sin(k + l) * g);
    a.lineTo(f, b + g);
    a.quadraticCurveTo(f + e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2), b + g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + e + Math.cos(k + l) * e, b + g + Math.sin(k + l) * g);
    a.quadraticCurveTo(f + e + Math.cos((k += l) + l / 2) * e / Math.cos(l / 2),
      b + g + Math.sin(k + l / 2) * g / Math.cos(l / 2), f + e + Math.cos(k + l) * e, b + g + Math.sin(k + l) * g);
    a.closePath()
  };
  a.wedge = function(a, f, b, h, d, e, g) {
    a.moveTo(f, b);
    a.arc(f, b, h, d, e, g);
    a.lineTo(f, b);
    a.closePath()
  };
  a.triangle = function(c, f, b, h) {
    a.regularPolygon(c, f, b, h, 3)
  };
  a.regularPolygon = function(a, f, b, h, d) {
    a.moveTo(f, b - h);
    for (var e = 1, g; e < d; e++) g = 0.017453 * 360 / d * e, a.lineTo(Math.sin(g) * h + f, -Math.cos(g) * h + b);
    a.lineTo(f, b - h);
    a.closePath()
  };
  a.gear = function(a, f, b, h, d, e) {
    1 > e && (h *= e);
    var m = g / d,
      k = m / 4;
    e = h / e;
    a.moveTo(h + f, b);
    for (var l =
        1; l <= d; l++) a.lineTo(Math.cos(m * l - 3 * k) * e + f, Math.sin(m * l - 3 * k) * e + b), a.lineTo(Math.cos(m * l - 2 * k) * e + f, Math.sin(m * l - 2 * k) * e + b), a.lineTo(Math.cos(m * l - k) * h + f, Math.sin(m * l - k) * h + b), a.lineTo(Math.cos(m * l) * h + f, Math.sin(m * l) * h + b);
    a.closePath()
  };
  a.star = function(a, f, b, h, d, e) {
    1 > e && (h *= e);
    var m = g / d,
      k = m / 2;
    e = h / e;
    a.moveTo(h + f, b);
    for (var l = 1; l <= d; l++) a.lineTo(Math.cos(m * l - k) * e + f, Math.sin(m * l - k) * e + b), a.lineTo(Math.cos(m * l) * h + f, Math.sin(m * l) * h + b);
    a.closePath()
  };
  a.burst = function(a, f, b, h, d, e) {
    1 > e && (h *= e);
    var m = g / d,
      k = m / 2,
      l =
      m / 4;
    e = h / e;
    var r = 0;
    a.moveTo(h + f, b);
    for (r = 1; r <= d; r++) a.quadraticCurveTo(Math.cos(m * r - 3 * l) * (e / Math.cos(l)) + f, Math.sin(m * r - 3 * l) * (e / Math.cos(l)) + b, Math.cos(m * r - k) * e + f, Math.sin(m * r - k) * e + b), a.quadraticCurveTo(Math.cos(m * r - l) * (e / Math.cos(l)) + f, Math.sin(m * r - l) * (e / Math.cos(l)) + b, Math.cos(m * r) * h + f, Math.sin(m * r) * h + b);
    a.closePath()
  };
  a.radialBurst = function(a, f, b, h, d, e) {
    e = 4 * e || 1;
    var m = g / d,
      k = m / 8,
      l = m / 4;
    a.moveTo(h + f, b);
    for (var r = 1; r <= d; r++) a.moveTo(0 * Math.cos(m * r - k * e) + f, 0 * Math.sin(m * r - k * e) + b), a.lineTo(Math.cos(m * r -
      l * e) * h + f, Math.sin(m * r - l * e) * h + b), a.lineTo(Math.cos(m * r) * h + f, Math.sin(m * r) * h + b), a.lineTo(0 * Math.cos(m * r - k * e) + f, 0 * Math.sin(m * r - k * e) + b);
    a.closePath()
  };
  a.spiral = function(c, f, b, h, d, e, m) {
    var k = 0,
      l = 0,
      r = 0,
      p = 0;
    e = e / d * g;
    var q = "moveTo";
    if (m)
      for (m = d; 0 < m; m--) {
        var r = Math.pow(h, m / d),
          t = m * e,
          k = Math.cos(t) * r + f,
          r = Math.sin(t) * r + b;
        if (a[q]) l = Math.sqrt(Math.pow(k - l, 2) + Math.pow(r - p, 2)), a[q](c, k, r, l / 2, 5, 3.35);
        else c[q](k, r);
        "moveTo" === q && (a.point.x = k, a.point.y = r, q = "lineTo");
        l = k;
        p = r
      } else {
        for (m = 0; m <= d; m++) r = Math.pow(h, m / d), t =
          m * e, k = Math.cos(t) * r + f, r = Math.sin(t) * r + b, c.lineTo(k, r);
        a.point.x = k;
        a.point.y = r
      }
    c.closePath()
  };
  a.spirals = function(c, f, b, h, d, e, m, k) {
    for (k = d; k--;) {
      c.save();
      c.translate(f, b);
      c.rotate(k * g / d);
      c.translate(-f, -b);
      c.moveTo(f, b);
      var l = 100 * e;
      a.spiral(c, f, b, h * m, l, e, !0);
      var r = a.point.x,
        p = a.point.y;
      a.spiral(c, f, b, h, l, e);
      c.lineTo(r, p);
      c.restore()
    }
    c.closePath()
  };
  a.supershape = a.superformula = function(a, f, b, h, d, e, m, k, l) {
    0 === e && (e = 0.01);
    0 === m && (m = -0.01);
    0 === k && (k = 0.01);
    0 === l && (l = 0.01);
    for (var r = "moveTo", p = 0; p <= d; p++) {
      var q =
        p * g / d,
        t = Math.pow(Math.abs(Math.cos(e * q / 4) / 1), k),
        s = Math.pow(Math.abs(Math.sin(e * q / 4) / 1), l),
        s = Math.pow(t + s, 1 / m);
      0 === s ? q = t = 0 : (s = 1 / s, t = s * Math.cos(q), q = s * Math.sin(q));
      a[r](t * h + f, q * h + b);
      r = "lineTo"
    }
    a.closePath()
  };
  a.clearPath = function(c, f, b, h, d, e, g, k, l) {
    var r = c.globalCompositeOperation;
    c.beginPath();
    c.globalCompositeOperation = "destination-out";
    a[f](c, f, b, h, d, e, g, k, l);
    c.fill();
    c.globalCompositeOperation = r;
    c.beginPath()
  };
  a.clipPath = function(c, f, b, h, d, e, g, k, l) {
    c.beginPath();
    a[f](c, f, b, h, d, e, g, k, l);
    c.clip()
  }
})(sketch.vector.shape);
"undefined" !== typeof module && module.exports && (module.exports = sketch.vector.shape);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
(function(a) {
  var g = {},
    c = {},
    f = 1 / (180 / Math.PI),
    b = function(a) {
      sketch = b.__self || sketch;
      a = a || {};
      this.convertMetrics = sketch.util.getScreenMetrics ? this.convertMetrics || sketch.util.getScreenMetrics() : {
        normal_px: 16,
        "xx-small_px": 9,
        "x-small_px": 10,
        small_px: 13,
        medium_px: 16,
        large_px: 18,
        "x-large_px": 24,
        "xx-large_px": 32,
        "%>px": 0.16,
        "px>pt": 0.7500187504687618,
        "pt>pc": 0.08333333333333333,
        "px>in": 0.010416666666666666,
        "in>ft": 0.08333333333333333,
        "ft>yd": 0.3333333333333333,
        "px>mm": 0.2645833333333333,
        "mm>cm": 0.1,
        "cm>m": 0.01,
        "px>ex": 0.11951429390955158,
        "ex>em": 0.52295,
        "px>px": 1,
        "px>pc": 0.06250156253906347,
        "pt>px": 1.3333,
        "pc>px": 15.9996,
        "pc>pt": 12,
        "px>cm": 0.02645833333333333,
        "mm>m": 0.001,
        "mm>px": 3.779527559055119,
        "m>mm": 1E3,
        "cm>mm": 10,
        "px>m": 2.645833333333333E-4,
        "cm>px": 37.795275590551185,
        "m>px": 3779.527559055118,
        "m>cm": 100,
        "px>ft": 8.680555555555555E-4,
        "in>yd": 0.027777777777777776,
        "in>px": 96,
        "yd>in": 36,
        "ft>in": 12,
        "px>yd": 2.8935185185185184E-4,
        "ft>px": 1152,
        "yd>px": 3456,
        "yd>ft": 3,
        "px>em": 0.0625,
        "ex>px": 8.3672,
        "em>px": 16,
        "em>ex": 1.9122287025528253
      };
      this.type = "svg";
      this.cors = a.cors || !1;
      this.debug = a.debug || !1;
      this.debugSVG = a.debugSVG || !1;
      this.debugBBox = a.debugBBox || !1;
      this.placement = a.placement || "bbox";
      this.defaultStroke = this.defaultFill = "#000000";
      this.state = {
        fillStyle: "#000000"
      };
      this.defs = {};
      this.vob = {
        type: "svg"
      };
      this.batch = 0;
      this.skipRender = a.skipRender || !1;
      this.useCache = a.useCache || !1;
      this.uid = 0;
      a.src && (this.src = a.src);
      a.srcs && (this.srcs = a.srcs);
      a.data && (this.data = a.data);
      a.cache && (this.cache = a.cache);
      a.ctx && (this.ctx =
        a.ctx);
      a.onerror && (this.onerror = a.onerror);
      a.onload && (this.onload = a.onload);
      a.document && (this.document = a.document);
      return a.src || a.document ? this.load() : this
    };
  b.prototype.load = function() {
    if (!this.src && !this.data && !this.document) return this;
    var b = this;
    if (this.src || this.data) {
      var d = this.src || this.data;
      if ("string" !== typeof d) {
        if (this.onerror) this.onerror("not string");
        return this
      }
      this.__id = d.replace(this.rxAlphaNumeric, "");
      if (a.SVG.isSVG(d)) return this.fromString(d), this;
      !1 !== this.useCache && (this.document =
        document.getElementById(this.__id))
    } else if (this.document) return this.__id = "#", this.onParseReady(), this;
    if (c[d]) {
      if (this.onerror) this.onerror("404")
    } else if (this.document)
      if (g[this.__id] && g[this.__id].loaded || this.srcs && this.srcs[d]) this.onParseReady();
      else b.onParseReady();
    else this.srcs && this.srcs[d] ? this.fromString(this.srcs[d]) : sketch.util.request({
      url: d,
      onerror: function() {
        c[d] = !0;
        if (b.onerror) b.onerror("404")
      },
      onload: function(a) {
        b.fromString(a.responseText)
      }
    });
    return this
  };
  b.decodeDataURL = function(a) {
    return atob(STRING.decode_utf8(a.split(",").pop()))
  };
  b.prototype.fromString = function(a, c) {
    var d;
    d = new DOMParser;
    0 === a.indexOf("data:image/svg") && (a = b.decodeDataURL(a));
    this.srcXML = a;
    a = a.replace(/\<(\?xml|(\!DOCTYPE[^\>\[]+(\[[^\]]+)?))+[^>]+\>/g, "");
    a = a.replace(/(xmlns(:.*|)="&.*;")/g, "");
    this.document = d = d.parseFromString("<object>" + a + "</object>", "text/xml").documentElement;
    this.svg = d.querySelector ? d.querySelector("svg") : d;
    this.document.id = this.__id;
    "undefined" === typeof module && this.debugSVG && document.body.appendChild(this.document);
    this.onParseReady(c);
    if (this.debugSVG) return this;
    this.document.style && (this.document.style.visibility = "hidden", this.document.style.opacity = 0, this.document.style.zIndex = -1, this.document.style.width = "1px", this.document.style.height = "1px");
    return this
  };
  b.prototype.onParseReady = function(a) {
    if (g[this.__id]) {
      if (this.onload) this.onload(g[this.__id]);
      return this
    }
    var b = this,
      c = (new Date).getTime(),
      d = this.document.contentDocument || this.document;
    this.loaded = !0;
    this.element = d;
    this.parse({
      document: d,
      skipRender: this.skipRender,
      onload: function(d) {
        if (d) {
          b.vob =
            d[0];
          b.viewBox = b.getBoundingBox(null);
          b.viewBoxStroke = b.getBoundingBox(null, !0);
          b.debug && console.log("parseTime", (new Date).getTime() - c);
          b.useCache && (g[b.__id] = b);
          a && a(b);
          if (b.onload) b.onload(b);
          if (!b.debug) try {
            document.body.removeChild(b.document)
          } catch (e) {}
        }
      },
      node: {
        childNodes: []
      }
    })
  };
  b.prototype.rxSplitByUppercase = /([A-Z]?[^A-Z]*)/g;
  b.prototype.rxAlphaNumeric = /[^A-Z0-9]+/gi;
  b.prototype.rxNumeric = /[0-9.-]*/g;
  b.prototype.parse = function(a) {
    if (a.node) {
      if (a.document && a.document.childNodes && a.document.childNodes.length) var b =
        a.document.childNodes;
      else if (a.document) {
        var c = a.document.nodeName.toLowerCase();
        if (m[c]) b = [a.document];
        else {
          if (a.onload) a.onload([]);
          return this
        }
      } else {
        if (a.onload) a.onload([]);
        return this
      }
      a.defs && (this.defs = a.defs);
      for (var d = this, e = sketch.vector.shape, f = a.node.childNodes, g = a.svg || d.svg, w = a.skipRender || !1, v = a.ctx || this.ctx, u = [], y = 0, x = b.length; y < x; y++) {
        var z = b[y],
          c = z.nodeName.toLowerCase();
        "#" !== c[0] && (0 === c.indexOf("sketchjs:") && (c = c.substr(9)), z.type = c, u.push(z))
      }
      var A = u.length,
        B = -1,
        D = function() {
          if (0 ===
            ++d.batch % 250) setTimeout(D, 0);
          else if (++B === A) {
            if (a.onload) a.onload(f)
          } else {
            var b = u[B],
              c = b.type,
              l = "";
            v && v.save();
            if ("none" === h(b).display) return D();
            switch (c) {
              case "svg":
                d.currentNode = l = d.getAttributes(b, "id,x,y,width,height,viewBox,version,author,license,metadata");
                l.matrix = sketch.vector.Transform.getIdentity();
                l.type = "svg";
                if ("undefined" !== typeof sketch.vector.SVGFont) {
                  c = d.element.getElementsByTagName("font");
                  c.length && (d.vob.type || (d.vob = l), v && (d.debug && (v.canvas.style.border = "1px solid rgba(0,0,0,0.1)",
                    d.document.style.left = l.width + "px"), v.canvas.width = l.width || 1, v.canvas.height = l.height || 1), d.typeface = new sketch.vector.SVGFont(v), d.document.width = l.width || 1, d.document.height = l.height || 1, g = l);
                  for (var m = 0; m < c.length; m++) d.typeface.load(c[m].cloneNode(!0), function(a) {})
                }
                if (l.viewBox) {
                  var m = l.viewBox,
                    c = l.width,
                    r = l.height,
                    y = m[2] - m[0],
                    x = m[3] - m[1];
                  v && (v.canvas.width = c, v.canvas.height = r);
                  y = Math.min(c / y, r / x);
                  x = new sketch.vector.Transform;
                  x.translate(-m[0], -m[1]);
                  x.translate(c / 2, r / 2);
                  x.scale(y, y);
                  x.translate(1 *
                    (-c / 2) / y, 1 * (-r / 2) / y);
                  v && x.apply(v);
                  l.matrix = x.matrix;
                  l.transform = x.matrix;
                  l.transform.type = "transform"
                }
                f.push(l);
                l.childNodes = [];
                d.parse({
                  skipRender: a.skipRender,
                  document: b,
                  node: l,
                  svg: g,
                  onload: function(a) {
                    l.childNodes = a;
                    v && v.restore();
                    D()
                  }
                });
                return;
              case "title":
                if (!g) break;
                g.title = b.textContent;
                break;
              case "desc":
                if (!g) break;
                g.desc = b.textContent;
                break;
              case "a":
              case "switch":
              case "g":
                if (d.currentNode = l = d.getAttributes(b, "id,labels"), l.parentNode = a.node, l.type = "g", v && v.beginPath(), d.parseTransform(b, !0), d.parseClipPath(b, !0), l.style = d.parseStyle(v, b, !w), b.hasChildNodes) {
                  f.push(l);
                  l.childNodes = [];
                  d.parse({
                    skipRender: a.skipRender,
                    document: b,
                    node: l,
                    svg: g,
                    onload: function(a) {
                      l.childNodes = a;
                      v && v.restore();
                      D()
                    }
                  });
                  return
                }
              case "use":
                if (c = d.parseHref(b))
                  if (d.currentNode = l = {}, l.parentNode = a.node, l.type = "use", c = c.substr(1), !d.defs[c]) {
                    var z = d.getElementById(c);
                    v && v.beginPath();
                    d.parseTransform(b, !0);
                    d.parseClipPath(b, !0);
                    d.parseTransform(z, !0);
                    d.parseClipPath(z, !0);
                    f.push(l);
                    l.childNodes = [];
                    d.parse({
                      skipRender: a.skipRender,
                      document: z,
                      node: l,
                      svg: g,
                      onload: function(a) {
                        l.childNodes = a;
                        v && v.restore();
                        D()
                      }
                    });
                    return
                  }
                break;
              case "fegaussianblur":
                d.currentNode = l = d.getAttributes(b, "id,stdDeviation");
                l.parentNode = a.node;
                l.type = "GaussianBlur";
                f.push(l);
                break;
              case "image":
                if (c = d.parseHref(b)) {
                  if (!g.cors && "http" === c.substr(0, 4)) break;
                  d.currentNode = l = d.getAttributes(b, "id,x,y,width,height,preserveAspectRatio,labels", !0);
                  l.parentNode = a.node;
                  l.type = "image";
                  l.x = l.x || 0;
                  l.y = l.y || 0;
                  v && v.beginPath();
                  d.parseTransform(b, !0);
                  d.parseClipPath(b, !0);
                  d.svg.data ? (b = d.svg.data.split("/"), b.pop(), (b = b.join("/")) && (b += "/")) : b = "";
                  l.image = new Image;
                  l.image.node = l;
                  l.image.onload = function() {
                    var a = this.width,
                      b = this.height,
                      c = this.node.matrix;
                    v && v.setTransform(c.a, c.b, c.c, c.d, c.x, c.y);
                    if (this.node.preserveAspectRatio && "none" !== this.node.preserveAspectRatio) {
                      var d = this.node.preserveAspectRatio.split(" ")[0],
                        c = d.substr(1, 3),
                        d = d.substr(5, 3);
                      a > this.node.width && (b *= this.node.width / a, a = this.node.width);
                      b > this.node.height && (a *= this.node.height / b, b = this.node.height);
                      switch (c) {
                        case "Min":
                          c = 0;
                          break;
                        case "Mid":
                          c = (this.node.width - a) / 2;
                          break;
                        case "Max":
                          c = this.node.width - a
                      }
                      switch (d) {
                        case "Min":
                          d = 0;
                          break;
                        case "Mid":
                          d = (this.node.height - b) / 2;
                          break;
                        case "Max":
                          d = this.node.height - b
                      }
                      v && v.drawImage(this, c, d, a, b);
                      l.x = c;
                      l.y = d;
                      l.width = a;
                      l.height = b
                    } else v && v.drawImage(this, this.node.x, this.node.y, this.node.width, this.node.height);
                    l.bbox = new sketch.vector.BBox([l.x, l.y, l.x + l.width, l.y + l.height], l.matrix);
                    v && v.restore();
                    f.push(l);
                    D()
                  };
                  l.image.onerror = function() {
                    v && v.restore();
                    D()
                  }; - 1 !== c.indexOf("base64") || "http" === c.substr(0, 4) ? (l.href = c, l.image.src = c) : (l.href = b + c, l.image.src = b + c);
                  return
                }
              case "text":
                if (!sketch.vector.text) {
                  console.log("missing text module");
                  break
                }
                d.currentNode = l = d.getAttributes(b, "id,x,y,dx,dy,labels", !0);
                l.parentNode = a.node;
                l.type = "text";
                l.childNodes = [];
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                l.style = d.parseStyle(v, b, !w);
                for (var y = r = Infinity, O = x = -Infinity, P = l.dx || 0 + (l.x || 0), N = l.dy || 0 + (l.y || 0), b = b.childNodes, m = c = 0, Q = b.length; m < Q; m++) {
                  z =
                    b[m];
                  if ("[object Text]" === String(z)) {
                    var K = {},
                      R = document.createElement("tspan");
                    R.textContent = z.textContent;
                    z = R
                  } else K = d.getAttributes(z, "id,x,y,dx,dy", !0);
                  "undefined" !== typeof K.x && (P = 0);
                  "undefined" !== typeof K.y && (N = 0);
                  P = 0 !== (K.dy || 0) ? K.dx || 0 : P + (K.dx || 0);
                  N += K.dy || 0;
                  K.x = P + (K.x || 0);
                  K.y = N + (K.y || 0);
                  K.parentNode = l;
                  K.type = "tspan";
                  K.content = z.textContent.trim();
                  d.currentNode = K;
                  K.style = d.parseStyle(v, z, !w);
                  l.childNodes.push(K);
                  R = d.fontStyleToString(v, K.style);
                  z = sketch.vector.text.measureText(z.textContent,
                    R);
                  r > K.x && (r = K.x);
                  y > K.y && (y = K.y - K.style.fontSize);
                  O < K.y + z.height && (O = K.y + z.height - K.style.fontSize);
                  x < K.x + z.width && (x = K.x + z.width);
                  P += z.width;
                  c += z.width
                }
                switch (l.style.textAnchor) {
                  case "middle":
                    r -= c / 2;
                    x -= c / 2;
                    break;
                  case "end":
                    r -= c, x -= c
                }
                c = [r, y, x, O];
                l.bbox = new sketch.vector.BBox(c, l.matrix);
                f.push(l);
                break;
              case "rect":
                d.currentNode = l = d.getAttributes(b, "id,x,y,rx,ry,width,height,labels");
                l.parentNode = a.node;
                l.type = "rect";
                l.x || (l.x = 0);
                l.y || (l.y = 0);
                if (!l.width) break;
                if (!l.height) break;
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                c = [l.x, l.y, l.x + l.width, l.y + l.height];
                l.bbox = new sketch.vector.BBox(c, l.matrix);
                "undefined" === typeof l.rx && "undefined" !== typeof l.ry && (l.rx = l.ry);
                "undefined" === typeof l.ry && "undefined" !== typeof l.rx && (l.ry = l.rx);
                v && e && ("undefined" === typeof l.rx ? e.rect(v, l.x, l.y, l.width + l.x, l.height + l.y) : e.roundRect(v, l.x, l.y, l.width, l.height, l.rx, l.ry));
                l.style = d.parseStyle(v, b, !w);
                f.push(l);
                break;
              case "circle":
                d.currentNode = l = d.getAttributes(b, "id,cx,cy,r,labels");
                l.parentNode =
                  a.node;
                l.type = "circle";
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                c = [l.cx - l.r, l.cy - l.r, l.cx + l.r, l.cy + l.r];
                l.bbox = new sketch.vector.BBox(c, l.matrix);
                l.cx = l.cx || 0;
                l.cy = l.cy || 0;
                v && e.ellipse(v, l.cx, l.cy, l.r, l.r);
                l.style = d.parseStyle(v, b, !w);
                f.push(l);
                break;
              case "ellipse":
                d.currentNode = l = d.getAttributes(b, "id,cx,cy,rx,ry,labels");
                l.parentNode = a.node;
                l.type = "ellipse";
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                l.cx = l.cx || 0;
                l.cy = l.cy || 0;
                c = [l.cx - l.rx, l.cy - l.ry, l.cx + l.rx,
                  l.cy + l.ry
                ];
                l.bbox = new sketch.vector.BBox(c, l.matrix);
                v && e && e.ellipse(v, l.cx, l.cy, l.rx, l.ry);
                l.style = d.parseStyle(v, b, !w);
                f.push(l);
                break;
              case "line":
                d.currentNode = l = d.getAttributes(b, "id,x1,y1,x2,y2,labels");
                l.parentNode = a.node;
                l.type = "line";
                l.x1 = l.x1 || 0;
                l.y1 = l.y1 || 0;
                l.x2 = l.x2 || 0;
                l.y2 = l.y2 || 0;
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                c = [l.x1, l.y1, l.x2, l.y2];
                l.bbox = new sketch.vector.BBox(c, l.matrix);
                v && e && (v.moveTo(l.x1, l.y1), v.lineTo(l.x2, l.y2));
                l.style = d.parseStyle(v, b, !w);
                f.push(l);
                break;
              case "pencil":
              case "polyline":
              case "polygon":
                m = d.parsePoints(b, c);
                r = m.points;
                d.currentNode = l = d.getAttributes(b, "id,labels");
                l.parentNode = a.node;
                l.type = c.toLowerCase();
                l.points = r;
                v && v.beginPath();
                d.parseTransform(b, !0);
                d.parseClipPath(b, !0);
                l.data = m.data;
                l.bbox = new sketch.vector.BBox(l.data, l.matrix);
                v && e && e.VOBPath(v, l.data);
                l.style = d.parseStyle(v, b, !w);
                f.push(l);
                break;
              case "path":
                d.currentNode = l = d.getAttributes(b, "id,d,labels"), l.parentNode = a.node, l.type = "path", v && v.beginPath(), d.parseTransform(b, !0), d.parseClipPath(b, !0), l.data = sketch.vector.SVGPath.toVOBPath(l.d), l.bbox = new sketch.vector.BBox(l.data, l.matrix), l.element = b, v && e && e.VOBPath(v, l.data), l.style = d.parseStyle(v, b, !w), f.push(l)
            }
            v && v.restore();
            D()
          }
        };
      D();
      return f
    }
  };
  b.prototype.parseAttribute = function(a, b, c) {
    "undefined" === typeof a && (a = c);
    "inherit" === a && (a = this.currentNode, a = a.parentNode && a.parentNode.style && a.parentNode.style[b] ? a.parentNode.style[b] : c);
    return a
  };
  b.prototype.parseStyleAttribute = function(a, b, c) {
    a = b[c] || a.getAttribute(c);
    b = "color" === c ? "color" : c + "Style";
    if (a) {
      if (sketch.color.webcolors[a]) a = "#" + sketch.color.webcolors[a];
      else if ("none" === a) a = "rgba(0,0,0,0)";
      else if ("currentColor" === a) a = this.state.color;
      else if ("url" === a.substr(0, 3)) {
        a = a.substr(5, a.indexOf(")") - 5);
        var d = this.ctx,
          e = this.parseDefs(d, a, c);
        e ? d && this.setStyle(d, e, b) : a = ""
      }
      "inherit" === a && (d = this.currentNode, d.parentNode && d.parentNode.style && d.parentNode.style[b] ? a = d.parentNode.style[b] : "stroke" !== c && (a = "#000000"));
      return a
    }
  };
  b.prototype.parseStyle = function(a,
    b, c) {
    var d = this.currentNode,
      e = this.state = sketch.util.clone(d.parentNode.style || this.state),
      f = h(b);
    d.uid = this.uid++;
    a && a.save();
    var g = this.getAttributes(b, "opacity,fill-rule,fill-opacity,stroke-width,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-dasharray,stroke-dashoffset,stroke-opacity,font-size,font-family,font-weight,font-style,line-height,text-anchor", !0);
    "undefined" !== typeof g.opacity ? (e.opacity = g.opacity, a && (a.globalAlpha = e.opacity)) : d.parentNode.style ? (e.opacity = d.parentNode.style.opacity,
      a && (a.globalAlpha = e.opacity)) : (e.opacity = 1, a && (a.globalAlpha = 1));
    var m = b.attributes;
    if (m) {
      var v = m.length;
      v && "undefined" === typeof d.attributes && (d.attributes = {});
      for (var u = 0; u < v; u++) {
        var y = m[u];
        if ("data-" === y.name.substr(0, 5)) {
          var x = y.name.substr(5).split("-");
          x[1] && (x[1] = x[1][0].toUpperCase() + x[1].substr(1));
          x = x.join("");
          d.attributes[x] = y.value
        }
      }(m = f.filter || b.getAttribute("filter")) ? (v = m.substr(5, m.length - 6), !this.defs[v] && (m = this.getElementById(v)) && (this.defs[v] = this.getAttributes(m, "id,x,y,width,height"),
        this.defs[v].type = "filter", this.defs[v].filter = this.parse({
          document: m,
          node: {
            childNodes: []
          }
        })), e.filter = v) : delete e.filter;
      g.fontSize && (e.fontSize = g.fontSize);
      if (g.fontFamily)
        for (e.fontFamily = g.fontFamily, m = g.fontFamily.split(",");;) {
          v = m.shift();
          if (!v) break;
          if (this.typeface && this.typeface.packages[v]) {
            e.fontRenderer = "SVG";
            break
          }
          if (sketch.vector.text && sketch.vector.text.detectFont(v)) {
            e.fontRenderer = "native";
            break
          }
        }
      g.fontWeight && (e.fontWeight = g.fontWeight);
      g.fontStyle && (e.fontStyle = g.fontStyle);
      g.lineHeight &&
        (e.lineHeight = g.lineHeight);
      g.textAnchor && (e.textAnchor = g.textAnchor);
      a && (a.font = this.fontStyleToString(a, e));
      if (m = this.parseStyleAttribute(b, f, "color")) e.color = m;
      if (m = this.parseStyleAttribute(b, f, "fill")) g.fillStyle = m;
      else if (m = d.parentNode, m.style) {
        m = sketch.util.clone(m.style);
        for (x in g) m[x] = g[x];
        g = m
      } else g.fillStyle = "default";
      e.fillStyle = this.parseAttribute(g.fillStyle, "fillStyle", "#000000");
      e.fillRule = this.parseAttribute(g.fillRule, "fillRule", "nonzero");
      e.fillOpacity = Math.max(0, this.parseAttribute(g.fillOpacity,
        "fillOpacity", 1));
      c && (e && a) && ("default" === e.fillStyle ? a.fillStyle = this.defaultFill : e.fillStyle && (a.fillStyle = e.fillStyle), a.save(), a.globalAlpha *= e.fillOpacity, d.content ? "SVG" === e.fontRenderer ? (this.typeface.setFont(a.font), this.typeface.fillText(d.content, d.x, d.y)) : a.fillText(d.content, d.x, d.y) : a.fill(), a.restore());
      if (m = this.parseStyleAttribute(b, f, "stroke")) g.strokeStyle = m;
      else if (m = d.parentNode, m.style) {
        m = sketch.util.clone(m.style);
        for (x in g) m[x] = g[x];
        g = m
      }
      e.strokeWidth = this.parseAttribute(g.strokeWidth,
        "strokeWidth", 1);
      e.strokeStyle = this.parseAttribute(g.strokeStyle, "strokeStyle", "none");
      e.strokeLinecap = this.parseAttribute(g.strokeLinecap, "strokeLinecap", "butt");
      e.strokeLinejoin = this.parseAttribute(g.strokeLinejoin, "strokeLinejoin", "miter");
      e.strokeMiterlimit = Math.max(1, this.parseAttribute(g.strokeMiterlimit, "strokeMiterlimit", 4));
      e.strokeDasharray = this.parseAttribute(g.strokeDasharray, "strokeDasharray", "none");
      e.strokeDashoffset = this.parseAttribute(g.strokeDashoffset, "strokeDashoffset", 0);
      e.strokeOpacity =
        Math.max(0, this.parseAttribute(g.strokeOpacity, "strokeOpacity", 1));
      c && (e && a) && (a.lineWidth = 0 === e.strokeWidth ? 1E-10 : e.strokeWidth || 1, a.lineCap = e.strokeLinecap || "butt", a.lineJoin = e.strokeLinejoin || "miter", a.miterLimit = e.strokeMiterlimit || a.lineWidth, e.strokeStyle && "none" !== e.strokeStyle && (a.strokeStyle = e.strokeStyle, a.save(), a.globalAlpha *= e.strokeOpacity, d.content ? "SVG" === e.fontRenderer ? (this.typeface.setFont(a.font), this.typeface.strokeText(d.content, d.x, d.y)) : a.strokeText(d.content, d.x, d.y) : a.stroke(),
        a.restore()));
      a && a.restore();
      return e
    }
  };
  b.prototype.parseDefs = function(a, b, c) {
    if (this.defs[b]) return this.defs[b];
    var d = this.getElementById(b);
    if (!d) return {};
    c = d.nodeName.toLowerCase();
    switch (c) {
      case "pattern":
        return this.defs[b] = this.parsePattern(a, d);
      case "lineargradient":
      case "radialgradient":
        return this.defs[b] = this.parseGradient(a, d, c)
    }
  };
  b.prototype.addDef = function(a) {
    this.defs[a.id] = a
  };
  b.prototype.Gradient = function(a) {
    a = a || {};
    return {
      gradientUnits: a.gradientUnits || "objectBoundingBox",
      id: a.id ||
        "HelloGradient",
      type: a.type || "linearGradient",
      stops: a.stops || [{
        color: "#FFF",
        offset: 0
      }, {
        color: "#000",
        offset: 1
      }],
      x1: isFinite(a.x1) ? a.x1 : 0,
      x2: isFinite(a.x2) ? a.x2 : 1,
      y1: isFinite(a.y1) ? a.h1 : 0,
      y2: isFinite(a.y2) ? a.y2 : 0
    }
  };
  b.prototype.Pattern = function(a) {
    return {
      id: a.id || "HelloPattern",
      pattern: a.pattern || CanvasPattern,
      patternUnits: a.patternUnits || "userSpaceOnUse",
      type: a.type || "pattern",
      width: a.width || 100,
      height: a.height || 100
    }
  };
  b.prototype.parseGradient = function(a, b, c) {
    if ("lineargradient" === c) {
      var d = this.getAttributes(b,
        "id,x1,y1,x2,y2,spreadMethod,gradientUnits,gradientTransform");
      d.type = "linearGradient"
    } else d = this.getAttributes(b, "id,cx,cy,r,fx,fy,spreadMethod,gradientUnits,gradientTransform"), d.type = "radialGradient", "undefined" === typeof d.fx && (d.fx = d.cx, d.fy = d.cy);
    "undefined" === typeof d.gradientUnits && (d.gradientUnits = "objectBoundingBox");
    var e = [],
      f = b.childNodes,
      g = this.parseHref(b);
    if (g) return e = this.parseDefs(a, g.substr(1), c), d.stops = e.stops, d;
    var m = h(b);
    b = m.color || b.getAttribute("color") || this.state.color;
    a = 0;
    for (var v in f)
      if (g = f[v], g.nodeName && (c = g.nodeName.toLowerCase(), "stop" === c && (m = h(g), c = m["stop-color"] || g.getAttribute("stop-color")))) sketch.color.webcolors[c] ? c = "#" + sketch.color.webcolors[c] : "none" === c ? c = "rgba(0,0,0,0)" : "currentColor" === c ? c = b || "#000000" : "inherit" === c && (c = b || "#000000"), (m = m["stop-opacity"] || g.getAttribute("stop-opacity")) && "1" !== m && ("inherit" === m && (m = 1), "#" === c.substr(0, 1) ? (c = sketch.color.space(c.substr(1), "W3>HEX24>RGB"), c.A = 255 * parseFloat(m)) : "rgba" === c.substr(0, 4) ? (c = sketch.color.space(c,
        "W3>RGBA"), c.A *= parseFloat(m)) : "rgb" === c.substr(0, 3) && (c = sketch.color.space(c, "W3>RGB"), c.A = 255 * parseFloat(m)), c = sketch.color.space.RGBA_W3(c)), g = g.getAttribute("offset") || "0", m = -1 !== g.indexOf("%") ? 100 : 1, g = parseFloat(g) / m, g < a && (g = a), e.push({
        offset: g,
        color: c
      }), a = g;
    d.stops = e;
    return d
  };
  b.prototype.parsePattern = function(b, c) {
    var d = this,
      e = this.getAttributes(c, "patternUnits,patternContentUnits,patternTransform,x,y,width,height,preserveAspectRatio,href"),
      f = this.parseHref(c);
    f && (e.href = f);
    e.type = "pattern";
    e.id = c.id;
    var h = new a.SVG;
    h.element = c;
    h.parse({
      skipRender: !0,
      document: c,
      node: {
        childNodes: []
      },
      onload: function(a) {
        e.childNodes = a;
        if (a.length) {
          a = document.createElement("canvas").getContext("2d");
          var c = d.getBoundingBox(e.childNodes, !1, 0.5);
          a.canvas.width = c[2] - c[0];
          a.canvas.height = c[3] - c[1];
          h.render({
            ctx: a,
            childNodes: e.childNodes,
            viewBox: c,
            placement: "crop"
          });
          b && (a.canvas.width && a.canvas.height) && (e.pattern = b.createPattern(a.canvas, "repeat"))
        }
        e.href && d.parseDefs(b, e.href.substr(1), "pattern")
      }
    });
    return e
  };
  b.prototype.parseHref = function(a) {
    return a.getAttribute("xlink:href") || a.getAttribute("href")
  };
  b.prototype.parseTransform = function(a, b, c) {
    var e = this.ctx,
      h = this.currentNode;
    if (a) {
      a = a.getAttribute(c || "transform");
      if (b)
        if (h.parentNode.matrix) {
          var g = h.parentNode.matrix;
          c = h.matrix = {
            a: g.a,
            b: g.b,
            c: g.c,
            d: g.d,
            x: g.x,
            y: g.y
          }
        } else c = h.matrix = sketch.vector.Transform.getIdentity();
      else c = sketch.vector.Transform.getIdentity();
      if (a) {
        var g = new sketch.vector.Transform(c),
          m = new sketch.vector.Transform;
        if ("matrix" ===
          a.substr(0, 6)) a = a.substr(7, a.length - 8), a = d(a), b && (e && e.transform(a[0], a[1], a[2], a[3], a[4], a[5]), m.transform(a[0], a[1], a[2], a[3], a[4], a[5])), g.transform(a[0], a[1], a[2], a[3], a[4], a[5]);
        else if (-1 !== a.indexOf("(")) {
          a = a.substr(0, a.length - 1).split(")");
          for (var w = 0, v = a.length; w < v; w++) {
            var u = a[w].replace(/^\s+|\s+$/, "").split("(");
            c = u[0].replace(/^\s+|\s+$/, "");
            u = d(u[1]);
            switch (c) {
              case "translate":
                2 === u.length ? (b && (e && e.translate(u[0], u[1]), m.translate(u[0], u[1])), g.translate(u[0], u[1])) : (b && (e && e.translate(u[0],
                  0), m.translate(u[0], 0)), g.translate(u[0]));
                break;
              case "scale":
                2 === u.length ? (b && (e && e.scale(u[0], u[1]), m.scale(u[0], u[1])), g.scale(u[0], u[1])) : (b && (e && e.scale(u[0], u), m.scale(u[0], u[0])), g.scale(u[0], u[0]));
                break;
              case "rotate":
                c = u[0] * f;
                3 === u.length ? (b && (e && (e.translate(u[1], u[2]), e.rotate(c), e.translate(-u[1], -u[2])), m.translate(u[1], u[2]), m.rotate(c), m.translate(-u[1], -u[2])), g.translate(u[1], u[2]), g.rotate(c), g.translate(-u[1], -u[2])) : (b && (e && e.rotate(c), m.rotate(c)), g.rotate(c));
                break;
              case "skewX":
                c =
                  u[0] * f;
                b && (e && e.transform(1, 0, Math.tan(c), 1, 0, 0), m.skew(c, 0));
                g.skew(c, 0);
                break;
              case "skewY":
                c = u[0] * f, b && (e && e.transform(1, Math.tan(c), 0, 1, 0, 0), m.skew(0, c)), g.skew(0, c)
            }
          }
        }
        b && (h.transform = m.matrix, h.transform.type = "transform", h.matrix = g.matrix);
        return {
          matrix: g.matrix,
          transform: m.matrix
        }
      }
    }
  };
  b.prototype.parseClipPath = function(a, b) {
    var c = this.ctx,
      d = this.currentNode;
    if (a) {
      var e = a.getAttribute("clip-path");
      if (e) {
        e = e.substr(5, e.length - 6);
        if (this.defs[e]) return b && (d.clipPath = this.defs[e].d), c && (this.renderChildNodes(c, {}, d.clipPath, !0), c.clip(), c.beginPath()), this.defs[e];
        var f = this.getElementById(e);
        if (f) return this.defs[e] = this.getAttributes(f, "id,x,y,width,height,clipPathUnits"), this.defs[e].type = "clipPath", f = this.parse({
          document: f,
          matrix: this.vob.matrix,
          node: {
            childNodes: []
          },
          skipRender: !0
        }), c && (c.clip(), c.beginPath()), f.id = e, this.defs[e].d = f, b && (d.clipPath = f), this.defs[e]
      }
    }
  };
  b.prototype.parsePoints = function(a, b) {
    var c = a.getAttribute("points");
    if (c) {
      var d = c.replace(/[\s,]+/g, " ").trim().split(/[, ]/);
      if (!(2 >
          d.length)) {
        for (var e = [], c = [], f = 0, h = d.length; f < h; f += 2) {
          var g = d[f],
            m = d[f + 1];
          e.push({
            cmd: c.length ? "L" : "M",
            x: parseFloat(g),
            y: parseFloat(m)
          });
          c.push([g, m])
        }
        d = c.length - 1;
        f = c[d];
        isFinite(f[1]) || (e[d].y = f[1] = c[0][1]);
        "Polygon" === b ? (c = "" + c.join(" ") + "", e.push({
          cmd: "Z",
          x: e[0].x,
          y: e[0].y
        })) : c = "" + c.join(" ");
        return {
          points: c,
          data: e
        }
      }
    }
  };
  b.prototype.getAttributes = function(a, b, c) {
    var e = {};
    if (!a || !a.getAttribute) return {};
    var f = h(a),
      g = 0;
    b = b.split(",");
    for (var m = b.length; g < m; g++) {
      var w = b[g],
        v = this.__attributes[w],
        u = !1;
      if (!v)
        if (v = this.__attributesNS[w]) w = this.__namepace + ":" + w, u = !0;
        else if (w = w.match(this.rxSplitByUppercase).slice(0, -1).join("-").toLowerCase(), v = this.__attributes[w], !v) {
        console.log(w);
        continue
      }
      v = v.format;
      if (c) {
        var y = f[w] || a.getAttribute(w); - 1 !== w.indexOf("-") && (w = w.split("-"), w[1] && (w[1] = w[1][0].toUpperCase() + w[1].substr(1)), w = w.join(""))
      } else y = a.getAttribute(w) || f[w], "id" !== w || y || (y = a.getAttribute("xml:id"));
      if (y)
        if ("inherit" === y) u = this.currentNode, u.parentNode && (u.parentNode.style && u.parentNode.style[w]) &&
          (e[w] = u.parentNode.style[w]);
        else if ("none" === y) e[w] = y;
      else switch (u && (w = w.replace(this.__namepace + ":", "")), v) {
        case "numarray":
          e[w] = d(y);
          break;
        case "coordinate":
          e[w] = parseFloat(y);
          (v = y.replace(this.rxNumeric, "")) && "px" !== v && (e[w] *= this.convertMetrics[v + ">px"]); - 1 !== y.indexOf("%") && (e[w] *= 3);
          Infinity === e[w] && (e[w] = 4294967295); - Infinity === e[w] && (e[w] = -4294967295);
          break;
        case "float":
          e[w] = parseFloat(y);
          Infinity === e[w] && (e[w] = 4294967295); - Infinity === e[w] && (e[w] = -4294967295);
          break;
        case "gradientTransform":
        case "patternTransform":
        case "transform":
          u =
            this.parseTransform(a, !1, v);
          e[w] = u.matrix;
          break;
        case "string":
          e[w] = y
      }
    }
    return e
  };
  b.prototype.getBoundingBox = function(a, b, c) {
    var d = Infinity,
      e = Infinity,
      f = -Infinity,
      h = -Infinity,
      g = function(a) {
        for (var c = 0, k = a.length; c < k; c++) {
          var m = a[c];
          if (m) {
            if (m.bbox) {
              if (b && m.style && m.style.strokeStyle) var r = m.style.strokeWidth || 0,
                A = m.bbox.x1 - r,
                B = m.bbox.x2 + r,
                D = m.bbox.y1 - r,
                r = m.bbox.y2 + r;
              else A = m.bbox.x1, B = m.bbox.x2, D = m.bbox.y1, r = m.bbox.y2;
              A < d && (d = A);
              D < e && (e = D);
              B > f && (f = B);
              r > h && (h = r)
            }
            m.childNodes && g(m.childNodes)
          }
        }
      };
    g(a || [this.vob]);
    c && (d -= c, e -= c, f += c, h += c);
    return [d, e, f, h]
  };
  b.prototype.getElementById = function(a) {
    if (this.element.ownerDocument) {
      var b = this.element.ownerDocument.getElementById(a);
      b || (b = e(this.element.ownerDocument, a))
    } else(b = this.element.getElementById(a)) || (b = e(this.element, a));
    return b
  };
  b.prototype.getLayerById = function(a) {
    var b = function(c) {
      for (var d = 0; d < c.length; d++) {
        var e = c[d];
        if (e.id === a || e.childNodes && (e = b(e.childNodes))) return e
      }
    };
    return b(this.vob.childNodes)
  };
  b.prototype.getLayerBy = function(a,
    b) {
    var c = function(d) {
      for (var e = 0; e < d.length; e++) {
        var f = d[e];
        if (f[a] === b || f.childNodes && (f = c(f.childNodes))) return f
      }
    };
    return c(this.vob.childNodes)
  };
  b.prototype.fontStyleToString = function(a, b) {
    if (a && b) {
      var c = b.textAnchor || "left";
      "middle" === c && (c = "center");
      a.textAlign = c;
      return (b.fontStyle || "normal") + " " + (b.fontWeight || "normal") + " " + (b.fontSize || "normal") + "px " + (b.fontFamily || "sans-serif")
    }
  };
  b.prototype.createCanvas = function() {
    var a = document.createElement("canvas");
    a.ctx = a.getContext("2d");
    return a
  };
  b.prototype.walk = function(a, b, c) {
    var d = "undefined" !== typeof c,
      e = function(f) {
        for (var h = 0; h < f.length; h++) {
          var g = f[h];
          if (b) {
            if (d && g[b] === c) return a(g);
            g[b] && a(g)
          } else a(g);
          if (g.childNodes && (g = e(g.childNodes))) return g
        }
      };
    if (this.vob) return e(this.vob.childNodes)
  };
  var h = function(a) {
      if (a.__style) return a.__style;
      if (!a.getAttribute) return a.__style = {};
      var b = a.getAttribute("style");
      if (!b) return a.__style = {};
      for (var b = b.split(";"), c = {}, d = 0, e = b.length; d < e; d++) {
        var f = b[d].split(":");
        f[0] && f[1] && (c[f[0].trim()] =
          f[1].trim())
      }
      return a.__style = c
    },
    d = function(a) {
      var b = [];
      if (!a) return [];
      for ("string" === typeof a && (a = -1 !== a.indexOf(",") ? a.split(",") : a.split(" ")); a.length;) {
        var c = parseFloat(a.shift());
        b.push(c)
      }
      return b
    },
    e = function(a, b) {
      return window.XPathResult ? a.evaluate('//*[@xml:id="' + b + '"]', a, function() {
        return "http://www.w3.org/XML/1998/namespace"
      }, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue : a.getElementById ? a.getElementById(b) : null
    },
    m = {
      text: !0,
      rect: !0,
      circle: !0,
      ellipse: !0,
      line: !0,
      polyline: !0,
      polygon: !0,
      path: !0
    };
  a.SVG = b;
  a.SVG.storage = g;
  a.SVG.isSVG = function(a) {
    return 0 === a.indexOf("data:image/svg") || 0 === a.indexOf("<?xml") || 0 === a.indexOf("<svg")
  }
})(sketch.vector);
"undefined" !== typeof module && module.exports && (window = {}, DOMParser = require("xmldom").DOMParser, module.exports = sketch.vector.SVG);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
(function() {
  var a = function(a) {
    a.prototype.__dtd = "https://sketch.io/dtd/";
    a.prototype.__namepace = "sketchjs";
    a.prototype.__version = "3.0";
    a.prototype.__attributesNS = {
      labels: {
        param: "labels",
        format: "string",
        value: ""
      },
      license: {
        param: "license",
        format: "string",
        value: ""
      },
      author: {
        param: "author",
        format: "string",
        value: ""
      },
      version: {
        param: "version",
        format: "string",
        value: ""
      },
      metadata: {
        param: "metadata",
        format: "string",
        value: ""
      },
      brush: {
        param: "brush",
        format: "string",
        value: ""
      },
      uid: {
        param: "uid",
        format: "int",
        value: ""
      }
    };
    a.prototype.__attributes = {
      id: {
        param: "id",
        format: "string",
        value: ""
      },
      src: {
        param: "src",
        format: "string",
        value: ""
      },
      href: {
        param: "href",
        format: "string",
        value: ""
      },
      "xlink:href": {
        param: "xlink:href",
        format: "string",
        value: ""
      },
      display: {
        param: "display",
        format: "string",
        valid: "inline | block | list-item | run-in | compact | marker | table | inline-table | table-row-group | table-header-group | table-footer-group | table-row | table-column-group | table-column | table-cell | table-caption | none | inherit",
        value: "inline"
      },
      visibility: {
        param: "visibility",
        format: "string",
        valid: "visible | hidden | collapse | inherit",
        value: "visible"
      },
      viewBox: {
        param: "viewBox",
        format: "numarray",
        value: 0
      },
      preserveAspectRatio: {
        param: "preserveAspectRatio",
        format: "string",
        valid: "[defer] <align> [<meetOrSlice>]",
        value: "xMidYMid meet"
      },
      x: {
        param: "x",
        format: "coordinate",
        value: ""
      },
      y: {
        param: "y",
        format: "coordinate",
        value: ""
      },
      width: {
        param: "width",
        format: "coordinate",
        value: ""
      },
      height: {
        param: "height",
        format: "coordinate",
        value: ""
      },
      transform: {
        param: "transform",
        format: "transform",
        value: "matrix(1,0,0,1,0,0)"
      },
      dx: {
        param: "dx",
        format: "coordinate",
        value: ""
      },
      dy: {
        param: "dy",
        format: "coordinate",
        value: ""
      },
      cx: {
        param: "cx",
        format: "coordinate",
        value: ""
      },
      cy: {
        param: "cy",
        format: "coordinate",
        value: ""
      },
      rx: {
        param: "rx",
        format: "float",
        value: ""
      },
      ry: {
        param: "ry",
        format: "float",
        value: ""
      },
      r: {
        param: "r",
        format: "coordinate",
        value: ""
      },
      x1: {
        param: "x1",
        format: "float",
        value: ""
      },
      y1: {
        param: "y1",
        format: "float",
        value: ""
      },
      x2: {
        param: "x2",
        format: "float",
        value: ""
      },
      y2: {
        param: "y2",
        format: "float",
        value: ""
      },
      d: {
        param: "d",
        format: "string",
        value: ""
      },
      points: {
        param: "points",
        format: "string",
        value: ""
      },
      "font-size": {
        param: "font-size",
        format: "float",
        valid: "<absolute-size> | <relative-size> | <length> | <percentage> | inherit",
        value: "medium"
      },
      "font-style": {
        param: "font-style",
        format: "string",
        valid: "normal | italic | oblique | inherit",
        value: "normal"
      },
      "font-family": {
        param: "font-family",
        format: "string",
        valid: "[[ <family-name> | <generic-family> ],]* [<family-name> | <generic-family>] | inherit",
        value: "sans-serif"
      },
      "font-weight": {
        param: "font-weight",
        format: "string",
        valid: "normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900 | inherit",
        value: "normal"
      },
      "line-height": {
        param: "line-height",
        format: "float",
        valid: "normal | <number> | <length> | <percentage> | inherit",
        value: "normal"
      },
      "text-decoration": {
        param: "text-decoration",
        format: "string",
        valid: "none | [ underline || overline || line-through || blink ] | inherit",
        value: "none"
      },
      "text-anchor": {
        param: "text-anchor",
        format: "string",
        valid: "start | middle | end | inherit",
        value: "start"
      },
      kerning: {
        param: "kerning",
        format: "float",
        valid: "auto | <length> | inherit",
        value: "auto"
      },
      "letter-spacing": {
        param: "letter-spacing",
        format: "float",
        valid: "normal | <length> | inherit",
        value: "normal"
      },
      "word-spacing": {
        param: "word-spacing",
        format: "float",
        valid: "normal | <length> | inherit",
        value: "normal"
      },
      "clip-path": {
        param: "clip-path",
        format: "string",
        value: ""
      },
      clipPathUnits: {
        param: "clipPathUnits",
        format: "string",
        value: "userSpaceOnUse"
      },
      opacity: {
        param: "opacity",
        format: "float",
        value: 1
      },
      fill: {
        param: "fill",
        format: "string",
        value: "black"
      },
      "fill-rule": {
        param: "fill-rule",
        format: "string",
        valid: "nonzero | evenodd | inherit",
        value: "nonzero"
      },
      "fill-opacity": {
        param: "fill-opacity",
        format: "float",
        valid: "<opacity-value> | inherit",
        value: 1
      },
      stroke: {
        param: "stroke",
        format: "string",
        value: "black"
      },
      "stroke-width": {
        param: "stroke-width",
        format: "coordinate",
        valid: "<percentage> | <length> | inherit",
        value: 1
      },
      "stroke-linecap": {
        param: "stroke-linecap",
        format: "string",
        valid: "butt | round | square | inherit",
        value: "butt"
      },
      "stroke-linejoin": {
        param: "stroke-linejoin",
        format: "string",
        valid: "miter | round | bevel | inherit",
        value: "miter"
      },
      "stroke-miterlimit": {
        param: "stroke-miterlimit",
        format: "float",
        valid: "<miterlimit> | inherit",
        value: 4
      },
      "stroke-dasharray": {
        param: "stroke-dasharray",
        format: "numarray",
        valid: "none | <dasharray> | inherit",
        value: "none"
      },
      "stroke-dashoffset": {
        param: "stroke-dashoffset",
        format: "coordinate",
        valid: "<percentage> | <length> | inherit",
        value: 0
      },
      "stroke-opacity": {
        param: "stroke-opacity",
        format: "float",
        valid: "<opacity-value> | inherit",
        value: 1
      },
      stops: {
        param: "stops",
        format: "string",
        value: ""
      },
      gradientUnits: {
        param: "gradientUnits",
        format: "string",
        valid: "userSpace | userSpaceOnUse | objectBoundingBox",
        value: "userSpace"
      },
      gradientTransform: {
        param: "gradientTransform",
        format: "gradientTransform",
        value: "matrix(1,0,0,1,0,0)"
      },
      spreadMethod: {
        param: "spreadMethod",
        format: "string",
        valid: "pad | reflect | repeat",
        value: "pad"
      },
      fx: {
        param: "fx",
        format: "coordinate",
        value: ""
      },
      fy: {
        param: "fy",
        format: "coordinate",
        value: ""
      },
      patternUnits: {
        param: "patternUnits",
        format: "string",
        value: ""
      },
      patternContentUnits: {
        param: "patternContentUnits",
        format: "string",
        value: ""
      },
      patternTransform: {
        param: "patternTransform",
        format: "patternTransform",
        value: "matrix(1,0,0,1,0,0)"
      },
      stdDeviation: {
        param: "stdDeviation",
        format: "float",
        value: 0
      },
      filter: {
        param: "filter",
        format: "string",
        value: ""
      },
      color: {
        param: "color",
        format: "string",
        value: ""
      },
      "color-interpolation-filters": {
        param: "color-interpolation-filters",
        format: "string",
        valid: "auto | sRGB | linearRGB | inherit",
        value: "sRGB"
      }
    }
  };
  "undefined" !== typeof module &&
    module.exports ? module.exports = a : a(sketch.vector.SVG)
})();
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
"undefined" === typeof sketch.vector.SVGPath && (sketch.vector.SVGPath = {});
(function(a) {
  var g = {
    m: 2,
    l: 2,
    h: 1,
    v: 1,
    c: 6,
    s: 4,
    q: 4,
    t: 2,
    a: 7,
    z: 0
  };
  a.fromVOBPath = function(a) {
    for (var b = "", c = {}, d = 0, e = a.length; d < e; d++)
      if (c = a[d]) switch (c.cmd) {
        case "M":
          b += "M" + c.x + " " + c.y + " ";
          break;
        case "L":
          b += "L" + c.x + " " + c.y + " ";
          break;
        case "C":
          b += "C" + c.x1 + " " + c.y1 + ", " + c.x2 + " " + c.y2 + ", " + c.x + " " + c.y + " ";
          break;
        case "Q":
          b += "Q" + c.x1 + " " + c.y1 + ", " + c.x + " " + c.y + " ";
          break;
        case "Z":
        case "z":
          b += "z"
      }
      return b.substr(0, b.length - 1)
  };
  a.fromVARPath = function(a) {
    for (var b = "", c = {}, d = 0, e = a.length; d < e; d++)
      if (c = a[d]) switch (c[0]) {
        case "M":
          b +=
            "M" + c[1] + " " + c[2] + " ";
          break;
        case "L":
          b += "L" + c[1] + " " + c[2] + " ";
          break;
        case "C":
          b += "C" + c[1] + " " + c[2] + ", " + c[3] + " " + c[4] + ", " + c[5] + " " + c[6] + " ";
          break;
        case "Q":
          b += "Q" + c[1] + " " + c[2] + ", " + c[3] + " " + c[4] + " ";
          break;
        case "Z":
        case "z":
          b += "z"
      }
      return b.substr(0, b.length - 1)
  };
  a.fromVOBPolygon = function(a) {
    for (var b = "", c = {}, d = 0, e = a.length; d < e; d++) switch ((c = a[d]).cmd) {
      case "Z":
        break;
      default:
      case "M":
      case "L":
        b += c.x + "," + c.y + " "
    }
    return b.substr(0, b.length - 1)
  };
  a.toVOBPolygon = function(a) {
    if (a) {
      a = a.match(/[0-9]*/gi);
      for (var b = [], c = 0, d = a.length; c < d; c++) a[c] && b.push(parseFloat(a[c]));
      a = [];
      c = 0;
      for (d = b.length; c < d; c += 2) a.push({
        x: b[c],
        y: b[c + 1]
      });
      return a
    }
  };
  a.toVOBPath = function(a) {
    if (a) {
      a = a.replace(/([^e])([+-])/g, "$1 $2");
      a = a.match(/([mlhvcsqtaz])|[0-9.\-e]*/gi);
      for (var b = [], h = 0, d = a.length; h < d; h++) a[h] && b.push(a[h]);
      a = b;
      for (var b = "", e = h = 0, m = 0, k = 0, l = 0, r, p, q = "", t = 0, s = []; b = a[h];) {
        var w = g[b.toLowerCase()] + 1;
        if (w) {
          for (var v = 1, d = w, u = []; v < d; v++) u.push(parseFloat(a[h + v]));
          t = w;
          h += w
        } else {
          v = 0;
          d = t - 1;
          for (u = []; v < d; v++) u.push(parseFloat(a[h +
            v]));
          b = "m" === q ? "l" : "M" === q ? "L" : q;
          h += t - 1
        }
        if (b) {
          switch (b) {
            case "M":
              e = u[0];
              m = u[1];
              k = e;
              l = m;
              r = p = null;
              s.push({
                cmd: "M",
                x: e,
                y: m
              });
              break;
            case "m":
              e += u[0];
              m += u[1];
              k = e;
              l = m;
              r = p = null;
              s.push({
                cmd: "M",
                x: e,
                y: m
              });
              break;
            case "L":
              e = u[0];
              m = u[1];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "l":
              e += u[0];
              m += u[1];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "H":
              e = u[0];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "h":
              e += u[0];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "V":
              m = u[0];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "v":
              m += u[0];
              r = p = null;
              s.push({
                cmd: "L",
                x: e,
                y: m
              });
              break;
            case "C":
              e = u[4];
              m = u[5];
              r = u[2];
              p = u[3];
              s.push({
                cmd: "C",
                x1: u[0],
                y1: u[1],
                x2: u[2],
                y2: u[3],
                x: u[4],
                y: u[5]
              });
              break;
            case "c":
              0 === u[4] && 0 === u[5] && (u[4] += 1E-4, u[5] += 1E-4);
              s.push({
                cmd: "C",
                x1: u[0] + e,
                y1: u[1] + m,
                x2: u[2] + e,
                y2: u[3] + m,
                x: u[4] + e,
                y: u[5] + m
              });
              r = e + u[2];
              p = m + u[3];
              e += u[4];
              m += u[5];
              break;
            case "S":
              null !== r && q.match(/[sc]/i) || (r = e, p = m);
              s.push({
                cmd: "C",
                x1: e - (r - e),
                y1: m - (p - m),
                x2: u[0],
                y2: u[1],
                x: u[2],
                y: u[3]
              });
              r = u[0];
              p = u[1];
              e = u[2];
              m = u[3];
              break;
            case "s":
              0 === u[2] &&
                0 === u[3] && (u[2] += 1E-4, u[3] += 1E-4);
              null !== r && q.match(/[sc]/i) || (r = e, p = m);
              s.push({
                cmd: "C",
                x1: e - (r - e),
                y1: m - (p - m),
                x2: e + u[0],
                y2: m + u[1],
                x: e + u[2],
                y: m + u[3]
              });
              r = e + u[0];
              p = m + u[1];
              e += u[2];
              m += u[3];
              break;
            case "Q":
              r = u[0];
              p = u[1];
              e = u[2];
              m = u[3];
              s.push({
                cmd: "Q",
                x1: u[0],
                y1: u[1],
                x: u[2],
                y: u[3]
              });
              break;
            case "q":
              0 === u[2] && 0 === u[3] && (u[2] += 1E-4, u[3] += 1E-4);
              s.push({
                cmd: "Q",
                x1: u[0] + e,
                y1: u[1] + m,
                x: u[2] + e,
                y: u[3] + m
              });
              r = e + u[0];
              p = m + u[1];
              e += u[2];
              m += u[3];
              break;
            case "T":
              null !== r && q.match(/[qt]/i) ? (r = e - (r - e), p = m - (p - m)) : (r = e, p = m);
              s.push({
                cmd: "Q",
                x1: r,
                y1: p,
                x: u[0],
                y: u[1]
              });
              e = u[0];
              m = u[1];
              break;
            case "t":
              0 === u[0] && 0 === u[1] && (u[0] += 1E-4, u[1] += 1E-4);
              null !== r && q.match(/[qt]/i) ? (r = e - (r - e), p = m - (p - m)) : (r = e, p = m);
              s.push({
                cmd: "Q",
                x1: r,
                y1: p,
                x: e + u[0],
                y: m + u[1]
              });
              e += u[0];
              m += u[1];
              break;
            case "A":
              d = c(u[5], u[6], u[0], u[1], u[3], u[4], u[2], e, m);
              for (e = 0; e < d.length; e++) s.push(d[e]);
              e = u[5];
              m = u[6];
              break;
            case "a":
              u[5] += e;
              u[6] += m;
              d = c(u[5], u[6], u[0], u[1], u[3], u[4], u[2], e, m);
              for (e = 0; e < d.length; e++) s.push(d[e]);
              e = u[5];
              m = u[6];
              break;
            case "Z":
              s.push({
                cmd: "Z",
                x: k,
                y: l
              });
              l = k = 0;
              break;
            case "z":
              s.push({
                cmd: "Z",
                x: k,
                y: l
              }), e = k, m = l
          }
          q = b
        }
      }
      return s
    }
  };
  var c = function(a, b, c, d, e, g, k, l, r) {
    var p = k * (Math.PI / 180);
    k = Math.sin(p);
    var p = Math.cos(p),
      q = [];
    c = Math.abs(c);
    d = Math.abs(d);
    var t = 0.5 * p * (l - a) + 0.5 * k * (r - b),
      s = 0.5 * p * (r - b) - 0.5 * k * (l - a),
      t = t * t / (c * c) + s * s / (d * d);
    1 < t && (t = Math.sqrt(t), c *= t, d *= t);
    var t = p / c,
      s = k / c,
      w = -k / d,
      v = p / d,
      u = t * l + s * r;
    r = w * l + v * r;
    l = t * a + s * b;
    a = w * a + v * b;
    t = 1 / ((l - u) * (l - u) + (a - r) * (a - r)) - 0.25;
    0 > t && (t = 0);
    t = Math.sqrt(t);
    g === e && (t = -t);
    e = 0.5 * (u + l) - t * (a - r);
    b = 0.5 * (r + a) + t * (l - u);
    u = Math.atan2(r - b, u - e);
    r = Math.atan2(a - b, l - e) - u;
    0 > r && 1 === g ? r += 2 * Math.PI : 0 < r && 0 === g && (r -= 2 * Math.PI);
    g = Math.ceil(Math.abs(r / (0.5 * Math.PI + 0.001)));
    for (var y = 0; y < g; y++) {
      a = u + y * r / g;
      var x = u + (y + 1) * r / g,
        t = p * c,
        s = -k * d,
        w = k * c,
        v = p * d;
      l = 0.5 * (x - a);
      var z = 8 / 3 * Math.sin(0.5 * l) * Math.sin(0.5 * l) / Math.sin(l);
      l = e + Math.cos(a) - z * Math.sin(a);
      a = b + Math.sin(a) + z * Math.cos(a);
      var A = e + Math.cos(x),
        B = b + Math.sin(x),
        D = A + z * Math.sin(x),
        x = B - z * Math.cos(x);
      q[y] = {
        cmd: "C",
        x1: t * l + s * a,
        y1: w * l + v * a,
        x2: t * D + s * x,
        y2: w * D + v * x,
        x: t * A + s * B,
        y: w * A + v * B
      }
    }
    return q
  }
})(sketch.vector.SVGPath);
"undefined" !== typeof module && module.exports && (module.exports = sketch.vector.SVGPath);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
(function() {
  var a = function(a) {
    a.prototype.render = function(c) {
      c = c || {};
      sketch = a.__self || sketch;
      if (this.vob) {
        var f = c.calcStroke ? c.viewBoxStroke || this.viewBoxStroke : c.viewBox || this.viewBox,
          b = c.placement || this.placement;
        if ("[object CanvasRenderingContext2D]" === String(c)) var h = c,
          d = sketch.vector.Transform.getIdentity();
        else h = c.ctx || this.ctx, h || (h = this.ctx = this.createCanvas().ctx), d = c.matrix || sketch.vector.Transform.getIdentity();
        h.save();
        switch (b) {
          case "crop":
            var e = f[2] - f[0],
              m = f[3] - f[1],
              d = (new sketch.vector.Transform).translate(-f[0], -f[1]).matrix;
            c.width && c.height ? (b = c.width, b = Math.min(b / e, c.height / m), d.a *= b, d.d *= b, d.x += f[0] * (1 - b), d.y += f[1] * (1 - b), f = (m - e) * b / 2, 0 < f ? d.x += f : d.y -= f, h.canvas.width = c.width, h.canvas.height = c.height) : (h.canvas.width = e >> 0, h.canvas.height = m >> 0);
            h.transform(d.a, d.b, d.c, d.d, d.x, d.y);
            break;
          case "bbox":
            e = f[2] * d.a;
            b = e - f[0] * d.a;
            b = d.a * (e / b - 1);
            this.vob.matrix = d;
            this.vob.matrix.a += b;
            this.vob.matrix.d += b;
            this.vob.matrix.x -= f[0] * this.vob.matrix.a;
            this.vob.matrix.y -= f[1] * this.vob.matrix.d;
            d = this.vob.matrix;
            h.transform(d.a,
              d.b, d.c, d.d, d.x, d.y);
            break;
          case "none":
            h.canvas.width = this.ctx.canvas.width, h.canvas.height = this.ctx.canvas.height
        }
        c.defaultFill && (this.defaultFill = c.defaultFill);
        f = c.childNodes || [this.vob];
        this.activeAreas = [];
        this.renderChildNodes(h, c, f);
        h.restore();
        return this.activeAreas
      }
    };
    a.prototype.renderChildNodes = function(a, f, b, h) {
      if (b && b.length) {
        var d = b.length,
          e = sketch.vector.shape;
        this.typeface && (this.typeface.ctx = a);
        for (var g = 0; g < d; g++) {
          var k = b[g];
          this.currentNode = k;
          a && (a.save(), a.beginPath(), a.save());
          if (k.matrix) {
            var l = k.matrix;
            a && a.transform(l.a, l.b, l.c, l.d, l.x, l.y)
          }
          k.clipPath && k.clipPath.length && (this.renderChildNodes(a, f, k.clipPath, !0), a && (a.clip(), a.beginPath()));
          switch (k.type) {
            case "image":
              a.drawImage(k.image, k.x, k.y, k.width, k.height);
              break;
            case "line":
              a.moveTo(k.x1, k.y1);
              a.lineTo(k.x2, k.y2);
              break;
            case "polyline":
            case "polygon":
            case "path":
              e.VOBPath(a, k.data);
              break;
            case "ellipse":
              e.ellipse(a, k.cx, k.cy, k.rx, k.ry);
              break;
            case "circle":
              e.ellipse(a, k.cx, k.cy, k.r, k.r);
              break;
            case "rect":
              isFinite(k.rx) ?
                e.roundRect(a, k.x, k.y, k.width, k.height, k.rx, k.ry) : e.rect(a, k.x, k.y, k.width + k.x, k.height + k.y)
          }
          f.point && a.isPointInPath(f.point.x, f.point.y) && this.activeAreas.push(k);
          (l = k.style) && !h && (a.save(), "undefined" !== typeof l.opacity && (a.globalAlpha = l.opacity), l.fillStyle && (a.save(), this.setStyle(a, this.defs[l.fillStyle] || l, "fillStyle", this.defaultFill), a.globalAlpha *= l.fillOpacity, k.content ? (a.font = this.fontStyleToString(a, l), "SVG" === l.fontRenderer ? (this.typeface.setFont(a.font), this.typeface.fillText(k.content,
            k.x, k.y)) : a.fillText(k.content, k.x, k.y)) : a.fill(), a.restore()), a.lineWidth = 0 === l.strokeWidth ? 1E-10 : l.strokeWidth || 1, a.lineCap = l.strokeLinecap || "butt", a.lineJoin = l.strokeLinejoin || "miter", a.miterLimit = l.strokeMiterlimit || a.lineWidth, l.strokeStyle && "none" !== l.strokeStyle && (a.save(), this.setStyle(a, this.defs[l.strokeStyle] || l, "strokeStyle", this.defaultStroke), a.globalAlpha *= l.strokeOpacity, k.content ? (a.font = this.fontStyleToString(a, l), "SVG" === l.fontRenderer ? (this.typeface.setFont(a.font), this.typeface.strokeText(k.content,
            k.x, k.y)) : a.strokeText(k.content, k.x, k.y)) : a.stroke(), a.restore()), a.restore());
          this.debugBBox && (k.bbox && !h) && (l = k.bbox, a.save(), a.setTransform(1, 0, 0, 1, 0, 0), a.strokeRect(l.x1, l.y1, l.x2 - l.x1, l.y2 - l.y1), a.restore());
          a.restore();
          k.childNodes && k.childNodes.length && this.renderChildNodes(a, f, k.childNodes, h);
          a.restore()
        }
      }
    };
    a.prototype.setStyle = function(c, f, b, h) {
      sketch = a.__self || sketch;
      "undefined" !== typeof f.strokeWidth && (c.lineWidth = f.strokeWidth || 1E-10);
      "undefined" !== typeof f.strokeLinecap && (c.lineCap =
        f.strokeLinecap);
      "undefined" !== typeof f.strokeLinejoin && (c.lineJoin = f.strokeLinejoin);
      "undefined" !== typeof f.strokeMiterlimit && (c.miterLimit = f.strokeMiterlimit);
      var d;
      if (f.gradientTransform) {
        var e = f.gradientTransform;
        this.currentNode && this.currentNode.matrix && (d = new sketch.vector.Transform, d.transform(e.a, e.b, e.c, e.d, e.x, e.y), d = d.matrix)
      }
      switch (f.type) {
        case "linearGradient":
          "undefined" === String(f.x1) && (f.x1 = 0);
          "undefined" === String(f.y1) && (f.y1 = 0);
          "undefined" === String(f.x2) && (f.x2 = 0);
          "undefined" ===
          String(f.y2) && (f.y2 = 0);
          if (!c) break;
          d && c.transform(d.a, d.b, d.c, d.d, d.x, d.y);
          if ("objectBoundingBox" === f.gradientUnits) {
            0 === f.x1 && (0 === f.y1 && 0 === f.x2 && 0 === f.y2) && (f.x2 = 1);
            var m = this.currentNode;
            if (!m.bbox) break;
            h = m.bbox;
            var k = h.x1 + (h.x2 - h.x1) * f.x1,
              l = h.y1 + (h.y2 - h.y1) * f.y1,
              r = h.x1 + (h.x2 - h.x1) * f.x2,
              p = h.y1 + (h.y2 - h.y1) * f.y2;
            d = c.createLinearGradient(k, l, r, p);
            d = (new sketch.vector.Transform(m.matrix)).invert();
            k = d.point2d(k, l);
            d = d.point2d(r, p);
            d = c.createLinearGradient(k.x, k.y, d.x, d.y)
          } else d = c.createLinearGradient(f.x1,
            f.y1, f.x2, f.y2);
          h = 0;
          for (e = f.stops.length; h < e; h++) {
            var q = f.stops[h];
            d.addColorStop(q.offset, q.color)
          }
          c[b] = d;
          break;
        case "radialGradient":
          "undefined" === typeof f.cx && (f.cx = 0.5);
          "undefined" === typeof f.cy && (f.cy = 0.5);
          "undefined" === typeof f.fx && (f.fx = 0.5);
          "undefined" === typeof f.fy && (f.fy = 0.5);
          "undefined" === typeof f.r && (f.r = 0.5);
          if (!c) break;
          d && c.transform(d.a, d.b, d.c, d.d, d.x, d.y);
          if ("objectBoundingBox" === f.gradientUnits) {
            m = this.currentNode;
            h = m.bbox;
            if (!m.bbox) break;
            var e = h.x2 - h.x1,
              q = h.y2 - h.y1,
              k = h.x1 + e * f.cx,
              l = h.y1 + q * f.cy,
              r = h.x1 + e * f.fx,
              p = h.y1 + q * f.cy,
              t = 1.6 * Math.max(e, q) * f.r;
            d = (new sketch.vector.Transform(m.matrix)).invert();
            k = d.point2d(k, l);
            d = d.point2d(r, p);
            d = c.createRadialGradient(k.x, k.y, 0, d.x, d.y, t);
            q < e && (e = q / e, c.translate(0, h.y2), c.scale(1, e))
          } else d = c.createRadialGradient(f.cx, f.cy, 0, f.fx, f.fy, f.r);
          h = 0;
          for (e = f.stops.length; h < e; h++) q = f.stops[h], d.addColorStop(q.offset, q.color);
          c[b] = d;
          break;
        case "pattern":
          c.translate(f.x || 0, f.y || 0);
          c[b] = f.pattern || "none";
          break;
        default:
          c[b] = "default" === f[b] ? h || this.defaultFill :
            f[b]
      }
    }
  };
  "undefined" !== typeof module && module.exports ? (DOMParser = require("xmldom").DOMParser, module.exports = a) : a(sketch.vector.SVG)
})();
"undefined" === typeof sketch && (sketch = {});
sketch.io = sketch.io || {};
(function(a) {
  a.io.JSON = function(a) {
    var b = this,
      h = a.util.array2object(["[object Blob]", "[object File]"]);
    this.read = function(d, e, g) {
      if (!d) return console.log("missing configure");
      e = e || d.onload || c;
      g = g || d.onerror || c;
      var k = d.data || d.blob || d.hash && d || d.src || d;
      if (h[String(k)]) return a.convert.blobToText(d.blob || d, function(a) {
        b.read(a, e, g)
      });
      if ("string" === typeof k) {
        if ("<" === k.substr(0, 1)) return a.loader.stop();
        if ("http" === k.substr(0, 4) || a.util.parseUri.isLocalhost(k)) return a.util.request({
          url: k,
          onload: function(a) {
            d.data =
              a.responseText;
            b.read(d, e, g)
          }
        });
        try {
          k = JSON.parse(k)
        } catch (l) {
          return g(l)
        }
      }
      return e(k)
    };
    this.open = function(d, e, h) {
      e = d.onload || e || c;
      h = d.onerror || h || c;
      b.read(d, function(c) {
        if (c) {
          if (d.mergeIntoActions) return b.merge(c, e, h);
          a.loader.thread = a.loader.thread || a.loader.add("opening sketch...");
          "sketch" === c.title && (c.title = a.project.title = a.feature.project.title);
          "..." === c.description && (c.description = a.project.description = a.feature.project.description);
          c.actions && a.scene.setData(c.actions, !0);
          a.history && a.feature.history.vector &&
            (c.history && c.history.vector) && (a.history.history.vector = c.history.vector);
          c = b.upgrade(c);
          c = c.metadata || {};
          for (var l in c) typeof c[l] === typeof a.project[l] && (a.project[l] = c[l]);
          c.background && a.setBackground(c.background);
          a.project.setSize(c.width, c.height, c.units);
          a.orient && a.orient.reset();
          a.render.state = "preload";
          a.scene.reindex();
          a.render.preload({
            onprogress: function(b) {
              a.loader.update(a.loader.thread, "opening sketch...", 99 * b >> 0)
            },
            onload: function() {
              a.loader.stop();
              a.assets && a.assets.addFromActions(a.scene.data);
              e && e()
            }
          })
        }
      }, h)
    };
    this.merge = function(b, c, h) {
      if (!b) return h();
      b = b.actions ? b.actions : b;
      for (h = 0; h < b.length; h++) {
        var k = b[h];
        a.scene.getById(k.id) || (a.scene.push(k), a.scene.dataById[k.id] = k)
      }
      a.scene.reindex();
      a.render.preload({
        onload: function() {
          a.assets && a.assets.addFromActions(a.scene.data);
          c && c()
        }
      })
    };
    this.save = function(b, c) {
      b = b || function(a, b) {
        console.log(a, b)
      };
      var h = a.scene.data,
        k = {};
      if (a.history && a.history.history)
        if (c) {
          var l = a.feature.sync.json;
          l && l.undo && (k.history = {}, k.history.vector = a.history.history.vector)
        } else a.feature.history.vector &&
          (k.history = {}, k.history.vector = a.history.history.vector);
      k.metadata = a.project;
      k.version = a.__version;
      k.title = a.project.title;
      k.description = a.project.description;
      k.actions = g(a.scene.clone(h, !0));
      "sketch" === k.title && (k.title = a.project.title = a.feature.project.title);
      "..." === k.description && (k.description = a.project.description = a.feature.project.description);
      this.assets(function(c) {
        b(JSON.stringify(k, a.util.json.filterCircular), c)
      })
    };
    this.assets = function(b) {
      b = b || {};
      "function" === typeof b && (b = {
        callback: b
      });
      var c = b.actions || (b.fromSelection ? a.scene.getSelection() : a.scene.data),
        h = b.callback || function(a) {
          console.log(a)
        },
        k = b.toBlobURL || !1,
        l = function() {
          !--t && s >= q - 1 && h(p)
        };
      b = function(b) {
        ++t;
        var c = b.src;
        if (p[c]) l();
        else if (!1 === g && a.util.parseUri.isLocalhost(c)) l();
        else if (a.assets.data[c]) {
          var d = a.assets.data[c],
            e = a.configure.image,
            h = e.mime,
            e = e.quality,
            m = b.type;
          if ("clipart" === m) {
            if (d.srcXML) b = d.srcXML;
            else {
              if ("function" !== typeof d.stringify) return a.feature.debug && console.log("cannot stringify svg", d), l();
              b = d.stringify()
            }
            b = new Blob([b], {
              type: "image/svg+xml"
            });
            p[c] = k ? URL.createObjectURL(b) : b;
            l()
          } else a.detect.stampResource[m] && "image/jpeg" === h && (m = d.getContext("2d"), m.save(), m.globalCompositeOperation = "destination-atop", m.fillStyle = "#fff", m.fillRect(0, 0, d.width, d.height), m.restore()), k ? a.assets.IDtoURL[b.src] ? (p[c] = a.assets.IDtoURL[b.src], l()) : d.blob ? (p[c] = URL.createObjectURL(d.blob), l()) : d.toBlob(function(a) {
            p[c] = URL.createObjectURL(a);
            l()
          }, h, e) : d.blob ? (p[c] = d.blob, l()) : a.assets.getBlob(c, function(a) {
            p[c] =
              a;
            l()
          }, h, e)
        } else l()
      };
      var g = a.feature.sync.localRefs,
        p = {},
        q = c.length;
      if (0 === q || a.fromServer) return h(p);
      for (var t = 0, s = 0; s < q; s++) {
        var w = c[s];
        w.src ? b(w) : !t && s >= q - 1 && h(p)
      }
    };
    this.upgrade = function(b) {
      b.version = b.version || "2.0a";
      b.version = b.version.replace("dev", "");
      var c = new a.util.version(b.version || "2.0"),
        h = {
          "2.0a": c.isLessThan("2.0a"),
          "3.3": c.isLessThan("3.3"),
          "3.4": c.isLessThan("3.4"),
          "3.4.6": c.isLessThan("3.4.6"),
          "3.4.6.1": c.isLessThan("3.4.6.1")
        };
      b.srcs && a.feature.deubg && console.log("data.srcs");
      for (var k = b.actions, l = 0, g = k.length; l < g; l++) {
        var p = k[l];
        h["2.0a"] && (p.color_mode && (p.fill.mode = p.color_mode), p.color_noise && (p.fill.noise = p.color_noise), p.flow && (p.spacing = p.flow));
        h["3.3"] && (p.src && (p.src = p.src.replace("/brush/", "/stamp/"), p.src = p.src.replace("/animal/", "/animals/")), "polygon" === p.type && (p.type = "regularPolygon"), "radialBurst" === p.type && (p.spread = p.slope, delete p.slope), "0,00000000" === p.fill.gradient && (p.fill.gradient = "none"));
        h["3.4.6"] && (p.content && (p.content = p.content.split("\uf7c2\uf7a0").join(" ")),
          a.detect("brush", p.type) && p.bbox.padding && (p.bbox.x -= 2 * p.bbox.padding, p.bbox.y -= 2 * p.bbox.padding), "paint" === p.composite && (p.composite = "source-over"), "light" === p.composite && (p.composite = "lighter"), isFinite(p.saturation) && (p.type = "image"), "image" === p.type && (delete p.temperature, delete p.tint, delete p.exposure, delete p.brightness, delete p.contrast, delete p.saturation, delete p.filters))
      }
      k = b.metadata = b.metadata || {};
      h["3.4"] && (b.title && (k.title = b.title), b.description && (k.description = b.description), isFinite(b.width) &&
        (k.width = b.width), isFinite(b.height) && (k.height = b.height));
      h["3.4.6"] && "string" !== typeof k.units && (k.units = !1 === k.autoResize || !1 === k.infiniteCanvas ? "px" : "%");
      h["3.4.6.1"] && (isFinite(k.x) && isFinite(k.y)) && (k.x = -k.x, k.y = -k.y);
      if (a.feature.project.lockProperties) {
        a.util.mergeObject(a.feature.project || {}, k);
        for (var q in k);
      } else k.background = k.background || "transparent", k.units = k.units || "%", k.width = k.width || 1, k.height = k.height || 1, k.x = k.x || 0, k.y = k.y || 0, k.pages = k.pages || {
        data: [],
        current: 0,
        length: 0
      };
      a.feature.debug &&
        console.log("upgrade", c);
      return b
    }
  };
  var g = function(a) {
      for (var b in a) {
        var c = a[b].data;
        if (c && c.length)
          for (var d = 0; d < c.length; d++) c[d].x = Math.round(1E3 * c[d].x) / 1E3, c[d].y = Math.round(1E3 * c[d].y) / 1E3;
        c = a[b].bbox;
        c.width = Math.round(1E3 * c.width) / 1E3;
        c.height = Math.round(1E3 * c.height) / 1E3;
        c.x = Math.round(1E3 * c.x) / 1E3;
        c.y = Math.round(1E3 * c.y) / 1E3
      }
      return a
    },
    c = function(a, b) {
      console.log("callback", a, b)
    }
})(sketch);
"undefined" !== typeof module && module.exports && (module.exports = sketch.io.JSON);
"undefined" === typeof sketch && (sketch = {});
sketch.io = sketch.io || {};
sketch.save = sketch.save || {};
sketch.download = sketch.download || {};
sketch.convert = sketch.convert || {};
sketch.open = sketch.open || {};
(function(a) {
  a.server && a.server.save && (a.save.remote = a.server.save, a.open.remote = a.server.open);
  a.io.zip && (a.open.sketch = a.open.zip = a.io.zip.open, a.zip = a.io.zip);
  var g = function(b, c, e, f, k, l, g) {
      var p = typeof b,
        q = "object" === p ? b : {},
        t = function(a, b, c) {
          typeof q[a] !== b && (q[a] = c)
        },
        s = function(a, b, c) {
          if ("function" === typeof c)
            if (q.callback) {
              var d = q.callback;
              q.callback = function() {
                d();
                c()
              }
            } else q.callback = c;
          if (typeof c === b) return q[a] = c, !0
        };
      "number" === p ? (s("x", "number", b), s("y", "number", c), s("width", "number", e),
        s("height", "number", f), s("mime", "string", k), s("quality", "number", l), s("callback", "function", g)) : "string" === p ? (s("mime", "string", b), s("quality", "number", c), s("callback", "function", e)) : "function" === p && s("callback", "function", b);
      b = a.canvas2d.pixelRatio;
      c = a.project.getBounds();
      c.width && t("width", "number", c.width * b);
      c.height && t("height", "number", c.height * b);
      t("mime", "string", a.configure.image.mime);
      t("quality", "number", a.configure.image.quality);
      return q
    },
    c = new function() {
      var b = "undefined" === typeof document ?
        !1 : "download" in document.createElement("a");
      this.lapse = 1E3;
      this.now = function() {
        return (new Date).getTime()
      };
      this.getElement = function() {
        var b = this.element || a.$("#sk-download-element");
        if (b) return b;
        this.element = document.createElement("a");
        this.element.id = "download";
        this.element.target = "_blank";
        this.element.style.display = "none";
        this.element.timestamp = this.now() - this.lapse;
        document.body.appendChild(this.element);
        return this.element
      };
      this.isReady = function(a) {
        var b = this.getElement(),
          c = this.now();
        if (c - b.timestamp >=
          this.lapse) return a ? !0 : b.timestamp = c
      };
      this.onReady = function(a) {
        var b = this.getElement();
        if (this.isReady(!0)) return a(b), b
      };
      this.download = function(d, e) {
        if (b) {
          window.alertify && !1 === a.userAgent.nodewebkit && alertify.log("Saving to computer...");
          var f = c.getElement();
          f.download = e;
          f.href = d;
          f.click()
        } else window.open().document.write("<title>" + e + '</title><img src="' + d + '"/>')
      }
    };
  a.download.blob = function(b, d) {
    b = b || new Blob(["hello world"]);
    d = d || a.project.title + ".txt";
    var e = a.supports.io.blob;
    a.supports.chooseEntry ?
      chrome.fileSystem.chooseEntry({
        type: "saveFile",
        suggestedName: d
      }, function(a) {
        a.createWriter(function(a) {
          a.write(b)
        }, function(a) {
          console.log(a)
        })
      }) : e ? (window.alertify && !1 === a.userAgent.nodewebkit && alertify.log("Saving to computer..."), saveAs(b, d)) : (e = URL.createObjectURL(b), c.download(e, d))
  };
  a.download.text = function(b, d, e) {
    d = d || a.project.title + ".txt";
    e = e || "text/plain";
    a.supports.io.blob ? a.download.blob(new Blob([b], {
      type: e
    }), d) : (b = "data:" + e + ";base64," + btoa(b), c.download(b, d))
  };
  a.download.canvas = function(b,
    d, e, f) {
    if (c.isReady()) {
      b = b || document.createElement("canvas");
      e = e || "image/png";
      f = f || 1;
      var k = e.split("/").pop(),
        l = d || a.project.title || "sketch";
      d = -1 === l.indexOf(k) ? l + "." + k : l;
      a.supports.io.blob ? b.toBlob(function(b) {
        a.download.blob(b, d)
      }, e, f) : (b = b.toDataURL(e, f), c.download(b, d))
    }
  };
  a.download.sketch = a.download.zip = function(b) {
    c.isReady() && a.save.zip(function(c) {
      var e = b || a.project.title;
      b = -1 === e.indexOf(".zip") ? e + ".zip" : e;
      a.download.blob(c, b)
    })
  };
  a.download.svg = function(b) {
    c.isReady() && a.save.svg(function(c,
      e) {
      var f = b || a.project.title;
      b = -1 === f.indexOf(".svg") ? f + ".svg" : f;
      a.download.text(c, b, "image/svg+xml")
    })
  };
  a.download.json = function(b) {
    c.isReady() && a.save.json(function(c, e) {
      var f = b || a.project.title;
      b = -1 === f.indexOf(".json") ? f + ".json" : f;
      a.download.text(JSON.stringify(c, a.util.json.filterCircular), b, "application/json")
    })
  };
  a.download.image = function(b, d, e, f, k, l, r) {
    c.onReady(function(c) {
      var q = g(b, d, e, f, k, l, r);
      a.save.canvas(q, function(b) {
        a.download.canvas(b, q.filename, q.mime, q.quality)
      })
    })
  };
  a.download.pdf =
    function(b, d, e, f, k, l, r) {
      a.loader.thread = a.loader.thread || a.loader.add("reading files...");
      c.onReady(function(c) {
        var q = g(b, d, e, f, k, l, r),
          t = a.project.pages.data,
          s = t.length || 1,
          w = 0,
          v = 0;
        0 === t.length ? (w = a.project.bounds.width, v = a.project.bounds.height) : t.forEach(function(a) {
          w = Math.max(w, a.width);
          v = Math.max(v, a.height)
        });
        c = a.convert.metrics["px>mm"];
        var u = new jsPDF(w > v ? "landscape" : "portrait", "mm", [w * c, v * c]),
          y = u.internal.pageSize.width,
          x = u.internal.pageSize.height,
          z = 0;
        new a.util.Queue({
          range: {
            from: 0,
            to: s -
              1
          },
          oncomplete: function() {
            var b = q.filename || a.project.title;
            a.download.blob(u.output("blob"), b + ".pdf");
            a.loader.update(a.loader.thread, null, 100)
          },
          next: function(b, c, d) {
            var e = this;
            0 !== d && u.addPage();
            var f = t[d] || a.project.bounds;
            q.x = 0;
            q.y = z;
            q.width = f.width;
            q.height = f.height;
            a.save.canvas(q, function(b) {
              var c = b.toDataURL("image/jpeg", 1);
              b = Math.max(b.width / y, b.height / x);
              u.addImage(c, "JPEG", 0, 0, f.width / b, f.height / b);
              z += f.height;
              a.loader.update(a.loader.thread, null, 100 * (d / s));
              setTimeout(e.next, 1)
            })
          }
        })
      })
    };
  a.convert.htmlToCanvas = function(a) {
    var b = document.querySelector("#html-to-canvas");
    if (!b) return a.onerror();
    b.style.display = "block";
    b.innerHTML = a.html;
    html2canvas(b, {
      onerror: a.onerror,
      onrendered: function(c) {
        a.onload(c);
        b.style.display = "none"
      }
    })
  };
  a.convert.blobToText = function(a, b) {
    var c = new FileReader;
    c.onload = function(a) {
      b(a.target.result)
    };
    c.readAsText(a)
  };
  a.open.folder = function(b, c, e) {
    a.loader.thread = a.loader.thread || a.loader.add("reading files...");
    var f, k = new a.util.Queue({
      items: b,
      flatten: !0,
      oncomplete: function() {
        f ? a.open.json(f, c, e) : (a.loader.update(a.loader.thread, null, 100), c && c())
      },
      next: function(c, d, e) {
        k = this;
        a.loader.update(a.loader.thread, null, Math.max(0, (100 * ((e + 1) / b.length) >> 0) - 1));
        if (!c.name) return this.next();
        switch (c.name) {
          case "sketch.json":
            a.convert.blobToText(c, function(a) {
              f = a;
              k.next()
            });
            break;
          case "README.txt":
            this.next();
            break;
          default:
            var g = "#" + c.name.split(".").shift();
            "image/svg+xml" === c.type ? a.convert.blobToText(c, function(b) {
              a.assets.add({
                type: "clipart",
                data: b,
                onload: k.next,
                onerror: k.next,
                targetId: g
              })
            }) : (c = URL.createObjectURL(c), a.assets.add({
              type: "image",
              src: c,
              onload: k.next,
              onerror: k.next,
              targetId: g
            }))
        }
      }
    })
  };
  a.open.chooseEntry = function(b) {
    return a.supports.chooseEntry ? (chrome.fileSystem.chooseEntry({
      type: "openFile",
      accepts: [{
        extensions: a.util.uploader.formats
      }]
    }, function(a) {
      a && a.file(function(a) {
        b(a)
      })
    }), !0) : !1
  };
  a.open.clipart = a.open.image = function(b) {
    "string" === typeof b && (b = {
      src: b
    });
    var c = b.callback || b.onload,
      e = b.onprogress,
      f = b.onerror,
      k = function(e) {
        if (b.openAsNew) {
          a.exec("reset");
          var f = e.width;
          e = e.height;
          var l = a.area.padding / 2;
          a.project.setSize(f, e);
          a.scene.add({
            type: "image",
            src: b.src,
            width: f,
            height: e,
            x: f / 2 + l,
            y: e / 2 + l
          }, function() {
            a.exec("select");
            a.scene.deselectAll();
            a.orient.reset();
            a.orient.render();
            c && c()
          }, onerror)
        } else a.addMedia(b)
      };
    if (b.blob) a.assets.add(b.blob, function(a, b) {
      k(b)
    }, f, e);
    else if (-1 !== b.src.indexOf("filesystem:")) {
      var l = new Image;
      l.src = b.src;
      l.onprogress = e;
      l.onerror = f;
      l.onload = function() {
        var a = document.createElement("canvas"),
          b = a.getContext("2d");
        a.width =
          this.width;
        a.height = this.height;
        b.drawImage(this, 0, 0);
        k(a)
      }
    } else a.assets.addImage(b.src, function(a, b) {
      k(b)
    }, f, e)
  };
  a.open.fromQuery = function(b, c) {
    "string" === typeof b && (b = a.util.parseUri(b).queryKey);
    for (var e in b) "" === b[e] && (b[e] = !0);
    b.folder ? (a.io.json.folder = b.folder, a.io.json.open({
      src: b.folder + "sketch.json",
      onload: c
    })) : b.image ? a.open.image({
      src: b.image,
      openAsNew: !0,
      onload: c
    }) : b.json ? a.open.json({
      src: b.json,
      onload: c
    }) : a.feature.stream.sketch ? (e = a.server.getResource(), -1 === e.indexOf("/") && (e = "room/" +
      e), a.socketIO(e, c)) : a.feature.fileSystem ? a.fs.openFile({
      onload: function(b) {
        a.open.folder(b, c)
      },
      onerror: function(b) {
        b && 1 === b.code && a.lib.template && a.feature.canvas.openDefaultProject ? a.lib.template.open("tutorial-0", function() {
          c && c();
          a.fs.save()
        }) : c && c()
      }
    }) : a.server.open ? a.server.open(c) : c && c()
  };
  a.Save = function(a) {
    this.toDataURL = function(a, b) {
      "string" === typeof a && (a = {
        mime: a
      });
      a = a || {};
      return this.canvas(a).toDataURL(a.mime || "image/png", a.quality || 1)
    };
    this.blob = function(a, b) {
      "function" === typeof a ? (b =
        a, a = {}) : (a = a || {}, b = b || a.callback || f);
      this.canvas(a).toBlob(function(a) {
        b(a)
      }, a.mime || "image/png")
    };
    this.toBlobURL = function(a, b) {
      "function" === typeof a ? (b = a, a = {}) : (a = a || {}, b = b || a.callback || f);
      this.blob(a, function(a) {
        b(URL.createObjectURL(a))
      })
    };
    var c = function(b, c, d, f, g) {
      var p = document.createElement("canvas"),
        q = p.getContext("2d");
      p.width = d;
      p.height = f;
      g && ("none" !== g && a.feature.canvas.saveWithBackground) && (q.save(), q.fillStyle = g, q.translate(-Math.abs(b % d), -Math.abs(c % f)), q.fillRect(0, 0, 2 * d, 2 * f), q.restore());
      b = a.canvas2d.layers;
      for (var t in b) "cache" !== t && "active" !== t && q.drawImage(b[t], 0, 0);
      return p
    };
    this.canvas = function(b, f, k, l, g) {
      var p = a.canvas2d.pixelRatio,
        q = a.project.getBounds();
      a.project.getViewport();
      k = k || q.width * p;
      l = l || q.height * p;
      var t = "object" === typeof b ? b : {},
        s = g,
        w = t.callback,
        v = "function" === typeof f ? f : "";
      g = function(a) {
        s && s(a);
        w && w(a);
        v && v(a)
      };
      l = isFinite(t.height) ? t.height : l;
      k = isFinite(t.width) ? t.width : k;
      f = isFinite(t.y) ? t.y : isFinite(f) ? f : 0;
      b = isFinite(t.x) ? t.x : isFinite(b) ? b : 0;
      var p = t.highRes || !1,
        q = t.background || void 0,
        u = t.clampToLayer || !1,
        y = t.fromSelection || !1,
        t = y || t.getBoundingBox || !isFinite(b) || !isFinite(f) || !isFinite(k) || !isFinite(l);
      "undefined" === typeof q && "transparent" !== a.project.background && (q = a.configure.backgroundRaw);
      t && a.scene ? (l = a.scene.getBoundingBox({
        clampToLayer: u,
        fromSelection: y
      }), b = l.x >> 0, f = l.y >> 0, k = l.width >> 0, l = l.height >> 0) : (b -= a.project.scrollLeft, f -= a.project.scrollTop);
      k = Math.ceil(k);
      l = Math.ceil(l);
      u && (k = Math.min(k, a.canvas2d.width), l = Math.min(l, a.canvas2d.height), b =
        Math.max(b, 0), f = Math.max(f, 0));
      if (a.getSnapshot) return a.getSnapshot(g, k, l);
      if (a.scene) {
        var u = a.canvas2d.x,
          t = a.canvas2d.y,
          x = a.canvas2d.zoom,
          z = a.render.cache.enabled;
        a.canvas2d.x = -b - a.project.x;
        a.canvas2d.y = -f - a.project.y;
        a.canvas2d.zoom = 1;
        a.render.clipped = !1;
        a.render.selected = y && a.selection.items;
        a.render.cache.enabled = !p;
        a.render.forOutput = !0;
        a.setSize(k, l);
        a.render.output();
        b = c(b, f, k, l, q);
        a.canvas2d.x = u;
        a.canvas2d.y = t;
        a.canvas2d.zoom = x;
        a.render.clipped = !1;
        a.render.selected = !1;
        a.render.cache.enabled =
          z;
        a.setSize();
        a.render("root.save.canvas")
      } else b = c(b, f, k, l, q);
      g && g(b);
      return b
    };
    this.image = function(b, c) {
      b = b || {};
      c = c || b.callback || function(a) {
        console.log(a)
      };
      var d = function(d) {
          b.toDataURL ? c(d.toDataURL(p, b.quality || 1), b) : b.toBlob || b.toBlobURL || b.toDownload ? d.toBlob(function(d) {
            b.toDownload && a.download.blob(d, a.project.title + "." + g);
            b.toBlobURL ? c(URL.createObjectURL(d), b) : c(d, b)
          }, p) : c(d, b)
        },
        f = a.canvas2d,
        g = b.format || "png",
        p = "image/" + g;
      b.crop ? a.save.canvas({
        background: b.background,
        fromSelection: b.fromSelection ||
          !1,
        getBoundingBox: b.getBoundingBox || !1,
        clampToLayer: b.clampToLayer || !1,
        callback: function(c) {
          a.util.thumbnailer({
            src: c,
            width: b.width || f.width,
            height: b.height || f.height,
            center: b.center,
            croparea: b.croparea,
            crop: b.crop,
            onload: d
          })
        }
      }) : a.save.canvas({
        x: b.x || 0,
        y: b.y || 0,
        fromSelection: b.fromSelection || !1,
        getBoundingBox: b.getBoundingBox || !1,
        clampToLayer: b.clampToLayer || !1,
        width: b.width || f.width,
        height: b.height || f.height,
        background: b.background,
        callback: d
      })
    };
    a.io && a.io.json ? (this.json = a.io.json.save, this.assets =
      a.io.json.assets) : this.json = this.assets = function() {
      console.log("Missing IO.JSON support.")
    };
    this.svg = a.io && a.io.svg ? a.io.svg.save : function() {
      console.log("Missing IO.SVG support.")
    };
    this.sketch = this.zip = function(b, c) {
      b = b || f;
      this.folder(function(d) {
        a.io.zip.encode(d, function(a) {
          b(a)
        }, c)
      })
    };
    this.folder = function(c) {
      c = c || f;
      a.save.json(function(a, d) {
        var f = [],
          h;
        for (h in d) {
          var g = b[d[h].type];
          f.push({
            filename: h.substr(1) + "." + g,
            blob: d[h]
          })
        }
        f.push({
          filename: "sketch.json",
          blob: new Blob([a], {
            type: "text/plain"
          })
        });
        f.push({
          filename: "README.txt",
          blob: new Blob(["\tWelcome to Sketchpad!\n\n\tThe contents of your drawing are kept in this .ZIP file.\n\n\tTo reload your image just drag the .ZIP back into Sketchpad!\n\n\t... but it seems you're here to explore, so here's a rundown:\n\n\tThe .JSON file inside has all your drawing commands, styles,\n\ttransforms, and other things that make up your drawing.\n\n\tThe other files included are other media resources which you\n\tmay of uploaded, or which you've taken with your webcam.\n\n\tWe hope you enjoy Sketchpad =)\n\n\tSketch.IO <hello@sketch.io>\n\thttps://sketch.io/\n\t\t\t\t"], {
            type: "text/plain"
          })
        });
        c(f)
      })
    };
    this.syncData = function(b) {
      b = b || {};
      var c = b.onprogress,
        d = b.onload || f;
      b = b.sync || a.feature.sync;
      var l = 0,
        g;
      for (g in b) b[g] && (!0 === b[g] && (b[g] = {}), l++);
      var p = l,
        q = function() {
          c && c(100 * ((p - (l - 1)) / p));
          --l || d && d(s)
        },
        t, s = {};
      for (g in b)
        if (t = b[g]) switch (g) {
          case "folder":
            a.save.folder(function(a) {
              s.folder = a;
              q()
            }, !0);
            break;
          case "zip":
            a.save.zip(function(a) {
              s.sketch = a;
              q()
            });
            break;
          case "svg":
            a.save.svg(function(a, b) {
              s.svg = b;
              q()
            });
            break;
          case "json":
            a.save.json(function(a) {
              s.json = a;
              q()
            }, !0);
            break;
          case "thumb":
            t.suffix = t.suffix || "thumb";
          case "image":
            var w = t.format || "png";
            t.idx = t.suffix ? t.suffix + "." + w : w;
            t.toBlob || (t.toDataURL = !0);
            a.save.image(t, function(a, b) {
              s[b.idx] = a;
              q()
            });
            break;
          default:
            q()
        }
    };
    this.fromQuery = function(b, c) {
      a.feature.fileSystem ? a.fs.save(c) : a.server.save(c)
    };
    return this
  };
  a.print = function(b) {
    a.save.canvas({
      callback: function(a) {
        var c = document.querySelector("#print");
        c || (c = document.createElement("div"), c.id = "print", document.body.appendChild(c));
        c.innerHTML = "";
        c.appendChild(a);
        b || window.print()
      }
    })
  };
  var f = function(a, b) {
      console.log("callback", a, b)
    },
    b = {
      "image/png": "png",
      "image/gif": "gif",
      "image/jpeg": "jpeg",
      "image/svg+xml": "svg"
    }
})(sketch);
"undefined" !== typeof module && module.exports && (module.exports = sketch.Save);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.lib && (sketch.lib = {});
(function(a) {
  (function() {
    for (var g = "template stamp text clipart image color gradient texture".split(" "), c = 0; c < g.length; c++) {
      var f = g[c];
      (a.lib[f] = a.lib[f] || {}).meta = {}
    }
  })();
  a.lib.setData = function(g, c) {
    if (c.data || c.official) {
      var f = a.lib[g],
        b = {};
      c.reset && (f.tree = c.data ? {} : f.defaultTree || {});
      new a.util.Queue({
        items: c,
        flatten: !0,
        oncomplete: function() {
          for (var c in f.tree) b[c] || (b[c] = f.tree[c]);
          f.tree = b;
          a.lib.init(g);
          a.ui.buildConfigure(null, !0)
        },
        next: function(c, d, e) {
          if ("reset" === d) return this.next();
          if ("defaultValue" ===
            d) return f.defaultItem = c, this.next();
          e = c;
          e.data && (e = e.data);
          for (var g = 0; g < e.length; g++) {
            var k = e[g];
            "string" === typeof k && (k = {
              filepath: k,
              name: STRING.basename(k),
              category: c.category || "Unknown"
            });
            "undefined" === typeof k.name && (k.name = STRING.basename(k.filepath));
            if ("undefined" === typeof k.id) {
              var l = (new Date).getTime();
              k.id = k.name.replace(this.rxAlphaNumeric, "") + l
            }
            l = k.category || c.category || "Unknown";
            (b[l] || (b[l] = [])).push(k)
          }
          e = a.scene.copyRules(c, {});
          f.meta[c.category || d] = e;
          this.next()
        }
      })
    }
  };
  a.lib.setClipartDefaultValue =
    function(g) {
      var c = a.lib.clipart;
      if (g = g || c.defaultItem) g = 0 === g.indexOf("./") ? g : c.path + "/" + g, delete a.toolkit.media.style.render, a.toolkit.media.style.src = g, a.configure.tools.clipart.src = g
    };
  a.lib.setClipartData = function(g) {
    g && (a.lib.setData("clipart", g), a.lib.setClipartDefaultValue(g.defaultValue))
  };
  a.lib.setStampDefaultValue = function(g) {
    var c = a.lib.clipart;
    g = g || c.defaultItem;
    a.configure.tools.stamp.src = g
  };
  a.lib.setStampData = function(g) {
    g && (a.lib.setData("stamp", g), a.lib.setStampDefaultValue(g.defaultValue))
  };
  a.lib.setTextData = function(g) {
    g && (a.lib.setData("text", g), g.defaultValue && (a.configure.tools.text.fontFamily = g.defaultValue))
  };
  a.lib.setPaletteData = function(g) {
    var c = function(c) {
      var b = g[c];
      if (b) {
        var h = b.official,
          d = b.data;
        !1 === b.enabled ? (a.feature.palette[c] = !1, dom.setCSS("." + c + "-indicator", "display", "none")) : (a.feature.palette[c] = !0, dom.setCSS("." + c + "-indicator", "display", ""));
        if (h || d) {
          if (h) {
            for (var e = [], m = 0; m < h.length; m++) e.push({
              dna: h[m],
              status: "official"
            });
            h = e.concat(d)
          } else h = d;
          !0 !== b.reset &&
            (h = h.concat(a.style[c]));
          if (!h.length) return;
          a.style.reset(c);
          a.style.add(h, c)
        }
        b.defaultValue && (a.style.fill[c] = b.defaultValue)
      }
    };
    c("color");
    c("gradient");
    c("pattern");
    a.palette.rebuild()
  };
  a.lib.init = function(g) {
    var c = a.lib[g],
      f = a.loc.MEDIA + c.dir;
    c.meta = c.meta || {};
    c.path = f;
    c.type = g;
    c.defaultTree = c.defaultTree || a.util.clone(c.tree);
    c.mediaDir = f.substr(0, f.lastIndexOf("/"));
    c.byId = {};
    c.byName = {};
    c.byPath = {};
    c.paths = [];
    c.getEntry = function(b) {
      var e = c.byPath[b];
      if (e) return e;
      b = a.assets.getItem(b);
      return c.byPath[b.src]
    };
    var f = function(a, b) {
        for (var f = c.tree[b], h = 0; h < f.length; h++) {
          var l = f[h],
            r = l.filepath || "";
          l.type = g;
          l.filename = STRING.basename(r);
          0 === r.indexOf(".") ? (l.thumbnail = r.replace("/media/", "/media/thumb/").replace(".svg", ".png"), l.filepath = r) : "text" === g ? (l.thumbnail = c.mediaDir + "/thumb/font/" + l.name + ".png", l.filepath = r) : (l.thumbnail = c.mediaDir + "/thumb/" + g + "/" + r.replace(".svg", ".png"), l.filepath = c.path + "/" + r);
          l.folder = b;
          l.id && (c.byId[l.id] = l);
          c.byName[l.name] = l;
          c.byPath[l.filepath] = l;
          c.paths.push(l)
        }
      },
      b = function(a,
        b, f) {
        switch (f) {
          default: return c.tree[b].sort(function(a, b) {
            return a.name.localeCompare(b.name)
          })
        }
      },
      h;
    for (h in c.tree) b(g, h), f(g, h)
  };
  a.lib.setTemplateData = function(g) {
    g && a.lib.setData("template", a.util.clone(g))
  };
  a.lib.template.open = function(g, c, f) {
    g = g || a.lib.template.defaultItem;
    f = "boolean" === typeof f ? f : !0;
    var b = a.lib.template.byId[g] || a.lib.template.byName[g];
    if (!b) return console.log("missing template");
    f && a.reset();
    var h = 1,
      d = function() {
        b.alert && (a.feature.alert = b.alert);
        var d = 0;
        if (b.clip) {
          var f =
            new a.vector.BBox(e.path),
            l = f.x2 - f.x1,
            f = f.y2 - f.y1,
            g = a.util.getMetrics(a.$(".icon-powernib")),
            d = g.height - (g.padding[1] + g.padding[3]) / 2,
            g = a.project.getViewport();
          h = Math.min(g.width / l, (g.height - d) / f) - 0.05;
          a.setClip(b.clip, h)
        }
        a.project.setSize(l * h, f * h);
        b.background && a.setBackground(b.background);
        var p = a.tool.type,
          l = a.util.clone(b.data);
        a.scene.add({
          data: l,
          scale: h,
          onload: function() {
            a.toolkit.setTool(p);
            a.scene.deselectAll();
            a.orient.reset().render();
            a.orient.setPan(0, d / 2);
            a.lib.setClipartDefaultValue();
            c && c(h)
          }
        })
      };
    if (b.clip) {
      var e = b.clip;
      "string" === typeof e.path ? (e.path = a.vector.SVGPath.toVOBPath(path), d()) : "string" === typeof e.src ? new a.vector.SVG({
        src: e.src,
        onload: function(a) {
          e.path = a.vob.childNodes[0].data;
          d()
        }
      }) : e.path && d()
    } else d()
  };
  a.setClip = function(g, c) {
    g.path ? a.setClipPath(g, c) : a.setClipRect(g, c)
  };
  a.setClipRect = function(g, c) {
    a.project.clip = g
  };
  a.setClipPath = function(g, c) {
    var f = new a.vector.Transform;
    f.scale(c, c);
    f.flatten(g.path);
    a.project.clip = {};
    a.project.clip.path = g.path;
    a.project.clip.style =
      g.style
  }
})(sketch);
(function(a) {
  var g = String.fromCharCode(65279);
  a.toolkit.register("text", function(c) {
    var f = this;
    f.container = document.createElement("div");
    f.container.className = "sk-textarea-wrap";
    c.defaultWidth = c.defaultWidth || 300;
    c.defaultHeight = c.defaultHeight || 100;
    c.minWidth = c.minWidth || 15;
    c.minHeight = c.minHeight || 15;
    this.id = "text";
    this.ctx = c.layer0.ctx;
    this.active = c.active.ctx;
    this.cache = c.cache.ctx;
    this.enable = function() {
      var b = a.toolkit.select;
      a.tool !== b && b && b.enable({
        cursor: !0,
        search: this.type
      })
    };
    this.disable =
      function() {
        var b = a.toolkit.select;
        a.tool !== b && b && b.disable({
          cursor: !0
        })
      };
    this.loadResource = function(b) {
      var c = b.action,
        h = b.onload;
      c.dirty = !0;
      c.render = function(b, c, d) {
        a.__editing && this.id === a.selection.id || (b = {
          ctx: b,
          opacity: this.opacity,
          composite: this.composite,
          fill: this.fill,
          blur: this.blur,
          content: this.content,
          textMetrics: this.__textMetrics,
          useHighRes: this.useHighRes,
          applyMatrix: d
        }, f.copyParams(b, this), b.bbox = a.util.clone(this.bbox), b.bbox.x = 0, b.bbox.y = 0, b.bbox.rotate = 0, this.__textMetrics = a.vector.text.drawLineBreaks(b))
      };
      b = c.fontFamily;
      var k = c.bbox;
      k.owidth || (k.owidth = k.width);
      k.oheight || (k.oheight = k.height);
      f.loadFont({
        fontFamily: b,
        onload: function() {
          h && h(c)
        },
        onerror: function(a) {
          h && h(c, a)
        }
      })
    };
    this.loadFont = function(b) {
      var c = b.onload,
        f = b.onerror,
        h = b.fontFamily;
      b = function(a) {
        a ? (a = "&ldquo;" + h + "&rdquo; font-family unavailable.", f && f(a)) : c && c()
      };
      if (a.vector.text.detectFont(h)) c && c();
      else if (a.lib.text.byName[h]) {
        var l = a.util.clone(a.lib.text.byName[h]);
        l.useLoader = !0;
        a.vector.text.attach(l, b)
      } else a.vector.text.attachFromGoogleAPI(h,
        b)
    };
    this.changeColor = function(a) {
      f.style.fillStyle = a
    };
    var b = function(b, c) {
      if (c = c || a.scene.data[a.selection.idx]) c.dirtyControl = !0, a.render.dirtyControls = !0, a.render("root.toolkit.text." + b)
    };
    this.keydown = function(c) {
      c = c.keyCode;
      if (eventjs.metaKey) {
        var e = a.scene.data[a.selection.idx];
        86 === c || 88 === c || 90 === c ? setTimeout(function() {
          f.updateObjectSize();
          b("keydown")
        }, 25) : e && (85 === c ? h(e, "textDecoration", "underline", "none") : 73 === c ? h(e, "fontStyle", "italic", "normal") : 66 === c && h(e, "fontWeight", "bold", "normal"))
      }
    };
    var h = function(a, b, c, f) {
      a[b] = a[b] === f ? c : f
    };
    this.keyup = function(c) {
      if (27 === c.keyCode) a.scene.deselectAll(), b("keyup.1");
      else if (eventjs.metaKey && (88 === c.keyCode || 86 === c.keyCode)) f.updateObjectSize(), b("keyup.2");
      else if (8 === c.keyCode) {
        c = f.textarea;
        var e = f.cleanText(f.textarea.innerHTML),
          h = a.vector.text.getRange();
        if (h) {
          var k = e.substr(0, h.startOffset),
            e = e.substr(h.endOffset);
          f.textarea.innerHTML = a.vector.text.entities(k + e);
          (k = k.length) && a.vector.text.setRange(c, k, k);
          f.updateObjectSize();
          b("keyup.3")
        }
      }
    };
    this.keypress = function(c) {
      var e = a.scene.data[a.selection.idx];
      if ("undefined" !== typeof e && 0 !== c.which && 8 !== c.keyCode && !eventjs.metaKey) {
        eventjs.prevent(c);
        var h = f.textarea,
          k = f.cleanText(f.textarea.innerHTML);
        c = f.cleanText(String.fromCharCode(c.charCode || c.keyCode));
        if ("pre-nowrap" !== e.whiteSpace || 10 !== c.charCodeAt()) {
          var l = a.vector.text.getRange(f.textarea);
          if (l) {
            var g = k.substr(0, l.startOffset),
              k = k.substr(l.endOffset),
              k = f.cleanText(g + c + k);
            f.textarea.innerHTML = a.vector.text.entities(k);
            (k = (g + c).length) &&
            a.vector.text.setRange(h, k, k);
            f.updateObjectSize();
            b("keypress", e)
          }
        }
      }
    };
    this.record = function(d, e, h) {
      if ("eyeDropper" !== a.colorPicker.state) {
        var k = f.style;
        if ("undefined" === typeof k.render) e.pause(), f.loadResource({
          action: f.style,
          onload: function() {
            e.resume();
            f.record(d, e)
          }
        });
        else {
          var l = !!e.action;
          !0 === l ? "undefined" === typeof f.textarea && f.createTextarea() : "down" === e.state && (a.area.show(f.style), f.updateCSSTransform());
          var r = a.canvas2d,
            p = r.zoom * r.pixelRatio,
            q = r.zoom,
            t = (q - 1) / q,
            s = a.project.scrollLeft * t,
            w =
            a.project.scrollTop * t,
            t = e.start.x / q + s,
            v = e.start.y / q + w;
          e.y = e.y / q + w;
          e.x = e.x / q + s;
          q = k.bbox;
          q.x = Math.min(t, e.x) - 1 * r.x / p;
          q.y = Math.min(v, e.y) - 1 * r.y / p;
          q.width = Math.abs(t - e.x) || 1;
          q.height = Math.abs(v - e.y) || 1;
          q.units = "objectBoundingBox";
          if ("down" === e.state) h = e.action || {}, r = a.scene.fromConfigure(a.configure.tools.text), q = {
            type: "text",
            fill: a.util.clone(r.fill),
            opacity: r.opacity || 100,
            composite: r.composite,
            blur: h.blur || r.blur || 0,
            render: f.style.render,
            content: h.content || "",
            bbox: a.util.clone(q)
          }, f.copyParams(q, h,
            r), e.action && a.scene.copyRules(e.action, q), k = a.scene.addObject(q, k, e.action ? !1 : !0), f.textarea.innerHTML = k.content || g, !1 === l && (a.active.canvas.width = a.active.canvas.width, a.scene.updateBBox(), a.scene.updateConstrain(k), a.scene.updateTransform(k), a.render.action(a.active, k), a.area.renderControls(a.selection.idx));
          else if (k = a.scene.data[a.selection.idx]) {
            f.dragging = !0;
            r = k.bbox;
            r.x = q.x;
            r.y = q.y;
            r.width = q.width;
            r.height = q.height;
            k.dirty = !0;
            k.dirtyTransform = !0;
            p = a.toolkit.getDimensionConstraint(k, null, !1);
            r.x = q.x - (e.x < e.start.x ? p.width - r.width : 0);
            r.y = q.y - (e.y < e.start.y ? p.height - r.height : 0);
            r.width = r.owidth = p.width;
            r.height = r.oheight = p.height;
            r.viewBox = [0, 0, r.width, r.height];
            e.action && e.action.bbox && a.util.mergeObject(e.action.bbox, k.bbox);
            if ("up" === e.state) {
              f.dragging = !1;
              if (q.width < c.minWidth || q.height < c.minHeight)
                if (a.feature.placement.click || a.feature.tools.text.clickToPlace) q = a.project.bounds.width / 3 / a.canvas2d.zoom, p = 2 * a.tool.style.fontSize / a.canvas2d.zoom, k.fontSize /= a.canvas2d.zoom, q = r.width =
                  Math.max(c.defaultWidth, q), p = r.height = Math.max(c.defaultHeight, p), r.viewBox = [0, 0, q, p];
                else {
                  l = a.selection.id;
                  a.scene.deselectAll();
                  a.scene.removeById(l);
                  b("record", k);
                  return
                }!1 === l && (a.area.inGenesis = !0, f.focus());
              r.owidth = r.width;
              r.oheight = r.height;
              f.updateObjectSize()
            }
            a.scene.updateBBox();
            a.scene.updateConstrain(k);
            a.scene.updateTransform(k);
            !1 === l && b("sk.text.record");
            "up" === e.state && h && h()
          }
        }
      }
    };
    this.focus = function() {
      setTimeout(function() {
        a.util.exists("cordova.plugins.SoftKeyboard.show") ? cordova.plugins.SoftKeyboard.show(function() {},
          function() {}) : f.textarea.focus()
      }, 50)
    };
    this.selectAll = function(b) {
      b = b || f.textarea;
      a.vector.text.range.selectAll(b.firstChild)
    };
    this.updateBBox = function() {
      var c = a.scene.data[a.selection.idx];
      "undefined" !== typeof c && (f.textarea || f.createTextarea(), c.content && (f.textarea.innerHTML = f.cleanText(c.content)), f.updateCSSTransform(c), b("updateBBox", c))
    };
    this.updateObjectSize = function(b) {
      var c = b ? a.__editing && b.id === a.scene.data[a.selection.idx] ? f.cleanText(f.textarea.innerHTML) : b.content : f.cleanText(f.textarea.innerHTML);
      b = b || a.scene.data[a.selection.idx];
      if ("undefined" !== typeof b) {
        var h = a.vector.text.getFontStyle(b),
          c = c ? a.vector.text.format(c, b) : " ",
          k = (2 * (b.blur || 0) + (b.diameter || 0) + (b.lineWidth || 0)) * (b.scale ? b.scale.max : 1);
        if ("pre-nowrap" === b.whiteSpace) {
          var l = b.bbox.owidth,
            h = 1.1 * a.vector.text.measureTextWidth(c, h);
          b.bbox.viewBox[2] = b.bbox.owidth = b.bbox.width = h;
          b.bbox.x += (l - h) / 2;
          b.dirty = !0
        }
        l = a.vector.text.drawLineBreaks(f.copyParams({
          fillStyle: b.fillStyle,
          lineHeight: b.lineHeight,
          letterSpacing: b.letterSpacing,
          blur: b.blur ||
            0,
          content: c,
          bbox: b.bbox
        }, b));
        a.feature.useCanvasTextRender && b.content !== c && (b.dirty = !0);
        b.content = c;
        b.__textMetrics = l;
        c = b.bbox.owidth + k / 2;
        k = l.height + k / 2;
        b.bbox.height !== k && (b.dirty = !0, b.dirtyControl = !0, b.bbox.height < k && a.area.inGenesis || !a.area.inGenesis) && (b.bbox.width = c, b.bbox.height = k, b.bbox.viewBox = [0, 0, c, k], f.container.style.height = k + "px");
        f.updateCSS(b)
      }
    };
    this.cleanText = function(a) {
      return a.split("&nbsp;").join(" ").split("<br>").join("\n").split("<div>").join("\n").split("\r").join("\n").replace(/&lt;/g,
        "<").replace(/&gt;/g, ">").replace(/&quot;/g, '"').replace(/&amp;/g, "&").split(String.fromCharCode(160)).join(String.fromCharCode(32)).replace(/(<([a-z/]+)>)/ig, "")
    };
    this.createTextarea = function() {
      if (f.textarea) {
        var b = f.textarea.style.cssText,
          c = f.textarea.innerHTML;
        f.textarea.parentNode.removeChild(f.textarea);
        f.styleCode.parentNode.removeChild(f.styleCode)
      } else a.addTooltip(f.container, ""), c = b = "";
      if (a.toolkit.text) return f.styleCode = document.createElement("style"), f.styleCode.type = "text/css", f.container.appendChild(f.styleCode),
        f.textarea = document.createElement("div"), f.textarea.className = "textarea", f.textarea.setAttribute("contentEditable", "true"), f.textarea.style.cssText = b + ";" + a.vector.text.CSSWhiteSpace.preWrap, f.textarea.innerHTML = c, f.container.appendChild(f.textarea), eventjs.add(f.textarea, "drag", eventjs.stop), eventjs.add(f.textarea, "keydown", f.keydown), eventjs.add(f.textarea, "keypress", f.keypress), eventjs.add(f.textarea, "keyup", f.keyup), f.textarea
    };
    this.updateCSS = function(a) {
      f.updateCSSStyle(a);
      f.updateCSSTransform(a)
    };
    this.updateCSSTransform = function(b) {
      if ("undefined" === typeof b && (b = a.scene.data[a.selection.idx], "undefined" === typeof b)) return;
      if ("undefined" === typeof b.bbox) return console.log("meh");
      if (b.id > a.util.INFINITY_MINUS_8bit || a.selection.items[b.zIndex]) {
        var c = a.canvas2d,
          h = c.pixelRatio,
          k = c.zoom,
          l = a.project.scrollLeft * (k - 1),
          g = a.project.scrollTop * (k - 1),
          p = b.bbox,
          q = a.area.padding / 2,
          t = b.blur || 0,
          s = isFinite(b.opacity) ? b.opacity : 100,
          w = a.render.cache.padding / 2,
          v = p.width,
          u = p.height,
          y = p.rotate,
          x = p.scale.x,
          z = p.scale.y;
        if ("objectBoundingBox" === p.units) var A = "50% 50%",
          B = (v - v * x) / 2,
          D = (u - u * z) / 2;
        else A = "0 0", D = B = 0;
        B = p.x - q - (B - q);
        p = p.y - q - (D - q);
        v = Math.max(0, v - t) * k;
        w = Math.max(0, u - w - t + 5) * k;
        l = B * k + c.x / h - l;
        c = p * k + c.y / h - g;
        s /= 100;
        h = f.container.style;
        h.padding = t / 2 + "px";
        h.left = l + "px";
        h.top = c + "px";
        h.width = Math.min(v, window.innerWidth - l) + "px";
        h.height = Math.min(w, window.innerHeight - c) + "px";
        h.opacity = s;
        a.vector.text.setFontStyle(b, f.container);
        h.transform = h.msTransform = h.OTransform = h.MozTransform = h.WebkitTransform = "rotate(" + y + "deg) scale(" +
          x + "," + z + ")";
        h.transformOrigin = h.msTransformOrigin = h.OTransformOrigin = h.MozTransformOrigin = h.WebkitTransformOrigin = A
      }
    };
    this.updateCSSStyle = function() {
      var b = a.scene.data[a.selection.idx];
      if ("undefined" !== typeof b && "undefined" !== typeof b.fill) {
        var c = f.textarea || f.createTextarea(),
          h = b.fill.type,
          k = "webkitFilter" in c.style,
          l = "textShadow" in c.style;
        if ("webkitBackgroundClip" in c.style && k) {
          switch (h) {
            case "color":
              var g = "background: " + b.fill.color;
              break;
            case "gradient":
              g = a.style.getGradientCSS(b.fill.gradient,
                "left");
              break;
            case "pattern":
              g = "background: url(" + b.fill.pattern + ")"
          }
          f.styleCode.innerHTML = "\t\t\t\tdiv.sk-textarea-wrap div.textarea { " + g + " }\t\t\t";
          c.setAttribute("data-content", c.innerHTML);
          c.style.textShadow = "none";
          c.style.backgroundClip = "text";
          c.style.webkitBackgroundClip = "text";
          c.style.textFillColor = "transparent";
          c.style.webkitTextFillColor = "transparent";
          c.style.filter = "blur(" + b.blur / 3 + "px)";
          c.style.webkitFilter = "blur(" + b.blur / 3 + "px)";
          b = a.style.getBlendMode();
          c.style.backgroundBlendMode = b;
          c.style.webkitBackgroundBlendMode = b
        } else {
          switch (h) {
            case "color":
              g = b.fill.color;
              break;
            case "gradient":
            case "pattern":
              g = "#000"
          }
          l ? (c.style.color = g, c.style.textShadow = "none") : c.style.color = g
        }
      }
    };
    this.style = {
      blur: 0,
      bbox: {
        x: 200,
        y: 18,
        width: 400,
        height: 470,
        rotate: 0,
        scale: {
          x: 1,
          y: 1
        }
      }
    };
    this.copyParams = function(a, b, c) {
      b = b || {};
      c = c || {};
      a.fontStyle = b.fontStyle || c.fontStyle || "normal";
      a.fontVariant = b.fontVariant || c.fontVariant || "normal";
      a.fontWeight = b.fontWeight || c.fontWeight || "bold";
      a.fontSize = b.fontSize || c.fontSize ||
        41;
      a.fontFamily = b.fontFamily || c.fontFamily || "Arial";
      a.letterSpacing = b.letterSpacing || c.letterSpacing || 0;
      a.lineHeight = b.lineHeight || c.lineHeight || 1;
      a.textAlign = b.textAlign || c.textAlign || "center";
      a.textDecoration = b.textDecoration || c.textDecoration || "none";
      a.textTransform = b.textTransform || c.textTransform || "none";
      a.whiteSpace = b.whiteSpace || c.whiteSpace || "normal";
      return a
    };
    this.copyParams(this.style);
    this.createTextarea();
    this.textarea && this.container.appendChild(this.textarea);
    a.canvas2d.container.appendChild(this.container);
    return a.toolkit.init(this)
  })
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
"undefined" === typeof sketch.vector.text && (sketch.vector.text = {});
(function(a) {
  function g() {
    a.container || e();
    var b = document.createElement("span");
    b.style.cssText = a.CSSWhiteSpace.preWrap;
    b.className = "lineBreakData";
    a.container.appendChild(b);
    a.elementContent = b
  }

  function c(b) {
    var c = a.elementContent;
    c.style.display = "block";
    c.style.width = b.width + "px";
    c.style.font = b.font;
    c.style.letterSpacing = (b.letterSpacing || 0) + "px";
    c.style.textAlign = b.textAlign || "left";
    c.style.textDecoration = b.textDecoration || "none";
    c.style.textTransform = b.textTransform || "none";
    c.innerHTML = a.entities(b.content);
    b = c.firstChild || c;
    var d = document.createRange();
    d.setStart(b, 0);
    d.setEnd(b, 0);
    var e = 1,
      f = b.textContent,
      h = f.length,
      l = [],
      k = 0,
      g = d.getClientRects();
    if (0 === g.length) return {
      data: l,
      lines: l.length,
      height: 1,
      width: 1
    };
    for (var m = g[g.length - 1].top, p = a.spaceOffset, q = a.mOffset, r = c.offsetHeight, t = c.offsetWidth, H = [], J = [], I = function(b) {
        0 === a.tOffset && (b = b.trim());
        l.push(b);
        J.push({
          data: H,
          width: P.width
        });
        H = []
      }; f;) {
      if (e > h) {
        I(f);
        break
      }
      d.setStart(b, k);
      d.setEnd(b, e);
      e++;
      var g = d.getClientRects(),
        L = g[g.length - 1],
        O = m !== L.top,
        P = O ? g[g.length - 2] : L,
        g = e - 1 - k - p + q,
        g = f.substr(0, g).substr(-1),
        N = g.charCodeAt();
      g && 65279 !== N && H.push({
        character: g,
        width: P.width,
        height: P.height,
        left: P.left,
        top: P.top
      });
      O && (e--, g = e - k - p + q, I(f.substr(0, g)), f = f.substr(g), k = e - p + q, m = L.top)
    }
    f && 10 === f[f.length - 1].charCodeAt() && I("");
    c.style.display = "none";
    return {
      data: l,
      lineMetrics: J,
      lines: l.length,
      height: r,
      width: t
    }
  }

  function f(b) {
    var c = a.elementContent;
    c.style.display = "block";
    c.style.width = b.width + "px";
    c.style.font = b.font;
    c.style.letterSpacing = (b.letterSpacing ||
      0) + "px";
    c.style.textAlign = b.textAlign || "left";
    c.style.textDecoration = b.textDecoration || "none";
    c.style.textTransform = b.textTransform || "none";
    c.innerHTML = b.content;
    b = document.body.createTextRange();
    for (var d = 1, e = target.innerText, f = e.length, h = [], l = 0, g = c.offsetHeight, k = c.offsetWidth; e;) {
      if (d > f) {
        h.push(e);
        break
      }
      b.moveToElementText(target);
      b.collapse(!0);
      b.moveEnd("character", d);
      b.moveStart("character", l);
      b.select();
      d++;
      1 < b.getClientRects().length && (d--, h.push(e.substr(0, d - l - 1)), e = e.substr(d - l - 1), l = d - 1)
    }
    c.style.display =
      "none";
    return {
      data: h,
      lines: h.length,
      height: g,
      width: k
    }
  }

  function b(b) {
    function c(d) {
      f.push(d);
      d = a.measureText(d, b.font);
      p += d.height;
      m = Math.max(d.width, m)
    }

    function d() {
      if (!(a.measureTextWidth(h, b.font) <= b.width)) {
        for (var e = h.length, f = 0, l = 0, g = 0; g < e; g++) {
          var m = h.substr(f, ++l).replace(r, "");
          a.measureTextWidth(m, b.font) > b.width && (m = m.substr(0, m.length - 1).replace(r, ""), m.match(k) ? (f = m.split(k), m = m[f[0].length], g -= f[1].length, c(f[0] + m)) : m.match(" ") ? (f = m.split(" "), g -= f.pop().length, c(f.join(" "))) : c(m), f =
            g, l = 1)
        }
        return h.substr(f, l + 1)
      }
    }
    for (var e = b.content.split("\n"), f = [], h = "", g, m = 0, p = 0, q = 0; q <= e.length; q++) {
      if (h) {
        c(h);
        if (q === e.length) break;
        h = ""
      }
      for (var t = e[q], F = t.split(l), C = 0, E = 0; E < F.length + 2; E++) {
        var H = 0 > C - 1 ? "" : t.substr(C - 1, 1),
          J = F[E] || "";
        if (a.measureTextWidth(h + H + J, b.font) <= b.width) h += H + J;
        else if (g = d()) h = g + H + J;
        else {
          g = H.match(k) ? H : "";
          if (h || H) a.measureTextWidth(h + g, b.font) > b.width ? "\u2013" === g ? J = h + g + J : (c(h), J = g + J) : c(h + g);
          h = J
        }
        C += J.length + 1
      }
    }
    return {
      data: f,
      lines: f.length,
      height: p,
      width: m
    }
  }
  a.entities = function(a) {
    return a.split(String.fromCharCode(160)).join(String.fromCharCode(32)).replace(/&/g,
      "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;")
  };
  a.format = function(a, b) {
    if (b.textTransform) switch (b.textTransform) {
      case "uppercase":
        a = a.toUpperCase();
        break;
      case "lowercase":
        a = a.toLowerCase();
        break;
      case "capitalize":
        a = a.replace(/^(.)|\s(.)/g, function(a) {
          return a.toUpperCase()
        })
    }
    if (b.whiteSpace) switch (b.whiteSpace) {
      case "normal":
      case "pre":
      case "pre-wrap":
        a = a.split(" ").join(String.fromCharCode(160));
        break;
      case "pre-nowrap":
        a = a.split("\n").join(" ").split(" ").join(String.fromCharCode(160));
        break;
      case "pre-line":
      case "nowrap":
        a = a.replace(/\s{2,}/g, " ")
    }
    return a
  };
  a.textTransform = function(a, b) {
    switch (b) {
      case "uppercase":
        return a.toUpperCase();
      case "lowercase":
        return a.toLowerCase();
      case "capitalize":
        return a.replace(/^(.)|\s(.)/g, function(a) {
          return a.toUpperCase()
        });
      default:
        return a
    }
  };
  a.getMetrics = function(b, c) {
    var d = "ltr";
    window.getComputedStyle && (d = window.getComputedStyle(document.body, "").direction);
    var f = a.measureTextHeight(b, c),
      h = a.measureTextWidth(b, c);
    return e({
      marginReset: !0,
      text: b,
      callback: function(b) {
        b.style.cssText = "font: " + c + "; white-space: nowrap; display: block;";
        var e = a.image,
          l = e.offsetTop + 1,
          g = l - f;
        b.style.cssText = "font: " + c + "; white-space: nowrap; line-height: 0; display: block;";
        var k = e.offsetTop + 1;
        b.style.verticalAlign = "sub";
        var m = l - (e.offsetTop - f);
        b.style.verticalAlign = "super";
        return {
          font: c,
          direction: d,
          ascent: l,
          descent: -g,
          height: f,
          width: h,
          textBaseline: {
            alphabetic: 0,
            top: l,
            hanging: 8 * l / 10,
            middle: k,
            ideographic: g,
            bottom: g,
            subScript: m,
            superScript: l - (e.offsetTop - f)
          },
          textAlign: {
            left: 0,
            start: -("ltr" === d) ? 0 : h,
            end: -("ltr" === d) ? h : 0,
            right: -h,
            center: -h / 2
          }
        }
      }
    })
  };
  a.measureText = function(b, c) {
    return {
      width: a.measureTextWidth(b, c),
      height: a.measureTextHeight(b, c)
    }
  };
  a.measureTextWidth = function(a, b) {
    return e({
      text: a + a + a,
      callback: function(a) {
        a.style.cssText = "font: " + b + "; white-space: nowrap; display: inline;";
        return a.offsetWidth / 3
      }
    })
  };
  a.measureTextHeight = function(a, b) {
    return e({
      text: "1<br>2<br>3<br>4<br>5<br>6<br>7",
      callback: function(a) {
        a.style.cssText = "font: " + b + "; white-space: nowrap; display: inline;";
        return a.offsetHeight / 7 + 0.5 >> 0
      }
    })
  };
  a.textAlign = function(b, c) {
    var d = window.getComputedStyle(document.body, "").direction,
      f = a.measureTextWidth(b, c);
    return e({
      text: b,
      callback: function(a) {
        return {
          left: 0,
          start: -("ltr" === d) ? 0 : f,
          end: -("ltr" === d) ? f : 0,
          right: -f,
          center: -f / 2
        }
      }
    })
  };
  a.textBaseline = function(b, c) {
    var d = a.measureTextHeight(b, c);
    return e({
      marginReset: !0,
      text: b,
      callback: function(b) {
        b.style.cssText = "font: " + c + "; white-space: nowrap; display: block;";
        var e = a.image.offsetTop + 1,
          f = e - d;
        b.style.cssText = "font: " +
          c + "; white-space: nowrap; line-height: 0; display: block;";
        return {
          alphabetic: 0,
          top: e,
          hanging: 8 * e / 10,
          middle: a.image.offsetTop + 1,
          ideographic: f,
          bottom: f
        }
      }
    })
  };
  a.textBaselineTop = function(b, c) {
    return e({
      text: b,
      callback: function(b) {
        b.style.cssText = "font: " + c + "; white-space: nowrap; display: block;";
        return 1.315 * a.image.offsetTop
      }
    })
  };
  var h, d, e = function(b) {
    var c = document.body;
    a.element || (a.parent = document.createElement("span"), a.text = document.createElement("span"), a.parent.appendChild(a.text), a.image = document.createElement("img"),
      a.image.style.cssText = "vertical-align: baseline; background: #000; width: 10px; height: 1px; display: inline;", a.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII=", a.parent.appendChild(a.image), a.element = document.createElement("div"), a.element.className = "metrics", a.element.appendChild(a.parent), a.container = document.createElement("div"), a.container.id = "sketchapi-text-metrics", a.container.appendChild(a.element), c.insertBefore(a.container,
        c.firstChild));
    if (b)
      if (a.text.innerHTML = b.text, a.element.style.cssText = "display: block;", b.marginReset) {
        b.setup && 1 !== b.setup || (h = c.style.padding, d = c.style.margin, c.style.padding = 0, c.style.margin = 0);
        if (!b.setup) var e = b.callback(a.parent);
        b.setup && 2 !== b.setup || (c.style.padding = h, c.style.margin = d, a.element.style.display = "none");
        if (!b.setup) return e
      } else return e = b.callback(a.parent), a.element.style.display = "none", e
  };
  a.getFontStyle = function(a) {
    var b = [];
    a.fontStyle && b.push(a.fontStyle);
    a.fontVariant &&
      b.push(a.fontVariant);
    a.fontWeight && b.push(a.fontWeight);
    a.fontSize && b.push(a.fontSize + "px");
    a.fontFamily && b.push('"' + a.fontFamily + '"');
    return b.join(" ")
  };
  a.setFontStyle = function(a, b) {
    var c = (a.fontSize || 30) * (sketch.canvas2d.zoom || 1),
      d = a.textMetrics || a.__textMetrics,
      d = d ? d.lineHeight * sketch.canvas2d.zoom + "px" : Math.ceil((a.lineHeight || 1) * c) + "em",
      e = b.style;
    e.fontStyle = a.fontStyle || "normal";
    e.fontVariant = a.fontVariant || "normal";
    e.fontWeight = a.fontWeight || "normal";
    e.fontSize = c + "px";
    e.fontFamily = a.fontFamily ||
      "Arial";
    e.letterSpacing = (a.letterSpacing || 0) + "px";
    e.lineHeight = d;
    e.textAlign = a.textAlign || "center";
    e.textDecoration = a.textDecoration || "none";
    e.textTransform = a.textTransform || "none"
  };
  var m = 1 / (180 / Math.PI);
  a.drawLineBreaks = function(b) {
    var c = b.content;
    if (c) {
      var d = a.getFontStyle(b),
        e = b.ctx,
        f = b.bbox,
        h = b.textMetrics,
        l = b.fontSize || 0,
        g = b.textAlign || "left",
        k = b.textDecoration || "none",
        l = b.textTransform || "none",
        p = b.letterSpacing || 0,
        q = b.lineHeight || 0,
        c = a.format(c, b);
      h && h.data || (h = a.getLineBreaks({
        font: d,
        content: c,
        textTransform: l,
        textDecoration: k,
        lineHeight: q,
        letterSpacing: p,
        width: f.width
      }), h.baseline = a.textBaseline("test", d), h.lineHeight = h.height / h.lines);
      c = {
        data: h.data,
        lines: h.lines,
        lineMetrics: h.lineMetrics,
        baseline: h.baseline,
        lineHeight: h.lineHeight,
        height: h.height,
        width: h.width,
        x: f.x,
        y: f.y
      };
      if (!e) return c;
      e.save();
      e.font = d;
      b.useHighRes && !b.applyMatrix ? l = d = 1 : (d = f.scale.x, l = f.scale.y);
      q = f.rotate * m;
      e.translate(f.x, f.y);
      q && e.rotate(q);
      e.translate(-f.x * d, -f.y * l);
      1 === d && 1 === l || e.scale(d, l);
      e.fillStyle = sketch.style.createGradient("fill",
        e, 0, 0, f.width, 0, b);
      b.clip && (e.rect(f.x, f.y, f.width, f.height), e.clip());
      (q = (b.blur || 0) / 2) ? (l = b.fontSize, b = f.y + q, d = f.x - h.width - l, e.shadowOffsetX = h.width + l, e.shadowOffsetY = 0, e.shadowBlur = q, e.shadowColor = "#000") : (b = f.y, d = f.x);
      l = 0;
      switch (g) {
        case "right":
          l = f.width;
          break;
        case "center":
          l = f.width / 2
      }
      for (var q = h.baseline, r = h.data, h = h.lineMetrics, t = 0, E = r.length; t < E; t++) {
        var H = r[t].replace("\n", ""),
          J = t * c.lineHeight + b + q.top;
        if (0 !== p && h)
          for (var I = d, L = h[t], O = f.width - L.width, P = 0; P < H.length; P++) {
            var N = L.data[P];
            e.fillText(H[P],
              I + O / 2, J);
            I = N.width
          } else {
            var I = d + l;
            e.textAlign = g;
            e.fillText(H, I, J)
          }
        switch (k) {
          case "underline":
            e.fillRect(0, J + q.top + 1, f.width, 1);
            break;
          case "overline":
            e.fillRect(0, J + q.alphabetic, f.width, 1);
            break;
          case "line-through":
            e.fillRect(0, J + 2 * q.middle, f.width, 1)
        }
      }
      e.restore();
      return c
    }
  };
  var k = /[\u2014\u2013-]/,
    l = /[ \u2014\u2013-]/,
    r = /^\s+|\s+$/g;
  a.CSSWhiteSpace = {};
  a.CSSWhiteSpace.preWrap = "white-space: pre-wrap;white-space: -moz-pre-wrap !important;white-space: -pre-wrap;white-space: -o-pre-wrap;word-wrap: break-word;";
  a.getLineBreaks = function(d) {
    if (document.createRange) {
      g();
      var e = document.createElement("span");
      document.body.appendChild(e);
      a.spaceOffset = 1;
      var h = a,
        l = document.createRange();
      e.textContent = "d\u2014d";
      e.className = "wrap";
      e.style.cssText = "display: block; width: 1.6em; " + a.CSSWhiteSpace.preWrap + " font: bold 22px arial;";
      l.setStart(e.firstChild, 0);
      l.setEnd(e.firstChild, e.textContent.length);
      l = 2 < l.getClientRects().length ? 1 : 0;
      h.tOffset = l;
      a.mOffset = a.tOffset ? 0 : 1;
      document.body.removeChild(e);
      return (a.getLineBreaks =
        c)(d)
    }
    return document.body.createTextRange ? (g(), (a.getLineBreaks = f)(d)) : (a.getLineBreaks = b)(d)
  };
  a.range = {};
  a.range.selectAll = function(a) {
    if (document.selection) {
      var b = document.body.createTextRange();
      b.moveToElementText(a);
      b.select()
    } else if (window.getSelection) {
      var c = window.getSelection();
      0 < c.rangeCount && c.removeAllRanges();
      b = document.createRange();
      b.selectNode(a);
      c.addRange(b)
    }
  };
  a.getRange = function(b) {
    var c = window.getSelection();
    if (null === c) return c = a.getCursorPos(b), {
      startOffset: c,
      endOffset: c
    };
    if (b =
      c.focusNode) return 3 === b.nodeType ? c.getRangeAt(0) : b.firstChild ? (c = b.firstChild, {
      startOffset: 0,
      endOffset: c.data && c.data.length || 0
    }) : {
      startOffset: 0,
      endOffset: 0
    }
  };
  a.setRange = function(a, b, c) {
    var d = document.createRange();
    a = a.firstChild || a;
    d.setStart(a, b);
    d.setEnd(a, c);
    a = window.getSelection();
    a.removeAllRanges();
    a.addRange(d)
  };
  a.getCursorPos = function(a) {
    var b = 0;
    if (window.getSelection) {
      var c = window.getSelection();
      c.rangeCount && (c = c.getRangeAt(0), c.commonAncestorContainer.parentNode === a && (b = c.endOffset))
    } else document.selection &&
      document.selection.createRange && (c = document.selection.createRange(), c.parentElement() === editableDiv && (a = document.createElement("span"), editableDiv.insertBefore(a, editableDiv.firstChild), b = c.duplicate(), b.moveToElementText(a), b.setEndPoint("EndToEnd", c), b = b.text.length));
    return b
  };
  a.attach = function(a, b) {
    a.callback = b || a.callback;
    a.family = a.family || a.name;
    var c = new p(a);
    if (!c.detectFont(a)) {
      var d = a.family,
        e = a.filepath;
      2 === e.split("/").length && (e = sketch.loc.MEDIA + "font/" + e);
      a.filepath = e;
      var f = document.createElement("style");
      f.type = "text/css";
      document.getElementsByTagName("head")[0].appendChild(f);
      d = "@font-face {\t\tfont-family: '" + d + "';\t\tsrc: url('" + e + ".eot');\t\tsrc: url('" + e + ".eot?#iefix') format('embedded-opentype'),\t\t\turl('" + e + ".woff') format('woff'),\t\t\turl('" + e + ".ttf') format('truetype'),\t\t\turl('" + e + ".svg#" + d + "') format('svg');\t\tfont-weight: normal;\t\tfont-style: normal;\t}";
      f.styleSheet ? f.styleSheet.cssText = d : f.innerHTML = d;
      a.callback && c.waitForFont(a)
    }
  };
  a.attachFromCSS = function(a, b) {
    a.callback = b ||
      a.callback;
    var c = new p(a);
    if (!c.detectFont(a)) {
      var d = a.href.replace(/[^a-zA-Z 0-9]+/g, ""),
        e = document.getElementById(d);
      if (e) return c = e.getAttribute("data-error"), a.callback ? a.callback(c) : c;
      a.link = e = document.createElement("link");
      e.href = a.href;
      e.id = d;
      e.setAttribute("rel", "stylesheet");
      e.setAttribute("type", "text/css");
      e.onerror = function() {
        a.callback && a.callback("404");
        e.setAttribute("data-error", "404")
      };
      document.body.appendChild(e);
      c.waitForFont(a)
    }
  };
  a.attachFromGoogleAPI = function(b, c) {
    a.attachFromCSS({
      family: b,
      href: window.location.protocol + "//fonts.googleapis.com/css?family=" + b + ":regular",
      callback: function(a) {
        a && (a = "&ldquo;" + b + "&rdquo; font-family unavailable.");
        c && c(a)
      }
    })
  };
  var p = function(b) {
      b = b || {};
      var c = this;
      this.metrics = void 0;
      this.test = b.test || "Thequickbrownfox";
      this.font = this.missing = this.arial = this.ctx = this.canvas = void 0;
      this.createHash = function(a) {
        c.canvas.width = c.canvas.width;
        c.ctx.font = c.font;
        c.ctx.fillText(a, 0, c.metrics.textBaseline.top);
        return c.ctx.canvas.toDataURL()
      };
      this.getHash = function(b) {
        c.metrics ||
          (c.metrics = a.getMetrics(c.test, "16px Arial, Helvetica"), c.canvas = document.createElement("canvas"), c.canvas.width = c.metrics.width, c.canvas.height = c.metrics.height, c.font = "16px Arial, Helvetica", c.ctx = c.canvas.getContext("2d"), c.ctx.font = "16px Arial, Helvetica", c.arial = c.createHash(c.test), c.missing = c.createHash(""));
        c.font = "16px '" + b + "', Arial, Helvetica";
        return c.createHash(c.test)
      };
      this.detectFont = function(b) {
        "string" === typeof b && (b = {
          family: b
        });
        if (!b) return console.log("missing conf");
        if (!b.family) return console.log("missing family",
          b);
        var d = b.family,
          e = b.callback,
          f = a.supports[d];
        if ("boolean" === typeof f) return e && e(), f;
        if ("arial" === d.toLowerCase()) return a.supports[b.family] = !0, e && e(), !0;
        d = c.getHash(d);
        return d !== c.missing && d !== c.arial ? (a.supports[b.family] = !0, e && e(), !0) : !1
      };
      this.waitForFont = function(b) {
        if (!c.detectFont(b)) {
          var d = (new Date).getTime(),
            e = b.timeout || 2E4,
            f = function(c) {
              a.supports[b.family] = !1;
              b.link && b.link.setAttribute("data-error", "timeout");
              clearInterval(g);
              b.callback("timeout");
              h()
            },
            h = function() {
              window.sketch &&
                (sketch.loader && t[b.family]) && sketch.loader.remove(t[b.family])
            },
            l = null,
            g = setInterval(function() {
              var k = c.getHash(b.family),
                m = (new Date).getTime() - d;
              k !== c.missing && k !== c.arial ? (a.supports[b.family] = !0, clearInterval(g), b.callback(), h()) : m > e ? f() : b.filepath && (2E3 < m && !l) && (l = sketch.util.request({
                url: b.filepath,
                onerror: f
              }))
            }, 10);
          window.sketch && (sketch.loader && b.useLoader) && !t[b.family] && (t[b.family] = sketch.loader.add("loading &ldquo;" + b.family + "&rdquo;"))
        }
      }
    },
    q = new p,
    t = {};
  a.supports = {};
  a.detectFont = q.detectFont;
  a.waitForFont = q.waitForFont
})(sketch.vector.text);
"undefined" !== typeof module && module.exports && (module.exports = sketch.vector.text);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
(function(a) {
  a.BBox = function(c, f, b) {
    sketch = a.BBox.__self || sketch;
    if (!c) return {};
    this.unset();
    if (4 === c.length && isFinite(c[0])) {
      var h = new sketch.vector.Transform(f);
      f = h.point2d(c[0], c[1]);
      b = h.point2d(c[0], c[3]);
      var d = h.point2d(c[2], c[3]),
        e = h.point2d(c[2], c[1]);
      c = Math.min(f.x, b.x, d.x, e.x);
      var h = Math.max(f.x, b.x, d.x, e.x),
        g = Math.min(f.y, b.y, d.y, e.y);
      f = Math.max(f.y, b.y, d.y, e.y);
      return {
        x1: c,
        y1: g,
        x2: h,
        y2: f
      }
    }
    return this.path(c, f, b)
  };
  a.BBox.prototype = {
    path: function(a, f, b) {
      var h, d = !0;
      f && (h = new sketch.vector.Transform(f),
        d = sketch.vector.Transform.isIdentity(f));
      var e;
      f = this.x;
      var g = this.y,
        k, l, r;
      if (d)
        for (d = 0, r = a.length; d < r; d++) switch ((e = a[d]).cmd) {
          case "M":
            e.x < f.min && (f.min = e.x);
            e.x > f.max && (f.max = e.x);
            e.y < g.min && (g.min = e.y);
            e.y > g.max && (g.max = e.y);
            k = e.x;
            l = e.y;
            break;
          case "L":
            e.x < f.min && (f.min = e.x);
            e.x > f.max && (f.max = e.x);
            e.y < g.min && (g.min = e.y);
            e.y > g.max && (g.max = e.y);
            k = e.x;
            l = e.y;
            break;
          case "C":
            this.cubic(k, l, e.x1, e.y1, e.x2, e.y2, e.x, e.y);
            k = e.x;
            l = e.y;
            break;
          case "Q":
            var p = k + 2 / 3 * (e.x1 - k),
              q = l + 2 / 3 * (e.y1 - l),
              t = p + (e.x - k) / 3,
              s = q +
              (e.y - l) / 3;
            this.cubic(k, l, p, q, t, s, e.x, e.y);
            k = e.x;
            l = e.y
        } else
          for (d = 0, r = a.length; d < r; d++) switch ((e = a[d]).cmd) {
            case "M":
              var w = h.point2d(e.x, e.y);
              w.x < f.min && (f.min = w.x);
              w.x > f.max && (f.max = w.x);
              w.y < g.min && (g.min = w.y);
              w.y > g.max && (g.max = w.y);
              k = w.x;
              l = w.y;
              break;
            case "L":
              w = h.point2d(e.x, e.y);
              w.x < f.min && (f.min = w.x);
              w.x > f.max && (f.max = w.x);
              w.y < g.min && (g.min = w.y);
              w.y > g.max && (g.max = w.y);
              k = w.x;
              l = w.y;
              break;
            case "C":
              w = h.point2d(e.x, e.y);
              p = h.point2d(e.x1, e.y1);
              e = h.point2d(e.x2, e.y2);
              this.cubic(k, l, p.x, p.y, e.x, e.y, w.x,
                w.y);
              k = w.x;
              l = w.y;
              break;
            case "Q":
              w = h.point2d(e.x, e.y), h.point2d(e.x1, e.y1), p = k + 2 / 3 * (w.x1 - k), q = l + 2 / 3 * (w.y1 - l), t = p + (w.x - k) / 3, s = q + (w.y - l) / 3, this.cubic(k, l, p, q, t, s, w.x, w.y), k = w.x, l = w.y
          }
      b && (f.expand(b), g.expand(b));
      return {
        x1: f.min,
        x2: f.max,
        y1: g.min,
        y2: g.max
      }
    },
    cubic: function(a, f, b, h, d, e, g, k) {
      var l = this.x,
        r = this.y;
      g < l.min && (l.min = g);
      g > l.max && (l.max = g);
      k < r.min && (r.min = k);
      k > r.max && (r.max = k);
      var p = l.contains(b) && l.contains(d),
        q = r.contains(h) && r.contains(e);
      if (!p) {
        var p = 3 * a - 9 * b + 9 * d - 3 * g,
          t = 6 * b - 12 * d + 6 * g,
          s = 3 * d - 3 *
          g;
        if (0 >= Math.abs(p)) 0 <= Math.abs(t) && (s = -s / t, 0 < s && 1 > s && l.extendToCubic(s, 1 - s, a, g, b, d));
        else if (s = t * t - 4 * p * s, 0 <= s) {
          var w = Math.sqrt(s),
            s = (-t + w) / (2 * p);
          0 < s && 1 > s && l.extendToCubic(s, 1 - s, a, g, b, d);
          s = (-t - w) / (2 * p);
          0 < s && 1 > s && l.extendToCubic(s, 1 - s, a, g, b, d)
        }
      }
      q || (p = 3 * f - 9 * h + 9 * e - 3 * k, t = 6 * h - 12 * e + 6 * k, s = 3 * e - 3 * k, 0 >= Math.abs(p) ? 0 <= Math.abs(t) && (s = -s / t, 0 < s && 1 > s && r.extendToCubic(s, 1 - s, f, k, h, e)) : (s = t * t - 4 * p * s, 0 <= s && (w = Math.sqrt(s), s = (-t + w) / (2 * p), 0 < s && 1 > s && r.extendToCubic(s, 1 - s, f, k, h, e), s = (-t - w) / (2 * p), 0 < s && 1 > s && r.extendToCubic(s,
        1 - s, f, k, h, e))))
    },
    unset: function() {
      this.x = new g({
        min: Infinity,
        max: -Infinity
      });
      this.y = new g({
        min: Infinity,
        max: -Infinity
      })
    }
  };
  var g = function(a) {
    this.min = a.min;
    this.max = a.max
  };
  g.prototype = {
    extendToCubic: function(a, f, b, h, d, e) {
      a = a * a * a * b + 3 * a * a * f * d + 3 * a * f * f * e + f * f * f * h;
      a < this.min && (this.min = a);
      a > this.max && (this.max = a)
    },
    extendTo: function(a) {
      a < this.min && (this.min = a);
      a > this.max && (this.max = a)
    },
    contains: function(a) {
      return this.min <= a && a <= this.max
    },
    expand: function(a) {
      this.min -= a;
      this.max += a
    }
  }
})(sketch.vector);
"undefined" !== typeof module && module.exports && (module.exports = sketch.vector.BBox);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.vector && (sketch.vector = {});
(function(a) {
  var g = {
      a: 1,
      b: 0,
      x: 0,
      c: 0,
      d: 1,
      y: 0
    },
    c = function(b) {
      var c = a.Transform.identity;
      return b.a === c.a && b.b === c.b && b.c === c.c && b.d === c.d && b.x === c.x && b.y === c.y
    },
    f = function() {
      return {
        a: 1,
        b: 0,
        x: 0,
        c: 0,
        d: 1,
        y: 0
      }
    };
  a.Transform = function(a, c) {
    this.matrix = "undefined" === typeof a ? {
      a: 1,
      b: 0,
      x: 0,
      c: 0,
      d: 1,
      y: 0
    } : "undefined" === typeof a[0] ? a : this.cloneMatrix(a);
    return this
  };
  a.Transform.identity = g;
  a.Transform.isIdentity = c;
  a.Transform.getIdentity = f;
  a.Transform.prototype = {
    identity: g,
    isIdentity: c,
    getIdentity: f,
    point2d: function(a,
      c) {
      var d = this.matrix;
      return {
        x: d.a * a + d.c * c + d.x,
        y: d.b * a + d.d * c + d.y
      }
    },
    point2dx: function(a, c, d) {
      var e = this.matrix,
        f = a[c],
        g = a[d];
      a[c] = e.a * f + e.c * g + e.x;
      a[d] = e.b * f + e.d * g + e.y
    },
    flatten: function(a, c, d) {
      if (a && a.length) {
        c && (a = JSON.parse(JSON.stringify(a)));
        c = 0;
        for (var e = a.length, f; c < e; c++)
          if (f = a[c]) switch (f.cmd) {
            case "M":
              this.point2dx(f, "x", "y");
              break;
            case "L":
              this.point2dx(f, "x", "y");
              break;
            case "C":
              this.point2dx(f, "x", "y");
              this.point2dx(f, "x1", "y1");
              this.point2dx(f, "x2", "y2");
              break;
            case "Q":
              this.point2dx(f, "x",
                "y");
              this.point2dx(f, "x1", "y1");
              break;
            case "Z":
            case "z":
              isFinite(f.x) && isFinite(f.y) && this.point2dx(f, "x", "y")
          }
          d && (this.matrix = this.getIdentity());
        return a
      }
    },
    invert: function(a) {
      a = a || this.matrix;
      "undefined" === typeof a.a && (M = this.cloneMatrix(M));
      var c = a.a * a.d - a.b * a.c;
      delete this.matrix;
      this.combine({
        a: a.d / c,
        b: -a.b / c,
        x: (a.b * a.y - a.d * a.x) / c,
        c: -a.c / c,
        d: a.a / c,
        y: (a.c * a.x - a.a * a.y) / c
      });
      return this
    },
    transform: function(a, c, d, e, f, g) {
      var l = this.matrix;
      this.matrix = {
        a: l.a * a + l.c * c,
        b: l.b * a + l.d * c,
        c: l.a * d + l.c * e,
        d: l.b *
          d + l.d * e,
        x: l.a * f + l.c * g + l.x,
        y: l.b * f + l.d * g + l.y
      };
      return this
    },
    setTransform: function(a, c, d, e, f, g) {
      this.matrix = {
        a: a,
        b: c,
        c: d,
        d: e,
        x: f,
        y: g
      };
      return this
    },
    rotate: function(a) {
      var c = this.matrix,
        d = Math.cos(a);
      a = Math.sin(a);
      this.matrix = {
        a: c.a * d + c.b * -a,
        b: c.a * a + c.b * d,
        c: c.c * d + c.d * -a,
        d: c.c * a + c.d * d,
        x: c.x,
        y: c.y
      };
      return this
    },
    scale: function(a, c) {
      "undefined" === typeof c && (c = a);
      var d = this.matrix;
      this.matrix = {
        a: d.a * a,
        b: d.b * c,
        c: d.c * a,
        d: d.d * c,
        x: d.x,
        y: d.y
      };
      return this
    },
    skew: function(a, c) {
      var d = this.matrix,
        e = d.a,
        f = d.b,
        g = d.c,
        l =
        d.d,
        r = Math.tan(a),
        p = Math.tan(c);
      d.a = e + g * p;
      d.b = f + l * p;
      d.c = e * r + g;
      d.d = f * r + l;
      return this
    },
    translate: function(a, c) {
      "undefined" === typeof c && (c = 0);
      var d = this.matrix;
      d.x = d.a * a + d.c * c + d.x;
      d.y = d.b * a + d.d * c + d.y;
      return this
    },
    combine: function(a) {
      var c = [];
      if ("undefined" !== typeof a.matrix)
        for (var d = 0; d < arguments.length; d++) c[d] = arguments[d].matrix;
      else if ("number" === typeof a.a)
        for (d = 0; d < arguments.length; d++) c[d] = arguments[d];
      else c = a;
      for (var d = this.matrix, e = [], f = 0; f < c.length; f++) "undefined" === typeof d ? d = c[f] : (e = c[f],
        d = {
          a: d.a * e.a + d.b * e.c,
          b: d.a * e.b + d.b * e.d,
          c: d.c * e.a + d.d * e.c,
          d: d.c * e.b + d.d * e.d,
          x: d.a * e.x + d.c * e.y + d.x,
          y: d.b * e.x + d.d * e.y + d.y
        });
      this.matrix = d;
      return this
    },
    clone: function() {
      return new a.Transform(this.cloneMatrix())
    },
    cloneMatrix: function(a) {
      a = a || this.matrix;
      return "undefined" === typeof a.a ? {
        a: a[0],
        b: a[1],
        c: a[2],
        d: a[3],
        x: a[4],
        y: a[5]
      } : {
        a: a.a,
        b: a.b,
        c: a.c,
        d: a.d,
        x: a.x,
        y: a.y
      }
    },
    reset: function() {
      this.matrix = f();
      return this
    },
    toString: function() {
      var a = this.matrix;
      return "" + a.a + "," + a.b + "," + a.c + "," + a.d + "," + a.x + "," + a.y
    },
    toArray: function() {
      var a = this.matrix;
      return [a.a, a.b, a.c, a.d, a.x, a.y]
    },
    apply: function(a, c) {
      var d = this.matrix;
      c ? a.transform(d.a, d.b, d.c, d.d, d.x, d.y) : a.setTransform(d.a, d.b, d.c, d.d, d.x, d.y);
      return this
    }
  };
  a.Transform.__default = new a.Transform
})(sketch.vector);
"undefined" !== typeof module && module.exports && (module.exports = sketch.vector.Transform);
if ("undefined" === typeof widget) var widget = {};
(function() {
  var a, g = {
    id: "loader",
    bars: 12,
    radius: 0,
    lineWidth: 14,
    lineHeight: 40,
    timeout: 0,
    display: !0
  };
  widget.Loader = function(b) {
    "undefined" === typeof a && (a = !!document.createElement("canvas").getContext);
    if (a) {
      var h = this;
      "string" === typeof b && (b = {
        message: b
      });
      "boolean" === typeof b && (b = {
        display: !1
      });
      "undefined" === typeof b && (b = {});
      b.container = b.container || document.body;
      if (b.container) {
        for (var d in g) "undefined" === typeof b[d] && (b[d] = g[d]);
        var e = document.getElementById(b.id);
        if (e) this.span = e.parentNode.getElementsByTagName("span")[0];
        else {
          var m = document.createElement("div");
          d = document.createElement("span");
          d.className = "message";
          m.className = g.id;
          m.style.cssText = c("opacity", 400);
          this.span = d;
          this.div = m;
          e = document.createElement("canvas");
          e.id = b.id;
          e.style.cssText = "opacity: 1; position: absolute; z-index: 10000;";
          m.appendChild(e);
          m.appendChild(d);
          var k = document.createElement("div");
          k.className = "meter";
          k.style.padding = "10px";
          d = document.createElement("span");
          d.style.width = "3%";
          k.appendChild(d);
          this.meter = d;
          this.meterContainer = k;
          this.span.appendChild(k);
          b.container.appendChild(m)
        }
        var l = b.bars,
          r = b.radius,
          p = 2 * (b.lineHeight + 20) + 2 * b.radius;
        f(b.container);
        var q = window.devicePixelRatio || 1;
        e.width = p * q;
        e.height = p * q;
        var t = 0,
          s = e.getContext("2d");
        s.globalCompositeOperation = "lighter";
        s.shadowOffsetX = 1;
        s.shadowOffsetY = 1;
        s.shadowBlur = 0;
        s.shadowColor = "rgba(0, 0, 0, 0.5)";
        this.messages = {};
        this.message = function(a, b) {
          if (!this.interval) return this.start(b, a);
          this.update(null, a);
          b && b()
        };
        this.update = function(a, b, c) {
          if (!isFinite(a))
            for (a in this.messages);
          if (a = this.messages[a]) a.message =
            b = b || a.message, "number" === typeof c && (a.span.innerHTML = c + "%"), "..." === b.substr(-3) ? (a._message = b.substr(0, b.length - 3), a.messageAnimate = [".&nbsp;&nbsp;", "..&nbsp;", "..."].reverse()) : (a._message = b, a.messageAnimate = !1), a.element.innerHTML = b
        };
        this.add = function(a) {
          "string" === typeof a && (a = {
            message: a
          });
          this.span.style.cssText = "background: " + (b.background ? b.background : "rgba(0,0,0,1)") + ";";
          this.div.style.cssText = c("opacity", 400);
          this.stopPropagation ? this.div.style.cssText += "background: rgba(0,0,0,0.25);" : (this.div.style.pointerEvents =
            "none", this.div.style.height = 0);
          this.div.style.opacity = 1;
          this.div.style.display = "block";
          b.background && (this.div.style.background = b.backgrond);
          var d = (new Date).getTime(),
            e = Math.abs(d * Math.random() >> 0),
            f = a.message,
            l = document.createElement("div");
          l.style.cssText = c("opacity", 500);
          var h = document.createElement("span");
          h.style.cssText = "float: right; width: 50px;";
          var g = document.createElement("span");
          g.innerHTML = f;
          l.appendChild(g);
          l.appendChild(h);
          l.appendChild(document.createElement("br"));
          d = this.messages[e] = {
            seed: e,
            container: l,
            element: g,
            span: h,
            message: f,
            timeout: 1E3 * (a.timeout || b.timeout),
            timestamp: d,
            getProgress: a.getProgress
          };
          this.span.appendChild(l);
          this.span.style.display = "block";
          this.update(d.seed, f);
          a.onstart && setTimeout(a.onstart, 150);
          this.center();
          this.interval || a.delay || v();
          clearInterval(this.interval);
          this.interval = setInterval(v, 30);
          return e
        };
        this.remove = function(a) {
          t += 0.07;
          (new Date).getTime();
          sketch.loader.thread === a && delete sketch.loader.thread;
          "object" === typeof a && (a = a.join(":"));
          a && (a = ":" +
            a + ":");
          for (var b in this.messages) {
            var c = this.messages[b];
            a && -1 === a.indexOf(":" + c.seed + ":") || (delete this.messages[c.seed], c.container.style.color = "#99ff88", w(c), c.getProgress && (c.span.innerHTML = "100%"))
          }
        };
        this.start = function(a, c) {
          if (c || b.message) return h.add({
            message: c || b.message,
            onstart: a
          })
        };
        this.stop = function(a) {
          if (isFinite(a)) this.update(a, null, 100);
          else {
            h.remove();
            clearInterval(h.interval);
            delete h.interval;
            delete sketch.loader.thread;
            if (b.oncomplete) b.oncomplete();
            e && e.style && (setTimeout(function() {
              h.div.style.opacity =
                0
            }, 1), setTimeout(function() {
              h.interval || (h.stopPropagation = !1, m.style.display = "none", s.clearRect(0, 0, p, p))
            }, 400))
          }
        };
        this.center = function() {
          var a = f(b.container),
            c = a.width - p,
            a = (document.documentElement && document.documentElement.scrollTop || document.body.scrollTop) + (a.height - p) / 2 - Math.max(70, h.span.offsetHeight / 2) + p;
          e.style.left = c / 2 + "px";
          e.style.top = a - p + "px";
          e.style.width = p + "px";
          e.style.height = p + "px";
          h.span.style.top = a + "px"
        };
        d = document.createElement("style");
        document.getElementsByTagName("head")[0].appendChild(d);
        d.styleSheet ? d.styleSheet.cssText = ".loader { color: #fff; position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 100000; opacity: 0; display: none; font-size: 1em; }.loader span { overflow: hidden; white-space: nowrap; }.loader span.message { margin: auto; opacity: 1; display: none; border-radius: 10px; padding: 0; width: 300px; text-align: center; position: absolute; z-index: 10000; left: 0; right: 0; }.loader span.message div { border-bottom: 1px solid rgba(255,255,255,0.15); padding: 7px 10px; clear: both; text-align: left; opacity: 1; }.loader span.message span { text-overflow: ellipsis; -o-text-overflow: ellipsis; width: 80%; float: left }.loader span.message div:last-child { border-bottom: none; }" :
          d.innerHTML = ".loader { color: #fff; position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 100000; opacity: 0; display: none; font-size: 1em; }.loader span { overflow: hidden; white-space: nowrap; }.loader span.message { margin: auto; opacity: 1; display: none; border-radius: 10px; padding: 0; width: 300px; text-align: center; position: absolute; z-index: 10000; left: 0; right: 0; }.loader span.message div { border-bottom: 1px solid rgba(255,255,255,0.15); padding: 7px 10px; clear: both; text-align: left; opacity: 1; }.loader span.message span { text-overflow: ellipsis; -o-text-overflow: ellipsis; width: 80%; float: left }.loader span.message div:last-child { border-bottom: none; }";
        var w = function(a) {
            setTimeout(function() {
              a.container.style.opacity = 0
            }, 1);
            setTimeout(function() {
              a.container.parentNode.removeChild(a.container)
            }, 250)
          },
          v = function() {
            var a = (new Date).getTime();
            h.center();
            for (var c in h.messages) {
              var d = h.messages[c],
                e = t / 0.07 >> 0,
                f = parseInt(d.span.innerHTML);
              if (isFinite(f) && 100 <= f) h.remove(d.seed);
              else {
                if (0 === e % 5 && d.getProgress) {
                  if (d.timeout && d.timestamp && a - d.timestamp > d.timeout) {
                    h.remove(d.seed);
                    continue
                  }
                  f = d.getProgress();
                  if (100 <= f) {
                    h.remove(d.seed);
                    continue
                  }
                  d.span.innerHTML =
                    (f >> 0) + "%"
                }
                0 === e % 10 && d.messageAnimate && (d.element.innerHTML = d._message + d.messageAnimate[e / 10 % d.messageAnimate.length])
              }
            }
            c || h.stop();
            if (isFinite(h.percent)) h.meterContainer.style.display = "", h.meter.style.width = h.percent + "%";
            else {
              h.meterContainer.style.display = "none";
              s.save();
              s.clearRect(0, 0, p * q, p * q);
              s.scale(q, q);
              s.translate(p / 2, p / 2);
              a = 360 - 360 / l;
              for (c = 0; c < l; c++) {
                d = 2 * (c / l) * Math.PI + t;
                s.save();
                s.translate(r * Math.sin(-d), r * Math.cos(-d));
                s.rotate(d);
                var d = -b.lineWidth / 2,
                  e = b.lineWidth,
                  f = b.lineHeight,
                  g = e /
                  2;
                s.beginPath();
                s.moveTo(d + g, 0);
                s.lineTo(d + e - g, 0);
                s.quadraticCurveTo(d + e, 0, d + e, 0 + g);
                s.lineTo(d + e, 0 + f - g);
                s.quadraticCurveTo(d + e, 0 + f, d + e - g, 0 + f);
                s.lineTo(d + g, 0 + f);
                s.quadraticCurveTo(d, 0 + f, d, 0 + f - g);
                s.lineTo(d, 0 + g);
                s.quadraticCurveTo(d, 0, d + g, 0);
                s.fillStyle = "hsla(" + c / (l - 1) * a + ", 100%, 50%, 0.85)";
                s.fill();
                s.restore()
              }
              s.restore();
              t += 0.07
            }
          };
        if (!1 === b.display) return this;
        this.start();
        return this
      }
    }
  };
  var c = function(a, c) {
      return "\t\t-webkit-transition-property: " + a + ";\t\t-webkit-transition-duration: " + c + "ms;\t\t-moz-transition-property: " +
        a + ";\t\t-moz-transition-duration: " + c + "ms;\t\t-o-transition-property: " + a + ";\t\t-o-transition-duration: " + c + "ms;\t\t-ms-transition-property: " + a + ";\t\t-ms-transition-duration: " + c + "ms;"
    },
    f = function(a) {
      if (window.innerWidth && window.innerHeight) var c = window.innerWidth,
        d = window.innerHeight;
      else "CSS1Compat" === document.compatMode && document.documentElement && document.documentElement.offsetWidth ? (c = document.documentElement.offsetWidth, d = document.documentElement.offsetHeight) : document.body && document.body.offsetWidth &&
        (c = document.body.offsetWidth, d = document.body.offsetHeight);
      a && (c = a.offsetWidth);
      return {
        width: c,
        height: d
      }
    }
})();
"undefined" === typeof widget && (widget = {});
widget.Range = function(a) {
  function g(a) {
    var b = [];
    if (!a) return [];
    for ("number" === typeof a ? a = [a] : "string" === typeof a && (a = -1 !== a.indexOf(",") ? a.split(",") : a.split(" ")); a.length;) {
      var c = parseFloat(a.shift());
      b.push(c)
    }
    return b
  }

  function c(a, b) {
    return "number" === typeof a ? a : "NaN" === String(parseFloat(a)) ? b : parseFloat(a)
  }
  return function(a) {
    var b = this,
      h = a.onchange;
    this.target = a.target;
    this.setValue = function(a, c) {
      1 === b.thumbs.length && "undefined" === typeof c && (c = a, a = 0);
      b.thumbs[a].value = c;
      b.update(a, "set")
    };
    this.target &&
      (this.target.onchange && (h = this.target.onchange), this.target.setValue = this.setValue, a.value = this.target.value, a.min = this.target.getAttribute("min"), a.max = this.target.getAttribute("max"), a.step = this.target.getAttribute("step"));
    this.value = g(a.value, 0);
    this.min = c(a.min, 0);
    this.max = c(a.max, 100);
    this.step = c(a.step, 1);
    this.thumbs = [];
    this.format = a.format;
    !0 === a.canCross ? (this.canCross = !0, this.canPush = !1) : !1 === a.canPush ? this.canPush = this.canCross = !1 : (this.canCross = !1, this.canPush = !0);
    var d = document.createElement("div"),
      e = document.createElement("span");
    e.className = "sk-track";
    d.appendChild(e);
    for (var m = 0, k = this.value.length, e = 0; e < k; e++) {
      var l = document.createElement("div");
      d.appendChild(l);
      this.thumbs.push({
        index: e,
        element: l,
        left: 0,
        value: this.value[e]
      })
    }
    if (2 === k) {
      var r = document.createElement("div");
      r.className = "sk-range-span";
      d.appendChild(r);
      var p = document.createElement("div");
      p.className = "sk-range-span";
      p.style.display = "none";
      d.appendChild(p)
    }
    this.element = d;
    this.setup = function() {
      a.parent && a.parent.appendChild(d);
      if ("object" !== typeof a.css && (a.css = {}, a.className ? (a.css.slider = "", a.css.thumb = "") : (a.css.slider = "background: #000 -webkit-radial-gradient(45px 45px, cover, rgb(0, 0, 0) 0%, rgb(255, 255, 255) 100%); border: 1px solid #000; border-radius: 25px; width: 500px; height: 40px; top: 0; position: relative; z-index: 100", a.css.thumb = "background: #fff -webkit-radial-gradient(45px 45px, cover, rgb(0, 100, 255) 0%, rgb(255, 255, 255) 100%); border: 2px solid rgba(0,100,255,1); top: -2px; border-radius: 25px; width: 40px; height: 40px; position: absolute;"),
          sketch.gen && sketch.gen.rangeBar && sketch.feature.ui.genRangeBar)) {
        var b = sketch.gen.rangeBar({
          gradient: a.gradient,
          barWidth: d.offsetWidth
        });
        a.css.slider += "background-image: url(" + b.toDataURL() + ");\t\t\t\t\tbackground-size:" + b.style.width + " " + b.style.height + ";"
      }
      d.className = a.className;
      d.style.cssText = a.css.slider;
      for (b = 0; b < k; b++) this.thumbs[b].element.style.cssText = a.css.thumb
    };
    this.setAnimate = function(b, c) {
      var d = this.thumbs[b].element,
        e = d.style.left;
      d.style.cssText = a.css.thumb;
      d.style.left = e
    };
    this.update =
      function(c, e) {
        var l = b.thumbs[c || 0],
          g = l.element,
          m = d.offsetWidth || 236,
          u = g.offsetWidth || 10,
          y = Math.max(0, Math.min(m - u, (l.value - b.min) / (b.max - b.min) * (m - u))),
          u = u / 2;
        if (this.canPush) {
          var x = y + u;
          if (x < l.left)
            for (var z = l.index - 1; - 1 < z; z--) {
              var A = this.thumbs[z];
              A.left > x && (A.element.style.cssText = a.css.thumb, A.element.style.left = Math.round(y) + "px", A.left = x, A.value = l.value, b.state = e || "change", h(b, A))
            } else
              for (z = l.index + 1; z < k; z++) A = this.thumbs[z], A.left < x && (A.element.style.cssText = a.css.thumb, A.element.style.left =
                Math.round(y) + "px", A.left = x, A.value = l.value, b.state = e || "change", h(b, A));
          g.style.left = Math.round(y) + "px";
          l.left = x
        } else if (this.canCross) g.style.left = Math.round(y) + "px", l.left = y + u;
        else {
          x = y + u;
          if (x < l.left)
            for (z = l.index - 1; - 1 < z; z--) {
              if (A = this.thumbs[z], A.left > x) {
                y = A.left - u;
                x = A.left;
                A.value = l.value;
                b.state = e || "change";
                h(b, A);
                break
              }
            } else
              for (z = l.index + 1; z < k; z++)
                if (A = this.thumbs[z], A.left < x) {
                  y = A.left - u;
                  x = A.left;
                  A.value = l.value;
                  b.state = e || "change";
                  h(b, A);
                  break
                }
          g.style.left = Math.round(y) + "px";
          l.left = x
        }
        b.state =
          e || "change";
        h(b, l);
        2 === k && (l = b.thumbs[0].left, g = b.thumbs[1].left, l <= g ? (r.style.left = Math.min(l, g) + "px", r.style.width = Math.abs(l - g) + "px", p.style.display = "none") : (r.style.left = "0px", r.style.width = g + "px", p.style.left = l + "px", p.style.width = m - l + "px", p.style.display = "block"))
      };
    this.wheel = function(a, c) {
      var d = b.thumbs[0],
        e = (d.value - b.min) / (b.max - b.min),
        e = Math.min(1, Math.max(0, e - c.wheelDelta / 5E3));
      d.value = e * (b.max - b.min) + b.min;
      b.update(0, c.state)
    };
    this.mousedown = function(a, c) {
      for (var e = eventjs.proxy.getCoord(a),
          f = eventjs.proxy.getBoundingBox(d), l = Infinity, h, e = e.x - f.x1, f = 0; f < k; f++) {
        var g = b.thumbs[f],
          p = g.left - e,
          r = Math.abs(p);
        if (0 > p && r <= l || -1 < p && r < l) l = r, h = g
      }
      if (h) {
        var A = h.element,
          B = h.index;
        A.style.zIndex = ++m;
        eventjs.proxy.drag({
          event: a,
          target: d,
          position: "relative",
          animationFrame: !0,
          listener: function(a, e) {
            var f = d.offsetWidth;
            b.setAnimate(B, "move" !== e.state);
            var l = A.offsetWidth,
              f = Math.max(0, Math.min(f - l, e.x - l / 2)) / (f - l);
            "down" === e.state ? (eventjs.blur(), eventjs.cancel(a), l = "start") : "up" === e.state ? (eventjs.cancel(a),
              l = "end") : (eventjs.cancel(a), l = "change");
            h.value = f * (b.max - b.min) + b.min;
            b.update(B, l);
            c && c(e)
          }
        })
      }
    };
    eventjs.add(d, "wheel", this.wheel);
    eventjs.add(d, "mousedown", this.mousedown);
    this.target && this.target.parentNode && (this.target.parentNode.insertBefore(d, this.target), this.target.style.display = "none");
    this.setup();
    for (e = k - 1; - 1 < e; e--) b.setAnimate(e, !0), b.update(e, "load"), b.state = "load";
    return this
  }
}({});
"undefined" === typeof widget && (widget = {});
widget.Thumbnailer = function(a) {
  var g = {
    background: "",
    width: 300,
    height: 100,
    center: !0,
    crop: "edge",
    src: "path.to.image"
  };
  a = function(a) {
    a || (a = {});
    for (var b in g) "undefined" === typeof a[b] && (a[b] = g[b]);
    this.conf = a;
    this.height = a.height;
    this.width = a.width;
    this.generate = function(b) {
      "string" === typeof b && (b = {
        src: b
      });
      var d, e = b.src,
        g = b.canvas,
        k = "function" === typeof FlashCanvas,
        l;
      for (l in b) a[l] = b[l];
      var r = isFinite(b.center) ? b.center : a.center,
        p = (b.crop || a.crop).toLowerCase(),
        q = isFinite(b.croparea) ? b.croparea : a.croparea,
        t = b.background || a.background;
      "none" === t && (t = "");
      var s = isFinite(b.width) ? b.width : a.width,
        w = isFinite(b.height) ? b.height : a.height,
        v = b.onload || a.onload;
      q && q.length && (q = {
        x1: q[0],
        y1: q[1],
        x2: q[2],
        y2: q[3]
      });
      if ("undefined" === typeof g && (g = document.createElement("canvas"), "undefined" !== typeof Event && eventjs.add)) {
        var u = {};
        for (l in a) "function" === typeof a[l] && (u[l] = a[l]);
        for (l in b) "function" === typeof b[l] && (u[l] = b[l]);
        eventjs.add(g, u)
      }
      var y = g.getContext("2d");
      b = function() {
        if (d.width || d.height) {
          q || (q = {
            x1: 0,
            y1: 0,
            x2: d.width,
            y2: d.height
          });
          var a = q.x1 || 0,
            b = q.y1 || 0,
            c = q.x2 - q.x1 || s,
            e = q.y2 - q.y1 || w;
          "auto" === s ? (g.height = w, g.width = s = c / e * w) : (g.height = "auto" === w ? w = e / c * s : w, g.width = s);
          var f = 1,
            l = 0,
            h = 0;
          "none" !== p && (f = s / w < c / e, f = (l = "fit" === p) && f || !l && !f ? w / e : s / c);
          e = Math.round(q.x2 * f) || 1;
          c = Math.round(q.y2 * f) || 1;
          l = Math.round(r ? (s - e) / 2 : 0);
          h = Math.round(r ? (w - c) / 2 : 0);
          g.width = s;
          g.height = w;
          y.save();
          y.rect(0, 0, s, w);
          t && (y.save(), y.scale(0.25, 0.25), y.fillStyle = t, y.fill(), y.restore());
          y.translate(l, h);
          y.scale(f, f);
          y.drawImage(d, -a, -b);
          y.restore()
        }
        v && v(g, d)
      };
      l = String(e);
      c[l] || k && "[object]" === l ? (d = e, b()) : (g.setAttribute("data-src", e), d = new Image, k ? (d.src = e, y.loadImage(d, b)) : dom.loadImage({
        src: e,
        image: d,
        onload: b
      }));
      return g
    };
    return this
  };
  var c = {
    "[object HTMLImageElement]": !0,
    "[object HTMLCanvasElement]": !0,
    "[object Canvas]": !0
  };
  return a
}({});
if ("undefined" !== typeof module && module.exports && (module.exports = widget.Thumbnailer, "undefined" === typeof document)) {
  var canvas = require("canvas");
  document = {
    createElement: function() {
      return new canvas
    }
  };
  Image = canvas.Image
}
"undefined" === typeof widget && (widget = {});
widget.Uploader = function(a) {
  var g = this;
  a = a || {};
  this.debug = !1;
  this.action = a.action || "./filesystem.php?upload=true";
  this.confirm = a.confirm || "text";
  this.onUpload = a.onUpload || a.onupload;
  this.onProgress = a.onProgress || a.onprogress;
  this.onLoad = a.onLoad || a.onload;
  this.onInputReady = a.onInputReady || a.oninputready;
  this.onError = a.onError || a.onerror;
  this.onAbort = a.onAbort || a.onabort;
  this.onChangeDefault = this.onChange = a.onChange || a.onchange;
  this.mode = a.mode || "read";
  this.maxFiles = a.maxFiles || 1;
  this.maxFileSize =
    a.maxFileSize || 104857600;
  this.directory = a.directory || !1;
  "object" === typeof a.fakeInput ? (this.fakeInput = a.fakeInput, this.fakeInputParent = a.fakeInputParent || null) : "object" === typeof a.fileInput && (this.fileInput = a.fileInput);
  this.dropAreaContainer = a.dropArea || document.body;
  this.dropAreaMessage = a.dropAreaMessage || "Drop File(s) Here";
  this.dropAreaStyle = a.dropAreaStyle || "";
  this.files = {};
  this.filesByName = {};
  this.filesByPath = {};
  this.formats = {};
  var c = (a.formats || "jpg,jpeg,gif,png").split(",");
  for (a = 0; a < c.length; a++) this.formats[c[a].trim().toLowerCase()] = !0;
  this.createFileInput = function(a) {
    a = a || {};
    var b = a.element || a,
      d = b && b.parentNode;
    if (d) {
      if ("fakeInputContainer" === d.className) return;
      g.fakeInput = b;
      g.fileInput = null
    }
    if (g.fileInput) var e = g.fileInput;
    else if (g.fakeInput) {
      e = g.fileInput = document.createElement("input");
      e.style.cssText = "position: absolute; top: 0; z-index: 1000; font-size: 1000px; text-align: right; width: inherit; height: inherit; cursor: pointer; right: 0; filter: alpha(opacity: 0); opacity: 0;";
      var f = function(a, b) {
        g.onChange = g.onChangeDefault ||
          g.onChange;
        eventjs.remove(document.body, "focus", f)
      };
      eventjs.add(e, "mousedown", function(b) {
        g.onChange = a.onChange || g.onChange
      });
      eventjs.add(e, "click", function(a, b) {
        eventjs.add(document.body, "focus", f)
      });
      c.length && sketch.supports.chooseEntry ? eventjs.add(e, "click", function(a) {
        sketch.open.chooseEntry(function(b) {
          h([b], a)
        })
      }) : (e.setAttribute("type", "file"), e.setAttribute("capture", "camera"));
      1 < g.maxFiles ? (e.setAttribute("name", "files[]"), e.setAttribute("multiple", "multiple")) : e.setAttribute("name", "file");
      g.directory && (e.setAttribute("directory", ""), e.setAttribute("mozdirectory", ""), e.setAttribute("webkitdirectory", ""));
      var l = {
          A: !0,
          SPAN: !0
        },
        k = g.fakeInput,
        m = g.fakeInputContainer = document.createElement("span"),
        d = g.fakeInputParent || k.parentNode;
      m.className = "fakeInputContainer";
      m.style.cssText = "position: relative; overflow: hidden; z-index: 0;";
      k.style.cssText && (m.style.cssText += k.style.cssText);
      l[k.nodeName] && (m.style.display = "inline-block");
      var p = !0,
        b = function() {
          p && (p = !1, g.fakeInputParent ? g.fakeInputParent.appendChild(m) :
            k.parentNode && k.parentNode.replaceChild(m, k), m.appendChild(k), m.appendChild(e));
          var a = sk.util.getMetrics(k),
            b = a.width,
            a = a.height;
          !l[k.nodeName] && (b && a) && (m.style.width = b + "px", m.style.height = a + "px");
          if (g.onInputReady) g.onInputReady()
        },
        d = sk.util.getMetrics(k),
        r = d.height;
      d.width || r ? window.setTimeout(b, 0) : window.setTimeout(b, 250)
    }
    this.initFileInput(e)
  };
  this.initFileInput = function(a) {
    a && (a.onchange = function(b) {
      if (a.files && a.files.length) h(b.target.files, b, function() {
        a.value = ""
      });
      else {
        var c = a.value,
          d = c.replace(/\\/g,
            "/").replace(/.*\//, "");
        h([{
          src: c,
          name: d
        }], b)
      }
    })
  };
  var f = document.createElement("form");
  f.style.cssText = "z-index: 999; background: rgba(0,200,0, 0.5); position: fixed; width: 100%; height: 100%; left: 0; top: 0; display: none; font-weight: bold; font-size: 2.5em; color: #fff; line-height: 1em; text-align: center; text-shadow: 0 0 15px #000;";
  f.id = "sk-uploader";
  this.createDropArea = function(a) {
    var b = !!a;
    a = a || this.dropAreaContainer;
    g.dropAreaStyle && (f.style.cssText += g.dropAreaStyle);
    f.innerHTML = g.dropAreaMessage;
    f.onclick = function() {
      f.style.display = "none"
    };
    f.ondragenter = function(a) {
      a.preventDefault();
      a.stopPropagation();
      return !1
    };
    f.ondragover = function(a) {
      a.preventDefault();
      a.stopPropagation();
      return !1
    };
    f.ondrop = function(a) {
      a.preventDefault();
      a.stopPropagation();
      f.style.display = "none";
      var b = a.dataTransfer;
      "undefined" !== typeof b && ("undefined" !== typeof b.items ? new p(b.items, function(b) {
        b.length && h(b, a)
      }) : "undefined" !== typeof b.files && (b = b.files, 0 !== b.length && h(b, a)))
    };
    f.ondragleave = function(a) {
      if (0 !== a.x || 0 !==
        a.y)
        for (var b = document.elementFromPoint(a.x, a.y); b !== document && b;) {
          if ("sk-uploader" === b.id) return;
          b = b.parentNode
        }
      a.preventDefault();
      a.stopPropagation();
      setTimeout(function() {
        f.style.display = "none"
      }, 100)
    };
    a === window && (a = document.body);
    b || a.appendChild(f);
    a.ondragenter = function(a) {
      a.dataTransfer && a.dataTransfer.files && r(a.dataTransfer.types, "Files") && setTimeout(function() {
        f.style.display = "table"
      }, 10)
    };
    a === document.body && (window.onresize = function(a) {
      window.innerWidth && window.innerHeight && (f.style.width =
        window.innerWidth + "px", f.style.height = window.innerHeight + "px")
    })()
  };
  var b = {
      length: 0
    },
    h = function(a, c, d) {
      if (g.onProgress) g.onProgress({
        transferPercent: 0
      }, c);
      var e = 0,
        f = function(a, b) {
          b.src && (b = [b]);
          for (var c in b) {
            var d = g.files[c],
              e = b[c];
            d.src = e.src;
            d.size = e.size;
            d.type = e.type;
            d.name = e.name
          }
          k()
        },
        l = {
          jpg: !0,
          jpeg: !0,
          gif: !0,
          png: !0
        },
        h = function(a) {
          var b = a.hash;
          if (a.type && !l[a.type.substr(6).toLowerCase()]) {
            var c = new FileReader;
            c.onload = function(a) {
              g.files[b].src = a.target.result;
              g.files[b].isRead = !0;
              return k()
            };
            c.readAsText(a)
          } else try {
            var d = (window.URL || window.webkitURL).createObjectURL(a);
            g.files[b].src = d;
            g.files[b].isRead = !0;
            return k()
          } catch (e) {
            try {
              c = new FileReader, c.onload = function(a) {
                g.files[b].src = a.target.result;
                g.files[b].isRead = !0;
                return k()
              }, c.readAsDataURL(a)
            } catch (h) {
              a.upload = new g.upload({
                file: a,
                onUpload: f
              })
            }
          }
        },
        k = function(a) {
          a ? m() : setTimeout(m, 30)
        },
        m = function() {
          if (g.onProgress) g.onProgress({
            transferPercent: 100 * (e / a.length) >> 0
          }, c);
          var l = a[e];
          if (++e > g.maxFiles || !l) {
            if (g.onLoad) g.onLoad();
            if (1 ===
              g.maxFiles) {
              if ("undefined" === typeof a[0]) {
                if (g.onError) g.onError(g, "UPLOAD_ERR_FORMAT");
                d && d();
                return
              }
              g.file = a[0];
              d && d();
              return g.onChange(g, c)
            }
            for (var m in g.files);
            d && d();
            return g.files[m] ? g.onChange(g, c) : void 0
          }
          m = l.name || l.fileName || "";
          var p = l.path || m,
            r = m.substr(m.lastIndexOf(".") + 1).toLowerCase(),
            u = g.createFileHash(l),
            z = g.files[u];
          if (z && (g.changedFiles[u] = z, g.changedFilesByName[m] = z, g.changedFilesByPath[p] = z, "upload" === g.mode && z.isUploaded || "read" === g.mode && z.isRead)) return k(!0);
          b[u] = b.length++;
          if (!g.formats[r]) {
            if (g.onError) g.onError(g, "UPLOAD_ERR_FORMAT");
            return k(!0)
          }
          r = l.fileSize || l.size;
          if (0 === r) {
            if (g.onError) g.onError(g, "UPLOAD_ERR_NO_FILE");
            return k(!0)
          }
          if (r && r > g.maxFileSize) {
            if (g.onError) g.onError(g, "UPLOAD_ERR_FORM_SIZE");
            return k(!0)
          }
          l.hash = u;
          g.files[u] = l;
          g.filesByName[m] = l;
          g.filesByPath[p] = l;
          g.changedFiles[u] = l;
          g.changedFilesByName[m] = l;
          g.changedFilesByPath[p] = l;
          if ("upload" === g.mode) l.upload = new g.upload({
            file: l,
            onUpload: f
          });
          else if ("read" === g.mode) h(l);
          else return k(!0)
        };
      g.changedFiles = {};
      g.changedFilesByName = {};
      g.changedFilesByPath = {};
      k()
    };
  this.createFileHash = function(a) {
    var b = {};
    b.name = a.name || a.fileName;
    b.src = a.src;
    b.size = a.size || a.fileSize;
    b.type = a.type;
    a = JSON.stringify(b);
    for (var b = 5381, c = 0, d = a.length; c < d; c++) var e = a.substr(c, 1).charCodeAt(),
      b = (b << 5) + b + e;
    return b
  };
  this.setLanguage = function(a) {
    for (var b in a) this.translation[b] = a[b]
  };
  this.translation = {
    UPLOAD_ERR_INI_SIZE: "The uploaded file exceeds the upload_max_filesize directive",
    UPLOAD_ERR_FORM_SIZE: "The uploaded file exceeds the MAX_FILE_SIZE directive",
    UPLOAD_ERR_PARTIAL: "The uploaded file was only partially uploaded",
    UPLOAD_ERR_NO_FILE: "No file was uploaded",
    UPLOAD_ERR_NO_TMP_DIR: "Missing a temporary folder",
    UPLOAD_ERR_CANT_WRITE: "Failed to write file to disk",
    UPLOAD_ERR_EXTENSION: "A PHP extension stopped the file upload",
    UPLOAD_ERR_FORMAT: "The uploaded file was an invalid format",
    UPLOAD_ERR_XHTTP: ""
  };
  this.upload = function(a) {
    this.onAbort = a.onAbort;
    this.onUpload = a.onUpload;
    this.onProgress = a.onProgress;
    this.action = a.action || g.action;
    this.confirm =
      a.confirm || g.confirm;
    this.files = 0 === String(a.file).indexOf("[object") ? [a.file] : a.files;
    this.bytes = this.timeLapse = this.timeRemaining = this.transferPercent = this.transferTotal = this.transferSpeed = 0;
    if (g.onUpload) g.onUpload(this);
    window.FormData ? e(this, a.onUpload) : m(this, a.onUpload)
  };
  var d = function(a, b) {
      var c = Object.prototype.toString.call(a);
      "[object Object]" === c && a.src && (c = "");
      switch (c) {
        case "[object Array]":
          for (var c = 0, d = a.length; c < d; c++) b(a[c]);
          break;
        case "[object Object]":
          for (d in a) b(a[d], d);
          break;
        default:
          b(a)
      }
    },
    e = function(a, b) {
      if ("[object Blob]" === String(a.files)) var c = a.files;
      else c = new FormData, d(a.files, function(a, b) {
        if ("undefined" !== typeof a.data) c.append(b || a.name || a.fileName, a.data);
        else if (a.src && "data:" === a.src.substr(0, 5)) {
          var d = JSON.stringify(a);
          c.append(b || a.name || a.fileName, d)
        } else c.append(b || a.hash, a)
      });
      var e = new XMLHttpRequest;
      e.upload.onprogress = function(b) {
        if (b.lengthComputable) {
          var c = b.loaded;
          a.transferPercent = Math.round(100 * c / b.total);
          a.transferTotal = k(c);
          var d = 2 * (c - a.bytes);
          0 !== d && (a.bytes = c, a.transferSpeed = k(d), a.timeRemaining = l((b.total - a.bytes) / d), a.timeLapse = l(Date.now() - b.timeStamp));
          if (a.onProgress) a.onProgress(a, b);
          else if (g.onProgress) g.onProgress(a, b)
        } else a.transferSpeed = 0, a.transferTotal = 0, a.transferPercent = 0, a.timeRemaining = 0
      };
      e.onload = function(c) {
        "[object Blob]" !== String(a.files) && d(a.files, function(a, b) {
          "undefined" === typeof a.date && (a.isUploaded = !0)
        });
        var e = c.target.responseText;
        if ("json" === a.confirm) try {
          e = JSON.parse(e)
        } catch (f) {
          console.log(c.target.responseText)
        }
        if (g.translation[e]) {
          if (g.onError) g.onError(g,
            e)
        } else {
          if (g.onLoad) g.onLoad(a, e);
          b && b(a, e)
        }
      };
      e.onerror = function(a) {
        if (g.onError) g.onError(g, "UPLOAD_ERR_XHTTP", a)
      };
      e.onabort = function(b) {
        if (g.onAbort) g.onAbort(a, "UPLOAD_ERR_XHTTP", b)
      };
      e.open("POST", a.action, !0);
      e.send(c)
    },
    m = function(a, b) {
      var c = document.createElement("form");
      document.body.appendChild(c);
      var e = document.createElement("iframe");
      e.setAttribute("id", "upload_iframe");
      e.setAttribute("name", "upload_iframe");
      e.setAttribute("width", "0");
      e.setAttribute("height", "0");
      e.setAttribute("border",
        "0");
      e.setAttribute("style", "width: 0; height: 0; border: none;");
      var f = function() {
        try {
          var f = e.contentDocument.body
        } catch (l) {
          try {
            f = e.contentWindow.document.body
          } catch (h) {
            f = e.document.body
          }
        }
        if (f.innerHTML) {
          d(a.files, function(a) {
            "undefined" === typeof a.date && (a.isUploaded = !0)
          });
          f = f.innerHTML;
          if ("json" === a.confirm) try {
            f = JSON.parse(f)
          } catch (k) {
            console.log && console.log(f)
          }
          if (g.translation[f]) {
            if (g.onError) g.onError(g, f)
          } else {
            if (g.onLoad) g.onLoad(a, f);
            b && b(a, f)
          }
        }
        setTimeout(function() {
          c.parentNode && c.parentNode.removeChild(c);
          g.fileInput.parent && g.fileInput.parent.appendChild(g.fileInput)
        }, 250)
      };
      e.addEventListener ? e.addEventListener("load", f, !0) : e.attachEvent && e.attachEvent("onload", f);
      c.appendChild(e);
      window.frames.upload_iframe.name = "upload_iframe";
      d(a.files, function(a, b) {
        if ("undefined" !== typeof a.data) {
          var d = document.createElement("input");
          d.type = "hidden";
          d.value = a.data;
          d.name = b || a.name || a.fileName
        } else a.src && "data:image/" === a.src.substr(0, 11) ? (d = document.createElement("input"), d.type = "hidden", d.value = JSON.stringify(a),
          d.name = b || a.name || a.fileName) : "string" === typeof a ? (d = document.createElement("input"), d.type = "hidden", d.value = a, d.name = b) : (d = g.fileInput, d.parent = d.parentNode, d.name = b || a.hash);
        c.appendChild(d)
      });
      c.setAttribute("target", "upload_iframe");
      c.setAttribute("action", a.action);
      c.setAttribute("method", "post");
      c.setAttribute("enctype", "multipart/form-data");
      c.setAttribute("encoding", "multipart/form-data");
      c.submit()
    },
    k = function(a) {
      return 1048576 < a ? Math.round(100 * a / 1048576) / 100 + "MB" : 1024 < a ? Math.round(a / 1024) +
        "KB" : a + "B"
    },
    l = function(a) {
      var b = a / 3600 >> 0,
        c = (a - 3600 * b) / 60 >> 0;
      a = a - 3600 * b - 60 * c;
      10 > b && (b = "0" + b);
      10 > c && (c = "0" + c);
      10 > a && (a = "0" + a);
      return b + ":" + c + ":" + a
    },
    r = function(a, b) {
      for (var c = a.length; c--;)
        if (a[c] === b) return !0;
      return !1
    },
    p = function(a, b, c) {
      c = isFinite(c) ? c : Infinity;
      var d = this;
      this.files = [];
      this.pending = 0;
      this.recurse = function(a, b, c) {
        this.pending++;
        if (!a) return d.runCallback();
        a.isFile ? a.file(function(a) {
          a.path = b + a.name;
          d.files.push(a);
          d.runCallback()
        }) : a.isDirectory && a.createReader().readEntries(function(e) {
          for (var f =
              0; f < e.length; f++) d.recurse(e[f], b + a.name + "/", c + 1);
          d.runCallback()
        })
      };
      this.runCallback = function() {
        --this.pending || b(this.files)
      };
      for (c = 0; c < a.length; c++)
        if (a[c].webkitGetAsEntry) {
          var e = a[c].webkitGetAsEntry();
          this.recurse(e, "", 0)
        }
      return this
    };
  this.dropAreaContainer && this.createDropArea();
  (this.fakeInput || this.fileInput) && this.createFileInput();
  return this
};
"undefined" === typeof zIndexGlobal && (zIndexGlobal = 1E3);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  var g = a.windows = [];
  g.focused = [];
  var c = g.idToIndex = {};
  g.add = function(b, f, d, e) {
    var m = b.id;
    f = document.querySelector("#" + m);
    if ("undefined" === typeof f) return console.log("element does not exist"), this;
    if (isFinite(c[m])) return console.log("element already exists"), this;
    if (m) "px" === b.format && (b.x = b.left, b.y = b.top, b.left /= window.innerWidth, b.top /= window.innerHeight);
    else {
      for (var k in b) f = b[k], f.id = k, g.add(f);
      return g.restore()
    }
    e = b.display;
    k = (b.position || "top left").split(" ");
    !0 === e && (e = "block");
    !1 === e && (e = "none");
    b.vAlign = k[0] || "top";
    b.hAlign = k[1] || "left";
    b.element = f;
    if (b.autoclose) {
      var l = b.ghost = document.createElement("div");
      l.id = m + "-ghost";
      l.style.cssText = "width: 100%; height: 100%; position: fixed; top: 0; z-index: 100;";
      f.parentNode.insertBefore(l, f);
      eventjs.add({
        target: l,
        mousemove: function(b) {
          "eyeDropper" === a.colorPicker.state && a.colorPicker.mouseLayerUpdate(b)
        },
        mousedown: function(b, c) {
          "eyeDropper" === a.colorPicker.state ? a.colorPicker.mouseLayerExit(b) : g.close(m)
        }
      })
    }
    c[m] = g.length;
    g.push(b);
    a.getItem(m, function(c) {
      c && (c = JSON.parse(c), "boolean" === typeof e && e ? c.display = "block" : e && (c.display = e), "NONE" === b.display && (c.display = "none"), "BLOCK" === b.display && (c.display = "block"), b.autoclose && (l.style.display = c.display), a.util.mergeObject(c, b))
    });
    return this
  };
  g.setCurrentTab = function(a, c) {
    a && c && (dom.setClass({
      className: "selected",
      list: "div",
      target: document.querySelector("#" + a + " " + c)
    }), g.record({
      id: a,
      className: c
    }))
  };
  g.byId = function(a) {
    a = c[a];
    return "undefined" === typeof a ? !1 : g[a]
  };
  g.record = function(b) {
    var c =
      g.byId(b.id);
    if (c) {
      "undefined" !== typeof b.x && (c.x = b.x);
      "undefined" !== typeof b.y && (c.y = b.y);
      "undefined" !== typeof b.left && (c.left = b.left);
      "undefined" !== typeof b.top && (c.top = b.top);
      "undefined" !== typeof b.display && (c.display = b.display);
      "undefined" !== typeof b.index && (c.index = b.index);
      "undefined" !== typeof b.className && (c.className = b.className);
      var d = JSON.stringify(c, a.util.json.filterCircular);
      a.setItem(b.id, d);
      g.focusElement(b.id, c.display)
    }
  };
  g.restore = function() {
    var a = document.documentElement.scrollTop,
      c = document.documentElement.scrollLeft,
      d = window.innerWidth,
      e = window.innerHeight;
    f.element && g.setContainer(f.element);
    for (var m = [], k = {}, l = 0; l < g.length; l++) {
      var r = g[l],
        p = r.vAlign,
        q = r.hAlign,
        t = document.getElementById(r.id);
      if (t && t.style) {
        t.style.display = "block";
        var t = sk.util.getMetrics(t),
          s = f[p || "top"],
          w = f[q || "left"];
        r.objectBoundingBox && (r.x = 0.5 * d - t.width / 2, r.y = 0.5 * e - t.height / 2 + 20);
        var s = (isFinite(r.y) ? r.y : r.top * e) + s,
          r = (isFinite(r.x) ? r.x : r.left * d) + w,
          s = s + a,
          r = r + c,
          w = Math.min(s, e),
          v = Math.min(r, d);
        k.BOTTOM =
          s + t.height - e;
        k.TOP = w - s;
        k.RIGHT = r + t.width - d;
        k.LEFT = v - r;
        k[p] = Math.max(k[p] || 0, k[p.toUpperCase()]);
        k[q] = Math.max(k[q] || 0, k[q.toUpperCase()]);
        s -= Math.max(0, k.BOTTOM);
        r -= Math.max(0, k.RIGHT);
        m.push({
          top: Math.max(f.y, s),
          left: Math.max(f.x, r)
        })
      }
    }
    a = 100;
    for (l = 0; l < g.length; l++) r = g[l], r.display && !0 !== r.display || (r.display = "block"), (t = document.getElementById(r.id)) && t.style && (d = m[l], c = "bottom" === r.vAlign ? d.top - k.bottom : d.top + k.top, d = "right" === r.hAlign ? d.left - k.right : d.left + k.left, c = Math.ceil(c), d = Math.ceil(d),
      t.style.top = c + "px", t.style.left = d + "px", t.style.display = r.display || "block", t.style.zIndex = r.zIndexFixed || r.index || ++a, zIndexGlobal = Math.max(zIndexGlobal, r.index || 0), "block" === r.display && -1 === t.className.indexOf("opened") && (t.className += " opened"));
    return this
  };
  g.blink = function(a, c) {
    var d = document.getElementById(a);
    if (d)
      if (g.isOpen(d) || g.open(a), setTimeout(function() {
          d.blinking = !1
        }, 250), d.blinking) c && c(!0);
      else return d.blinking = !0, d.className = (" " + d.className + " ").split(" blink ").join(" blink-stall ").trim(),
        setTimeout(function() {
          d.className = (" " + d.className + " ").split(" blink-stall ").join(" ").trim(); - 1 === d.className.indexOf("opened") ? g.open(a) : d.className += " blink";
          c && c(!0)
        }, 0), this
  };
  g.open = function(a, c) {
    c = !1 !== c;
    var d = document.getElementById(a);
    if (d) {
      var e = d.className;
      if (-1 !== e.indexOf("sk-window")) {
        -1 === (" " + e + " ").indexOf(" opened ") && (d.className = (e + " opened").trim());
        var e = g.byId(a),
          f = e.zIndexFixed ? e.zIndexFixed : ++zIndexGlobal;
        d.style.display = "block";
        d.style.zIndex = f;
        d.style.opacity = 1;
        clearTimeout(d.interval);
        g.record({
          id: a,
          display: "block",
          index: f
        });
        e.autoclose && (e.ghost.style.display = "block");
        c && setTimeout(g.restore, 500);
        return this
      }
    }
  };
  g.close = function(a) {
    var c = g.byId(a),
      d = document.getElementById(a);
    d.style.opacity = 0;
    d.className = (" " + d.className + " ").split(" opened ").join(" ").trim();
    d.interval = setTimeout(function() {
      d.style.opacity = 1;
      d.style.display = "none";
      g.record({
        id: a,
        display: "none"
      })
    }, 250);
    c.autoclose && (c.ghost.style.display = "none");
    return this
  };
  g.focus = function(a) {
    var c = document.getElementById(a);
    if (c) {
      var d = g.byId(a),
        d = d.zIndexFixed ? d.zIndexFixed : ++zIndexGlobal;
      c.style.zIndex = d;
      g.record({
        id: a,
        index: d
      });
      return this
    }
  };
  g.clearFocus = function() {
    g.focused = []
  };
  g.focusElement = function(a, c) {
    if ("none" !== c) {
      var d = g.focused.slice(-1)[0],
        e = " " + g.focused.join(" ") + " ";
      d !== a && -1 === e.indexOf(a) && g.focused.push(a)
    }
  };
  g.hasFocus = function() {
    return !!c[g.focused.slice(-1)[0]]
  };
  g.closeFocused = function() {
    var a = g.focused.pop();
    g.close(a)
  };
  g.isOpen = function(a) {
    "string" === typeof a && (-1 === a.indexOf("#") && (a = "#" + a),
      a = document.querySelector(a));
    if (a) return "none" === a.style.display ? !1 : -1 !== (" " + a.className + " ").indexOf(" opened ")
  };
  g.isClosed = function(a) {
    return !g.isOpen(a)
  };
  g.toggle = function(a, c) {
    var d, e = document.getElementById(a);
    if (!e) return console.log("missing", arguments);
    g.isOpen(e) ? (g.close(a), d = !1) : (g.open(a), g.restore(), d = !0);
    c && setTimeout(function() {
      c(d)
    }, 1)
  };
  var f = {
    x: 0,
    y: 0,
    left: 0,
    right: 0,
    top: 0,
    bottom: 0,
    vAlign: "top",
    hAlign: "left"
  };
  g.setClamp = function(a, c, d, e, m) {
    "object" === typeof a && (a.element && g.setContainer(a.element),
      m = a.format, e = a.height, d = a.width, c = a.y, a = a.x);
    f.x = a || null;
    f.y = c || null;
    f.width = d || null;
    f.height = e || null;
    f.format = m
  };
  g.setContainer = function(a) {
    var c = sk.util.getMetrics(a);
    f.element = a;
    f.metrics = c;
    f.left = c.x1;
    f.right = c.x2;
    f.top = c.y1;
    f.bottom = c.y2
  };
  g.drag = function(a, c) {
    var d = document.documentElement.scrollTop,
      e = document.documentElement.scrollLeft;
    return eventjs.proxy.drag({
      event: c,
      target: a,
      position: "move",
      listener: function(c, h) {
        eventjs.cancel(c);
        var l = sk.util.getMetrics(h.target),
          r = l.border[0],
          p = l.border[2];
        h.target.state = h.state;
        h.width = l.width;
        h.height = l.height;
        var l = f.x || 0,
          q = f.y || 0,
          t = f.width || window.innerWidth,
          s = f.height || window.innerHeight;
        h.x + h.width > t && (h.x = t - h.width);
        h.x < l && (h.x = l);
        h.y + h.height > s && (h.y = s - h.height);
        h.y < q && (h.y = q);
        h.target.moved = !0;
        a.style.left = Math.ceil(h.x - r) + "px";
        a.style.top = Math.ceil(h.y - p) + "px";
        q = g.byId(a.id);
        "down" === h.state ? (r = q.zIndexFixed ? q.zIndexFixed : ++zIndexGlobal, a.style.zIndex = r) : "up" === h.state && (l = "bottom" === q.vAlign ? h.y - f.bottom : h.y - f.top - d, q = "right" === q.hAlign ?
          h.x - f.right : h.x - f.left - e, g.record({
            id: a.id,
            x: q - r,
            y: l - p,
            left: q / window.innerWidth,
            top: l / window.innerHeight,
            index: zIndexGlobal
          }), g.restore())
      }
    })
  };
  g.write = function(a) {
    g.createWindow(a);
    (a = document.querySelector("#sketch-help .content")) && eventjs.proxy.wheelPreventElasticBounce(a);
    g.restore()
  };
  g.createWindow = function(b, c) {
    var d = document.querySelector("#avgrund-" + b);
    if (d || c) {
      var e = "sketch-" + b,
        f = document.querySelector("#" + e);
      if (f) g.toggle(e);
      else {
        f = document.createElement("div");
        f.className = "sk-window";
        f.id =
          e;
        var k = document.createElement("div");
        k.className = "sk-header";
        var l = document.createElement("div");
        l.className = "sk-header-text sk-" + b + "-header";
        var r = document.createElement("span");
        r.className = "sk-close icon-close";
        var p = document.createElement("div");
        p.className = "content";
        eventjs.add(p, "mousedown", eventjs.stop);
        k.appendChild(l);
        k.appendChild(r);
        f.appendChild(k);
        f.appendChild(p);
        document.querySelector(".sketchapi .sk-viewport").appendChild(f);
        g.add({
          id: e,
          left: 0,
          top: 0,
          display: !0
        });
        g.record({
          id: e,
          left: 0.5 -
            f.offsetWidth / window.innerWidth,
          top: 0.1,
          index: ++zIndexGlobal
        });
        g.addWindowEvent(f);
        g.lazyloader("#avgrund-" + b + " .lazy");
        p = f.querySelector(".content");
        p.innerHTML = c || d && d.innerHTML;
        eventjs.proxy.wheelPreventElasticBounce(p);
        l = f.querySelector(".sk-" + b + "-header");
        (e = document.getElementById("avgrund-" + b + "-tabs")) ? (dom.removeChildNodes(l), l.appendChild(e.cloneNode(!0))) : (b = STRING.ucwords(b), "About" === b && (b = "about-version"), l.innerHTML = "<span>" + a.language.translate(b) + "</span>");
        e = Math.min(420, 0.75 * window.innerWidth) +
          "px";
        l = Math.min(500, Math.round(0.75 * window.innerHeight)) + "px";
        f.style.width = e;
        p.style.width = "100%";
        p.style.maxHeight = l;
        f.querySelector("input") && a.uploader.initFileInput(f.querySelector("input"));
        g.restore()
      }
    } else if (d = document.querySelector("#sketch-file ." + b)) {
      var f = document.querySelector("#sketch-file"),
        p = f.querySelectorAll(".data"),
        l = b.split("-"),
        e = l[0],
        l = l[1];
      l || (b = f.getAttribute("data-" + e) || e + "-computer", l = b.split("-")[1]);
      f.setAttribute("data-" + e, b);
      if (d = f.querySelector(".tabs .selected")) d.className =
        (" " + d.className + " ").replace(" selected ", "");
      f.querySelector(".tab-" + e).className += " selected";
      if (d = f.querySelector(".leftBar .selected.option")) d.className = (" " + d.className + " ").replace(" selected ", "");
      if (l) {
        if (d = f.querySelector(".leftBar .link-" + b)) d.className += " selected";
        f.className = ((" " + f.className + " ").replace(" subcontent ", "") + " subcontent").trim()
      } else f.className = (" " + f.className + " ").replace(" subcontent ", "").trim();
      d = f.querySelectorAll(".leftBar .text");
      for (k = 0; k < d.length; k++) d[k].style.display =
        l ? "none" : "inline-block";
      for (k = 0; k < p.length; k++) p[k].style.display = "none";
      (p = f.querySelector("." + e + " .innerContent")) && l && (l = f.querySelector("." + b), l.style.display = "block", p.appendChild(l));
      f.querySelector("." + e).style.display = "block";
      p && (f.style.minHeight = "230px");
      a.loader.stop();
      a.uploader.createFileInput(document.querySelector(".sk-window .file-input"))
    }
  };
  g.addWindowEvent = function(b) {
    var c, d = b.id;
    eventjs.add({
      target: b,
      contextmenu: function(a) {
        c && c.remove && c.remove()
      },
      mousedown: function(a) {
        c = g.drag(this,
          a)
      },
      mouseover: function(a) {
        eventjs.stop(a);
        sk.setTooltip("")
      }
    });
    "sk-canvas" === d && eventjs.add(b, "dbltap", function(a) {
      b.className = ""
    });
    "sketch-tools" !== d && ((d = b.querySelector("span.sk-close")) && eventjs.add({
      target: d,
      mousedown: eventjs.stop,
      click: function(a, b) {
        eventjs.cancel(a);
        window.setTimeout(function() {
          g.close(b.target.parentNode.parentNode.id)
        }, 1)
      }
    }), a.util.each(b.querySelectorAll(".tree"), function(a) {
      eventjs.add(a, "click", function(a, b) {
        g.setCurrentTab("sk-open", ".start")
      })
    }))
  };
  g.lazyloader = function(a) {
    a =
      document.querySelectorAll(a);
    for (var c = 0; c < a.length; c++) {
      var d = a[c];
      d.src = d.getAttribute("data-src");
      d.className = (" " + d.className + " ").replace(" lazy ", " ").trim()
    }
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.ui && (sketch.ui = {});
(function(a) {
  a.ui.images = {};
  a.ui.images.transparent = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII=";
  var g = /[^0-9]/gi,
    c = function(b, c, d) {
      c = document.createElement("div");
      c.className = "sketch-file-picker";
      c.innerHTML = "Load your own image";
      a.ui.addLineBreak(b);
      b.appendChild(c);
      a.util.uploader.createFileInput(c)
    },
    f = function(b, c, d, e) {
      var f = d.getValue();
      if ("undefined" !== typeof f) {
        f = f.length ? f : [f];
        "Spacing" === e && (f = [f[0]]);
        a.ui.addLineBreak(b);
        var l = document.createElement("div");
        l.className = "sk-slider";
        b.appendChild(l);
        var h = document.createElement("span");
        h.className = "sk-title";
        l.appendChild(h);
        eventjs.add([l, h, b], "mousedown", eventjs.cancel);
        b = (b = e.match(/[A-Za-z0-9]*/g)) ? b.join(" ") : e;
        if (a.language.translate(b)) {
          h.setAttribute("data-cmd", b);
          h.innerHTML = a.language.translate(b).match(STRING.rxSplitByUppercase).join(" ").trim();
          e = document.createElement("span");
          e.className = "values";
          l.appendChild(e);
          for (b = 0; b < f.length; b++) {
            var k = document.createElement("input");
            k.className = "value" + b;
            k.value = f[b];
            eventjs.add(k, "mousedown", eventjs.stop);
            eventjs.add(k, "keydown keyup change", function(a) {
              eventjs.stop(a);
              a = this.value.replace(g, "");
              var b = parseInt(this.className.substr(5)),
                c = m.thumbs[b];
              a = Math.max(m.min, Math.min(m.max, a));
              c.value !== a && (c.value = a, m.update(b))
            });
            e.appendChild(k);
            f[b + 1] && (k = document.createElement("small"), k.innerHTML = "/", e.appendChild(k))
          }
          var m = new widget.Range({
            parent: l,
            min: d.clamp.min,
            max: d.clamp.max,
            format: d.format,
            gradient: d.gradient,
            value: f.toString(),
            className: "sk-range",
            onchange: function(b, e) {
              a.area && a.area.inGenesis && a.area.exitGenesis();
              b.element.parentNode.querySelector(".value" + e.index).value = 10 < d.clamp.max ? Math.round(e.value) : Math.round(10 * e.value) / 10;
              if ("load" !== b.state && (!a.selection || 0 !== a.selection.length || "end" === b.state)) {
                var f = h.getAttribute("data-cmd"),
                  f = (f[0].toLowerCase() + f.substr(1)).replace(" ", "");
                a.toolkit.setParam({
                  tool: c.type,
                  cacheObject: b,
                  param: f,
                  thumbs: b.thumbs
                })
              }
            }
          });
          return m
        }
        a.feature.debug && console.log("range:", b, "disabled")
      }
    },
    b = function(b) {
      if (a.scene && a.scene.data) {
        var c = a.scene.data[a.selection.idx],
          d = c ? c.toolkit : {},
          e;
        for (e in a.ui.ranges) {
          var f = a.ui.ranges[e];
          if (!f) {
            a.feature.debug && console.log("disabled", e);
            break
          }
          var l = void 0;
          c && (l = c[e]);
          "undefined" === typeof l && d.device && (l = d.device.brush ? d.device.brush[e] : d.device[e]);
          "undefined" === typeof l && (l = a.scene.fromConfigure(a.configure.tools[b][e]));
          if ("undefined" !== typeof l)
            if (l = "undefined" !== typeof l.max ? [l.min, l.max] : l, 2 === f.thumbs.length) {
              if (f.thumbs[0].value !== l[0] ||
                f.thumbs[1].value !== l[1]) f.thumbs[0].value = l[0], f.thumbs[1].value = l[1], f.update(0, "load"), f.update(1, "load")
            } else l = l[0] || l, f.thumbs[0].value !== l && (f.thumbs[0].value = l, f.update(0, "load"))
        }
      }
    };
  a.ui.buildSelect = function(b) {
    var c = document.createElement("select");
    c.id = "select-" + STRING.replaceAll(b.label, " ", "");
    eventjs.add(c, "mousedown", function(b) {
      a.windows.focus("sk-configure");
      eventjs.stop(b)
    });
    eventjs.add(c, "change", b.onchange);
    b.element.appendChild(c);
    var d = document.createElement("optgroup");
    d.label =
      b.label;
    for (var e in b.data) {
      var f = document.createElement("option");
      b.selected === e && (f.selected = "selected");
      f.value = b.data[e];
      f.setAttribute("data-cmd", e);
      if (b.ucwords) {
        var l = STRING.splitByUpperCase(e).join(" "),
          l = STRING.ucwords(l.replace("regular", ""));
        f.innerHTML = a.language.translate(l)
      } else f.innerHTML = a.language.translate(e);
      d.appendChild(f)
    }
    b.style && (c.style.cssText = b.style);
    c.appendChild(d);
    c.getValue = function() {
      var a = c.options[c.selectedIndex];
      return a && a.value
    };
    return c
  };
  a.ui.buildConfigure =
    function(c, d, f) {
      f = a.perf();
      var g = document.getElementById("sk-configure");
      if (g) {
        if (g) {
          if (0 === g.offsetWidth) return;
          "block" !== g.style.display && g.__skBuildRequest || (g.__skBuildRequest = !0)
        } else if (!d) return;
        setTimeout(a.windows.restore, 1);
        "undefined" === typeof g.__skBuilt && (g.__skBuilt = !0);
        if ((c = c || a.tool.type) || d) {
          a.ui.buildConfigure.type = c;
          var m = g.getAttribute("type");
          g.setAttribute("type", c);
          if (c === m && !d) return b(c);
          k();
          (m = document.querySelector("#sk-configure .sk-configure-submenu")) && dom.removeChildNodes(m);
          (d = document.querySelector("#sk-configure .sk-configure-header")) && dom.removeChildNodes(d);
          var p = a.scene && a.scene.data[a.selection.idx] || a.configure.tools[c];
          p && (c = p.type);
          var r = g.querySelector(".sk-configure-content");
          g.querySelector(".sk-configure-scroller").style.display = "none";
          if (a.detect.noConfigure[c]) dom.removeChildNodes(r), d && (f = document.createElement("span"), f.textContent = STRING.ucwords(c || ""), d.appendChild(f)), "select" === c && a.ui.buildConfigureOptions(c);
          else if (g = a.feature.tools.image.filter, (r = "image" === c) && !g && (c = "clipart"), a.ui.buildConfigureOptions(c), a.scene && a.scene.data) {
            if (d || m) {
              var q = a.feature.ui.mediaSelect && a.lib[c],
                s = a.toolkit.getToolCategory(c);
              if (s) {
                var t = c.replace("_", " "),
                  F = a.toolkit.__icons[s];
                a.ui.buildSelect({
                  label: STRING.ucwords(s.replace("_", " ")),
                  element: d || m,
                  selected: t,
                  data: F.children,
                  ucwords: !0,
                  onchange: function() {
                    var b = this.options[this.selectedIndex].getAttribute("data-cmd").replace(" ", "_");
                    a.toolkit.setType(b);
                    a.style.setBlendMode(null)
                  }
                })
              } else if (q && (g && !r ||
                  !g)) {
                var s = q.tree,
                  C = p.src || "",
                  E = 0,
                  H;
                for (H in s) ++E;
                t = p.fontFamily ? (p = a.lib.text.byName[p.fontFamily]) && p.category || q.defaultCategory || H : a.ui.detectFolder(c, C) || q.defaultCategory || H;
                H = t;
                p = {};
                q = h[c];
                1 < E && (p["all " + q] = "everything");
                for (F in s) "yourFiles" === F && "yourFiles" === t ? (H = "your " + q, p["your " + q] = F) : p[F] = F;
                a.ui.buildSelect({
                  label: STRING.ucwords(q),
                  element: d || m,
                  selected: H,
                  data: p,
                  ucwords: !0,
                  onchange: function() {
                    var a = this.options[this.selectedIndex].value;
                    e(c, t, a);
                    l(c, a)
                  }
                })
              } else t = "", H = STRING.ucwords(c.replace("gl_",
                "")).match(/[A-Z][a-z]+/g).join(" "), d && (d.innerHTML = "<span>" + a.language.translate(H) + "<span>")
            }(g && !r || !g) && e(c, t, t);
            a.feature.debug && console.log("configure", c, f())
          } else d && (f = STRING.ucwords(c.replace("gl_", "").replace(/([A-Z])/g, " $1")), d.innerHTML = "<span>" + f + "</span>")
        }
      }
    };
  var h = {
      text: "fonts",
      stamp: "stamps",
      clipart: "clipart"
    },
    d;
  a.ui.scrollers = {};
  var e = function(b, c, e) {
      var f = a.lib[b];
      if (f && f.paths) {
        d && d.hide();
        var l = a.ui.scrollers;
        l[b] ? l[b].length !== f.paths.length ? l[b] = new m(b, c, e) : l[b].show(c, e) :
          l[b] = new m(b, c, e);
        d = l[b]
      }
    },
    m = function(b, c, d) {
      var e = this;
      this.type = b;
      this.library = c;
      this.folder = d;
      this.media;
      this.element;
      this.hide = function() {
        this.container.style.display = "none";
        this.content.style.display = "none"
      };
      this.show = function(b, c) {
        var d = function(a, b) {
          b.onerror = function() {
            console.log(a.type)
          }
        };
        e.container.style.display = "block";
        e.content.style.display = "block";
        e.library = b || e.library;
        e.folder = c || e.folder;
        var f = a.lib[e.type];
        if (f && f.paths) {
          e.updateSize(e.type, f);
          var l = 0,
            g = f.paths,
            h = e.overflow;
          c =
            e.folder;
          for (var k = 0; k < g.length; k++) {
            var m = g[k],
              p = m.thumbnail,
              r = m.image,
              q = r.canvas,
              s = m.filepath,
              t = !c || "everything" === c,
              u = m.folder === c;
            "yourFiles" === c && 0 === s.indexOf("#") || u || t ? (++l <= h && (r.src = p, d(m, r), "stamp" !== m.type && "text" !== m.type || a.ui.sourceAtop(q)), q.style.display = "block") : q.style.display = "none"
          }
          d = document.querySelector(".noItemsAdded");
          0 === l ? (a.feature.debug && console.log(f.tree, c), d || (d = document.createElement("div"), d.className = "noItemsAdded", d.textContent = "No items added", e.content.appendChild(d)),
            d.style.display = "block") : d && (d.style.display = "none")
        }
      };
      this.updateSize = function(b, c) {
        var d = this.container,
          e = d.style;
        e.display = "block";
        e.overflowY = "hidden";
        var f = d.offsetWidth;
        e.overflowY = "scroll";
        f = 2 * (f - d.offsetWidth || 10);
        e.overflowY = "auto";
        var l = d.offsetWidth - f,
          d = c.thumbnail,
          e = d._height / d._width,
          f = isFinite(d.rows) ? d.rows : 5,
          g = isFinite(d.columns) ? d.columns : 4,
          h = isFinite(d.padding) ? d.padding : 0,
          l = l / g >> 0,
          d = a.util.mergeObject(d, {
            width: l,
            height: l * e,
            padding: h,
            columns: g,
            rows: f
          });
        this.maxHeight = (d.height + 2 *
          d.padding) * d.rows;
        this.overflow = d.columns * (d.rows + 1);
        this.divider = d.columns;
        this.container.style.cssText += "max-height: " + this.maxHeight + "px;";
        return d
      };
      this.construct = function(b, c, d) {
        var e = a.lib[b];
        if (e && e.paths) {
          e.thumbnail = e.thumbnail || {};
          var f = document.querySelector("#sk-configure .sk-configure-scroller"),
            g = document.createElement("div");
          f.appendChild(g);
          this.container = f;
          l(b, c);
          var h = this.updateSize(b, e),
            k = this.overflow,
            m = this.divider;
          eventjs.proxy.wheelPreventElasticBounce(f);
          eventjs.add(f, "scroll",
            this.onScroll);
          g.onscroll = this.onScroll;
          var p = a.scene.data[a.selection.idx];
          p || (p = a.configure.tools[b]);
          for (var q = r(p), s = !1, t = e.paths, u = a.canvas2d.pixelRatio, w = 0; w < t.length; w++) {
            var v = t[w],
              y = v.image || document.createElement("img"),
              K = y.canvas || document.createElement("canvas");
            "text" === b ? v.name === p.fontFamily && (s = K) : v.filepath === q && (s = K);
            var R = h.width,
              S = h.height;
            K.style.width = R + "px";
            K.style.height = S + "px";
            y.canvas || (K.width = R * u, K.height = S * u, K.className = b, K.setAttribute("data-type", v.type), K.setAttribute("data-src",
                v.filepath), K.setAttribute("data-name", v.name), K.setAttribute("data-thumbnail", v.thumbnail), K.setAttribute("data-n", w), K.style.padding = h.padding + "px", K.title = v.filename, "clipart" !== v.type && "image" !== v.type || !a.feature.placement.mediaDrag ? eventjs.add(K, "mousedown", eventjs.stop) : eventjs.add(K, "mousedown", function(b) {
                eventjs.stop(b);
                a.feature.vector.edit || a.scene.deselectAll();
                var c = this.getAttribute("data-src");
                this.drag = a.toolkit.addFromDrag({
                  target: this,
                  event: b,
                  src: c
                })
              }), eventjs.add(K, "click", this.onClick),
              y.canvas = K, y.onload = function() {
                var c = this;
                setTimeout(function() {
                  a.util.thumbnailer({
                    src: c,
                    canvas: c.canvas,
                    width: c.width,
                    height: c.height,
                    croparea: !1,
                    onload: function(c) {
                      "stamp" !== b && "text" !== b || a.ui.sourceAtop(c)
                    }
                  })
                }, 1)
              });
            g.appendChild(K);
            v.image = y;
            v.canvas = K;
            s && dom.setClass({
              className: "selected",
              list: s.parentNode.querySelectorAll("." + b),
              target: s,
              on: !0
            })
          }
          this.media = e;
          this.length = e.paths.length;
          this.type = b;
          this.library = c;
          this.folder = d;
          this.divider = m;
          this.overflow = k;
          this.content = g;
          this.container = f;
          this.show();
          f.scrollTop = s ? s.offsetTop : 0
        }
      };
      this.onDblClick = function(b, c) {
        a.sidebar && a.sidebar.close()
      };
      this.onClick = function(b, c) {
        var d = c.target,
          e = d.getAttribute("data-src").split("/"),
          f = d.getAttribute("data-type");
        l(f, e[e.length - 2]);
        d.drag && (d.drag.remove(), (e = document.querySelector("#addFromDrag")) && e.parentNode.removeChild(e));
        "select" === a.tool.type && a.selection.length || "text" === f || "stamp" === f ? a.ui.changeMediaFromElement(d) : (a.scene.deselectAll(), a.ui.changeMediaFromElement(d), a.feature.placement.mediaClick &&
          a.addObject({
            type: f,
            src: d.getAttribute("data-src")
          }))
      };
      this.onScroll = function(a) {
        a = e.content;
        var b = e.container,
          c = e.media,
          d = e.folder,
          f = e.divider,
          l = e.overflow;
        window.clearTimeout(a.timeout);
        a.timeout = setTimeout(function() {
          for (var a = [], e = c.paths, g = 0; g < e.length; g++) {
            var h = e[g],
              k = !d || "everything" === d,
              m = h.folder === d;
            ("yourFiles" === d && "#" === h.filepath[0] || m || k) && a.push(h)
          }
          e = 0;
          k = a.length;
          m = Math.floor(b.scrollTop / b.scrollHeight * k / f) * f;
          for (g = 0; g < k; g++) h = a[g], ++e <= l + m && e > m && (h && h.image && !h.image.src) && (h.image.src =
            h.canvas.getAttribute("data-thumbnail"))
        }, 100)
      };
      return this.construct(b, c, d)
    };
  a.ui.detectFolder = function(b, c, d) {
    var e = a.lib[b];
    if (e) {
      b = e.tree;
      c = c.replace(e.path + "/", "");
      if (d) return d[c];
      for (var f in b)
        if (d = b[f], d[c]) return f
    }
  };
  var k = function() {
      var a = document.querySelector(".sk-configure-credits");
      if (a) return dom.removeChildNodes(a), a.style.display = "none", a
    },
    l = function(b, c) {
      var d = k(),
        e = a.lib[b].credits;
      if (e && e[c]) {
        d.style.display = "block";
        var e = e[c],
          f = document.createElement("a");
        f.href = e.url;
        f.target =
          "_blank";
        f.className = "roll";
        var l = document.createElement("span");
        l.setAttribute("data-title", e.name);
        l.innerHTML = e.name;
        f.appendChild(l);
        d.appendChild(document.createTextNode("By: "));
        d.appendChild(f)
      }
    },
    r = function(b) {
      if (!b) return "";
      var c = a.detect.srcRequired;
      if (c[b.type]) {
        var d = b.type,
          e = a.tool.type;
        !b.src && a.lib[d] && (b.src = a.lib[d].paths[0].path);
        c[e] && d !== e && a.toolkit.setTool(d);
        return b.src
      }
      if (b.fontFamily) return a.loc.MEDIA + "font/" + b.fontFamily + ".png"
    };
  a.ui.setToolMenu = function(b, c) {
    var d, e = a.toolkit.getToolCategory(b);
    "brushes" === e ? d = document.querySelector(".sk-brush-menu") : "shapes" === e && (d = document.querySelector(".sk-shape-menu"));
    if ((d = d || document.getElementById("tool-" + b) || document.querySelector("." + e)) && d.parentNode) {
      if ((e = a.toolkit.__icons[e]) && e.children && (e = e.children[b.replace("_", " ")], !0 !== e))
        if (d.id = "tool-" + b, d.title = STRING.ucwords(b), 0 === e.indexOf("icon-")) {
          var f = d.querySelector("img");
          f && (f.src = a.ui.images.transparent);
          if (f = d.querySelector(".sk-icon")) {
            for (var l = "", g = f.className.split(" "), h = 0; h < g.length; h++) 0 !==
              g[h].indexOf("icon-") && (l += " " + g[h]);
            f.className = l + " " + e
          }
        } else d.querySelector("img").src = e;
      c || dom.setClass({
        className: "selected",
        list: a.$$(".sketchapi .sk-toolset .selected"),
        target: d,
        on: !0
      })
    }
  };
  a.ui.setCursor = function(b) {
    if (!a.feature.debug) {
      var c = a.feature.cursorCSS,
        d = a.tool;
      a.active.canvas.style.cursor = b ? b : c && c[d.type] ? c[d.type] : ""
    }
  };
  a.ui.addLineBreak = function(a) {
    var b = document.createElement("div");
    b.className = "sk-break";
    a.appendChild(b)
  };
  a.ui.addClick = function(a, b, c) {
    if (a = "string" === typeof b ?
      a.querySelector(b) : b) eventjs.add(a, "click", c), eventjs.add(a, "mousedown", eventjs.stop)
  };
  a.ui.forQuery = function(a, b, c) {
    a = a.querySelectorAll(b);
    for (b = 0; b < a.length; b++) c(a[b])
  };
  a.ui.sourceAtop = function(b) {
    var c = b.className || "";
    c.indexOf("selected");
    var d = b.getContext("2d");
    d.globalCompositeOperation = "source-atop";
    d.fillStyle = a.feature.ui.sourceAtopColor;
    d.fillRect(0, 0, b.width, b.height);
    b.setAttribute("data-className", c)
  };
  a.ui.changeMediaFromElement = function(b) {
    var c = b.getAttribute("data-type"),
      d = b.getAttribute("data-src"),
      e = b.getAttribute("data-name");
    a.toolkit.setMedia({
      src: d,
      fontFamily: e,
      type: c,
      onload: function() {
        a.render.dirtyControls = !0
      }
    });
    if (b.parentNode && b.parentNode.querySelector(".selected")) {
      if ("stamp" === c || "text" === c) a.ui.sourceAtop(b.parentNode.querySelector(".selected")), a.ui.sourceAtop(b)
    } else "stamp" !== c && "text" !== c || a.ui.sourceAtop(b);
    "image" === c && (c = "clipart");
    dom.setClass({
      className: "selected",
      list: b.parentNode.querySelectorAll("." + c),
      target: b,
      on: !0
    })
  };
  var p = {
      menu: !0,
      "menu-download": !0,
      "menu-export": !0,
      "menu-about": !0,
      configure: !0,
      palette: !0
    },
    q = function(b, c) {
      eventjs.cancel(b);
      var d = c.target.id.substr(5);
      if (p[d]) return a.exec(d);
      "camera" === d && a.util.exists("chrome.permissions.request") ? chrome.permissions.request({
        permissions: ["videoCapture"]
      }, function(b) {
        b ? a.exec(d) : alertify.log("Access to camera was denied.")
      }) : a.exec(d)
    };
  a.ui.toolset = {};
  a.ui.toolset.initEvents = function(b) {
    b = b || {};
    var c = b.target || ".sk-toolset";
    a.util.each(document.querySelectorAll(".sketchapi " + c + " img"), function(a) {
      eventjs.add(a,
        "mousedown", eventjs.returnFalse)
    });
    a.util.each(document.querySelectorAll(".sketchapi " + c + " .sk-button"), function(c) {
      if (c.id && 0 === c.id.indexOf("tool-")) {
        for (var d in b) 0 === d.indexOf("on") && "function" === typeof b[d] && eventjs.add(c, d.substr(2), b[d]);
        a.util.each(c.querySelectorAll(".sk-arrow"), function(b) {
          var d, e, f = c.id.substr(5);
          a.detect.brush[f] ? (d = "menuBrushTools", e = "More brushes...") : a.detect.shape[f] && (d = "menuShapeTools", e = "More shapes...");
          eventjs.add({
            target: c,
            contextmenu: function(b) {
              var c = a.toolkit.select.getCoord(b);
              contextmenu.show(a.ui[d], c.x - 15, 45, !0);
              eventjs.cancel(b)
            },
            longpress: {
              timeout: 250,
              listener: function(b, c) {
                if ("start" === c.state) {
                  var e = a.toolkit.select.getCoord(b);
                  contextmenu.show(a.ui[d], e.x - 15, 45, !0)
                }
              }
            }
          });
          eventjs.add({
            target: b,
            mousedown: function(b, c) {
              var e = a.toolkit.select.getCoord(b);
              contextmenu.show(a.ui[d], e.x - 15, 45, !0)
            },
            mouseover: function(b) {
              eventjs.stop(b);
              a.setTooltip(a.language.translate(e))
            },
            mouseout: function(b) {
              eventjs.stop(b);
              a.setTooltip("")
            }
          })
        });
        eventjs.add({
          target: c,
          click: q,
          contextmenu: eventjs.cancel,
          mousedown: eventjs.cancel,
          mouseover: function(b) {
            eventjs.stop(b);
            b = c.getAttribute("data-title");
            a.setTooltip(a.language.translate(b))
          },
          mouseout: function(b) {
            eventjs.stop(b);
            a.setTooltip("")
          },
          dblclick: function() {
            var b = c.id.substr(5);
            a.configure.tools[b] && (a.windows.blink("sk-configure"), a.ui.buildConfigure())
          }
        })
      }
    })
  };
  a.setup.events = function() {
    var b = a.canvas2d.container;
    a.setup.onResize();
    a.setup.onHashChange();
    a.ui.toolset.initEvents();
    a.util.each(document.querySelectorAll(".sk-window"), a.windows.addWindowEvent);
    a.ui.setupStartWindow && a.ui.setupStartWindow();
    eventjs.add(window, "scroll", function() {
      a.windows.restore()
    });
    a.feature.preventScroll && !a.feature.debugCache && (eventjs.proxy.wheelPreventElasticBounce(".open-project-listing"), eventjs.add(window, "wheel", eventjs.cancel), eventjs.add(b, "wheel", eventjs.stop));
    a.feature.beforeUnloadPrompt && eventjs.add(window, "beforeunload", function(b) {
      var c = a.feature.beforeUnloadPrompt;
      return (b || window.event).returnValue = c
    });
    eventjs.isTouch && eventjs.add(document, "touchstart,touchmove,dragstart",
      eventjs.prevent);
    eventjs.add(a.active.canvas, "contextmenu", eventjs.prevent);
    a.windows && eventjs.add(a.active.canvas, "mouseup", a.windows.clearFocus);
    eventjs.add(a.active.canvas, "mouseup", function() {
      document.activeElement !== document.body && document.activeElement && document.activeElement.blur()
    });
    eventjs.add(window, "focus,load,blur", function() {
      eventjs.proxy.metaTrackerReset()
    })
  };
  a.ui.confirm = function(b) {
    if (a.scene && "delete-project-confirm" !== b.message && (a.scene.deselectAll(), !1 === a.__modified)) return b.callback(!0);
    var c = a.language.translate(b.message);
    b.labels && alertify.set({
      labels: b.labels
    });
    alertify.confirm('<h3 class="confirm-message">' + c + "</h3>", b.callback)
  };
  a.ui.param = function(a, b, c) {
    b = b.replace(")", "").split("(");
    this.param = a;
    this.format = b[0];
    this.range = b[1];
    this.value = c;
    return this
  };
  a.ui.vars = {};
  a.ui.vars.clamp = function(b, c, d, e, f) {
    f && a.util.mergeObject(f, this);
    "object" === typeof b ? (this.min = b[0], this.max = b[1], this.getValue = function() {
      return [this.min, this.max]
    }) : (this.value = b, this.getValue = function() {
      return this.value
    });
    this.clamp = {};
    this.clamp.min = c;
    this.clamp.max = d;
    this.type = "clamp";
    this.format = e || "float";
    return this
  };
  a.ui.vars.select = function(a, b, c, d) {
    this.type = "select";
    this.label = a || "";
    this.options = c;
    this.selected = b;
    this.setData = d;
    this.getOptions = function() {
      if ("function" === typeof c) return c();
      if (Array.isArray(c)) {
        for (var a = {}, b = 0; b < c.length; b++) {
          var d = c[b];
          a[d] = d
        }
        return a
      }
      return c
    }
  };
  a.ui.vars.checkbox = function(a, b) {
    this.type = "checkbox";
    this.label = a;
    this.checked = b
  };
  a.ui.vars.input = function(a) {
    this.type = "input";
    this.value = a
  };
  a.ui.vars.textarea = function(a) {
    this.type = "textarea";
    this.value = a
  };
  a.ui.vars.color = function(a) {
    this.type = "color";
    this.color = a
  };
  a.ui.vars.filePicker = function(a) {
    this.type = "filePicker";
    this.filter = a
  };
  a.ui.buildConfigureOptions = function(b) {
    var d = document.querySelector("#sk-configure .sk-configure-content");
    dom.removeChildNodes(d);
    if (b = a.configure.tools[b]) {
      a.ui.ranges = {};
      for (var e in b) {
        var l = b[e];
        if (l && l.type) {
          var g = e[0].toUpperCase() + e.substr(1);
          switch (l.type) {
            case "filePicker":
              c(d, b,
                l);
              break;
            case "select":
              a.ui.addLineBreak(d);
              s(d, l);
              break;
            case "checkbox":
              a.ui.addLineBreak(d);
              var h = document.createElement("label"),
                k = document.createElement("input"),
                m = document.createElement("span");
              m.textContent = g;
              m.style.cssText = "margin: 0 0 0 7px;";
              k.type = "checkbox";
              k.checked = l.checked;
              k.id = "checkbox-" + l.label;
              k.onchange = function() {
                var b = this.id.substr(9),
                  c = {};
                c[b] = !!this.checked;
                a.tool.update(c)
              };
              h.appendChild(k);
              h.appendChild(m);
              h.style.cssText = "display:block; margin: 5px 0 5px 7px;";
              d.appendChild(h);
              break;
            case "input":
              a.ui.addLineBreak(d);
              t(d, l, "input");
              break;
            case "textarea":
              a.ui.addLineBreak(d);
              t(d, l, "textarea");
              break;
            case "clamp":
              a.ui.ranges[e] = f(d, b, l, g)
          }
        }
      }
    }
  };
  var t = function(b, c, d) {
      a.ui.addLineBreak(b);
      var e = document.createElement("label");
      d = document.createElement(d || "input");
      d.textContent = c.value;
      var f = document.createElement("span");
      f.style.cssText = "margin: 0 0 0 7px;";
      e.appendChild(d);
      e.appendChild(f);
      b.appendChild(e);
      eventjs.add(d, "drag", eventjs.stop);
      eventjs.add(d, "change", function() {
        c.value =
          this.value;
        a.setTool(a.tool.type)
      })
    },
    s = function(b, c) {
      return a.ui.buildSelect({
        label: c.label,
        style: "width: 185px; margin: 10px 0 0 7px; text-transform: capitalize;",
        element: b,
        selected: c.selected,
        data: c.getOptions(),
        onchange: function() {
          var b = this.id.substr(7),
            d = this.options[this.selectedIndex],
            e = d.getAttribute("data-cmd"),
            d = d.value;
          c.setData ? c.setData(b, d) : (d = {}, d[b] = e, a.tool.update(d))
        }
      })
    }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
(function(a) {
  a.Palette = function() {
    var g = this,
      c = "fill",
      f = "color";
    this.visible = !1;
    this.fill = this.stroke = "#000";
    this.init = function(b) {
      b = b || {};
      "function" === typeof b && (b = {
        onload: b
      });
      var c = b.onload;
      k(b);
      a.getItem("paint.type", function(a) {
        g.update(a || f, !0, !0, c);
        g.setIndicator()
      })
    };
    this.setPane = function(b, c) {
      !1 === a.feature.palette[b] && (a.feature.palette[b] = !0, a.feature.palette.grid = !0, a.feature.palette.header = "", e(), this.init());
      this.update(b, !1, !1, c)
    };
    this.setPaintMethod = function(b, d) {
      c = b;
      a.setItem("paint.method",
        b);
      this.update(a.style[b].type, !1, !1, d);
      this.setIndicator()
    };
    this.toggle = function(b) {
      var c = a.$("#sk-palette");
      sk.windows.isOpen(c) ? this.hide() : this.show(b)
    };
    this.show = function(b) {
      this.visible = !0;
      b = b || {};
      var d = b.aside;
      (b = b.style) && a.style.apply({
        paintMethod: c,
        dna: b,
        useColorPicker: !0
      });
      if (d) {
        var e = b = 0;
        if (d.target) {
          var f = sk.util.getMetrics(d.target);
          b += f.x1;
          e += f.y1
        }
        if (d.position) {
          var g = a.$("#sk-palette"),
            h = g.style.display;
          g.style.display = "block";
          var f = sk.util.getMetrics(g),
            k = a.util.array2object(d.position.split(" "));
          k.bottom && (e -= f.height);
          k.right && (b -= f.width);
          g.style.display = h
        }
        d.top && (e += d.top);
        d.bottom && (e -= d.bottom);
        d.left && (b += d.left);
        d.right && (b -= d.right);
        g.style.left = b + "px";
        g.style.top = e + "px";
        sk.windows.record({
          id: "sk-palette",
          x: b,
          y: e,
          left: b / window.innerWidth,
          top: e / window.innerHeight,
          display: "block"
        });
        a.windows.open("sk-palette", !1)
      } else a.windows.open("sk-palette")
    };
    this.hide = function() {
      this.visible = !1;
      a.windows.close("sk-palette")
    };
    this.deselect = function() {
      dom.setClass("#sk-palette .sk-palette-scroller .selected",
        "selected", !1)
    };
    this.update = function(e, k, p, q) {
      var t = a.style[c];
      e = e || t.type;
      if (f !== e || k) {
        f = e;
        t.type = e;
        a.setItem("paint.type", e);
        switch (a.style[c].type) {
          case "color":
            b.style.display = "block";
            break;
          case "gradient":
          case "pattern":
            b.style.display = "none"
        }
        if (a.feature.palette.grid) {
          g.queue && g.queue.cancel();
          (k = a.$("." + e + "-indicator")) && dom.setClass(k, "selected", !0, "canvas");
          e = t.type;
          var s = "color" === e,
            w = "gradient" === e,
            v = "pattern" === e,
            u = e + a.style.hashDNA(t[e]);
          d.style.display = "none";
          dom.setClass(d, "color",
            s);
          dom.setClass(d, "gradient", w);
          dom.setClass(d, "pattern", v);
          dom.setClass(h, "color", s);
          dom.setClass(h, "gradient", w);
          dom.setClass(h, "pattern", v);
          var y = function(b, c, f, g) {
            a.style[e + "Official"][c] && (d.style.display = "block", dom.setClass(b, "official", !0));
            g === f && dom.setClass(b, "selected", !0)
          };
          p && (h.innerHTML = "");
          p && (d.innerHTML = "");
          var x = a.style[e];
          if (x) {
            var z = a.perf();
            g.queue = new a.util.Queue({
              items: x,
              flatten: !0,
              oncancel: q,
              oncomplete: function() {
                a.feature.debug && console.log("build palette", e, z());
                g.setIndicator();
                q && q()
              },
              next: function(b, f, g) {
                var k = x[g];
                b = a.style.hashDNA(k);
                f = e + b;
                var r = a.style[e + "Official"][b] ? d : h,
                  q = r.querySelector("#" + f);
                if (q && !p) return y(q, b, u, f), this.next();
                var t = document.createElement("canvas");
                t.getContext("2d");
                q = document.createElement("li");
                q.id = f;
                q.className = e;
                q.setAttribute("data-type", e);
                q.setAttribute("data-dna", "" + k);
                q.appendChild(t);
                r.appendChild(q);
                s ? a.style.renderSwatch(c, t, "color", k) : w ? a.style.renderSwatch(c, t, "gradient", k) : v && a.style.renderSwatch(c, t, "pattern", k);
                y(q, b, u, f);
                b = {
                  target: t,
                  mousedown: eventjs.stop,
                  click: m
                };
                "color" === e && (b.mouseover = function(b) {
                  eventjs.stop(b);
                  a.setTooltip(k.toUpperCase())
                }, b.mouseout = function(b) {
                  eventjs.stop(b);
                  a.setTooltip("")
                });
                eventjs.add(b);
                a.feature.palette.gridInstantLoad || 0 !== g % 10 ? this.next() : setTimeout(this.next, 0)
              }
            })
          }
        }
      }
    };
    this.rebuild = function(a) {
      a = sketch.$$("#sk-palette .sk-palette-scroller " + (a ? "." + a : "li"));
      dom.removeNodes(a);
      g.update(null, !0)
    };
    this.updateAndRecord = function(b) {
      g.setPane(b);
      a.style.apply({
        paintMethod: c,
        paintType: f,
        dna: a.style[c][f],
        useRender: !0,
        useRecord: !0
      })
    };
    this.setIndicator = function() {
      var b = a.style[c] || a.tool.device[c];
      if (a.scene && 1 === a.selection.length) {
        var d = a.scene.getOneSelected();
        d && "clipart" !== d.type && (d = d && d[c]) && (b = d)
      }
      for (var d = b.type, e = a.$$(".color-indicator"), f = 0; f < e.length; f++) a.style.renderSwatch(c, e[f], "color", b.color);
      e = a.$$(".gradient-indicator");
      for (f = 0; f < e.length; f++) a.style.renderSwatch(c, e[f], "gradient", b.gradient);
      e = a.$$(".pattern-indicator");
      for (f = 0; f < e.length; f++) a.style.renderSwatch(c,
        e[f], "pattern", b.pattern);
      e = a.$$(".style-indicator");
      for (f = 0; f < e.length; f++) e[f].style.cssText = "color" === b.type ? "background: " + b.color : a.style.getGradientCSS(b.gradient, "left top");
      sk.windows.isOpen("sk-palette") && (b = a.style.hashDNA(b[d]), (b = document.querySelector("#" + d + b)) && dom.setClass({
        target: b,
        list: b.parentNode.querySelectorAll("li"),
        className: "selected",
        on: !0
      }))
    };
    var b, h, d, e = function() {
        var c = a.$("#sk-palette");
        if (!c) {
          var e = a.$(".sketchapi"),
            c = dom.create('<div class="sk-window" id="sk-palette"></div>');
          e.appendChild(c)
        }
        dom.removeChildNodes(c);
        e = document.createElement("div");
        e.className = "sk-header";
        var f = a.feature.palette.gradient && "Gradients",
          k = a.feature.palette.pattern && "Patterns",
          m = a.feature.palette.color && "Colors";
        if (!1 !== a.feature.palette.header) {
          var s = a.feature.palette.header,
            w = document.createElement("div");
          w.className = "sk-header-content";
          w.innerHTML = f && k || k && m || m && f ? s || "" : s || f || m || k;
          e.appendChild(w);
          a.feature.palette.closeButton && (f = document.createElement("span"), f.className = "sk-close icon-close",
            eventjs.add({
              target: f,
              mousedown: eventjs.cancel,
              click: function(a, b) {
                eventjs.cancel(a);
                setTimeout(function() {
                  sk.windows.close(b.target.parentNode.parentNode.id)
                }, 1)
              }
            }), e.appendChild(f));
          c.appendChild(e)
        }
        f = document.createElement("div");
        f.className = "sk-palette-content";
        a.feature.palette.grid && (d = document.createElement("div"), d.className = "scroller scroller-official sk-palette-scroller", eventjs.proxy.wheelPreventElasticBounce(d), f.appendChild(d), h = document.createElement("div"), h.className = "scroller sk-palette-scroller",
          eventjs.proxy.wheelPreventElasticBounce(h), f.appendChild(h));
        b = document.createElement("div");
        b.className = "editor";
        f.appendChild(b);
        c.appendChild(f);
        if (a.feature.palette.gradient) {
          var v = document.createElement("ol");
          v.className = "tabs";
          e.appendChild(v);
          a.gen.interlace({
            size: 12,
            innerColor: "#fff",
            outerColor: "#d9d9d9",
            callback: function(b) {
              var c = b.css;
              b = function(b) {
                var d = document.createElement("canvas");
                d.innerHTML = "";
                d.className = b + "-indicator";
                d.style.background = c;
                eventjs.add({
                  target: d,
                  mousedown: eventjs.prevent,
                  mouseover: function(c) {
                    eventjs.stop(c);
                    a.setTooltip(STRING.ucwords(b))
                  },
                  mouseout: function(b) {
                    eventjs.stop(b);
                    a.setTooltip("")
                  },
                  click: function() {
                    g.updateAndRecord(b)
                  }
                });
                v.appendChild(d)
              };
              a.feature.palette.color && b("color");
              a.feature.palette.gradient && b("gradient");
              a.feature.palette.pattern && b("pattern")
            }
          });
          a.feature.palette.blend && (c = document.createElement("div"), c.id = "light-mode", e.appendChild(c), a.ui.blendSelectMenu = a.ui.buildSelect({
            label: "Blend Mode",
            element: c,
            selected: "normal",
            data: {
              Normal: "normal",
              Multiply: "multiply",
              Screen: "screen",
              Overlay: "overlay",
              Darken: "darken",
              Lighten: "lighten",
              "Color-dodge": "color-dodge",
              "Color-burn": "color-burn",
              "Hard-light": "hard-light",
              "Soft-light": "soft-light",
              Difference: "difference",
              Exclusion: "exclusion",
              Hue: "hue",
              Saturation: "saturation",
              Color: "color",
              Luminosity: "luminosity",
              Disco: "disco"
            },
            onchange: function() {
              var b = a.ui.blendSelectMenu.getValue();
              a.style.setBlendMode(b);
              a.render.setBlendMode(b);
              a.selection.length && a.toolkit.setParam({
                tool: "*",
                param: "composite",
                data: b,
                selection: a.selection.items
              })
            }
          }))
        }
      },
      m = function(b, e) {
        eventjs.cancel(b);
        var f = e.target.parentNode,
          k = f.getAttribute("data-type"),
          m = f.getAttribute("data-dna");
        g[c] = m;
        var s = "." + k + ".selected";
        dom.setClass(h.querySelector(s), "selected", !1);
        dom.setClass(d.querySelector(s), "selected", !1);
        dom.setClass(f, "selected", !0);
        "pattern" === k ? a.style.loadPattern(m, function(b) {
          a.style.apply({
            paintMethod: c,
            paintType: k,
            dna: m,
            useRender: !0,
            useRecord: !0,
            useColorPicker: !0
          })
        }) : "color" === k && a.colorPicker.update ? a.colorPicker.update(m,
          null, "up") : a.style.apply({
          paintMethod: c,
          paintType: k,
          dna: m,
          useRender: !0,
          useRecord: !0,
          useColorPicker: !0
        });
        a.feature.debug && console.log("dna", m)
      },
      k = function(b) {
        if (a.feature.palette.colorPicker) {
          if (a.util.exists("sk.color.picker")) {
            var d = b.onchange || function(b, d, e) {
              g.deselect();
              a.style.apply({
                paintMethod: c,
                paintType: "color",
                dna: e,
                useRender: !0,
                useRecord: d,
                selection: a.selection.items
              })
            };
            b.color && (a.style[c].color = b.color);
            var e = a.$("#sk-palette .editor"),
              f = a.feature.palette.eyeDropper ? {
                canvas: a.canvas2d.layers.layer0,
                target: a.canvas2d.layers.active
              } : null,
              h = a.feature.palette.closeButton;
            "boolean" !== typeof h && (h = !!b.onclose);
            a.colorPicker = new a.color.picker({
              recordId: "sk-palette",
              recordWindow: sk.windows.record,
              color: b.color,
              onchange: d,
              onclose: b.onclose,
              theme: b.theme,
              container: e,
              feature: {
                closeButton: !1,
                hexInput: a.feature.palette.hexInput,
                eyeDropper: f
              },
              modules: {
                hue: {
                  column: 2,
                  enable: !0,
                  width: 30,
                  height: 196
                },
                satval: {
                  column: 1,
                  enable: !0,
                  width: 196,
                  height: 196
                },
                alpha: {
                  column: 3,
                  enable: !1,
                  width: 30,
                  height: 196
                }
              }
            });
            b = document.createElement("div");
            b.className = "clear";
            a.colorPicker.element.appendChild(b);
            return a.colorPicker
          }
          a.feature.debug && console.log("missing sketch.color.picker module")
        }
      };
    e();
    return this
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.configure && (sketch.configure = {});
"undefined" === typeof sketch.configure.tools && (sketch.configure.tools = {});
sketch.Configure = function(a) {
  var g = function(b, c, f) {
      b = a.util.clone("object" === typeof b ? b : a.configure.tools[b]);
      b.type = c;
      a.configure.tools[c] = b;
      if (f)
        for (var g in f) null === f[g] ? delete b[g] : b[g] = f[g]
    },
    c = a.ui.vars,
    f = function() {
      if (a.style) return new a.style.Fill
    },
    b = function() {
      if (a.style) return new a.style.Stroke({
        lineWidth: 0
      })
    };
  a.configure.tools.select = {
    toolkit: "select",
    type: "select",
    opacity: new c.clamp(100, 0, 100, "%")
  };
  a.configure.tools.crop = {
    toolkit: "crop",
    type: "crop",
    ratio: new c.select("ratio", "377 x 197 (Facebook)",
      function() {
        return a.ui.PROJECT.param.presets
      },
      function(b, c) {
        var f = a.ui.PROJECT.getPresetData(c),
          g = {};
        g[b] = f;
        a.tool.update(g)
      }),
    constrain: new c.checkbox("constrain", !0)
  };
  a.configure.tools.zoom = {
    toolkit: "zoom",
    type: "zoom"
  };
  a.configure.tools.group = {
    toolkit: "group",
    type: "group",
    opacity: new c.clamp(100, 0, 100, "%"),
    composite: "source-over"
  };
  var h = {
    toolkit: "shape",
    composite: "source-over",
    movement: "placement",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 0, 100, "%")
  };
  g(h, "wedge", {
    startAngle: new c.clamp(0, 0, 360,
      "float"),
    endAngle: new c.clamp(270, 0, 360, "float"),
    anticlockwise: !1
  });
  g(h, "rectangle", {
    roundness: new c.clamp(0, 0, 100, "float")
  });
  g(h, "regularPolygon", {
    sides: new c.clamp(5, 3, 25, "int")
  });
  g(h, "gear", {
    sides: new c.clamp(30, 2, 100, "int"),
    slope: new c.clamp(1.1, 0.001, 1, "float")
  });
  g(h, "star", {
    sides: new c.clamp(5, 2, 100, "int"),
    slope: new c.clamp(0.5, 1, 10, "float")
  });
  g(h, "burst", {
    sides: new c.clamp(5, 2, 100, "int"),
    slope: new c.clamp(0.001, 0.001, 10, "float")
  });
  g(h, "radialBurst", {
    sides: new c.clamp(12, 1, 100, "int"),
    spread: new c.clamp(0.5, -1, 1, "float")
  });
  g(h, "spiral", {
    sides: new c.clamp(10, 1, 50, "int"),
    coils: new c.clamp(1, 1, 10, "int"),
    spread: new c.clamp(25, 0.5, 50, "%")
  });
  g(h, "supershape", {
    points: new c.clamp(500, 50, 1E3, "int"),
    m: new c.clamp(39, 0.1, 50, "int"),
    n1: new c.clamp(1, 0.1, 15, "float"),
    n2: new c.clamp(0.9, 0.1, 15, "float"),
    n3: new c.clamp(0.25, 0.1, 15, "float")
  });
  g(h, "ellipse");
  g(h, "circle");
  g("rectangle", "square");
  g("regularPolygon", "triangle", {
    sides: null
  });
  a.configure.tools.text = {
    toolkit: "text",
    type: "text",
    composite: "source-over",
    opacity: new c.clamp(100,
      1, 100, "%"),
    fontWeight: "normal",
    fontSize: new c.clamp(30, 1, 120, "float"),
    fontFamily: "Arial",
    fontVariant: "normal",
    fontStyle: "normal",
    textAlign: "center",
    textDecoration: "none",
    textTransform: "none",
    whiteSpace: "normal",
    fill: f(),
    stroke: b()
  };
  a.configure.tools.image = {
    toolkit: "media",
    type: "image",
    composite: "source-over",
    opacity: new c.clamp(100, 1, 100, "%")
  };
  a.configure.tools.clipart = {
    toolkit: "media",
    type: "clipart",
    composite: "source-over",
    color: "rgba(0,0,0,1)",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    filePicker: new c.filePicker
  };
  h = {
    toolkit: "brush",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 0, 100, "%"),
    spacing: {
      min: 3,
      max: a.util.INFINITY
    }
  };
  g(h, "textbrush", {
    diameter: new c.clamp(10, 1, 100, "px"),
    content: new c.textarea('"The quick brown fox jumps over the lazy dog" is an English-language pangram \u2013 a phrase that contains all of the letters of the English alphabet.')
  });
  g(h, "arrow", {
    diameter: new c.clamp(25, 1, 250, "px")
  });
  g(h, "polygon", {
    diameter: new c.clamp(1, 1, 100, "px")
  });
  g(h,
    "polyline", {
      diameter: new c.clamp(1, 1, 100, "px")
    });
  g(h, "path", {
    diameter: new c.clamp(1, 1, 100, "px")
  });
  g(h, "scissor", {
    diameter: new c.clamp(1, 1, 100, "px")
  });
  g(h, "eraser", {
    composite: "erase",
    diameter: new c.clamp(40, 1, 250, "px"),
    blur: new c.clamp(0, 0, 100, "%")
  });
  g(h, "paintbrush", {
    diameter: new c.clamp(100, 1, 250, "px"),
    blur: new c.clamp(20, 0, 100, "%")
  });
  g(h, "pencil", {
    diameter: new c.clamp(2, 1, 100, "px")
  });
  g(h, "streamer", {
    spacing: {
      min: 1,
      max: 50
    }
  });
  g(h, "calligraphy", {
    diameter: new c.clamp(17, 1, 50, "px")
  });
  a.configure.tools.chrome = {
    toolkit: "brush",
    type: "chrome",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(25, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 100
    },
    lineWidth: new c.clamp(1, 0.1, 5, "px"),
    spread: new c.clamp(20, 1, 50, "float"),
    lookback: 2E3
  };
  a.configure.tools.shader = {
    toolkit: "brush",
    type: "shader",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(75, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 100
    },
    lineWidth: new c.clamp(0.5, 0.1, 5, "px"),
    spread: new c.clamp(40, 1, 50, "float"),
    lookback: 2E3
  };
  a.configure.tools.sketchy = {
    toolkit: "brush",
    type: "sketchy",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(50, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 100
    },
    lineWidth: new c.clamp(1, 0.1, 5, "px"),
    spread: new c.clamp(40, 1, 50, "float"),
    lookback: 2E3
  };
  a.configure.tools.web = {
    toolkit: "brush",
    type: "web",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(25, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 100
    },
    lineWidth: new c.clamp(1, 0.1, 5, "px"),
    spread: new c.clamp(70, 1, 100, "int"),
    lookback: 2E3
  };
  a.configure.tools.fur = {
    toolkit: "brush",
    type: "fur",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 10
    },
    lineWidth: new c.clamp(0.5, 0.1, 5, "px"),
    diameter: new c.clamp(250, 1, 500, "px"),
    lookback: 2E3
  };
  a.configure.tools.hair = {
    toolkit: "brush",
    type: "hair",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 10
    },
    lineWidth: new c.clamp(0.5, 0.1, 10, "px"),
    diameter: new c.clamp(50, 1, 100, "px"),
    lookback: 20
  };
  a.configure.tools.spirograph = {
    toolkit: "brush",
    type: "spirograph",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(60, 1, 100, "%"),
    spacing: {
      min: 1,
      max: a.util.INFINITY
    },
    lineWidth: new c.clamp(0.1, 0.1, 2, "px"),
    distance: new c.clamp(100, 1, 250, "float"),
    contract: 0.005,
    outerRadius: new c.clamp(35.16814159292035, 1, 100, "float"),
    innerRadius: new c.clamp(43.92920353982301, 1, 100, "float"),
    increment: new c.clamp(0.576991150442478, 0.1, 5, "float")
  };
  a.configure.tools.spraypaint = {
    toolkit: "brush",
    type: "spraypaint",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(25, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 100
    },
    diameter: new c.clamp(100, 25, 250, "px")
  };
  a.configure.tools.crayon = {
    toolkit: "brush",
    type: "crayon",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    rotate: {
      hidden: !0,
      min: 0,
      max: 360
    },
    diameter: new c.clamp(19, 3, 42, "px")
  };
  a.configure.tools.stamp = {
    toolkit: "brush",
    type: "stamp",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    diameter: new c.clamp(100, 5, 500, "px"),
    rotate: new c.clamp([1, 360], 1, 360, "degree"),
    scale: new c.clamp([0.05, 1.5], 0.05, 3,
      "px"),
    translate: new c.clamp([0, 0], 0, 250, "px"),
    spacing: new c.clamp([12, a.util.INFINITY], 1, 250, "px"),
    pollock: !1
  };
  a.configure.tools.floodfill = {
    toolkit: "brush",
    type: "floodfill",
    composite: "source-over",
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    tolerance: new c.clamp(60, 1, 100, "%"),
    antialias: !1,
    contiguous: !0,
    click: !0
  };
  a.configure.tools.oil = {
    toolkit: "brush",
    type: "oil",
    composite: "source-over",
    blend: 0.98,
    bristles: 8,
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    spacing: {
      min: 1,
      max: 1
    },
    diameter: new c.clamp(50,
      1, 100, "px")
  };
  a.configure.tools.pastel = {
    toolkit: "brush",
    type: "pastel",
    composite: "source-over",
    blend: 0.97,
    bristles: 35,
    fill: f(),
    stroke: b(),
    opacity: new c.clamp(100, 1, 100, "%"),
    rotate: {
      hidden: !0,
      min: 0,
      max: 360
    },
    diameter: new c.clamp(25, 3, 42, "px")
  };
  g("clipart", "symbol");
  (function() {
    var b = a.util.clone(a.configure.tools);
    a.reset.configure = function(c) {
      a.configure.tools[c] = a.util.clone(b[c])
    }
  })()
};
"undefined" === typeof sketch && (sketch = {});
sketch.gen = sketch.gen || {};
(function(a) {
  var g, c, f = function(b) {
    var c = b.ctx,
      d = c.canvas,
      e = c.createPattern(d, "repeat");
    a.supports.io.blob ? d.toBlob(function(a) {
      a = URL.createObjectURL(a);
      e.css = "url('" + a + "')";
      e.data = a;
      e.canvas = d;
      b.callback && b.callback(e)
    }) : (c = d.toDataURL(), e.css = "url('" + c + "')", e.data = c, b.callback && b.callback(e));
    return e
  };
  a.gen.paper = function(b, c) {
    var d = (a.convert.metrics || sketch.util.getScreenMetrics())["in>px"],
      d = {
        notebook: {
          lineStartTop: 0.85 * d,
          lineHeight: 30,
          lineColor: "#8CA6BD",
          marginLeft: 0.85 * d,
          marginColor: "#FF7088",
          fillColor: "#F8F9B3"
        },
        looseLeaf: {
          lineStartTop: 0.85 * d,
          lineHeight: 30,
          lineColor: "#CAEAFB",
          marginLeft: 0.85 * d,
          marginColor: "#FF7088",
          fillColor: "#FAFAFA"
        },
        lined: {
          lineStartTop: -0.5,
          gutter: 0.25 * d,
          lineHeight: 30,
          lineColor: "#8CA6BD",
          fillColor: "#FAFAFA"
        }
      };
    b = d[b] || b || d.notebook;
    b.callback = c;
    var e = b.grid || 0,
      g = b.gutter || 0,
      k = b.lineStartTop || 0,
      l = b.lineStartLeft || 0,
      d = b.lineHeight || 1,
      r = b.lineColor || "#8CA6BD",
      p = b.marginLeft || 0,
      q = b.marginColor || "#C37F9B",
      t = document.createElement("canvas").getContext("2d");
    t.canvas.width =
      1024;
    t.canvas.height = 1024;
    t.fillStyle = b.fillColor || "#fff";
    t.fillRect(0, 0, 1024, 1024);
    e && (t.save(), t.translate(g, g), e = a.gen.grid({
      size: e,
      strokeColor: r,
      fillColor: "none"
    }), t.fillStyle = e, t.fillRect(0, 0, 1024, 1024), t.restore());
    e = 1024 / d;
    t.save();
    t.translate(l, k);
    for (k = 0; k < e; k++) t.beginPath(), t.moveTo(0, k * d), t.lineTo(1024, k * d), t.lineWidth = 1, t.strokeStyle = r, t.stroke();
    t.restore();
    p && (t.save(), t.beginPath(), t.moveTo(p, 0), t.lineTo(p, 1024), t.lineWidth = 1, t.strokeStyle = q, t.stroke(), t.restore());
    b.ctx = t;
    return f(b)
  };
  a.gen.grid = function(a, c) {
    var d = {
        grid: {
          size: 20,
          strokeColor: "#ddd",
          fillColor: "#fff"
        },
        graphPaper: {
          size: 20,
          strokeColor: "#BEE0BD",
          fillColor: "#F0FCE1"
        },
        bluePrint: {
          size: 20,
          strokeColor: "#2893e0",
          fillColor: "#0078CF"
        }
      },
      e = document.createElement("canvas").getContext("2d");
    a = d[a] || a || d.grid;
    a.callback = c || a.callback;
    a.ctx = e;
    var d = a.size || 12,
      g = a.strokeColor || "#000",
      k = a.fillColor || "#1f1f1f";
    e.canvas.width = d;
    e.canvas.height = d;
    e.fillStyle = k;
    e.fillRect(0, 0, d, d);
    e.moveTo(0, 0);
    e.lineTo(0, d);
    e.moveTo(0, 0);
    e.lineTo(d, 0);
    e.lineWidth = 1;
    e.strokeStyle = g;
    e.stroke();
    return f(a)
  };
  a.gen.interlace = function(a, c) {
    var d = {
        transparent: {
          size: 12,
          innerColor: "#fff",
          outerColor: "#d9d9d9"
        },
        transparentDark: {
          size: 12,
          innerColor: "#000",
          outerColor: "#1f1f1f"
        }
      },
      e = document.createElement("canvas").getContext("2d");
    a = d[a] || a || d.grid;
    a.callback = c || a.callback;
    a.ctx = e;
    var d = a.size || 12,
      g = a.innerColor || "#000",
      k = a.outerColor || "#1f1f1f";
    e.canvas.width = 2 * d;
    e.canvas.height = 2 * d;
    e.fillStyle = g;
    e.fillRect(0, 0, d, d);
    e.fillStyle = k;
    e.fillRect(d, 0, d, d);
    e.fillStyle =
      k;
    e.fillRect(0, d, d, d);
    e.fillStyle = g;
    e.fillRect(d, d, d, d);
    return f(a)
  };
  a.gen.rangeBar = function(b) {
    b = b || {};
    b.dash = b.dash || {};
    a.ui.rangeStyle ? sketch.util.mergeObject(sketch.ui.rangeStyle, b) : b.top = 8;
    g || (g = document.createElement("canvas"), c = g.getContext("2d"));
    var f = a.canvas2d.pixelRatio,
      d = (b.top || 0) * f,
      e = (b.left || 0) * f,
      m = (b.barWidth || 233) * f,
      k = (b.barHeight || 6) * f,
      l = b.fillStyle || "#555",
      r = b.gradient,
      p = d + k;
    b = b.dash;
    b.height = b.height || 4;
    b.heightSmall = b.heightSmall || 3;
    b.strokeStyle = b.strokeStyle || "#666";
    b.lineWidth =
      b.lineWidth || 1;
    b.globalAlpha = b.globalAlpha || 1;
    b.position = b.position || "top";
    g.width = m + 1;
    g.height = k + b.height + d;
    g.style.width = g.width / f + "px";
    g.style.height = g.height / f + "px";
    c.clearRect(e, d, m, 30);
    var f = 0,
      q = m - 9;
    c.save();
    c.beginPath();
    c.lineWidth = b.lineWidth;
    c.globalAlpha = b.globalAlpha;
    var t;
    t = "bottom" === b.position ? p - 5 : d - 1;
    for (var s = b.height, w = b.heightSmall, p = 0; p <= q + 1; p += q / 10) {
      var v = Math.round(p) + e + 4.5,
        u = f % 5 ? w : s;
      c.moveTo(v, t);
      "bottom" === b.position ? c.lineTo(v, t + u) : c.lineTo(v, t - u);
      c.strokeStyle = b.strokeStyle;
      c.stroke();
      c.beginPath();
      f++
    }
    c.restore();
    if (r)
      for (l = c.createLinearGradient(0, 0, m, 0), p = 0, b = r.length; p < b; p++) l.addColorStop(p / (b - 1 || 1), r[p]);
    c.fillStyle = l;
    v = e + 0.5;
    c.lineWidth = 0.25;
    c.strokeStyle = "#000";
    sketch.vector.shape ? sketch.vector.shape.roundRect(c, v, d, v + m, k, k / 2) : c.rect(v, d, v + m, k);
    c.fill();
    c.stroke();
    return g
  }
})(sketch);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.language && (sketch.language = {});
sketch.language.en = {
  "useMaxCopies-alert": "You can only include {maxCopies} {plural} of this clipart.",
  "about-version": "[?] <a href='http://sketch.io/' target='_blank'>SketchAPI</a> v{sk-version}",
  "exit-app-confirm": "You&rsquo;re about to exit this app.<p>Any unsaved data in current document will be lost.<p>Would you like to save before exiting?",
  "delete-project-confirm": "You&rsquo;re about to delete this document.<p>Do you want to continue?",
  "clear-confirm": "Changes to the open document will be lost.<p>Do you want to continue?",
  "new-project-confirm": "You&rsquo;re about to create a <i>new document</i>.<p>Any unsaved data in <i>current document</i> will be lost.",
  "open-confirm": "You&rsquo;re about to open a <i>new document</i>.<p>Any unsaved data in <i>current document</i> will be lost.",
  Helo: "Hello",
  "Hello %s, how are you today?": "Hello %s, how are you today?",
  weekend: "weekend",
  "Hello %s, how are you today? How was your %s.": "Hello %s, how are you today? How was your %s.",
  Hi: "Hi",
  Howdy: "Howdy",
  "%s cat": {
    one: "%s cat",
    other: "%s cats"
  },
  "There is one monkey in the %%s": {
    one: "There is one monkey in the %%s",
    other: "There are %d monkeys in the %%s"
  },
  tree: "tree",
  "There is one monkey in the %s": {
    one: "There is one monkey in the %s",
    other: "There are %d monkeys in the %s"
  },
  "Hello %s": "Hello %s"
};
(function(a, g) {
  var c = a.document,
    f;
  f = function() {
    var b = {},
      f = !1,
      d = [],
      e, m, k, l, r, p, q, t, s, w, v, u;
    u = function() {
      var a, b, d = !1,
        e = c.createElement("fakeelement"),
        f = {
          WebkitTransition: "webkitTransitionEnd",
          MozTransition: "transitionend",
          OTransition: "otransitionend",
          transition: "transitionend"
        };
      for (a in f)
        if (e.style[a] !== g) {
          b = f[a];
          d = !0;
          break
        }
      return {
        type: b,
        supported: d
      }
    };
    e = function(a) {
      return c.getElementById(a)
    };
    b = {
      labels: {
        ok: "OK",
        cancel: "Cancel"
      },
      delay: 5E3,
      buttonReverse: !1,
      buttonFocus: "ok",
      transition: g,
      addListeners: function(a) {
        var b =
          "undefined" !== typeof k,
          d = "undefined" !== typeof m,
          e = "undefined" !== typeof v,
          f = "",
          g = this,
          h, p, r, q, s;
        h = function(b) {
          "undefined" !== typeof b.preventDefault && b.preventDefault();
          r(b);
          "undefined" !== typeof v && (f = v.value);
          "function" === typeof a && ("undefined" !== typeof v ? a(!0, f) : a(!0));
          return !1
        };
        p = function(b) {
          "undefined" !== typeof b.preventDefault && b.preventDefault();
          r(b);
          "function" === typeof a && a(!1);
          return !1
        };
        r = function(a) {
          g.hide();
          g.unbind(c.body, "keyup", q);
          g.unbind(l, "focus", s);
          e && g.unbind(w, "submit", h);
          b && g.unbind(k,
            "click", h);
          d && g.unbind(m, "click", p)
        };
        q = function(a) {
          var b = a.keyCode;
          32 !== b || e || h(a);
          27 === b && d && p(a)
        };
        s = function(a) {
          e ? v.focus() : !d || g.buttonReverse ? k.focus() : m.focus()
        };
        this.bind(l, "focus", s);
        b && this.bind(k, "click", h);
        d && this.bind(m, "click", p);
        this.bind(c.body, "keyup", q);
        e && this.bind(w, "submit", h);
        this.transition.supported || this.setFocus()
      },
      bind: function(a, b, c) {
        "function" === typeof a.addEventListener ? a.addEventListener(b, c, !1) : a.attachEvent && a.attachEvent("on" + b, c)
      },
      handleErrors: function() {
        if ("undefined" !==
          typeof a.onerror) {
          var b = this;
          a.onerror = function(a, c, d) {
            b.error("[" + a + " on line " + d + " of " + c + "]", 0)
          };
          return !0
        }
        return !1
      },
      appendButtons: function(a, b) {
        return this.buttonReverse ? b + a : a + b
      },
      build: function(a) {
        var d = a.type,
          e = a.message,
          f = a.cssClass || "";
        a = c.createElement("div");
        a.className = "alertify-dialog";
        if ("none" === b.buttonFocus) {
          var g = c.createElement("button");
          g.id = "alertify-noneFocus";
          g.className = "alertify-hidden";
          a.appendChild(g)
        }
        if ("prompt" === d) {
          var l = c.createElement("form");
          l.id = "alertify-form";
          a.appendChild(l)
        }
        g =
          c.createElement("article");
        g.className = "alertify-inner";
        if ("string" === typeof e) {
          var e = '<p class="alertify-message">{{message}}</p>'.replace("{{message}}", e),
            h = c.createElement("span");
          h.innerHTML = e
        } else h = c.createElement("p"), h.className = "alertify-message", h.appendChild(e);
        g.appendChild(h);
        "prompt" === d && (e = c.createElement("div"), e.className = "alertify-text-wrapper", h = c.createElement("input"), h.type = "text", h.className = "alertify-text", h.id = "alertify-text", e.appendChild(h), g.appendChild(e));
        e = c.createElement("nav");
        e.className = "alertify-buttons";
        g.appendChild(e);
        "prompt" === d ? (l.appendChild(g), a.appendChild(l)) : a.appendChild(g);
        g = c.createElement("button");
        g.id = "alertify-resetFocus";
        g.className = "alertify-resetFocus";
        g.innerHTML = "Reset Focus";
        a.appendChild(g);
        switch (d) {
          case "confirm":
            g = c.createElement("button");
            g.className = "alertify-button alertify-button-ok";
            g.id = "alertify-ok";
            g.innerHTML = this.labels.ok;
            e.appendChild(g);
            g = c.createElement("button");
            g.className = "alertify-button alertify-button-cancel";
            g.id = "alertify-cancel";
            g.innerHTML = this.labels.cancel;
            e.appendChild(g);
            break;
          case "prompt":
            g = c.createElement("button");
            g.className = "alertify-button alertify-button-ok";
            g.id = "alertify-ok";
            g.innerHTML = this.labels.ok;
            e.appendChild(g);
            g = c.createElement("button");
            g.type = "submit";
            g.className = "alertify-button alertify-button-ok";
            g.id = "alertify-cancel";
            g.innerHTML = this.labels.ok;
            e.appendChild(g);
            break;
          case "alert":
            g = c.createElement("button"), g.className = "alertify-button alertify-button-ok", g.id = "alertify-ok", g.innerHTML = this.labels.ok,
              e.appendChild(g)
        }
        t.className = t.className.replace("alertify-isHidden", "");
        setTimeout(function() {
          t.className = "alertify alertify-" + d + " " + f
        }, 1);
        q.className = "alertify-cover";
        return a
      },
      close: function(a, b) {
        a = a || this.lastItem;
        var c = b && !isNaN(b) ? +b : this.delay,
          d = this,
          e, f;
        this.bind(a, "click", function() {
          e(a)
        });
        f = function(a) {
          a.stopPropagation();
          d.unbind(this, d.transition.type, f);
          s.removeChild(this);
          s.hasChildNodes() || (s.className += " alertify-logs-hidden")
        };
        e = function(a) {
          "undefined" !== typeof a && a.parentNode ===
            s && (d.transition.supported ? (d.bind(a, d.transition.type, f), a.className += " alertify-log-hide") : (s.removeChild(a), s.hasChildNodes() || (s.className += " alertify-logs-hidden")))
        };
        0 !== b && setTimeout(function() {
          e(a)
        }, c)
      },
      dialog: function(a, b, e, g, l) {
        p = c.activeElement;
        var k = function() {
          s && null !== s.scrollTop && q && null !== q.scrollTop || k()
        };
        if ("string" !== typeof b) throw Error("type must be a string");
        if ("undefined" !== typeof e && "function" !== typeof e) throw Error("fn must be a function");
        "function" === typeof this.init &&
          (this.init(), k());
        d.push({
          type: b,
          message: a,
          callback: e,
          placeholder: g,
          cssClass: l
        });
        f || this.setup();
        return this
      },
      extend: function(a) {
        if ("string" !== typeof a) throw Error("extend method must have exactly one paramter");
        return function(b, c) {
          this.log(b, a, c);
          return this
        }
      },
      hide: function() {
        var a, b = this;
        d.splice(0, 1);
        0 < d.length ? this.setup(!0) : (f = !1, a = function(c) {
          c.stopPropagation();
          t.className += " alertify-isHidden";
          b.unbind(t, b.transition.type, a)
        }, this.transition.supported ? (this.bind(t, this.transition.type, a),
          t.className = "alertify alertify-hide alertify-hidden") : t.className = "alertify alertify-hide alertify-hidden alertify-isHidden", q.className = "alertify-cover alertify-cover-hidden", p.focus())
      },
      init: function() {
        c.createElement("nav");
        c.createElement("article");
        c.createElement("section");
        q = c.createElement("div");
        q.setAttribute("id", "alertify-cover");
        q.className = "alertify-cover alertify-cover-hidden";
        c.body.appendChild(q);
        t = c.createElement("section");
        t.setAttribute("id", "alertify");
        t.className = "alertify alertify-hidden alertify-isHidden";
        c.body.appendChild(t);
        s = c.createElement("section");
        s.setAttribute("id", "alertify-logs");
        s.className = "alertify-logs alertify-logs-hidden";
        c.body.appendChild(s);
        c.body.setAttribute("tabindex", "0");
        this.transition = u();
        delete this.init
      },
      log: function(a, b, c) {
        var d = function() {
          s && null !== s.scrollTop || d()
        };
        "function" === typeof this.init && (this.init(), d());
        s.className = "alertify-logs";
        this.notify(a, b, c);
        return {
          lastItem: this.lastItem,
          close: this.close,
          hide: this.hide
        }
      },
      notify: function(a, b, d) {
        var e = c.createElement("article");
        e.className = "alertify-log" + ("string" === typeof b && "" !== b ? " alertify-log-" + b : "");
        e.innerHTML = a;
        s.appendChild(e);
        setTimeout(function() {
          e.className += " alertify-log-show"
        }, 50);
        this.close(e, d);
        this.lastItem = e
      },
      set: function(a) {
        var b;
        if ("object" !== typeof a && a instanceof Array) throw Error("args must be an object");
        for (b in a) a.hasOwnProperty(b) && (this[b] = a[b])
      },
      setFocus: function() {
        v ? (v.focus(), v.select()) : r.focus()
      },
      setup: function(a) {
        var c = d[0],
          p = this,
          s;
        f = !0;
        s = function(a) {
          a.stopPropagation();
          p.setFocus();
          p.unbind(t, p.transition.type, s)
        };
        this.transition.supported && !a && this.bind(t, this.transition.type, s);
        q.onclick = function() {
          b.hide()
        };
        t.innerHTML = "";
        t.appendChild(this.build(c));
        t.firstChild.onclick = function(a) {
          a.stopPropagation()
        };
        l = e("alertify-resetFocus");
        k = e("alertify-ok") || g;
        m = e("alertify-cancel") || g;
        r = "cancel" === b.buttonFocus ? m : "none" === b.buttonFocus ? e("alertify-noneFocus") : k;
        v = e("alertify-text") || g;
        w = e("alertify-form") || g;
        "string" === typeof c.placeholder && "" !== c.placeholder && (v.value = c.placeholder);
        a && this.setFocus();
        this.addListeners(c.callback)
      },
      unbind: function(a, b, c) {
        "function" === typeof a.removeEventListener ? a.removeEventListener(b, c, !1) : a.detachEvent && a.detachEvent("on" + b, c)
      }
    };
    return {
      close: function(a, c) {
        b.close(a, 1)
      },
      log_visible: function() {
        return !(!c.querySelector(".alertify-logs") || c.querySelector(".alertify-logs.alertify-logs-hidden"))
      },
      hide: function(a, c) {
        b.hide()
      },
      alert: function(a, c, d) {
        b.dialog(a, "alert", c, "", d);
        return this
      },
      confirm: function(a, c, d) {
        b.dialog(a, "confirm", c, "", d);
        return this
      },
      extend: b.extend,
      init: b.init,
      log: function(a, c, d) {
        b.log(a, c, d);
        return this
      },
      prompt: function(a, c, d, e) {
        b.dialog(a, "prompt", c, d, e);
        return this
      },
      success: function(a, c) {
        b.log(a, "success", c);
        return this
      },
      error: function(a, c) {
        b.log(a, "error", c);
        return this
      },
      set: function(a) {
        b.set(a)
      },
      labels: b.labels,
      debug: b.handleErrors
    }
  };
  "function" === typeof define && define.amd ? define([], function() {
    return new f
  }) : "undefined" === typeof a.alertify && (a.alertify = new f)
})(this);
"undefined" === typeof sketch && (sketch = {});
"undefined" === typeof sketch.color && (sketch.color = {});
(function(a) {
  a.color.picker = function(d) {
    "undefined" === typeof d && (d = {});
    var e = this,
      f = {
        light: {
          arrow: "000",
          interlace: {
            size: 8,
            color1: "#fff",
            color2: "#eee"
          }
        },
        dark: {
          arrow: "#fff",
          interlace: {
            size: 8,
            color1: "#fff",
            color2: "#eee"
          }
        }
      };
    this.init = function() {
      window.zIndexGlobal || (window.zIndexGlobal = 100);
      this.pixelRatio = 1;
      this.state = "colorPicker";
      this.color = h(d.color || "#000");
      this.container = d.container || document.body;
      this.margin = d.margin || 10;
      this.offset = this.margin / 2;
      this.strokeColor = d.strokeColor || "rgba(255,255,255,0.15)";
      this.recordId = d.recordId;
      this.feature = d.feature || {};
      this.eyeDropper = this.feature.eyeDropper || {};
      this.theme = f[d.theme || "dark"];
      var a = this.theme.arrow,
        e = document.createElement("canvas"),
        k = e.getContext("2d"),
        q = 16 / 3;
      e.width = 16;
      e.height = 16;
      for (var t = 0; 20 > t; t++) k.beginPath(), k.fillStyle = a, k.moveTo(0, 4), k.lineTo(4, 0), k.lineTo(4, 8), k.fill();
      k.translate(-q, -16);
      this.arrow = e;
      a = document.createElement("canvas");
      a.width = 10;
      a.height = 10;
      e = a.getContext("2d");
      e.lineWidth = 1;
      e.beginPath();
      k = a.width / 2;
      q = a.width / 2;
      e.arc(k,
        q, 4.5, 0, 2 * Math.PI, !0);
      e.strokeStyle = "#000";
      e.stroke();
      e.beginPath();
      e.arc(k, q, 3.5, 0, 2 * Math.PI, !0);
      e.strokeStyle = "#FFF";
      e.stroke();
      this.circle = a;
      k = this.theme.interlace;
      a = k.size;
      e = k.color1;
      q = k.color2;
      k = document.createElement("canvas").getContext("2d");
      k.canvas.width = 2 * a;
      k.canvas.height = 2 * a;
      k.fillStyle = e;
      k.fillRect(0, 0, a, a);
      k.fillStyle = q;
      k.fillRect(a, 0, a, a);
      k.fillStyle = q;
      k.fillRect(0, a, a, a);
      k.fillStyle = e;
      k.fillRect(a, a, a, a);
      a = k.createPattern(k.canvas, "repeat");
      try {
        a.data = k.canvas.toDataURL()
      } catch (s) {}
      this.interlace =
        a;
      this.onChange = d.onChange || d.onchange;
      this.onClose = d.onClose || d.onclose;
      this.onMouseDown = d.onMouseDown || d.onmousedown;
      this.onMouseUp = d.onMouseUp || d.onmousedown;
      this.modules = d.modules || {
        hue: !0,
        satval: !0,
        alpha: !0
      };
      this.conf = {};
      this.modules.hue && (a = this.modules.hue, this.conf.hue = {
        column: 0,
        enable: !d.modules || a.enable || !1,
        width: isFinite(a.width) ? a.width : 30,
        height: isFinite(a.height) ? a.height : 200
      });
      this.modules.satval && (a = this.modules.satval, this.conf.satval = {
        column: 1,
        enable: !d.modules || a.enable || !1,
        width: isFinite(a.width) ?
          a.width : 200,
        height: isFinite(a.height) ? a.height : 200
      });
      this.modules.alpha && (a = this.modules.alpha, this.conf.alpha = {
        column: 2,
        enable: !d.modules || a.enable || !1,
        width: isFinite(a.width) ? a.width : 30,
        height: isFinite(a.height) ? a.height : 200
      });
      a = this.element = document.createElement("div");
      a.id = d.id || "ColorPicker";
      d.className && (a.className = d.className);
      d.style && (a.style.cssText = d.style);
      d.draggable && eventjs.proxy.dragElement(a);
      this.container.appendChild(a);
      this.feature.hexInput && c(this);
      this.feature.closeButton &&
        b(this);
      g(this);
      this.update();
      "undefined" !== typeof d.display && (d.display ? this.open() : this.close());
      return this
    };
    this.update = function(a, b, c) {
      a && (e.color = h(a));
      "number" === typeof b && (e.color.A = b);
      b = a = 0;
      var d = -1,
        f;
      for (f in e.conf) {
        var g = e.conf[f];
        !1 !== g.enable && (a += g.width + e.margin + e.offset - 5, d !== g.row && (b += g.height + 2 * e.margin, d = g.row))
      }
      a *= e.pixelRatio;
      b *= e.pixelRatio;
      f = e.canvas;
      d = e.element;
      if (f.width !== a || f.height !== b) f.width = a, f.height = b, f.style.cssText = "left: " + -(e.offset - 1) + "px;", d.style.height = b +
        "px", d.style.width = a + "px";
      e.render(c || "update", !0);
      return e
    };
    this.render = function(b, c) {
      var d = e.conf.satval,
        f = e.conf.hue,
        g = e.conf.alpha,
        h = e.canvas,
        m = e.ctx;
      m.clearRect(0, 0, h.width, h.height);
      var v = a.color.space({
        H: e.color.H,
        S: 100,
        V: 100
      }, "HSV>RGB>HEX24>W3");
      a.color.space.HEX_RGB("0x" + v);
      var h = e.offset,
        u = e.conf.satval.width,
        y = e.conf.satval.height,
        x = e.ctx;
      x.save();
      x.fillStyle = e.interlace;
      x.fillRect(h, e.offset, e.conf.satval.width, e.conf.satval.height);
      x.globalAlpha = e.color.A / 255;
      x.fillStyle = k(v, "satval");
      x.fillRect(h, h, u, y);
      v = x.createLinearGradient(h, h, u + h, 0);
      v.addColorStop(0, k("rgba(255, 255, 255, 1)", "satval"));
      v.addColorStop(1, k("rgba(255, 255, 255, 0)", "satval"));
      x.fillStyle = v;
      x.fillRect(h, h, u, y);
      v = x.createLinearGradient(0, h, 0, y + h);
      v.addColorStop(0, "rgba(0, 0, 0, 0)");
      v.addColorStop(1, "rgba(0, 0, 0, 1)");
      x.fillStyle = v;
      x.fillRect(h, h, u, y);
      x.strokeStyle = k(e.strokeColor, "satval");
      x.strokeRect(h + 0.5, h + 0.5, u - 1, y - 1);
      x.restore();
      h = e.ctx;
      u = e.conf.satval.width + e.margin + e.offset;
      h.fillStyle = e.interlace;
      h.fillRect(u, e.offset, e.conf.hue.width, e.conf.hue.height);
      y = h.createLinearGradient(0, 0, 0, e.conf.hue.height + e.offset);
      y.addColorStop(0, k("rgba(255, 0, 0, 1)", "hue"));
      y.addColorStop(5 / 6, k("rgba(255, 255, 0, 1)", "hue"));
      y.addColorStop(4 / 6, k("rgba(0, 255, 0, 1)", "hue"));
      y.addColorStop(0.5, k("rgba(0, 255, 255, 1)", "hue"));
      y.addColorStop(2 / 6, k("rgba(0, 0, 255, 1)", "hue"));
      y.addColorStop(1 / 6, k("rgba(255, 0, 255, 1)", "hue"));
      y.addColorStop(1, k("rgba(255, 0, 0, 1)", "hue"));
      h.save();
      h.globalAlpha = e.color.A /
        255;
      h.fillStyle = y;
      h.fillRect(u, e.offset, e.conf.hue.width, e.conf.hue.height);
      h.strokeStyle = k(e.strokeColor, "hue");
      h.strokeRect(u + 0.5, e.offset + 0.5, e.conf.hue.width - 1, e.conf.hue.height - 1);
      h.restore();
      g.enable && (h = e.ctx, u = e.conf.satval.width + 2 * e.margin + e.conf.hue.width + e.offset, h.fillStyle = e.interlace, h.fillRect(u, e.offset, e.conf.alpha.width, e.conf.satval.height), y = a.color.space.HSV_RGB({
        H: e.color.H,
        S: e.color.S,
        V: e.color.V
      }), x = h.createLinearGradient(0, 0, 0, e.conf.satval.height), y.A = 255, x.addColorStop(0,
        k(a.color.space.RGBA_W3(y), "alpha")), y.A = 0, x.addColorStop(1, k(a.color.space.RGBA_W3(y), "alpha")), h.fillStyle = x, h.fillRect(u, e.offset, e.conf.alpha.width, e.conf.satval.height), h.strokeStyle = e.strokeColor, h.strokeRect(u + 0.5, e.offset + 0.5, e.conf.alpha.width - 1, e.conf.satval.height - 1));
      h = a.color.space(e.color, "HSVA>RGBA");
      u = a.color.space(h, "RGB>HEX24>W3");
      e.feature.hexInput && (e.hexInput.value = u.substr(1), e.hexBox.style.backgroundColor = a.color.space(h, "RGBA>W3"));
      m.save();
      g.enable && (m.globalAlpha = g.enable ?
        1 : 0, g = d.width + 2 * e.margin + f.width + g.width + e.offset, u = (255 - e.color.A) / 255 * d.height - 2, m.drawImage(e.arrow, g + 2, Math.round(u) + e.offset - 1));
      f && (m.globalAlpha = f.enable ? 1 : 0, g = d.width + e.margin + e.offset + f.width, u = (360 - e.color.H) / 362 * d.height - 2, u = Math.round(u) + e.offset - 1, m.drawImage(e.arrow, g + 2, u), m.beginPath(), m.moveTo(g - f.width, u + 3.5), m.lineTo(g, u + 3.5), m.strokeStyle = "rgba(255,255,255,0.5)", m.stroke(), m.beginPath(), m.moveTo(g - f.width, u + 4.5), m.lineTo(g, u + 4.5), m.strokeStyle = "rgba(0,0,0,0.5)", m.stroke());
      d && (m.globalAlpha =
        d.enable ? 1 : 0, g = e.color.S / 100 * d.width, u = (1 - e.color.V / 100) * d.height, g -= e.circle.width / 2, u -= e.circle.height / 2, m.drawImage(e.circle, Math.round(g) + e.offset, Math.round(u) + e.offset));
      m.restore();
      e.onChange && (b && c) && (d = e.toString(h), e.onChange(h, b, d))
    };
    var k = function(b, c) {
      if (!0 === e.conf[c].enable) return b;
      b = "rgba" === b.substr(0, 4) ? a.color.space(b, "W3>RGBA") : a.color.space(b, "W3>HEX32>RGBA");
      var d = Math.round(0.33 * b.R + 0.33 * b.G + 0.33 * b.B);
      return "rgba(" + d + "," + d + "," + d + "," + 0.42 * (b.A / 255) + ")"
    };
    this.toggle = function(a) {
      return "boolean" ===
        typeof a ? a ? e.open() : e.close() : -1 === (" " + e.element.className + " ").indexOf(" opened ") ? e.open() : e.close()
    };
    this.open = function() {
      var a = e.element,
        a = e.recordId || a.id,
        b = document.getElementById(a);
      d.recordWindow && d.recordWindow && d.recordWindow({
        id: a,
        display: "block"
      }); - 1 === (" " + b.className + " ").indexOf(" opened ") && (b.className = (b.className + " opened").trim());
      b.style.display = "block";
      b.style.zIndex = window.zIndexGlobal++;
      window.clearTimeout(b.interval);
      return e
    };
    this.close = function() {
      var a = e.element,
        a = e.recordId ||
        a.id,
        b = document.getElementById(a);
      d.recordWindow && d.recordWindow({
        id: a,
        display: "none"
      });
      b.className = (" " + b.className + " ").replace(" opened ", " ").trim();
      b.interval = setTimeout(function() {
        b.style.display = "none"
      }, 250);
      return e
    };
    this.destory = function() {
      document.body.removeChild(e.element);
      for (var a in e) delete e[a];
      return e
    };
    this.toString = function(b) {
      b = b || e.color;
      isFinite(b.H) && (b = a.color.space(b, "HSVA>RGBA"));
      return 255 === b.A ? a.color.space(b, "RGB>HEX24>W3") : a.color.space(b, "RGBA>W3")
    };
    return this.init()
  };
  var g = function(a) {
      var b = a.element,
        c = document.createElement("canvas"),
        f = c.getContext("2d");
      a.canvas = c;
      a.ctx = f;
      b.appendChild(c);
      eventjs.add(c, "drag", function(f, g) {
        eventjs.stop(f);
        var h = "down" === g.state,
          k = "up" === g.state;
        if (h && ("function" === typeof a.mouseLayerExit && a.mouseLayerExit(), a.onMouseDown)) a.onMouseDown(f);
        if (k && a.onMouseUp) a.onMouseUp(f);
        var t = a.margin / 2,
          s = g.x - t,
          t = g.y - t,
          w = 0 > s ? 0 : s > c.width ? c.width : s,
          v = 0 > t ? 0 : t > c.height ? c.height : t;
        if ("hexInput" === g.target.className) h && eventjs.stop(f), b.style.cursor =
          "text";
        else {
          if (w !== s || v !== t) a.feature.drag ? (b.style.cursor = "move", b.title = "Move", h && eventjs.proxy.drag({
            position: "move",
            event: f,
            target: b,
            animationFrame: !0,
            listener: function(c, f) {
              var g = window.innerWidth,
                h = window.innerHeight,
                k = f.target.offsetWidth,
                l = f.target.offsetHeight;
              f.x + k > g && (f.x = g - k);
              f.y + l > h && (f.y = h - l);
              0 > f.x && (f.x = 0);
              0 > f.y && (f.y = 0);
              b.style.left = f.x + "px";
              b.style.top = f.y + "px";
              "down" === f.state ? b.style.zIndex = window.zIndexGlobal++ : "up" === f.state && conf.recordWindow && conf.recordWindow({
                id: a.recordId ||
                  b.id,
                left: f.x / g,
                top: f.y / h,
                display: "block"
              });
              eventjs.prevent(c)
            }
          })) : b.style.cursor = "default";
          else if (w <= a.conf.satval.width) {
            if (!1 === a.conf.satval.enable) return;
            h && eventjs.stop(f);
            b.style.cursor = "default";
            b.title = "Saturation + Value";
            h && eventjs.proxy.drag({
              position: "relative",
              event: f,
              target: c,
              animationFrame: !0,
              listener: function(b, c) {
                var e = 0 > c.y - a.offset ? 0 : c.y - a.offset > a.conf.satval.height ? a.conf.satval.height : c.y - a.offset;
                a.color.S = 100 * ((0 > c.x - a.offset ? 0 : c.x - a.offset > a.conf.satval.width ? a.conf.satval.width :
                  c.x - a.offset) / a.conf.satval.width);
                a.color.V = 100 - 100 * (e / a.conf.satval.height);
                a.render(c.state, !0);
                eventjs.prevent(b)
              }
            })
          } else if (w > a.conf.satval.width + a.margin && w <= a.conf.satval.width + a.margin + a.offset + a.conf.hue.width) {
            if (!1 === a.conf.hue.enable) return;
            h && eventjs.stop(f);
            b.style.cursor = "crosshair";
            b.title = "Hue";
            h && eventjs.proxy.drag({
              position: "relative",
              event: f,
              target: c,
              animationFrame: !0,
              listener: function(b, c) {
                a.color.H = 360 - 360 * Math.min(1, (0 > c.y - a.offset ? 0 : c.y - a.offset > a.conf.satval.height ? a.conf.satval.height :
                  c.y - a.offset) / a.conf.satval.height);
                a.render(c.state, !0);
                eventjs.prevent(b)
              }
            })
          } else if (a.conf.alpha && w > a.conf.satval.width + a.conf.alpha.width + 2 * a.margin && w <= a.conf.satval.width + 2 * a.margin + a.offset + 2 * a.conf.alpha.width) {
            if (!1 === a.conf.alpha.enable) return;
            h && eventjs.stop(f);
            b.style.cursor = "crosshair";
            b.title = "Alpha";
            h && eventjs.proxy.drag({
              position: "relative",
              event: f,
              target: c,
              animationFrame: !0,
              listener: function(b, c) {
                a.color.A = 255 * (1 - Math.min(1, (0 > c.y - a.offset ? 0 : c.y - a.offset > a.conf.satval.height ? a.conf.satval.height :
                  c.y - a.offset) / a.conf.satval.height));
                a.render(c.state, !0);
                eventjs.prevent(b)
              }
            })
          } else b.style.cursor = "default";
          k && (b.style.cursor = "default");
          return !1
        }
      })
    },
    c = function(b) {
      var c = b.hexBoxContainer = document.createElement("div");
      b.interlace.data && (c.style.backgroundImage = "url(" + b.interlace.data + ")");
      c.className = "hexBox";
      c.title = "Eyedropper";
      var g = b.element,
        h = b.hexBox = document.createElement("div");
      c.appendChild(h);
      g.appendChild(c);
      b.eyeDropper.target && f(b);
      var l = /[^a-f0-9]/gi,
        r = b.hexInput = document.createElement("input");
      r.title = "HEX Code";
      r.className = "hexInput";
      r.size = 6;
      r.type = "text";
      eventjs.add(r, "mousedown", eventjs.stop);
      eventjs.add(r, "keydown keyup change", function(c) {
        var e = c.keyCode;
        eventjs.proxy.metaTracker(c);
        setTimeout(function() {
          var f = r.value.replace(l, "").substr(0, 6),
            f = a.color.space(f, "W3>HEX24");
          if ("NaN" !== String(f)) {
            if ("keydown" === c.type || "keyup" === c.type)
              if (40 === e) f = Math.max(0, f - (c.shiftKey ? 10 : 1)), r.value = a.color.space(f, "HEX24>W3").substr(1);
              else if (38 === e) f = Math.min(16777215, f + (c.shiftKey ? 10 : 1)), r.value =
              a.color.space(f, "HEX24>W3").substr(1);
            else if (!eventjs.metaKey || 86 !== e) return;
            16777215 < f && (f = 16777215);
            0 > f && (f = 0);
            b.update(a.color.space(f, "HEX24>RGB"), "RGB", "up")
          }
        }, 50);
        27 === e && this.blur()
      });
      g.appendChild(r)
    },
    f = function(b) {
      var c = b.element,
        f = b.modules,
        g = document.createElement("span");
      g.className = "icon-eyedropper";
      b.feature.closeButton && (g.style.marginRight = "16px");
      c.appendChild(g);
      var h = b.eyeDropper.target,
        r = null,
        p;
      b.mouseLayerUpdate = function(c) {
        eventjs.prevent(c);
        c = eventjs.proxy.getCoord(c);
        var e =
          eventjs.proxy.getBoundingBox(h);
        c.x += e.scrollLeft - e.x1;
        c.y += e.scrollTop - e.y1;
        c = b.eyeDropper.canvas.getContext("2d").getImageData(c.x, c.y, 1, 1);
        0 !== c.data[3] && (r = a.color.space(c.data, "RGBA>HSVA"), f.alpha || (r.A = 255), b.update(r, "HSVA"))
      };
      b.mouseLayerExit = function() {
        r && b.update(r, "HSVA", "up");
        b.hexBoxContainer.className = "hexBox";
        h.style.cursor = "default";
        h.title = p;
        eventjs.remove(document.body, "mouseup", b.mouseLayerExit);
        eventjs.remove(h, "mousemove", b.mouseLayerUpdate);
        setTimeout(function() {
            b.state = "colorPicker"
          },
          50)
      };
      eventjs.add({
        target: g,
        mouseover: function(b) {
          a.setTooltip && a.setTooltip("Eye Dropper");
          eventjs.stop(b)
        },
        mouseout: function(b) {
          a.setTooltip && a.setTooltip("");
          eventjs.stop(b)
        },
        click: function(a) {
          if ("eyeDropper" === b.state) return b.mouseLayerExit();
          r = null;
          b.state = "eyeDropper";
          p = h.title;
          b.hexBoxContainer.className = "hexBox active";
          h.style.cursor = "crosshair";
          h.title = "Pick color";
          setTimeout(function() {
            eventjs.add(document.body, "mouseup", b.mouseLayerExit);
            eventjs.add(h, "mousemove", b.mouseLayerUpdate)
          }, 0)
        }
      })
    },
    b = function(b) {
      var c = b.element,
        f = document.createElement("div");
      f.title = "Close";
      f.className = "hexClose icon-close";
      f.innerHTML = "x";
      eventjs.add({
        target: f,
        mousedown: eventjs.cancel,
        mouseover: function(b) {
          a.setTooltip && a.setTooltip("Close Color Picker");
          eventjs.stop(b)
        },
        mouseout: function(b) {
          a.setTooltip && a.setTooltip("");
          eventjs.stop(b)
        },
        click: b.onClose || function(a) {
          eventjs.cancel(a);
          b.close()
        }
      });
      c.appendChild(f)
    },
    h = function(b) {
      "string" === typeof b ? b = "hsla" === b.substr(0, 4) ? a.color.space(b, "W3>HSLA>RGBA>HSVA") :
        "rgba" === b.substr(0, 4) ? a.color.space(b, "W3>RGBA>HSVA") : "rgb" === b.substr(0, 3) ? a.color.space(b, "W3>RGB>HSV") : a.color.webcolors[b] ? a.color.space(a.color.webcolors[b], "W3>HEX24>RGB>HSV") : a.color.space(b, "W3>HEX24>RGB>HSV") : "undefined" !== typeof b.R && (b = a.color.space(b, "RGB>HSV"));
      "undefined" === typeof b.A && (b.A = 255);
      return b
    }
})(sketch);
var EnableContextMenu = function(a, g) {
  function c(b) {
    b = F(b);
    var c, d, e, f;
    a.body.appendChild(b);
    if (C) return b;
    c = b.getElementsByTagName("cmenu");
    d = [b];
    e = 0;
    for (f = c.length; e < f; e++) d.push(c[e]);
    e = 0;
    for (f = d.length; e < f; e++) w(d[e]);
    return b
  }

  function f(a) {
    setTimeout(a, 0)
  }

  function b(a) {
    var b = 0,
      c = 0;
    if (a.getClientRects) return a.getClientRects()[0];
    do b += a.offsetLeft, c += a.offsetTop, a = a.offsetParent; while (a);
    return {
      left: b,
      top: c
    }
  }

  function h(a) {
    return a.get ? a.get(0) : a
  }

  function d(a, b) {
    if ("none" !== a.style.display) {
      if (b) throw "no need to fade";
      a.style.display = "none";
      var d = a.launcher;
      d && d.removeAttribute("open");
      c.visible--
    }
  }

  function e() {
    var a = L.pop();
    d(a);
    return a
  }

  function m() {
    I.style.opacity = "0.0";
    J = setTimeout(function() {
      for (; L.length;) e(!1);
      I.style.display = "none";
      I.style.opacity = "1.0";
      A()
    }, P)
  }

  function k(a) {
    "inline-block" !== a.style.display && (a.style.display = "inline-block", c.visible++)
  }

  function l(a) {
    a.stopPropagation();
    a.preventDefault()
  }

  function r(a, b) {
    return b.nodeName === a ? b : r(a, b.parentNode || {
      nodeName: a
    })
  }

  function p(a) {
    var b = r("CMENU",
      a.target);
    if (O) {
      if (O === b) {
        L.push(b);
        O = void 0;
        return
      }
      console.error("SHOULD NOT BE A PREVIEW")
    }
    a = L.length;
    b = L.indexOf(b);
    for (a -= 1; a > b; a--) e()
  }

  function q(a) {
    if ("CMENU" !== a.target.nodeName || 0 !== a.offsetX) return a.stopPropagation(), a.preventDefault(), !1
  }

  function t(a) {
    Q = clearTimeout(Q);
    if (r("CMENU", a.toElement) === O) return !1;
    O && (d(O), O = void 0)
  }

  function s(a) {
    Q = clearTimeout(Q);
    Q = setTimeout(function() {
      var c = a.srcElement,
        e = c._contextMenu;
      e.launcher = c;
      c.setAttribute("open", !0);
      O && O !== e && d(O);
      O = e;
      c = b(c);
      e.style.top =
        c.top - 5 + "px";
      e.style.left = c.left + c.width - 1 + "px";
      k(e)
    }, 200)
  }

  function w(b) {
    var c = b.parentNode,
      d;
    eventjs.add(b, "mouseover", p, !1);
    eventjs.add(b, "mousedown", q);
    eventjs.add(b, "contextmenu", l);
    "CMENU" === c.nodeName ? (d = a.createElement("menuitem"), b.classList.add("submenu"), d.className = b.className, d.innerHTML = b.innerHTML, d._contextMenu = b, eventjs.add(d, "mouseover", s), eventjs.add(d, "mouseout", t), c.replaceChild(d, b)) : c.removeChild(b);
    I.appendChild(b)
  }

  function v(a, b, c) {
    c -= 5;
    N = new Date;
    L.push(a);
    a.style.top = c + "px";
    a.style.left = b + "px";
    k(a);
    I.style.display = "block";
    K = !1;
    var d = b + a.offsetWidth,
      e = c + a.offsetHeight,
      f = document.body.offsetHeight,
      g = document.body.offsetWidth;
    e > f && (a.style.top = c - (e - f) + "px");
    d > g && (a.style.left = b - (d - g) + "px")
  }

  function u(a, c, d) {
    var e;
    void 0 === d && (d = a.target);
    e = b(d);
    void 0 === c && (c = x(d));
    v(c, e.left, e.top + e.height + 8);
    a && (a.preventDefault(), a.stopPropagation());
    K = !0;
    return !1
  }

  function y(a, b, c) {
    u(a);
    K = !1
  }

  function x(b) {
    if (b && b.hasAttribute) return b._contextMenu ? b._contextMenu : b.hasAttribute("contextmenu") ?
      (b = a.getElementById(b.getAttribute("contextmenu")), b._contextMenu = b) : x(b.parentNode)
  }

  function z(a) {
    var b = x(a.srcElement),
      c = a.clientX,
      d = a.clientY;
    v(b, a.clientX, a.clientY);
    K = !0;
    E = c;
    H = d;
    a.preventDefault();
    a.stopPropagation();
    return !1
  }

  function A() {
    R.forEach(function(a) {
      try {
        a()
      } catch (b) {
        setTimeout(function() {
          throw b;
        }, 0)
      }
    });
    R = []
  }

  function B() {
    L = [];
    I = a.createElement("div");
    var b = "osx10_7",
      c = 0;
    /Mac/.test(navigator.userAgent) ? b = "osx10_7" : /Win/.test(navigator.userAgent) && (b = "win7");
    a.body.classList && (a.body.classList.add(b),
      I.className = "_contextmenu_screen_", P = 150, N = 0, a.body.appendChild(I), eventjs.add(I, "contextmenu", function(a) {
        a.preventDefault()
      }), eventjs.add(I, "mousedown", function(a) {
        m(a)
      }), eventjs.add(I, "mouseup", function(a) {
        a.stopPropagation();
        if (!c) {
          var b = a.target;
          if ("MENUITEM" === b.nodeName) {
            if (b._contextMenu) return !1;
            if (K) {
              var d;
              document.createEvent && (d = document.createEvent("MouseEvents"));
              b && (b.dispatchEvent && d && d.initMouseEvent) && (d.initMouseEvent("click", !0, !0, document.defaultView, 1, a.screenX, a.screenY, a.clientX,
                a.clientY, !1, !1, !1, !1, 0, null), b.dispatchEvent(d))
            }
          }
          300 > new Date - N ? K = !1 : m(a)
        }
      }), eventjs.add(I, "mousewheel", function(a) {
        a.preventDefault();
        a.stopPropagation();
        return !1
      }, !0), eventjs.add(I, "contextmenu", function(b) {
        I.style.display = "none";
        var e = a.elementFromPoint(b.clientX, b.clientY),
          g = x(e),
          h, k, l;
        if (g) {
          I.style.display = "block";
          clearTimeout(J);
          b.preventDefault();
          if (L[0] === g && (e = b.clientX, h = b.clientY, k = e - E, l = h - H, E = e, H = h, 50 > k * k + l * l)) {
            I.style.opacity = "1.0";
            I.style.display = "block";
            clearTimeout(J);
            f(m);
            return
          }
          c++;
          setTimeout(function() {
            for (; L.length;) {
              var a = L.pop();
              d(a)
            }
            I.style.display = "none";
            I.style.opacity = "1.0";
            I.style.display = "block";
            f(function() {
              c--;
              v(g, b.clientX, b.clientY)
            })
          }, P);
          return !1
        }
        I.style.opacity = "1.0";
        I.style.display = "block";
        clearTimeout(J);
        f(m)
      }), eventjs.add(I, "mouseover", function(a) {
        a.target === I && (Q = clearTimeout(Q), O && (d(O), O = void 0))
      }))
  }

  function D() {
    var b = a.getElementsByTagName("cmenu"),
      c, d, e = [];
    c = 0;
    for (d = b.length; c < d; c++) e[c] = b[c];
    c = 0;
    for (d = e.length; c < d; c++) w(e[c])
  }

  function G() {
    var b = a.querySelectorAll("[contextmenu]"),
      c, d, e;
    d = 0;
    for (e = b.length; d < e; d++) c = b[d], c._contextMenu = a.getElementById(c.getAttribute("contextmenu")), "INPUT" === c.nodeName ? (eventjs.add(c, "mouseup", y), eventjs.add(c, "contextmenu", u)) : eventjs.add(c, "contextmenu", z)
  }

  function F(b) {
    var c = a.createElement("cmenu"),
      d, e, f, g;
    c.setAttribute("type", "context");
    d = 0;
    for (e = b.length; d < e; d++)
      if (f = b[d]) {
        if (f.children) g = F(f.children), g.setAttribute("label", f.label);
        else if (f.hr) g = a.createElement("hr");
        else {
          g = a.createElement("menuitem");
          g.innerHTML = f.label;
          g.className =
            f.className || "";
          f.onclick && eventjs.add(g, "mouseup", f.onclick);
          f.icon && (g.icon = f.icon);
          f.checked && g.setAttribute("checked", f.checked ? "checked" : "");
          var h, k = {
            label: !0,
            icon: !0,
            hr: !0,
            onclick: !0,
            checked: !0
          };
          for (h in f) f.hasOwnProperty(h) && k[h] && g.dataset && (g.dataset[h] = f[h])
        }
        c.appendChild(g)
      }
    return c
  }
  var C = !1,
    E, H, J, I, L, O, P, N, Q, K = !1,
    R = [],
    S = g.contextmenu;
  c.hide = function(a, b) {
    a = a || c.menu;
    d(a, b)
  };
  c.show = function(b, d, e, f) {
    c.menu = b;
    if (C) throw "Not supported!";
    "string" === typeof b ? b = a.getElementById(b) : (b = h(b),
      b.id = b.id || (0 | 1E4 * Math.random()).toString(30));
    "number" === typeof d ? (v(b, d, e), K = f || K) : (u(null, b, h(d)), K = !1);
    return this
  };
  c.then = function(a) {
    C ? a() : R.push(a)
  };
  c.attach = function(a, b) {
    a = h(a);
    b = h(b);
    b.id = b.id || (0 | 1E4 * Math.random()).toString(30);
    a._contextMenu = b;
    "INPUT" === a.nodeName || "BUTTON" === a.nodeName ? (eventjs.add(a, "mouseup", y), eventjs.add(a, "contextmenu", u)) : eventjs.add(a, "contextmenu", z)
  };
  c.noConflict = function() {
    g.contextmenu = S;
    return c
  };
  c.visible = 0;
  C || (B(), D(), G());
  return g.contextmenu = c
};